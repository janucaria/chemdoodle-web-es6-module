//
// ChemDoodle Web Components 8.0.0
//
// http://web.chemdoodle.com
//
// Copyright 2009-2017 iChemLabs, LLC.  All rights reserved.
//
// The ChemDoodle Web Components library is licensed under version 3
// of the GNU GENERAL PUBLIC LICENSE.
//
// You may redistribute it and/or modify it under the terms of the
// GNU General Public License as published by the Free Software Foundation,
// either version 3 of the License, or (at your option) any later version.
//
// As an exception to the GPL, you may distribute this packed form of
// the code without the copy of the GPL license normally required,
// provided you include this license notice and a URL through which
// recipients can access the corresponding unpacked source code. 
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// ChemDoodle Web Components employs 3rd party libraries under the MIT
// license. For a full list with links to the original source, go to:
// https://web.chemdoodle.com/installation/download/#libraries
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact-us> for
// alternate licensing options.
//
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ChemDoodle",[],e):"object"==typeof exports?exports.ChemDoodle=e():t.ChemDoodle=e()}(window,function(){return(o={},r.m=n=[function(t,e,i){"use strict";i.r(e);var s=i(2);i.d(e,"jQuery",function(){return s.a});var r=i(3);for(var n in r)["jQuery","jsBezier","MarchingCubes","default"].indexOf(n)<0&&function(t){i.d(e,t,function(){return r[t]})}(n);var o=i(4);i.d(e,"jsBezier",function(){return o.a});var a=i(5);i.d(e,"MarchingCubes",function(){return a.a})},function(je,Ge,t){var Xe,e,i;e="undefined"!=typeof window?window:this,i=function(D,t){function e(t,e){return e.toUpperCase()}var i=[],S=D.document,u=i.slice,p=i.concat,a=i.push,r=i.indexOf,s={},n=s.toString,m=s.hasOwnProperty,g={},T=function(t,e){return new T.fn.init(t,e)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,l=/^-ms-/,h=/-([\da-z])/gi;function c(t){var e=!!t&&"length"in t&&t.length,i=T.type(t);return"function"!==i&&!T.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}T.fn=T.prototype={jquery:"2.2.4",constructor:T,selector:"",length:0,toArray:function(){return u.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:u.call(this)},pushStack:function(t){var e=T.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return T.each(this,t)},map:function(i){return this.pushStack(T.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(0<=i&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},T.extend=T.fn.extend=function(){var t,e,i,s,r,n,o=arguments[0]||{},a=1,l=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[a]||{},a++),"object"==typeof o||T.isFunction(o)||(o={}),a===l&&(o=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=o[e],o!==(s=t[e])&&(h&&s&&(T.isPlainObject(s)||(r=T.isArray(s)))?(n=r?(r=!1,i&&T.isArray(i)?i:[]):i&&T.isPlainObject(i)?i:{},o[e]=T.extend(h,n,s)):void 0!==s&&(o[e]=s));return o},T.extend({expando:"jQuery"+("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===T.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!T.isArray(t)&&0<=e-parseFloat(e)+1},isPlainObject:function(t){var e;if("object"!==T.type(t)||t.nodeType||T.isWindow(t))return!1;if(t.constructor&&!m.call(t,"constructor")&&!m.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||m.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?s[n.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;(t=T.trim(t))&&(1===t.indexOf("use strict")?((e=S.createElement("script")).text=t,S.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(l,"ms-").replace(h,e)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,s=0;if(c(t))for(i=t.length;s<i&&!1!==e.call(t[s],s,t[s]);s++);else for(s in t)if(!1===e.call(t[s],s,t[s]))break;return t},trim:function(t){return null==t?"":(t+"").replace(o,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(c(Object(t))?T.merge(i,"string"==typeof t?[t]:t):a.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},merge:function(t,e){for(var i=+e.length,s=0,r=t.length;s<i;s++)t[r++]=e[s];return t.length=r,t},grep:function(t,e,i){for(var s=[],r=0,n=t.length,o=!i;r<n;r++)!e(t[r],r)!=o&&s.push(t[r]);return s},map:function(t,e,i){var s,r,n=0,o=[];if(c(t))for(s=t.length;n<s;n++)null!=(r=e(t[n],n,i))&&o.push(r);else for(n in t)null!=(r=e(t[n],n,i))&&o.push(r);return p.apply([],o)},guid:1,proxy:function(t,e){var i,s,r;if("string"==typeof e&&(i=t[e],e=t,t=i),T.isFunction(t))return s=u.call(arguments,2),(r=function(){return t.apply(e||this,s.concat(u.call(arguments)))}).guid=t.guid=t.guid||T.guid++,r},now:Date.now,support:g}),"function"==typeof Symbol&&(T.fn[Symbol.iterator]=i[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){s["[object "+e+"]"]=e.toLowerCase()});var f=function(i){function c(t,e,i){var s="0x"+e-65536;return s!=s||i?e:s<0?String.fromCharCode(65536+s):String.fromCharCode(s>>10|55296,1023&s|56320)}function r(){w()}var t,m,b,n,o,p,f,g,y,l,h,w,D,a,S,_,u,d,v,T="sizzle"+1*new Date,x=i.document,C=0,s=0,A=rt(),E=rt(),F=rt(),P=function(t,e){return t===e&&(h=!0),0},R={}.hasOwnProperty,e=[],B=e.pop,M=e.push,I=e.push,L=e.slice,N=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},k="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",z="[\\x20\\t\\r\\n\\f]",O="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",U="\\["+z+"*("+O+")(?:"+z+"*([*^$|!~]?=)"+z+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+z+"*\\]",H=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",W=new RegExp(z+"+","g"),q=new RegExp("^"+z+"+|((?:^|[^\\\\])(?:\\\\.)*)"+z+"+$","g"),j=new RegExp("^"+z+"*,"+z+"*"),G=new RegExp("^"+z+"*([>+~]|"+z+")"+z+"*"),X=new RegExp("="+z+"*([^\\]'\"]*?)"+z+"*\\]","g"),V=new RegExp(H),Y=new RegExp("^"+O+"$"),Z={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+z+"*(even|odd|(([+-]|)(\\d*)n|)"+z+"*(?:([+-]|)"+z+"*(\\d+)|))"+z+"*\\)|)","i"),bool:new RegExp("^(?:"+k+")$","i"),needsContext:new RegExp("^"+z+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+z+"*((?:-\\d)?\\d*)"+z+"*\\)|)(?=[^-]|$)","i")},$=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=/'|\\/g,it=new RegExp("\\\\([\\da-f]{1,6}"+z+"?|("+z+")|.)","ig");try{I.apply(e=L.call(x.childNodes),x.childNodes),e[x.childNodes.length].nodeType}catch(t){I={apply:e.length?function(t,e){M.apply(t,L.call(e))}:function(t,e){for(var i=t.length,s=0;t[i++]=e[s++];);t.length=i-1}}}function st(t,e,i,s){var r,n,o,a,l,h,u,c,f=e&&e.ownerDocument,d=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return i;if(!s&&((e?e.ownerDocument||e:x)!==D&&w(e),e=e||D,S)){if(11!==d&&(h=K.exec(t)))if(r=h[1]){if(9===d){if(!(o=e.getElementById(r)))return i;if(o.id===r)return i.push(o),i}else if(f&&(o=f.getElementById(r))&&v(e,o)&&o.id===r)return i.push(o),i}else{if(h[2])return I.apply(i,e.getElementsByTagName(t)),i;if((r=h[3])&&m.getElementsByClassName&&e.getElementsByClassName)return I.apply(i,e.getElementsByClassName(r)),i}if(m.qsa&&!F[t+" "]&&(!_||!_.test(t))){if(1!==d)f=e,c=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(et,"\\$&"):e.setAttribute("id",a=T),n=(u=p(t)).length,l=Y.test(a)?"#"+a:"[id='"+a+"']";n--;)u[n]=l+" "+mt(u[n]);c=u.join(","),f=tt.test(t)&&ft(e.parentNode)||e}if(c)try{return I.apply(i,f.querySelectorAll(c)),i}catch(t){}finally{a===T&&e.removeAttribute("id")}}}return g(t.replace(q,"$1"),e,i,s)}function rt(){var s=[];return function t(e,i){return s.push(e+" ")>b.cacheLength&&delete t[s.shift()],t[e+" "]=i}}function nt(t){return t[T]=!0,t}function ot(t){var e=D.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function at(t,e){for(var i=t.split("|"),s=i.length;s--;)b.attrHandle[i[s]]=e}function lt(t,e){var i=e&&t,s=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(s)return s;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ht(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ut(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}function ct(o){return nt(function(n){return n=+n,nt(function(t,e){for(var i,s=o([],t.length,n),r=s.length;r--;)t[i=s[r]]&&(t[i]=!(e[i]=t[i]))})})}function ft(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in m=st.support={},o=st.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},w=st.setDocument=function(t){var e,i,s=t?t.ownerDocument||t:x;return s!==D&&9===s.nodeType&&s.documentElement&&(a=(D=s).documentElement,S=!o(D),(i=D.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",r,!1):i.attachEvent&&i.attachEvent("onunload",r)),m.attributes=ot(function(t){return t.className="i",!t.getAttribute("className")}),m.getElementsByTagName=ot(function(t){return t.appendChild(D.createComment("")),!t.getElementsByTagName("*").length}),m.getElementsByClassName=J.test(D.getElementsByClassName),m.getById=ot(function(t){return a.appendChild(t).id=T,!D.getElementsByName||!D.getElementsByName(T).length}),m.getById?(b.find.ID=function(t,e){if(void 0!==e.getElementById&&S){var i=e.getElementById(t);return i?[i]:[]}},b.filter.ID=function(t){var e=t.replace(it,c);return function(t){return t.getAttribute("id")===e}}):(delete b.find.ID,b.filter.ID=function(t){var i=t.replace(it,c);return function(t){var e=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===i}}),b.find.TAG=m.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):m.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,s=[],r=0,n=e.getElementsByTagName(t);if("*"!==t)return n;for(;i=n[r++];)1===i.nodeType&&s.push(i);return s},b.find.CLASS=m.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&S)return e.getElementsByClassName(t)},u=[],_=[],(m.qsa=J.test(D.querySelectorAll))&&(ot(function(t){a.appendChild(t).innerHTML="<a id='"+T+"'></a><select id='"+T+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&_.push("[*^$]="+z+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||_.push("\\["+z+"*(?:value|"+k+")"),t.querySelectorAll("[id~="+T+"-]").length||_.push("~="),t.querySelectorAll(":checked").length||_.push(":checked"),t.querySelectorAll("a#"+T+"+*").length||_.push(".#.+[+~]")}),ot(function(t){var e=D.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&_.push("name"+z+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||_.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),_.push(",.*:")})),(m.matchesSelector=J.test(d=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ot(function(t){m.disconnectedMatch=d.call(t,"div"),d.call(t,"[s!='']:x"),u.push("!=",H)}),_=_.length&&new RegExp(_.join("|")),u=u.length&&new RegExp(u.join("|")),e=J.test(a.compareDocumentPosition),v=e||J.test(a.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,s=e&&e.parentNode;return t===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):t.compareDocumentPosition&&16&t.compareDocumentPosition(s)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},P=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!m.sortDetached&&e.compareDocumentPosition(t)===i?t===D||t.ownerDocument===x&&v(x,t)?-1:e===D||e.ownerDocument===x&&v(x,e)?1:l?N(l,t)-N(l,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var i,s=0,r=t.parentNode,n=e.parentNode,o=[t],a=[e];if(!r||!n)return t===D?-1:e===D?1:r?-1:n?1:l?N(l,t)-N(l,e):0;if(r===n)return lt(t,e);for(i=t;i=i.parentNode;)o.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;o[s]===a[s];)s++;return s?lt(o[s],a[s]):o[s]===x?-1:a[s]===x?1:0}),D},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if((t.ownerDocument||t)!==D&&w(t),e=e.replace(X,"='$1']"),m.matchesSelector&&S&&!F[e+" "]&&(!u||!u.test(e))&&(!_||!_.test(e)))try{var i=d.call(t,e);if(i||m.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return 0<st(e,D,null,[t]).length},st.contains=function(t,e){return(t.ownerDocument||t)!==D&&w(t),v(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!==D&&w(t);var i=b.attrHandle[e.toLowerCase()],s=i&&R.call(b.attrHandle,e.toLowerCase())?i(t,e,!S):void 0;return void 0!==s?s:m.attributes||!S?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,i=[],s=0,r=0;if(h=!m.detectDuplicates,l=!m.sortStable&&t.slice(0),t.sort(P),h){for(;e=t[r++];)e===t[r]&&(s=i.push(r));for(;s--;)t.splice(i[s],1)}return l=null,t},n=st.getText=function(t){var e,i="",s=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=n(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[s++];)i+=n(e);return i},(b=st.selectors={cacheLength:50,createPseudo:nt,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(it,c),t[3]=(t[3]||t[4]||t[5]||"").replace(it,c),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&V.test(i)&&(e=p(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(it,c).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=A[t+" "];return e||(e=new RegExp("(^|"+z+")"+t+"("+z+"|$)"))&&A(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(i,s,r){return function(t){var e=st.attr(t,i);return null==e?"!="===s:!s||(e+="","="===s?e===r:"!="===s?e!==r:"^="===s?r&&0===e.indexOf(r):"*="===s?r&&-1<e.indexOf(r):"$="===s?r&&e.slice(-r.length)===r:"~="===s?-1<(" "+e.replace(W," ")+" ").indexOf(r):"|="===s&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(m,t,e,p,g){var _="nth"!==m.slice(0,3),v="last"!==m.slice(-4),x="of-type"===t;return 1===p&&0===g?function(t){return!!t.parentNode}:function(t,e,i){var s,r,n,o,a,l,h=_!=v?"nextSibling":"previousSibling",u=t.parentNode,c=x&&t.nodeName.toLowerCase(),f=!i&&!x,d=!1;if(u){if(_){for(;h;){for(o=t;o=o[h];)if(x?o.nodeName.toLowerCase()===c:1===o.nodeType)return!1;l=h="only"===m&&!l&&"nextSibling"}return!0}if(l=[v?u.firstChild:u.lastChild],v&&f){for(d=(a=(s=(r=(n=(o=u)[T]||(o[T]={}))[o.uniqueID]||(n[o.uniqueID]={}))[m]||[])[0]===C&&s[1])&&s[2],o=a&&u.childNodes[a];o=++a&&o&&o[h]||(d=a=0)||l.pop();)if(1===o.nodeType&&++d&&o===t){r[m]=[C,a,d];break}}else if(f&&(d=a=(s=(r=(n=(o=t)[T]||(o[T]={}))[o.uniqueID]||(n[o.uniqueID]={}))[m]||[])[0]===C&&s[1]),!1===d)for(;(o=++a&&o&&o[h]||(d=a=0)||l.pop())&&((x?o.nodeName.toLowerCase()!==c:1!==o.nodeType)||!++d||(f&&((r=(n=o[T]||(o[T]={}))[o.uniqueID]||(n[o.uniqueID]={}))[m]=[C,d]),o!==t)););return(d-=g)===p||d%p==0&&0<=d/p}}},PSEUDO:function(t,n){var e,o=b.pseudos[t]||b.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return o[T]?o(n):1<o.length?(e=[t,t,"",n],b.setFilters.hasOwnProperty(t.toLowerCase())?nt(function(t,e){for(var i,s=o(t,n),r=s.length;r--;)t[i=N(t,s[r])]=!(e[i]=s[r])}):function(t){return o(t,0,e)}):o}},pseudos:{not:nt(function(t){var s=[],r=[],a=f(t.replace(q,"$1"));return a[T]?nt(function(t,e,i,s){for(var r,n=a(t,null,s,[]),o=t.length;o--;)(r=n[o])&&(t[o]=!(e[o]=r))}):function(t,e,i){return s[0]=t,a(s,null,i,r),s[0]=null,!r.pop()}}),has:nt(function(e){return function(t){return 0<st(e,t).length}}),contains:nt(function(e){return e=e.replace(it,c),function(t){return-1<(t.textContent||t.innerText||n(t)).indexOf(e)}}),lang:nt(function(i){return Y.test(i||"")||st.error("unsupported lang: "+i),i=i.replace(it,c).toLowerCase(),function(t){var e;do{if(e=S?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===a},focus:function(t){return t===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return $.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ct(function(){return[0]}),last:ct(function(t,e){return[e-1]}),eq:ct(function(t,e,i){return[i<0?i+e:i]}),even:ct(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:ct(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:ct(function(t,e,i){for(var s=i<0?i+e:i;0<=--s;)t.push(s);return t}),gt:ct(function(t,e,i){for(var s=i<0?i+e:i;++s<e;)t.push(s);return t})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[t]=ht(t);for(t in{submit:!0,reset:!0})b.pseudos[t]=ut(t);function dt(){}function mt(t){for(var e=0,i=t.length,s="";e<i;e++)s+=t[e].value;return s}function pt(a,t,e){var l=t.dir,h=e&&"parentNode"===l,u=s++;return t.first?function(t,e,i){for(;t=t[l];)if(1===t.nodeType||h)return a(t,e,i)}:function(t,e,i){var s,r,n,o=[C,u];if(i){for(;t=t[l];)if((1===t.nodeType||h)&&a(t,e,i))return!0}else for(;t=t[l];)if(1===t.nodeType||h){if((s=(r=(n=t[T]||(t[T]={}))[t.uniqueID]||(n[t.uniqueID]={}))[l])&&s[0]===C&&s[1]===u)return o[2]=s[2];if((r[l]=o)[2]=a(t,e,i))return!0}}}function gt(r){return 1<r.length?function(t,e,i){for(var s=r.length;s--;)if(!r[s](t,e,i))return!1;return!0}:r[0]}function _t(t,e,i,s,r){for(var n,o=[],a=0,l=t.length,h=null!=e;a<l;a++)(n=t[a])&&(i&&!i(n,s,r)||(o.push(n),h&&e.push(a)));return o}function vt(d,m,p,g,_,t){return g&&!g[T]&&(g=vt(g)),_&&!_[T]&&(_=vt(_,t)),nt(function(t,e,i,s){var r,n,o,a=[],l=[],h=e.length,u=t||function(t,e,i){for(var s=0,r=e.length;s<r;s++)st(t,e[s],i);return i}(m||"*",i.nodeType?[i]:i,[]),c=!d||!t&&m?u:_t(u,a,d,i,s),f=p?_||(t?d:h||g)?[]:e:c;if(p&&p(c,f,i,s),g)for(r=_t(f,l),g(r,[],i,s),n=r.length;n--;)(o=r[n])&&(f[l[n]]=!(c[l[n]]=o));if(t){if(_||d){if(_){for(r=[],n=f.length;n--;)(o=f[n])&&r.push(c[n]=o);_(null,f=[],r,s)}for(n=f.length;n--;)(o=f[n])&&-1<(r=_?N(t,o):a[n])&&(t[r]=!(e[r]=o))}}else f=_t(f===e?f.splice(h,f.length):f),_?_(null,e,f,s):I.apply(e,f)})}function xt(t){for(var r,e,i,s=t.length,n=b.relative[t[0].type],o=n||b.relative[" "],a=n?1:0,l=pt(function(t){return t===r},o,!0),h=pt(function(t){return-1<N(r,t)},o,!0),u=[function(t,e,i){var s=!n&&(i||e!==y)||((r=e).nodeType?l(t,e,i):h(t,e,i));return r=null,s}];a<s;a++)if(e=b.relative[t[a].type])u=[pt(gt(u),e)];else{if((e=b.filter[t[a].type].apply(null,t[a].matches))[T]){for(i=++a;i<s&&!b.relative[t[i].type];i++);return vt(1<a&&gt(u),1<a&&mt(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(q,"$1"),e,a<i&&xt(t.slice(a,i)),i<s&&xt(t=t.slice(i)),i<s&&mt(t))}u.push(e)}return gt(u)}return dt.prototype=b.filters=b.pseudos,b.setFilters=new dt,p=st.tokenize=function(t,e){var i,s,r,n,o,a,l,h=E[t+" "];if(h)return e?0:h.slice(0);for(o=t,a=[],l=b.preFilter;o;){for(n in i&&!(s=j.exec(o))||(s&&(o=o.slice(s[0].length)||o),a.push(r=[])),i=!1,(s=G.exec(o))&&(i=s.shift(),r.push({value:i,type:s[0].replace(q," ")}),o=o.slice(i.length)),b.filter)!(s=Z[n].exec(o))||l[n]&&!(s=l[n](s))||(i=s.shift(),r.push({value:i,type:n,matches:s}),o=o.slice(i.length));if(!i)break}return e?o.length:o?st.error(t):E(t,a).slice(0)},f=st.compile=function(t,e){var i,s=[],r=[],n=F[t+" "];if(!n){for(e||(e=p(t)),i=e.length;i--;)(n=xt(e[i]))[T]?s.push(n):r.push(n);(n=F(t,function(g,_){function t(t,e,i,s,r){var n,o,a,l=0,h="0",u=t&&[],c=[],f=y,d=t||x&&b.find.TAG("*",r),m=C+=null==f?1:Math.random()||.1,p=d.length;for(r&&(y=e===D||e||r);h!==p&&null!=(n=d[h]);h++){if(x&&n){for(o=0,e||n.ownerDocument===D||(w(n),i=!S);a=g[o++];)if(a(n,e||D,i)){s.push(n);break}r&&(C=m)}v&&((n=!a&&n)&&l--,t&&u.push(n))}if(l+=h,v&&h!==l){for(o=0;a=_[o++];)a(u,c,e,i);if(t){if(0<l)for(;h--;)u[h]||c[h]||(c[h]=B.call(s));c=_t(c)}I.apply(s,c),r&&!t&&0<c.length&&1<l+_.length&&st.uniqueSort(s)}return r&&(C=m,y=f),u}var v=0<_.length,x=0<g.length;return v?nt(t):t}(r,s))).selector=t}return n},g=st.select=function(t,e,i,s){var r,n,o,a,l,h="function"==typeof t&&t,u=!s&&p(t=h.selector||t);if(i=i||[],1===u.length){if(2<(n=u[0]=u[0].slice(0)).length&&"ID"===(o=n[0]).type&&m.getById&&9===e.nodeType&&S&&b.relative[n[1].type]){if(!(e=(b.find.ID(o.matches[0].replace(it,c),e)||[])[0]))return i;h&&(e=e.parentNode),t=t.slice(n.shift().value.length)}for(r=Z.needsContext.test(t)?0:n.length;r--&&(o=n[r],!b.relative[a=o.type]);)if((l=b.find[a])&&(s=l(o.matches[0].replace(it,c),tt.test(n[0].type)&&ft(e.parentNode)||e))){if(n.splice(r,1),!(t=s.length&&mt(n)))return I.apply(i,s),i;break}}return(h||f(t,u))(s,e,!S,i,!e||tt.test(t)&&ft(e.parentNode)||e),i},m.sortStable=T.split("").sort(P).join("")===T,m.detectDuplicates=!!h,w(),m.sortDetached=ot(function(t){return 1&t.compareDocumentPosition(D.createElement("div"))}),ot(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||at("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),m.attributes&&ot(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||at("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ot(function(t){return null==t.getAttribute("disabled")})||at(k,function(t,e,i){var s;if(!i)return!0===t[e]?e.toLowerCase():(s=t.getAttributeNode(e))&&s.specified?s.value:null}),st}(D);T.find=f,T.expr=f.selectors,T.expr[":"]=T.expr.pseudos,T.uniqueSort=T.unique=f.uniqueSort,T.text=f.getText,T.isXMLDoc=f.isXML,T.contains=f.contains;function d(t,e,i){for(var s=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&T(t).is(i))break;s.push(t)}return s}function _(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}var v=T.expr.match.needsContext,x=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,b=/^.[^:#\[\.,]*$/;function y(t,i,s){if(T.isFunction(i))return T.grep(t,function(t,e){return!!i.call(t,e,t)!==s});if(i.nodeType)return T.grep(t,function(t){return t===i!==s});if("string"==typeof i){if(b.test(i))return T.filter(i,t,s);i=T.filter(i,t)}return T.grep(t,function(t){return-1<r.call(i,t)!==s})}T.filter=function(t,e,i){var s=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===s.nodeType?T.find.matchesSelector(s,t)?[s]:[]:T.find.matches(t,T.grep(e,function(t){return 1===t.nodeType}))},T.fn.extend({find:function(t){var e,i=this.length,s=[],r=this;if("string"!=typeof t)return this.pushStack(T(t).filter(function(){for(e=0;e<i;e++)if(T.contains(r[e],this))return!0}));for(e=0;e<i;e++)T.find(t,r[e],s);return(s=this.pushStack(1<i?T.unique(s):s)).selector=this.selector?this.selector+" "+t:t,s},filter:function(t){return this.pushStack(y(this,t||[],!1))},not:function(t){return this.pushStack(y(this,t||[],!0))},is:function(t){return!!y(this,"string"==typeof t&&v.test(t)?T(t):t||[],!1).length}});var w,C=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(T.fn.init=function(t,e,i){var s,r;if(!t)return this;if(i=i||w,"string"!=typeof t)return t.nodeType?(this.context=this[0]=t,this.length=1,this):T.isFunction(t)?void 0!==i.ready?i.ready(t):t(T):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),T.makeArray(t,this));if(!(s="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:C.exec(t))||!s[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(s[1]){if(e=e instanceof T?e[0]:e,T.merge(this,T.parseHTML(s[1],e&&e.nodeType?e.ownerDocument||e:S,!0)),x.test(s[1])&&T.isPlainObject(e))for(s in e)T.isFunction(this[s])?this[s](e[s]):this.attr(s,e[s]);return this}return(r=S.getElementById(s[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=S,this.selector=t,this}).prototype=T.fn,w=T(S);var A=/^(?:parents|prev(?:Until|All))/,E={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}T.fn.extend({has:function(t){var e=T(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(T.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,s=0,r=this.length,n=[],o=v.test(t)||"string"!=typeof t?T(t,e||this.context):0;s<r;s++)for(i=this[s];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?-1<o.index(i):1===i.nodeType&&T.find.matchesSelector(i,t))){n.push(i);break}return this.pushStack(1<n.length?T.uniqueSort(n):n)},index:function(t){return t?"string"==typeof t?r.call(T(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),T.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return d(t,"parentNode")},parentsUntil:function(t,e,i){return d(t,"parentNode",i)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return d(t,"nextSibling")},prevAll:function(t){return d(t,"previousSibling")},nextUntil:function(t,e,i){return d(t,"nextSibling",i)},prevUntil:function(t,e,i){return d(t,"previousSibling",i)},siblings:function(t){return _((t.parentNode||{}).firstChild,t)},children:function(t){return _(t.firstChild)},contents:function(t){return t.contentDocument||T.merge([],t.childNodes)}},function(s,r){T.fn[s]=function(t,e){var i=T.map(this,r,t);return"Until"!==s.slice(-5)&&(e=t),e&&"string"==typeof e&&(i=T.filter(e,i)),1<this.length&&(E[s]||T.uniqueSort(i),A.test(s)&&i.reverse()),this.pushStack(i)}});var P,R=/\S+/g;function B(){S.removeEventListener("DOMContentLoaded",B),D.removeEventListener("load",B),T.ready()}T.Callbacks=function(s){s="string"==typeof s?function(t){var i={};return T.each(t.match(R)||[],function(t,e){i[e]=!0}),i}(s):T.extend({},s);function i(){for(n=s.once,e=r=!0;a.length;l=-1)for(t=a.shift();++l<o.length;)!1===o[l].apply(t[0],t[1])&&s.stopOnFalse&&(l=o.length,t=!1);s.memory||(t=!1),r=!1,n&&(o=t?[]:"")}var r,t,e,n,o=[],a=[],l=-1,h={add:function(){return o&&(t&&!r&&(l=o.length-1,a.push(t)),function i(t){T.each(t,function(t,e){T.isFunction(e)?s.unique&&h.has(e)||o.push(e):e&&e.length&&"string"!==T.type(e)&&i(e)})}(arguments),t&&!r&&i()),this},remove:function(){return T.each(arguments,function(t,e){for(var i;-1<(i=T.inArray(e,o,i));)o.splice(i,1),i<=l&&l--}),this},has:function(t){return t?-1<T.inArray(t,o):0<o.length},empty:function(){return o&&(o=[]),this},disable:function(){return n=a=[],o=t="",this},disabled:function(){return!o},lock:function(){return n=a=[],t||(o=t=""),this},locked:function(){return!!n},fireWith:function(t,e){return n||(e=[t,(e=e||[]).slice?e.slice():e],a.push(e),r||i()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!e}};return h},T.extend({Deferred:function(t){var n=[["resolve","done",T.Callbacks("once memory"),"resolved"],["reject","fail",T.Callbacks("once memory"),"rejected"],["notify","progress",T.Callbacks("memory")]],r="pending",o={state:function(){return r},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var r=arguments;return T.Deferred(function(s){T.each(n,function(t,e){var i=T.isFunction(r[t])&&r[t];a[e[1]](function(){var t=i&&i.apply(this,arguments);t&&T.isFunction(t.promise)?t.promise().progress(s.notify).done(s.resolve).fail(s.reject):s[e[0]+"With"](this===o?s.promise():this,i?[t]:arguments)})}),r=null}).promise()},promise:function(t){return null!=t?T.extend(t,o):o}},a={};return o.pipe=o.then,T.each(n,function(t,e){var i=e[2],s=e[3];o[e[1]]=i.add,s&&i.add(function(){r=s},n[1^t][2].disable,n[2][2].lock),a[e[0]]=function(){return a[e[0]+"With"](this===a?o:this,arguments),this},a[e[0]+"With"]=i.fireWith}),o.promise(a),t&&t.call(a,a),a},when:function(t){function e(e,i,s){return function(t){i[e]=this,s[e]=1<arguments.length?u.call(arguments):t,s===r?h.notifyWith(i,s):--l||h.resolveWith(i,s)}}var r,i,s,n=0,o=u.call(arguments),a=o.length,l=1!==a||t&&T.isFunction(t.promise)?a:0,h=1===l?t:T.Deferred();if(1<a)for(r=new Array(a),i=new Array(a),s=new Array(a);n<a;n++)o[n]&&T.isFunction(o[n].promise)?o[n].promise().progress(e(n,i,r)).done(e(n,s,o)).fail(h.reject):--l;return l||h.resolveWith(s,o),h.promise()}}),T.fn.ready=function(t){return T.ready.promise().done(t),this},T.extend({isReady:!1,readyWait:1,holdReady:function(t){t?T.readyWait++:T.ready(!0)},ready:function(t){(!0===t?--T.readyWait:T.isReady)||(T.isReady=!0)!==t&&0<--T.readyWait||(P.resolveWith(S,[T]),T.fn.triggerHandler&&(T(S).triggerHandler("ready"),T(S).off("ready")))}}),T.ready.promise=function(t){return P||(P=T.Deferred(),"complete"===S.readyState||"loading"!==S.readyState&&!S.documentElement.doScroll?D.setTimeout(T.ready):(S.addEventListener("DOMContentLoaded",B),D.addEventListener("load",B))),P.promise(t)},T.ready.promise();function M(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}var I=function(t,e,i,s,r,n,o){var a=0,l=t.length,h=null==i;if("object"===T.type(i))for(a in r=!0,i)I(t,e,a,i[a],!0,n,o);else if(void 0!==s&&(r=!0,T.isFunction(s)||(o=!0),h&&(e=o?(e.call(t,s),null):(h=e,function(t,e,i){return h.call(T(t),i)})),e))for(;a<l;a++)e(t[a],i,o?s:s.call(t[a],a,e(t[a],i)));return r?t:h?e.call(t):l?e(t[0],i):n};function L(){this.expando=T.expando+L.uid++}L.uid=1,L.prototype={register:function(t,e){var i=e||{};return t.nodeType?t[this.expando]=i:Object.defineProperty(t,this.expando,{value:i,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!M(t))return{};var e=t[this.expando];return e||(e={},M(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var s,r=this.cache(t);if("string"==typeof e)r[e]=i;else for(s in e)r[s]=e[s];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,i){var s;return void 0===e||e&&"string"==typeof e&&void 0===i?void 0!==(s=this.get(t,e))?s:this.get(t,T.camelCase(e)):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,s,r,n=t[this.expando];if(void 0!==n){if(void 0===e)this.register(t);else{i=(s=T.isArray(e)?e.concat(e.map(T.camelCase)):(r=T.camelCase(e),e in n?[e,r]:(s=r)in n?[s]:s.match(R)||[])).length;for(;i--;)delete n[s[i]]}void 0!==e&&!T.isEmptyObject(n)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!T.isEmptyObject(e)}};var N=new L,k=new L,z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/[A-Z]/g;function U(t,e,i){var s;if(void 0===i&&1===t.nodeType)if(s="data-"+e.replace(O,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(s))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:z.test(i)?T.parseJSON(i):i)}catch(t){}k.set(t,e,i)}else i=void 0;return i}T.extend({hasData:function(t){return k.hasData(t)||N.hasData(t)},data:function(t,e,i){return k.access(t,e,i)},removeData:function(t,e){k.remove(t,e)},_data:function(t,e,i){return N.access(t,e,i)},_removeData:function(t,e){N.remove(t,e)}}),T.fn.extend({data:function(s,t){var e,i,r,n=this[0],o=n&&n.attributes;if(void 0!==s)return"object"==typeof s?this.each(function(){k.set(this,s)}):I(this,function(e){var t,i;if(n&&void 0===e)return void 0!==(t=k.get(n,s)||k.get(n,s.replace(O,"-$&").toLowerCase()))?t:(i=T.camelCase(s),void 0!==(t=k.get(n,i))?t:void 0!==(t=U(n,i,void 0))?t:void 0);i=T.camelCase(s),this.each(function(){var t=k.get(this,i);k.set(this,i,e),-1<s.indexOf("-")&&void 0!==t&&k.set(this,s,e)})},null,t,1<arguments.length,null,!0);if(this.length&&(r=k.get(n),1===n.nodeType&&!N.get(n,"hasDataAttrs"))){for(e=o.length;e--;)!o[e]||0===(i=o[e].name).indexOf("data-")&&(i=T.camelCase(i.slice(5)),U(n,i,r[i]));N.set(n,"hasDataAttrs",!0)}return r},removeData:function(t){return this.each(function(){k.remove(this,t)})}}),T.extend({queue:function(t,e,i){var s;if(t)return e=(e||"fx")+"queue",s=N.get(t,e),i&&(!s||T.isArray(i)?s=N.access(t,e,T.makeArray(i)):s.push(i)),s||[]},dequeue:function(t,e){e=e||"fx";var i=T.queue(t,e),s=i.length,r=i.shift(),n=T._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),s--),r&&("fx"===e&&i.unshift("inprogress"),delete n.stop,r.call(t,function(){T.dequeue(t,e)},n)),!s&&n&&n.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return N.get(t,i)||N.access(t,i,{empty:T.Callbacks("once memory").add(function(){N.remove(t,[e+"queue",i])})})}}),T.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?T.queue(this[0],e):void 0===i?this:this.each(function(){var t=T.queue(this,e,i);T._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&T.dequeue(this,e)})},dequeue:function(t){return this.each(function(){T.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--r||n.resolveWith(o,[o])}var s,r=1,n=T.Deferred(),o=this,a=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(s=N.get(o[a],t+"queueHooks"))&&s.empty&&(r++,s.empty.add(i));return i(),n.promise(e)}});function H(t,e){return t=e||t,"none"===T.css(t,"display")||!T.contains(t.ownerDocument,t)}var W=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,q=new RegExp("^(?:([+-])=|)("+W+")([a-z%]*)$","i"),j=["Top","Right","Bottom","Left"];function G(t,e,i,s){var r,n=1,o=20,a=s?function(){return s.cur()}:function(){return T.css(t,e,"")},l=a(),h=i&&i[3]||(T.cssNumber[e]?"":"px"),u=(T.cssNumber[e]||"px"!==h&&+l)&&q.exec(T.css(t,e));if(u&&u[3]!==h)for(h=h||u[3],i=i||[],u=+l||1;u/=n=n||".5",T.style(t,e,u+h),n!==(n=a()/l)&&1!==n&&--o;);return i&&(u=+u||+l||0,r=i[1]?u+(i[1]+1)*i[2]:+i[2],s&&(s.unit=h,s.start=u,s.end=r)),r}var X=/^(?:checkbox|radio)$/i,V=/<([\w:-]+)/,Y=/^$|\/(?:java|ecma)script/i,Z={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function $(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&T.nodeName(t,e)?T.merge([t],i):i}function Q(t,e){for(var i=0,s=t.length;i<s;i++)N.set(t[i],"globalEval",!e||N.get(e[i],"globalEval"))}Z.optgroup=Z.option,Z.tbody=Z.tfoot=Z.colgroup=Z.caption=Z.thead,Z.th=Z.td;var J,K,tt=/<|&#?\w+;/;function et(t,e,i,s,r){for(var n,o,a,l,h,u,c=e.createDocumentFragment(),f=[],d=0,m=t.length;d<m;d++)if((n=t[d])||0===n)if("object"===T.type(n))T.merge(f,n.nodeType?[n]:n);else if(tt.test(n)){for(o=o||c.appendChild(e.createElement("div")),a=(V.exec(n)||["",""])[1].toLowerCase(),l=Z[a]||Z._default,o.innerHTML=l[1]+T.htmlPrefilter(n)+l[2],u=l[0];u--;)o=o.lastChild;T.merge(f,o.childNodes),(o=c.firstChild).textContent=""}else f.push(e.createTextNode(n));for(c.textContent="",d=0;n=f[d++];)if(s&&-1<T.inArray(n,s))r&&r.push(n);else if(h=T.contains(n.ownerDocument,n),o=$(c.appendChild(n),"script"),h&&Q(o),i)for(u=0;n=o[u++];)Y.test(n.type||"")&&i.push(n);return c}J=S.createDocumentFragment().appendChild(S.createElement("div")),(K=S.createElement("input")).setAttribute("type","radio"),K.setAttribute("checked","checked"),K.setAttribute("name","t"),J.appendChild(K),g.checkClone=J.cloneNode(!0).cloneNode(!0).lastChild.checked,J.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!J.cloneNode(!0).lastChild.defaultValue;var it=/^key/,st=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rt=/^([^.]*)(?:\.(.+)|)/;function nt(){return!0}function ot(){return!1}function at(){try{return S.activeElement}catch(t){}}function lt(t,e,i,s,r,n){var o,a;if("object"==typeof e){for(a in"string"!=typeof i&&(s=s||i,i=void 0),e)lt(t,a,i,s,e[a],n);return t}if(null==s&&null==r?(r=i,s=i=void 0):null==r&&("string"==typeof i?(r=s,s=void 0):(r=s,s=i,i=void 0)),!1===r)r=ot;else if(!r)return t;return 1===n&&(o=r,(r=function(t){return T().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=T.guid++)),t.each(function(){T.event.add(this,e,r,s,i)})}T.event={global:{},add:function(e,t,i,s,r){var n,o,a,l,h,u,c,f,d,m,p,g=N.get(e);if(g)for(i.handler&&(i=(n=i).handler,r=n.selector),i.guid||(i.guid=T.guid++),(l=g.events)||(l=g.events={}),(o=g.handle)||(o=g.handle=function(t){return void 0!==T&&T.event.triggered!==t.type?T.event.dispatch.apply(e,arguments):void 0}),h=(t=(t||"").match(R)||[""]).length;h--;)d=p=(a=rt.exec(t[h])||[])[1],m=(a[2]||"").split(".").sort(),d&&(c=T.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,c=T.event.special[d]||{},u=T.extend({type:d,origType:p,data:s,handler:i,guid:i.guid,selector:r,needsContext:r&&T.expr.match.needsContext.test(r),namespace:m.join(".")},n),(f=l[d])||((f=l[d]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,s,m,o)||e.addEventListener&&e.addEventListener(d,o)),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),r?f.splice(f.delegateCount++,0,u):f.push(u),T.event.global[d]=!0)},remove:function(t,e,i,s,r){var n,o,a,l,h,u,c,f,d,m,p,g=N.hasData(t)&&N.get(t);if(g&&(l=g.events)){for(h=(e=(e||"").match(R)||[""]).length;h--;)if(d=p=(a=rt.exec(e[h])||[])[1],m=(a[2]||"").split(".").sort(),d){for(c=T.event.special[d]||{},f=l[d=(s?c.delegateType:c.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=n=f.length;n--;)u=f[n],!r&&p!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||s&&s!==u.selector&&("**"!==s||!u.selector)||(f.splice(n,1),u.selector&&f.delegateCount--,c.remove&&c.remove.call(t,u));o&&!f.length&&(c.teardown&&!1!==c.teardown.call(t,m,g.handle)||T.removeEvent(t,d,g.handle),delete l[d])}else for(d in l)T.event.remove(t,d+e[h],i,s,!0);T.isEmptyObject(l)&&N.remove(t,"handle events")}},dispatch:function(t){t=T.event.fix(t);var e,i,s,r,n,o,a=u.call(arguments),l=(N.get(this,"events")||{})[t.type]||[],h=T.event.special[t.type]||{};if((a[0]=t).delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,t)){for(o=T.event.handlers.call(this,t,l),e=0;(r=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,i=0;(n=r.handlers[i++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(n.namespace)||(t.handleObj=n,t.data=n.data,void 0===(s=((T.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,a))||!1===(t.result=s)&&(t.preventDefault(),t.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,s,r,n,o=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==t.type)){for(s=[],i=0;i<a;i++)void 0===s[r=(n=e[i]).selector+" "]&&(s[r]=n.needsContext?-1<T(r,this).index(l):T.find(r,this,null,[l]).length),s[r]&&s.push(n);s.length&&o.push({elem:l,handlers:s})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,s,r,n=e.button;return null==t.pageX&&null!=e.clientX&&(s=(i=t.target.ownerDocument||S).documentElement,r=i.body,t.pageX=e.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),t.which||void 0===n||(t.which=1&n?1:2&n?3:4&n?2:0),t}},fix:function(t){if(t[T.expando])return t;var e,i,s,r=t.type,n=t,o=this.fixHooks[r];for(o||(this.fixHooks[r]=o=st.test(r)?this.mouseHooks:it.test(r)?this.keyHooks:{}),s=o.props?this.props.concat(o.props):this.props,t=new T.Event(n),e=s.length;e--;)t[i=s[e]]=n[i];return t.target||(t.target=S),3===t.target.nodeType&&(t.target=t.target.parentNode),o.filter?o.filter(t,n):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===at()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&T.nodeName(this,"input"))return this.click(),!1},_default:function(t){return T.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},T.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},T.Event=function(t,e){if(!(this instanceof T.Event))return new T.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?nt:ot):this.type=t,e&&T.extend(this,e),this.timeStamp=t&&t.timeStamp||T.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=nt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=nt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=nt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,r){T.event.special[t]={delegateType:r,bindType:r,handle:function(t){var e,i=t.relatedTarget,s=t.handleObj;return i&&(i===this||T.contains(this,i))||(t.type=s.origType,e=s.handler.apply(this,arguments),t.type=r),e}}}),T.fn.extend({on:function(t,e,i,s){return lt(this,t,e,i,s)},one:function(t,e,i,s){return lt(this,t,e,i,s,1)},off:function(t,e,i){var s,r;if(t&&t.preventDefault&&t.handleObj)return s=t.handleObj,T(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=ot),this.each(function(){T.event.remove(this,t,i,e)});for(r in t)this.off(r,e,t[r]);return this}});var ht=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ut=/<script|<style|<link/i,ct=/checked\s*(?:[^=]|=\s*.checked.)/i,ft=/^true\/(.*)/,dt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function mt(t,e){return T.nodeName(t,"table")&&T.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function pt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function gt(t){var e=ft.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function _t(t,e){var i,s,r,n,o,a,l,h;if(1===e.nodeType){if(N.hasData(t)&&(n=N.access(t),o=N.set(e,n),h=n.events))for(r in delete o.handle,o.events={},h)for(i=0,s=h[r].length;i<s;i++)T.event.add(e,r,h[r][i]);k.hasData(t)&&(a=k.access(t),l=T.extend({},a),k.set(e,l))}}function vt(i,s,r,n){s=p.apply([],s);var t,e,o,a,l,h,u=0,c=i.length,f=c-1,d=s[0],m=T.isFunction(d);if(m||1<c&&"string"==typeof d&&!g.checkClone&&ct.test(d))return i.each(function(t){var e=i.eq(t);m&&(s[0]=d.call(this,t,e.html())),vt(e,s,r,n)});if(c&&(e=(t=et(s,i[0].ownerDocument,!1,i,n)).firstChild,1===t.childNodes.length&&(t=e),e||n)){for(a=(o=T.map($(t,"script"),pt)).length;u<c;u++)l=t,u!==f&&(l=T.clone(l,!0,!0),a&&T.merge(o,$(l,"script"))),r.call(i[u],l,u);if(a)for(h=o[o.length-1].ownerDocument,T.map(o,gt),u=0;u<a;u++)l=o[u],Y.test(l.type||"")&&!N.access(l,"globalEval")&&T.contains(h,l)&&(l.src?T._evalUrl&&T._evalUrl(l.src):T.globalEval(l.textContent.replace(dt,"")))}return i}function xt(t,e,i){for(var s,r=e?T.filter(e,t):t,n=0;null!=(s=r[n]);n++)i||1!==s.nodeType||T.cleanData($(s)),s.parentNode&&(i&&T.contains(s.ownerDocument,s)&&Q($(s,"script")),s.parentNode.removeChild(s));return t}T.extend({htmlPrefilter:function(t){return t.replace(ht,"<$1></$2>")},clone:function(t,e,i){var s,r,n,o,a,l,h,u=t.cloneNode(!0),c=T.contains(t.ownerDocument,t);if(!(g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||T.isXMLDoc(t)))for(o=$(u),s=0,r=(n=$(t)).length;s<r;s++)a=n[s],l=o[s],void 0,"input"===(h=l.nodeName.toLowerCase())&&X.test(a.type)?l.checked=a.checked:"input"!==h&&"textarea"!==h||(l.defaultValue=a.defaultValue);if(e)if(i)for(n=n||$(t),o=o||$(u),s=0,r=n.length;s<r;s++)_t(n[s],o[s]);else _t(t,u);return 0<(o=$(u,"script")).length&&Q(o,!c&&$(t,"script")),u},cleanData:function(t){for(var e,i,s,r=T.event.special,n=0;void 0!==(i=t[n]);n++)if(M(i)){if(e=i[N.expando]){if(e.events)for(s in e.events)r[s]?T.event.remove(i,s):T.removeEvent(i,s,e.handle);i[N.expando]=void 0}i[k.expando]&&(i[k.expando]=void 0)}}}),T.fn.extend({domManip:vt,detach:function(t){return xt(this,t,!0)},remove:function(t){return xt(this,t)},text:function(t){return I(this,function(t){return void 0===t?T.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return vt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||mt(this,t).appendChild(t)})},prepend:function(){return vt(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=mt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return vt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return vt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(T.cleanData($(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return T.clone(this,t,e)})},html:function(t){return I(this,function(t){var e=this[0]||{},i=0,s=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!ut.test(t)&&!Z[(V.exec(t)||["",""])[1].toLowerCase()]){t=T.htmlPrefilter(t);try{for(;i<s;i++)1===(e=this[i]||{}).nodeType&&(T.cleanData($(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return vt(this,arguments,function(t){var e=this.parentNode;T.inArray(this,i)<0&&(T.cleanData($(this)),e&&e.replaceChild(t,this))},i)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,o){T.fn[t]=function(t){for(var e,i=[],s=T(t),r=s.length-1,n=0;n<=r;n++)e=n===r?this:this.clone(!0),T(s[n])[o](e),a.apply(i,e.get());return this.pushStack(i)}});var bt,yt={HTML:"block",BODY:"block"};function wt(t,e){var i=T(e.createElement(t)).appendTo(e.body),s=T.css(i[0],"display");return i.detach(),s}function Dt(t){var e=S,i=yt[t];return i||("none"!==(i=wt(t,e))&&i||((e=(bt=(bt||T("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),i=wt(t,e),bt.detach()),yt[t]=i),i}function St(t,e,i,s){var r,n,o={};for(n in e)o[n]=t.style[n],t.style[n]=e[n];for(n in r=i.apply(t,s||[]),e)t.style[n]=o[n];return r}var Tt,Ct,At,Et,Ft,Pt,Rt=/^margin/,Bt=new RegExp("^("+W+")(?!px)[a-z%]+$","i"),Mt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=D),e.getComputedStyle(t)},It=S.documentElement;function Lt(){Pt.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Pt.innerHTML="",It.appendChild(Ft);var t=D.getComputedStyle(Pt);Tt="1%"!==t.top,Et="2px"===t.marginLeft,Ct="4px"===t.width,Pt.style.marginRight="50%",At="4px"===t.marginRight,It.removeChild(Ft)}function Nt(t,e,i){var s,r,n,o,a=t.style;return""!==(o=(i=i||Mt(t))?i.getPropertyValue(e)||i[e]:void 0)&&void 0!==o||T.contains(t.ownerDocument,t)||(o=T.style(t,e)),!i||!g.pixelMarginRight()&&Bt.test(o)&&Rt.test(e)&&(s=a.width,r=a.minWidth,n=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=s,a.minWidth=r,a.maxWidth=n),void 0!==o?o+"":o}function kt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}Ft=S.createElement("div"),(Pt=S.createElement("div")).style&&(Pt.style.backgroundClip="content-box",Pt.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===Pt.style.backgroundClip,Ft.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Ft.appendChild(Pt),T.extend(g,{pixelPosition:function(){return Lt(),Tt},boxSizingReliable:function(){return null==Ct&&Lt(),Ct},pixelMarginRight:function(){return null==Ct&&Lt(),At},reliableMarginLeft:function(){return null==Ct&&Lt(),Et},reliableMarginRight:function(){var t,e=Pt.appendChild(S.createElement("div"));return e.style.cssText=Pt.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",Pt.style.width="1px",It.appendChild(Ft),t=!parseFloat(D.getComputedStyle(e).marginRight),It.removeChild(Ft),Pt.removeChild(e),t}}));var zt=/^(none|table(?!-c[ea]).+)/,Ot={position:"absolute",visibility:"hidden",display:"block"},Ut={letterSpacing:"0",fontWeight:"400"},Ht=["Webkit","O","Moz","ms"],Wt=S.createElement("div").style;function qt(t){if(t in Wt)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=Ht.length;i--;)if((t=Ht[i]+e)in Wt)return t}function jt(t,e,i){var s=q.exec(e);return s?Math.max(0,s[2]-(i||0))+(s[3]||"px"):e}function Gt(t,e,i,s,r){for(var n=i===(s?"border":"content")?4:"width"===e?1:0,o=0;n<4;n+=2)"margin"===i&&(o+=T.css(t,i+j[n],!0,r)),s?("content"===i&&(o-=T.css(t,"padding"+j[n],!0,r)),"margin"!==i&&(o-=T.css(t,"border"+j[n]+"Width",!0,r))):(o+=T.css(t,"padding"+j[n],!0,r),"padding"!==i&&(o+=T.css(t,"border"+j[n]+"Width",!0,r)));return o}function Xt(t,e,i){var s=!0,r="width"===e?t.offsetWidth:t.offsetHeight,n=Mt(t),o="border-box"===T.css(t,"boxSizing",!1,n);if(r<=0||null==r){if(((r=Nt(t,e,n))<0||null==r)&&(r=t.style[e]),Bt.test(r))return r;s=o&&(g.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+Gt(t,e,i||(o?"border":"content"),s,n)+"px"}function Vt(t,e){for(var i,s,r,n=[],o=0,a=t.length;o<a;o++)(s=t[o]).style&&(n[o]=N.get(s,"olddisplay"),i=s.style.display,e?(n[o]||"none"!==i||(s.style.display=""),""===s.style.display&&H(s)&&(n[o]=N.access(s,"olddisplay",Dt(s.nodeName)))):(r=H(s),"none"===i&&r||N.set(s,"olddisplay",r?i:T.css(s,"display"))));for(o=0;o<a;o++)(s=t[o]).style&&(e&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=e?n[o]||"":"none"));return t}function Yt(t,e,i,s,r){return new Yt.prototype.init(t,e,i,s,r)}T.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Nt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,n,o,a=T.camelCase(e),l=t.style;if(e=T.cssProps[a]||(T.cssProps[a]=qt(a)||a),o=T.cssHooks[e]||T.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(t,!1,s))?r:l[e];"string"===(n=typeof i)&&(r=q.exec(i))&&r[1]&&(i=G(t,e,r),n="number"),null!=i&&i==i&&("number"===n&&(i+=r&&r[3]||(T.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,s))||(l[e]=i))}},css:function(t,e,i,s){var r,n,o,a=T.camelCase(e);return e=T.cssProps[a]||(T.cssProps[a]=qt(a)||a),(o=T.cssHooks[e]||T.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,i)),void 0===r&&(r=Nt(t,e,s)),"normal"===r&&e in Ut&&(r=Ut[e]),""===i||i?(n=parseFloat(r),!0===i||isFinite(n)?n||0:r):r}}),T.each(["height","width"],function(t,o){T.cssHooks[o]={get:function(t,e,i){if(e)return zt.test(T.css(t,"display"))&&0===t.offsetWidth?St(t,Ot,function(){return Xt(t,o,i)}):Xt(t,o,i)},set:function(t,e,i){var s,r=i&&Mt(t),n=i&&Gt(t,o,i,"border-box"===T.css(t,"boxSizing",!1,r),r);return n&&(s=q.exec(e))&&"px"!==(s[3]||"px")&&(t.style[o]=e,e=T.css(t,o)),jt(0,e,n)}}}),T.cssHooks.marginLeft=kt(g.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Nt(t,"marginLeft"))||t.getBoundingClientRect().left-St(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),T.cssHooks.marginRight=kt(g.reliableMarginRight,function(t,e){if(e)return St(t,{display:"inline-block"},Nt,[t,"marginRight"])}),T.each({margin:"",padding:"",border:"Width"},function(r,n){T.cssHooks[r+n]={expand:function(t){for(var e=0,i={},s="string"==typeof t?t.split(" "):[t];e<4;e++)i[r+j[e]+n]=s[e]||s[e-2]||s[0];return i}},Rt.test(r)||(T.cssHooks[r+n].set=jt)}),T.fn.extend({css:function(t,e){return I(this,function(t,e,i){var s,r,n={},o=0;if(T.isArray(e)){for(s=Mt(t),r=e.length;o<r;o++)n[e[o]]=T.css(t,e[o],!1,s);return n}return void 0!==i?T.style(t,e,i):T.css(t,e)},t,e,1<arguments.length)},show:function(){return Vt(this,!0)},hide:function(){return Vt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){H(this)?T(this).show():T(this).hide()})}}),((T.Tween=Yt).prototype={constructor:Yt,init:function(t,e,i,s,r,n){this.elem=t,this.prop=i,this.easing=r||T.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=s,this.unit=n||(T.cssNumber[i]?"":"px")},cur:function(){var t=Yt.propHooks[this.prop];return t&&t.get?t.get(this):Yt.propHooks._default.get(this)},run:function(t){var e,i=Yt.propHooks[this.prop];return this.options.duration?this.pos=e=T.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Yt.propHooks._default.set(this),this}}).init.prototype=Yt.prototype,(Yt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=T.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){T.fx.step[t.prop]?T.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[T.cssProps[t.prop]]&&!T.cssHooks[t.prop]?t.elem[t.prop]=t.now:T.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=Yt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},T.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},T.fx=Yt.prototype.init,T.fx.step={};var Zt,$t,Qt,Jt,Kt,te=/^(?:toggle|show|hide)$/,ee=/queueHooks$/;function ie(){return D.setTimeout(function(){Zt=void 0}),Zt=T.now()}function se(t,e){var i,s=0,r={height:t};for(e=e?1:0;s<4;s+=2-e)r["margin"+(i=j[s])]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function re(t,e,i){for(var s,r=(ne.tweeners[e]||[]).concat(ne.tweeners["*"]),n=0,o=r.length;n<o;n++)if(s=r[n].call(i,e,t))return s}function ne(n,t,e){var i,o,s=0,r=ne.prefilters.length,a=T.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=Zt||ie(),e=Math.max(0,h.startTime+h.duration-t),i=1-(e/h.duration||0),s=0,r=h.tweens.length;s<r;s++)h.tweens[s].run(i);return a.notifyWith(n,[h,i,e]),i<1&&r?e:(a.resolveWith(n,[h]),!1)},h=a.promise({elem:n,props:T.extend({},t),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},e),originalProperties:t,originalOptions:e,startTime:Zt||ie(),duration:e.duration,tweens:[],createTween:function(t,e){var i=T.Tween(n,h.opts,t,e,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(i),i},stop:function(t){var e=0,i=t?h.tweens.length:0;if(o)return this;for(o=!0;e<i;e++)h.tweens[e].run(1);return t?(a.notifyWith(n,[h,1,0]),a.resolveWith(n,[h,t])):a.rejectWith(n,[h,t]),this}}),u=h.props;for(!function(t,e){var i,s,r,n,o;for(i in t)if(r=e[s=T.camelCase(i)],n=t[i],T.isArray(n)&&(r=n[1],n=t[i]=n[0]),i!==s&&(t[s]=n,delete t[i]),(o=T.cssHooks[s])&&"expand"in o)for(i in n=o.expand(n),delete t[s],n)i in t||(t[i]=n[i],e[i]=r);else e[s]=r}(u,h.opts.specialEasing);s<r;s++)if(i=ne.prefilters[s].call(h,n,u,h.opts))return T.isFunction(i.stop)&&(T._queueHooks(h.elem,h.opts.queue).stop=T.proxy(i.stop,i)),i;return T.map(u,re,h),T.isFunction(h.opts.start)&&h.opts.start.call(n,h),T.fx.timer(T.extend(l,{elem:n,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}T.Animation=T.extend(ne,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return G(i.elem,t,q.exec(e),i),i}]},tweener:function(t,e){for(var i,s=0,r=(t=T.isFunction(t)?(e=t,["*"]):t.match(R)).length;s<r;s++)i=t[s],ne.tweeners[i]=ne.tweeners[i]||[],ne.tweeners[i].unshift(e)},prefilters:[function(e,t,i){var s,r,n,o,a,l,h,u=this,c={},f=e.style,d=e.nodeType&&H(e),m=N.get(e,"fxshow");for(s in i.queue||(null==(a=T._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,T.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(h=T.css(e,"display"))?N.get(e,"olddisplay")||Dt(e.nodeName):h)&&"none"===T.css(e,"float")&&(f.display="inline-block")),i.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),t)if(r=t[s],te.exec(r)){if(delete t[s],n=n||"toggle"===r,r===(d?"hide":"show")){if("show"!==r||!m||void 0===m[s])continue;d=!0}c[s]=m&&m[s]||T.style(e,s)}else h=void 0;if(T.isEmptyObject(c))"inline"===("none"===h?Dt(e.nodeName):h)&&(f.display=h);else for(s in m?"hidden"in m&&(d=m.hidden):m=N.access(e,"fxshow",{}),n&&(m.hidden=!d),d?T(e).show():u.done(function(){T(e).hide()}),u.done(function(){var t;for(t in N.remove(e,"fxshow"),c)T.style(e,t,c[t])}),c)o=re(d?m[s]:0,s,u),s in m||(m[s]=o.start,d&&(o.end=o.start,o.start="width"===s||"height"===s?1:0))}],prefilter:function(t,e){e?ne.prefilters.unshift(t):ne.prefilters.push(t)}}),T.speed=function(t,e,i){var s=t&&"object"==typeof t?T.extend({},t):{complete:i||!i&&e||T.isFunction(t)&&t,duration:t,easing:i&&e||e&&!T.isFunction(e)&&e};return s.duration=T.fx.off?0:"number"==typeof s.duration?s.duration:s.duration in T.fx.speeds?T.fx.speeds[s.duration]:T.fx.speeds._default,null!=s.queue&&!0!==s.queue||(s.queue="fx"),s.old=s.complete,s.complete=function(){T.isFunction(s.old)&&s.old.call(this),s.queue&&T.dequeue(this,s.queue)},s},T.fn.extend({fadeTo:function(t,e,i,s){return this.filter(H).css("opacity",0).show().end().animate({opacity:e},t,i,s)},animate:function(e,t,i,s){function r(){var t=ne(this,T.extend({},e),o);(n||N.get(this,"finish"))&&t.stop(!0)}var n=T.isEmptyObject(e),o=T.speed(t,i,s);return r.finish=r,n||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(r,t,n){function o(t){var e=t.stop;delete t.stop,e(n)}return"string"!=typeof r&&(n=t,t=r,r=void 0),t&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var t=!0,e=null!=r&&r+"queueHooks",i=T.timers,s=N.get(this);if(e)s[e]&&s[e].stop&&o(s[e]);else for(e in s)s[e]&&s[e].stop&&ee.test(e)&&o(s[e]);for(e=i.length;e--;)i[e].elem!==this||null!=r&&i[e].queue!==r||(i[e].anim.stop(n),t=!1,i.splice(e,1));!t&&n||T.dequeue(this,r)})},finish:function(o){return!1!==o&&(o=o||"fx"),this.each(function(){var t,e=N.get(this),i=e[o+"queue"],s=e[o+"queueHooks"],r=T.timers,n=i?i.length:0;for(e.finish=!0,T.queue(this,o,[]),s&&s.stop&&s.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===o&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<n;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),T.each(["toggle","show","hide"],function(t,s){var r=T.fn[s];T.fn[s]=function(t,e,i){return null==t||"boolean"==typeof t?r.apply(this,arguments):this.animate(se(s,!0),t,e,i)}}),T.each({slideDown:se("show"),slideUp:se("hide"),slideToggle:se("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,s){T.fn[t]=function(t,e,i){return this.animate(s,t,e,i)}}),T.timers=[],T.fx.tick=function(){var t,e=0,i=T.timers;for(Zt=T.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||T.fx.stop(),Zt=void 0},T.fx.timer=function(t){T.timers.push(t),t()?T.fx.start():T.timers.pop()},T.fx.interval=13,T.fx.start=function(){$t||($t=D.setInterval(T.fx.tick,T.fx.interval))},T.fx.stop=function(){D.clearInterval($t),$t=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(s,t){return s=T.fx&&T.fx.speeds[s]||s,t=t||"fx",this.queue(t,function(t,e){var i=D.setTimeout(t,s);e.stop=function(){D.clearTimeout(i)}})},Qt=S.createElement("input"),Jt=S.createElement("select"),Kt=Jt.appendChild(S.createElement("option")),Qt.type="checkbox",g.checkOn=""!==Qt.value,g.optSelected=Kt.selected,Jt.disabled=!0,g.optDisabled=!Kt.disabled,(Qt=S.createElement("input")).value="t",Qt.type="radio",g.radioValue="t"===Qt.value;var oe,ae=T.expr.attrHandle;T.fn.extend({attr:function(t,e){return I(this,T.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){T.removeAttr(this,t)})}}),T.extend({attr:function(t,e,i){var s,r,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return void 0===t.getAttribute?T.prop(t,e,i):(1===n&&T.isXMLDoc(t)||(e=e.toLowerCase(),r=T.attrHooks[e]||(T.expr.match.bool.test(e)?oe:void 0)),void 0!==i?null===i?void T.removeAttr(t,e):r&&"set"in r&&void 0!==(s=r.set(t,i,e))?s:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(s=r.get(t,e))?s:null==(s=T.find.attr(t,e))?void 0:s)},attrHooks:{type:{set:function(t,e){if(!g.radioValue&&"radio"===e&&T.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,s,r=0,n=e&&e.match(R);if(n&&1===t.nodeType)for(;i=n[r++];)s=T.propFix[i]||i,T.expr.match.bool.test(i)&&(t[s]=!1),t.removeAttribute(i)}}),oe={set:function(t,e,i){return!1===e?T.removeAttr(t,i):t.setAttribute(i,i),i}},T.each(T.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ae[e]||T.find.attr;ae[e]=function(t,e,i){var s,r;return i||(r=ae[e],ae[e]=s,s=null!=n(t,e,i)?e.toLowerCase():null,ae[e]=r),s}});var le=/^(?:input|select|textarea|button)$/i,he=/^(?:a|area)$/i;T.fn.extend({prop:function(t,e){return I(this,T.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[T.propFix[t]||t]})}}),T.extend({prop:function(t,e,i){var s,r,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return 1===n&&T.isXMLDoc(t)||(e=T.propFix[e]||e,r=T.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(s=r.set(t,i,e))?s:t[e]=i:r&&"get"in r&&null!==(s=r.get(t,e))?s:t[e]},propHooks:{tabIndex:{get:function(t){var e=T.find.attr(t,"tabindex");return e?parseInt(e,10):le.test(t.nodeName)||he.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(T.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){T.propFix[this.toLowerCase()]=this});var ue=/[\t\r\n\f]/g;function ce(t){return t.getAttribute&&t.getAttribute("class")||""}T.fn.extend({addClass:function(e){var t,i,s,r,n,o,a,l=0;if(T.isFunction(e))return this.each(function(t){T(this).addClass(e.call(this,t,ce(this)))});if("string"==typeof e&&e)for(t=e.match(R)||[];i=this[l++];)if(r=ce(i),s=1===i.nodeType&&(" "+r+" ").replace(ue," ")){for(o=0;n=t[o++];)s.indexOf(" "+n+" ")<0&&(s+=n+" ");r!==(a=T.trim(s))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,s,r,n,o,a,l=0;if(T.isFunction(e))return this.each(function(t){T(this).removeClass(e.call(this,t,ce(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(R)||[];i=this[l++];)if(r=ce(i),s=1===i.nodeType&&(" "+r+" ").replace(ue," ")){for(o=0;n=t[o++];)for(;-1<s.indexOf(" "+n+" ");)s=s.replace(" "+n+" "," ");r!==(a=T.trim(s))&&i.setAttribute("class",a)}return this},toggleClass:function(r,e){var n=typeof r;return"boolean"==typeof e&&"string"==n?e?this.addClass(r):this.removeClass(r):T.isFunction(r)?this.each(function(t){T(this).toggleClass(r.call(this,t,ce(this),e),e)}):this.each(function(){var t,e,i,s;if("string"==n)for(e=0,i=T(this),s=r.match(R)||[];t=s[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==r&&"boolean"!=n||((t=ce(this))&&N.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===r?"":N.get(this,"__className__")||""))})},hasClass:function(t){var e,i,s=0;for(e=" "+t+" ";i=this[s++];)if(1===i.nodeType&&-1<(" "+ce(i)+" ").replace(ue," ").indexOf(e))return!0;return!1}});var fe=/\r/g,de=/[\x20\t\r\n\f]+/g;T.fn.extend({val:function(i){var s,t,r,e=this[0];return arguments.length?(r=T.isFunction(i),this.each(function(t){var e;1===this.nodeType&&(null==(e=r?i.call(this,t,T(this).val()):i)?e="":"number"==typeof e?e+="":T.isArray(e)&&(e=T.map(e,function(t){return null==t?"":t+""})),(s=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in s&&void 0!==s.set(this,e,"value")||(this.value=e))})):e?(s=T.valHooks[e.type]||T.valHooks[e.nodeName.toLowerCase()])&&"get"in s&&void 0!==(t=s.get(e,"value"))?t:"string"==typeof(t=e.value)?t.replace(fe,""):null==t?"":t:void 0}}),T.extend({valHooks:{option:{get:function(t){var e=T.find.attr(t,"value");return null!=e?e:T.trim(T.text(t)).replace(de," ")}},select:{get:function(t){for(var e,i,s=t.options,r=t.selectedIndex,n="select-one"===t.type||r<0,o=n?null:[],a=n?r+1:s.length,l=r<0?a:n?r:0;l<a;l++)if(((i=s[l]).selected||l===r)&&(g.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!T.nodeName(i.parentNode,"optgroup"))){if(e=T(i).val(),n)return e;o.push(e)}return o},set:function(t,e){for(var i,s,r=t.options,n=T.makeArray(e),o=r.length;o--;)((s=r[o]).selected=-1<T.inArray(T.valHooks.option.get(s),n))&&(i=!0);return i||(t.selectedIndex=-1),n}}}}),T.each(["radio","checkbox"],function(){T.valHooks[this]={set:function(t,e){if(T.isArray(e))return t.checked=-1<T.inArray(T(t).val(),e)}},g.checkOn||(T.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var me=/^(?:focusinfocus|focusoutblur)$/;T.extend(T.event,{trigger:function(t,e,i,s){var r,n,o,a,l,h,u,c=[i||S],f=m.call(t,"type")?t.type:t,d=m.call(t,"namespace")?t.namespace.split("."):[];if(n=o=i=i||S,3!==i.nodeType&&8!==i.nodeType&&!me.test(f+T.event.triggered)&&(-1<f.indexOf(".")&&(f=(d=f.split(".")).shift(),d.sort()),l=f.indexOf(":")<0&&"on"+f,(t=t[T.expando]?t:new T.Event(f,"object"==typeof t&&t)).isTrigger=s?2:3,t.namespace=d.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:T.makeArray(e,[t]),u=T.event.special[f]||{},s||!u.trigger||!1!==u.trigger.apply(i,e))){if(!s&&!u.noBubble&&!T.isWindow(i)){for(a=u.delegateType||f,me.test(a+f)||(n=n.parentNode);n;n=n.parentNode)c.push(n),o=n;o===(i.ownerDocument||S)&&c.push(o.defaultView||o.parentWindow||D)}for(r=0;(n=c[r++])&&!t.isPropagationStopped();)t.type=1<r?a:u.bindType||f,(h=(N.get(n,"events")||{})[t.type]&&N.get(n,"handle"))&&h.apply(n,e),(h=l&&n[l])&&h.apply&&M(n)&&(t.result=h.apply(n,e),!1===t.result&&t.preventDefault());return t.type=f,s||t.isDefaultPrevented()||u._default&&!1!==u._default.apply(c.pop(),e)||!M(i)||l&&T.isFunction(i[f])&&!T.isWindow(i)&&((o=i[l])&&(i[l]=null),i[T.event.triggered=f](),T.event.triggered=void 0,o&&(i[l]=o)),t.result}},simulate:function(t,e,i){var s=T.extend(new T.Event,i,{type:t,isSimulated:!0});T.event.trigger(s,null,e)}}),T.fn.extend({trigger:function(t,e){return this.each(function(){T.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return T.event.trigger(t,e,i,!0)}}),T.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,i){T.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),T.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),g.focusin="onfocusin"in D,g.focusin||T.each({focus:"focusin",blur:"focusout"},function(i,s){function r(t){T.event.simulate(s,t.target,T.event.fix(t))}T.event.special[s]={setup:function(){var t=this.ownerDocument||this,e=N.access(t,s);e||t.addEventListener(i,r,!0),N.access(t,s,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=N.access(t,s)-1;e?N.access(t,s,e):(t.removeEventListener(i,r,!0),N.remove(t,s))}}});var pe=D.location,ge=T.now(),_e=/\?/;T.parseJSON=function(t){return JSON.parse(t+"")},T.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new D.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||T.error("Invalid XML: "+t),e};var ve=/#.*$/,xe=/([?&])_=[^&]*/,be=/^(.*?):[ \t]*([^\r\n]*)$/gm,ye=/^(?:GET|HEAD)$/,we=/^\/\//,De={},Se={},Te="*/".concat("*"),Ce=S.createElement("a");function Ae(n){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,s=0,r=t.toLowerCase().match(R)||[];if(T.isFunction(e))for(;i=r[s++];)"+"===i[0]?(i=i.slice(1)||"*",(n[i]=n[i]||[]).unshift(e)):(n[i]=n[i]||[]).push(e)}}function Ee(e,r,n,o){var a={},l=e===Se;function h(t){var s;return a[t]=!0,T.each(e[t]||[],function(t,e){var i=e(r,n,o);return"string"!=typeof i||l||a[i]?l?!(s=i):void 0:(r.dataTypes.unshift(i),h(i),!1)}),s}return h(r.dataTypes[0])||!a["*"]&&h("*")}function Fe(t,e){var i,s,r=T.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:s||(s={}))[i]=e[i]);return s&&T.extend(!0,t,s),t}Ce.href=pe.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Te,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":T.parseJSON,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Fe(Fe(t,T.ajaxSettings),e):Fe(T.ajaxSettings,t)},ajaxPrefilter:Ae(De),ajaxTransport:Ae(Se),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var u,c,f,i,d,s,m,r,p=T.ajaxSetup({},e),g=p.context||p,_=p.context&&(g.nodeType||g.jquery)?T(g):T.event,v=T.Deferred(),x=T.Callbacks("once memory"),b=p.statusCode||{},n={},o={},y=0,a="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!i)for(i={};e=be.exec(f);)i[e[1].toLowerCase()]=e[2];e=i[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?f:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return y||(t=o[i]=o[i]||t,n[t]=e),this},overrideMimeType:function(t){return y||(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(y<2)for(e in t)b[e]=[b[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||a;return u&&u.abort(e),l(0,e),this}};if(v.promise(w).complete=x.add,w.success=w.done,w.error=w.fail,p.url=((t||p.url||pe.href)+"").replace(ve,"").replace(we,pe.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=T.trim(p.dataType||"*").toLowerCase().match(R)||[""],null==p.crossDomain){s=S.createElement("a");try{s.href=p.url,s.href=s.href,p.crossDomain=Ce.protocol+"//"+Ce.host!=s.protocol+"//"+s.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=T.param(p.data,p.traditional)),Ee(De,p,e,w),2===y)return w;for(r in(m=T.event&&p.global)&&0==T.active++&&T.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!ye.test(p.type),c=p.url,p.hasContent||(p.data&&(c=p.url+=(_e.test(c)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=xe.test(c)?c.replace(xe,"$1_="+ge++):c+(_e.test(c)?"&":"?")+"_="+ge++)),p.ifModified&&(T.lastModified[c]&&w.setRequestHeader("If-Modified-Since",T.lastModified[c]),T.etag[c]&&w.setRequestHeader("If-None-Match",T.etag[c])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&w.setRequestHeader("Content-Type",p.contentType),w.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Te+"; q=0.01":""):p.accepts["*"]),p.headers)w.setRequestHeader(r,p.headers[r]);if(p.beforeSend&&(!1===p.beforeSend.call(g,w,p)||2===y))return w.abort();for(r in a="abort",{success:1,error:1,complete:1})w[r](p[r]);if(u=Ee(Se,p,e,w)){if(w.readyState=1,m&&_.trigger("ajaxSend",[w,p]),2===y)return w;p.async&&0<p.timeout&&(d=D.setTimeout(function(){w.abort("timeout")},p.timeout));try{y=1,u.send(n,l)}catch(t){if(!(y<2))throw t;l(-1,t)}}else l(-1,"No Transport");function l(t,e,i,s){var r,n,o,a,l,h=e;2!==y&&(y=2,d&&D.clearTimeout(d),u=void 0,f=s||"",w.readyState=0<t?4:0,r=200<=t&&t<300||304===t,i&&(a=function(t,e,i){for(var s,r,n,o,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=t.mimeType||e.getResponseHeader("Content-Type"));if(s)for(r in a)if(a[r]&&a[r].test(s)){l.unshift(r);break}if(l[0]in i)n=l[0];else{for(r in i){if(!l[0]||t.converters[r+" "+l[0]]){n=r;break}o||(o=r)}n=n||o}if(n)return n!==l[0]&&l.unshift(n),i[n]}(p,w,i)),a=function(t,e,i,s){var r,n,o,a,l,h={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)h[o.toLowerCase()]=t.converters[o];for(n=u.shift();n;)if(t.responseFields[n]&&(i[t.responseFields[n]]=e),!l&&s&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=n,n=u.shift())if("*"===n)n=l;else if("*"!==l&&l!==n){if(!(o=h[l+" "+n]||h["* "+n]))for(r in h)if((a=r.split(" "))[1]===n&&(o=h[l+" "+a[0]]||h["* "+a[0]])){!0===o?o=h[r]:!0!==h[r]&&(n=a[0],u.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+l+" to "+n}}}return{state:"success",data:e}}(p,a,w,r),r?(p.ifModified&&((l=w.getResponseHeader("Last-Modified"))&&(T.lastModified[c]=l),(l=w.getResponseHeader("etag"))&&(T.etag[c]=l)),204===t||"HEAD"===p.type?h="nocontent":304===t?h="notmodified":(h=a.state,n=a.data,r=!(o=a.error))):(o=h,!t&&h||(h="error",t<0&&(t=0))),w.status=t,w.statusText=(e||h)+"",r?v.resolveWith(g,[n,h,w]):v.rejectWith(g,[w,h,o]),w.statusCode(b),b=void 0,m&&_.trigger(r?"ajaxSuccess":"ajaxError",[w,p,r?n:o]),x.fireWith(g,[w,h]),m&&(_.trigger("ajaxComplete",[w,p]),--T.active||T.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,i){return T.get(t,e,i,"json")},getScript:function(t,e){return T.get(t,void 0,e,"script")}}),T.each(["get","post"],function(t,r){T[r]=function(t,e,i,s){return T.isFunction(e)&&(s=s||i,i=e,e=void 0),T.ajax(T.extend({url:t,type:r,dataType:s,data:e,success:i},T.isPlainObject(t)&&t))}}),T._evalUrl=function(t){return T.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},T.fn.extend({wrapAll:function(e){var t;return T.isFunction(e)?this.each(function(t){T(this).wrapAll(e.call(this,t))}):(this[0]&&(t=T(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(i){return T.isFunction(i)?this.each(function(t){T(this).wrapInner(i.call(this,t))}):this.each(function(){var t=T(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=T.isFunction(e);return this.each(function(t){T(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(){return this.parent().each(function(){T.nodeName(this,"body")||T(this).replaceWith(this.childNodes)}).end()}}),T.expr.filters.hidden=function(t){return!T.expr.filters.visible(t)},T.expr.filters.visible=function(t){return 0<t.offsetWidth||0<t.offsetHeight||0<t.getClientRects().length};var Pe=/%20/g,Re=/\[\]$/,Be=/\r?\n/g,Me=/^(?:submit|button|image|reset|file)$/i,Ie=/^(?:input|select|textarea|keygen)/i;function Le(i,t,s,r){var e;if(T.isArray(t))T.each(t,function(t,e){s||Re.test(i)?r(i,e):Le(i+"["+("object"==typeof e&&null!=e?t:"")+"]",e,s,r)});else if(s||"object"!==T.type(t))r(i,t);else for(e in t)Le(i+"["+e+"]",t[e],s,r)}T.param=function(t,e){function i(t,e){e=T.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)}var s,r=[];if(void 0===e&&(e=T.ajaxSettings&&T.ajaxSettings.traditional),T.isArray(t)||t.jquery&&!T.isPlainObject(t))T.each(t,function(){i(this.name,this.value)});else for(s in t)Le(s,t[s],e,i);return r.join("&").replace(Pe,"+")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=T.prop(this,"elements");return t?T.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!T(this).is(":disabled")&&Ie.test(this.nodeName)&&!Me.test(t)&&(this.checked||!X.test(t))}).map(function(t,e){var i=T(this).val();return null==i?null:T.isArray(i)?T.map(i,function(t){return{name:e.name,value:t.replace(Be,"\r\n")}}):{name:e.name,value:i.replace(Be,"\r\n")}}).get()}}),T.ajaxSettings.xhr=function(){try{return new D.XMLHttpRequest}catch(t){}};var Ne={0:200,1223:204},ke=T.ajaxSettings.xhr();g.cors=!!ke&&"withCredentials"in ke,g.ajax=ke=!!ke,T.ajaxTransport(function(r){var n,o;if(g.cors||ke&&!r.crossDomain)return{send:function(t,e){var i,s=r.xhr();if(s.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(i in r.xhrFields)s[i]=r.xhrFields[i];for(i in r.mimeType&&s.overrideMimeType&&s.overrideMimeType(r.mimeType),r.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)s.setRequestHeader(i,t[i]);n=function(t){return function(){n&&(n=o=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?e(0,"error"):e(s.status,s.statusText):e(Ne[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),o=s.onerror=n("error"),void 0!==s.onabort?s.onabort=o:s.onreadystatechange=function(){4===s.readyState&&D.setTimeout(function(){n&&o()})},n=n("abort");try{s.send(r.hasContent&&r.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}}),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return T.globalEval(t),t}}}),T.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),T.ajaxTransport("script",function(i){var s,r;if(i.crossDomain)return{send:function(t,e){s=T("<script>").prop({charset:i.scriptCharset,src:i.url}).on("load error",r=function(t){s.remove(),r=null,t&&e("error"===t.type?404:200,t.type)}),S.head.appendChild(s[0])},abort:function(){r&&r()}}});var ze=[],Oe=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ze.pop()||T.expando+"_"+ge++;return this[t]=!0,t}}),T.ajaxPrefilter("json jsonp",function(t,e,i){var s,r,n,o=!1!==t.jsonp&&(Oe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Oe.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return s=t.jsonpCallback=T.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(Oe,"$1"+s):!1!==t.jsonp&&(t.url+=(_e.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return n||T.error(s+" was not called"),n[0]},t.dataTypes[0]="json",r=D[s],D[s]=function(){n=arguments},i.always(function(){void 0===r?T(D).removeProp(s):D[s]=r,t[s]&&(t.jsonpCallback=e.jsonpCallback,ze.push(s)),n&&T.isFunction(r)&&r(n[0]),n=r=void 0}),"script"}),T.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||S;var s=x.exec(t),r=!i&&[];return s?[e.createElement(s[1])]:(s=et([t],e,r),r&&r.length&&T(r).remove(),T.merge([],s.childNodes))};var Ue=T.fn.load;function He(t){return T.isWindow(t)?t:9===t.nodeType&&t.defaultView}T.fn.load=function(t,e,i){if("string"!=typeof t&&Ue)return Ue.apply(this,arguments);var s,r,n,o=this,a=t.indexOf(" ");return-1<a&&(s=T.trim(t.slice(a)),t=t.slice(0,a)),T.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<o.length&&T.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){n=arguments,o.html(s?T("<div>").append(T.parseHTML(t)).find(s):t)}).always(i&&function(t,e){o.each(function(){i.apply(this,n||[t.responseText,e,t])})}),this},T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){T.fn[e]=function(t){return this.on(e,t)}}),T.expr.filters.animated=function(e){return T.grep(T.timers,function(t){return e===t.elem}).length},T.offset={setOffset:function(t,e,i){var s,r,n,o,a,l,h=T.css(t,"position"),u=T(t),c={};"static"===h&&(t.style.position="relative"),a=u.offset(),n=T.css(t,"top"),l=T.css(t,"left"),r=("absolute"===h||"fixed"===h)&&-1<(n+l).indexOf("auto")?(o=(s=u.position()).top,s.left):(o=parseFloat(n)||0,parseFloat(l)||0),T.isFunction(e)&&(e=e.call(t,i,T.extend({},a))),null!=e.top&&(c.top=e.top-a.top+o),null!=e.left&&(c.left=e.left-a.left+r),"using"in e?e.using.call(t,c):u.css(c)}},T.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){T.offset.setOffset(this,e,t)});var t,i,s=this[0],r={top:0,left:0},n=s&&s.ownerDocument;return n?(t=n.documentElement,T.contains(t,s)?(r=s.getBoundingClientRect(),i=He(n),{top:r.top+i.pageYOffset-t.clientTop,left:r.left+i.pageXOffset-t.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,i=this[0],s={top:0,left:0};return"fixed"===T.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),T.nodeName(t[0],"html")||(s=t.offset()),s.top+=T.css(t[0],"borderTopWidth",!0),s.left+=T.css(t[0],"borderLeftWidth",!0)),{top:e.top-s.top-T.css(i,"marginTop",!0),left:e.left-s.left-T.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===T.css(t,"position");)t=t.offsetParent;return t||It})}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,r){var n="pageYOffset"===r;T.fn[e]=function(t){return I(this,function(t,e,i){var s=He(t);if(void 0===i)return s?s[r]:t[e];s?s.scrollTo(n?s.pageXOffset:i,n?i:s.pageYOffset):t[e]=i},e,t,arguments.length)}}),T.each(["top","left"],function(t,i){T.cssHooks[i]=kt(g.pixelPosition,function(t,e){if(e)return e=Nt(t,i),Bt.test(e)?T(t).position()[i]+"px":e})}),T.each({Height:"height",Width:"width"},function(n,o){T.each({padding:"inner"+n,content:o,"":"outer"+n},function(s,t){T.fn[t]=function(t,e){var i=arguments.length&&(s||"boolean"!=typeof t),r=s||(!0===t||!0===e?"margin":"border");return I(this,function(t,e,i){var s;return T.isWindow(t)?t.document.documentElement["client"+n]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+n],s["scroll"+n],t.body["offset"+n],s["offset"+n],s["client"+n])):void 0===i?T.css(t,e,r):T.style(t,e,i,r)},o,i?t:void 0,i,null)}})}),T.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,s){return this.on(e,t,i,s)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},size:function(){return this.length}}),T.fn.andSelf=T.fn.addBack,void 0===(Xe=function(){return T}.apply(Ge,[]))||(je.exports=Xe);var We=D.jQuery,qe=D.$;return T.noConflict=function(t){return D.$===T&&(D.$=qe),t&&D.jQuery===T&&(D.jQuery=We),T},t||(D.jQuery=D.$=T),T},"object"==typeof je.exports?je.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)},function(t,e,i){"use strict";var s=i(1),r=i.n(s);i(6);r.a.noConflict(!0),e.a=r.a},function(n,o,t){(function(t){var e,i,s;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i=this,s=function(t){"use strict";var i=1e-6,n={};!function(){if("undefined"!=typeof Float32Array){var s=new Float32Array(1),r=new Int32Array(s.buffer);n.invsqrt=function(t){var e=.5*t;s[0]=t;r[0]=1597463007-(r[0]>>1);var i=s[0];return i*(1.5-e*i*i)}}else n.invsqrt=function(t){return 1/Math.sqrt(t)}}();var _=null;function e(t){return _=t}function s(){return _="undefined"!=typeof Float32Array?Float32Array:Array}s();var a={create:function(t){var e=new _(3);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):e[0]=e[1]=e[2]=0,e},createFrom:function(t,e,i){var s=new _(3);return s[0]=t,s[1]=e,s[2]=i,s},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i},add:function(t,e,i){return i&&t!==i?(i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i):(t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t)},subtract:function(t,e,i){return i&&t!==i?(i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i):(t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t)},multiply:function(t,e,i){return i&&t!==i?(i[0]=t[0]*e[0],i[1]=t[1]*e[1],i[2]=t[2]*e[2],i):(t[0]*=e[0],t[1]*=e[1],t[2]*=e[2],t)},negate:function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},scale:function(t,e,i){return i&&t!==i?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i):(t[0]*=e,t[1]*=e,t[2]*=e,t)},normalize:function(t,e){e||(e=t);var i=t[0],s=t[1],r=t[2],n=Math.sqrt(i*i+s*s+r*r);return n?1===n?(e[0]=i,e[1]=s,e[2]=r):(n=1/n,e[0]=i*n,e[1]=s*n,e[2]=r*n):(e[0]=0,e[1]=0,e[2]=0),e},cross:function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=e[0],a=e[1],l=e[2];return i[0]=r*l-n*a,i[1]=n*o-s*l,i[2]=s*a-r*o,i},length:function(t){var e=t[0],i=t[1],s=t[2];return Math.sqrt(e*e+i*i+s*s)},squaredLength:function(t){var e=t[0],i=t[1],s=t[2];return e*e+i*i+s*s},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},direction:function(t,e,i){i||(i=t);var s=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=Math.sqrt(s*s+r*r+n*n);return o?(o=1/o,i[0]=s*o,i[1]=r*o,i[2]=n*o):(i[0]=0,i[1]=0,i[2]=0),i},lerp:function(t,e,i,s){return s||(s=t),s[0]=t[0]+i*(e[0]-t[0]),s[1]=t[1]+i*(e[1]-t[1]),s[2]=t[2]+i*(e[2]-t[2]),s},dist:function(t,e){var i=e[0]-t[0],s=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+s*s+r*r)}},l=null,h=new _(4);a.unproject=function(t,e,i,s,r){r||(r=t),l||(l=D.create());var n=l,o=h;return o[0]=2*(t[0]-s[0])/s[2]-1,o[1]=2*(t[1]-s[1])/s[3]-1,o[2]=2*t[2]-1,o[3]=1,D.multiply(i,e,n),D.inverse(n)?(D.multiplyVec4(n,o),0===o[3]?null:(r[0]=o[0]/o[3],r[1]=o[1]/o[3],r[2]=o[2]/o[3],r)):null};var u=a.createFrom(1,0,0),c=a.createFrom(0,1,0),f=a.createFrom(0,0,1),d=a.create();a.rotationTo=function(t,e,i){i||(i=m.create());var s=a.dot(t,e),r=d;if(1<=s)m.set(p,i);else if(s<1e-6-1)a.cross(u,t,r),a.length(r)<1e-6&&a.cross(c,t,r),a.length(r)<1e-6&&a.cross(f,t,r),a.normalize(r),m.fromAngleAxis(Math.PI,r,i);else{var n=Math.sqrt(2*(1+s)),o=1/n;a.cross(t,e,r),i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[3]=.5*n,m.normalize(i)}return 1<i[3]?i[3]=1:i[3]<-1&&(i[3]=-1),i},a.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+"]"};var r,v={create:function(t){var e=new _(9);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]):e[0]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=0,e},createFrom:function(t,e,i,s,r,n,o,a,l){var h=new _(9);return h[0]=t,h[1]=e,h[2]=i,h[3]=s,h[4]=r,h[5]=n,h[6]=o,h[7]=a,h[8]=l,h},determinant:function(t){var e=t[0],i=t[1],s=t[2],r=t[3],n=t[4],o=t[5],a=t[6],l=t[7],h=t[8];return e*(h*n-o*l)+i*(-h*r+o*a)+s*(l*r-n*a)},inverse:function(t,e){var i,s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],l=t[5],h=t[6],u=t[7],c=t[8],f=c*a-l*u,d=-c*o+l*h,m=u*o-a*h,p=s*f+r*d+n*m;return p?(i=1/p,e||(e=v.create()),e[0]=f*i,e[1]=(-c*r+n*u)*i,e[2]=(l*r-n*a)*i,e[3]=d*i,e[4]=(c*s-n*h)*i,e[5]=(-l*s+n*o)*i,e[6]=m*i,e[7]=(-u*s+r*h)*i,e[8]=(a*s-r*o)*i,e):null},multiply:function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],l=t[5],h=t[6],u=t[7],c=t[8],f=e[0],d=e[1],m=e[2],p=e[3],g=e[4],_=e[5],v=e[6],x=e[7],b=e[8];return i[0]=f*s+d*o+m*h,i[1]=f*r+d*a+m*u,i[2]=f*n+d*l+m*c,i[3]=p*s+g*o+_*h,i[4]=p*r+g*a+_*u,i[5]=p*n+g*l+_*c,i[6]=v*s+x*o+b*h,i[7]=v*r+x*a+b*u,i[8]=v*n+x*l+b*c,i},multiplyVec2:function(t,e,i){i||(i=e);var s=e[0],r=e[1];return i[0]=s*t[0]+r*t[3]+t[6],i[1]=s*t[1]+r*t[4]+t[7],i},multiplyVec3:function(t,e,i){i||(i=e);var s=e[0],r=e[1],n=e[2];return i[0]=s*t[0]+r*t[3]+n*t[6],i[1]=s*t[1]+r*t[4]+n*t[7],i[2]=s*t[2]+r*t[5]+n*t[8],i},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i&&Math.abs(t[4]-e[4])<i&&Math.abs(t[5]-e[5])<i&&Math.abs(t[6]-e[6])<i&&Math.abs(t[7]-e[7])<i&&Math.abs(t[8]-e[8])<i},identity:function(t){return t||(t=v.create()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e;var i=t[1],s=t[2],r=t[5];return t[1]=t[3],t[2]=t[6],t[3]=i,t[5]=t[7],t[6]=s,t[7]=r,t},toMat4:function(t,e){return e||(e=D.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+"]"}},D={create:function(t){var e=new _(16);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e},createFrom:function(t,e,i,s,r,n,o,a,l,h,u,c,f,d,m,p){var g=new _(16);return g[0]=t,g[1]=e,g[2]=i,g[3]=s,g[4]=r,g[5]=n,g[6]=o,g[7]=a,g[8]=l,g[9]=h,g[10]=u,g[11]=c,g[12]=f,g[13]=d,g[14]=m,g[15]=p,g},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i&&Math.abs(t[4]-e[4])<i&&Math.abs(t[5]-e[5])<i&&Math.abs(t[6]-e[6])<i&&Math.abs(t[7]-e[7])<i&&Math.abs(t[8]-e[8])<i&&Math.abs(t[9]-e[9])<i&&Math.abs(t[10]-e[10])<i&&Math.abs(t[11]-e[11])<i&&Math.abs(t[12]-e[12])<i&&Math.abs(t[13]-e[13])<i&&Math.abs(t[14]-e[14])<i&&Math.abs(t[15]-e[15])<i},identity:function(t){return t||(t=D.create()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},transpose:function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e;var i=t[1],s=t[2],r=t[3],n=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=s,t[9]=n,t[11]=t[14],t[12]=r,t[13]=o,t[14]=a,t},determinant:function(t){var e=t[0],i=t[1],s=t[2],r=t[3],n=t[4],o=t[5],a=t[6],l=t[7],h=t[8],u=t[9],c=t[10],f=t[11],d=t[12],m=t[13],p=t[14],g=t[15];return d*u*a*r-h*m*a*r-d*o*c*r+n*m*c*r+h*o*p*r-n*u*p*r-d*u*s*l+h*m*s*l+d*i*c*l-e*m*c*l-h*i*p*l+e*u*p*l+d*o*s*f-n*m*s*f-d*i*a*f+e*m*a*f+n*i*p*f-e*o*p*f-h*o*s*g+n*u*s*g+h*i*a*g-e*u*a*g-n*i*c*g+e*o*c*g},inverse:function(t,e){e||(e=t);var i,s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],l=t[5],h=t[6],u=t[7],c=t[8],f=t[9],d=t[10],m=t[11],p=t[12],g=t[13],_=t[14],v=t[15],x=s*l-r*a,b=s*h-n*a,y=s*u-o*a,w=r*h-n*l,D=r*u-o*l,S=n*u-o*h,T=c*g-f*p,C=c*_-d*p,A=c*v-m*p,E=f*_-d*g,F=f*v-m*g,P=d*v-m*_,R=x*P-b*F+y*E+w*A-D*C+S*T;return R?(i=1/R,e[0]=(l*P-h*F+u*E)*i,e[1]=(-r*P+n*F-o*E)*i,e[2]=(g*S-_*D+v*w)*i,e[3]=(-f*S+d*D-m*w)*i,e[4]=(-a*P+h*A-u*C)*i,e[5]=(s*P-n*A+o*C)*i,e[6]=(-p*S+_*y-v*b)*i,e[7]=(c*S-d*y+m*b)*i,e[8]=(a*F-l*A+u*T)*i,e[9]=(-s*F+r*A-o*T)*i,e[10]=(p*D-g*y+v*x)*i,e[11]=(-c*D+f*y-m*x)*i,e[12]=(-a*E+l*C-h*T)*i,e[13]=(s*E-r*C+n*T)*i,e[14]=(-p*w+g*b-_*x)*i,e[15]=(c*w-f*b+d*x)*i,e):null},toRotationMat:function(t,e){return e||(e=D.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},toMat3:function(t,e){return e||(e=v.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},toInverseMat3:function(t,e){var i,s=t[0],r=t[1],n=t[2],o=t[4],a=t[5],l=t[6],h=t[8],u=t[9],c=t[10],f=c*a-l*u,d=-c*o+l*h,m=u*o-a*h,p=s*f+r*d+n*m;return p?(i=1/p,e||(e=v.create()),e[0]=f*i,e[1]=(-c*r+n*u)*i,e[2]=(l*r-n*a)*i,e[3]=d*i,e[4]=(c*s-n*h)*i,e[5]=(-l*s+n*o)*i,e[6]=m*i,e[7]=(-u*s+r*h)*i,e[8]=(a*s-r*o)*i,e):null},multiply:function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],l=t[5],h=t[6],u=t[7],c=t[8],f=t[9],d=t[10],m=t[11],p=t[12],g=t[13],_=t[14],v=t[15],x=e[0],b=e[1],y=e[2],w=e[3];return i[0]=x*s+b*a+y*c+w*p,i[1]=x*r+b*l+y*f+w*g,i[2]=x*n+b*h+y*d+w*_,i[3]=x*o+b*u+y*m+w*v,x=e[4],b=e[5],y=e[6],w=e[7],i[4]=x*s+b*a+y*c+w*p,i[5]=x*r+b*l+y*f+w*g,i[6]=x*n+b*h+y*d+w*_,i[7]=x*o+b*u+y*m+w*v,x=e[8],b=e[9],y=e[10],w=e[11],i[8]=x*s+b*a+y*c+w*p,i[9]=x*r+b*l+y*f+w*g,i[10]=x*n+b*h+y*d+w*_,i[11]=x*o+b*u+y*m+w*v,x=e[12],b=e[13],y=e[14],w=e[15],i[12]=x*s+b*a+y*c+w*p,i[13]=x*r+b*l+y*f+w*g,i[14]=x*n+b*h+y*d+w*_,i[15]=x*o+b*u+y*m+w*v,i},multiplyVec3:function(t,e,i){i||(i=e);var s=e[0],r=e[1],n=e[2];return i[0]=t[0]*s+t[4]*r+t[8]*n+t[12],i[1]=t[1]*s+t[5]*r+t[9]*n+t[13],i[2]=t[2]*s+t[6]*r+t[10]*n+t[14],i},multiplyVec4:function(t,e,i){i||(i=e);var s=e[0],r=e[1],n=e[2],o=e[3];return i[0]=t[0]*s+t[4]*r+t[8]*n+t[12]*o,i[1]=t[1]*s+t[5]*r+t[9]*n+t[13]*o,i[2]=t[2]*s+t[6]*r+t[10]*n+t[14]*o,i[3]=t[3]*s+t[7]*r+t[11]*n+t[15]*o,i},translate:function(t,e,i){var s,r,n,o,a,l,h,u,c,f,d,m,p=e[0],g=e[1],_=e[2];return i&&t!==i?(s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],l=t[5],h=t[6],u=t[7],c=t[8],f=t[9],d=t[10],m=t[11],i[0]=s,i[1]=r,i[2]=n,i[3]=o,i[4]=a,i[5]=l,i[6]=h,i[7]=u,i[8]=c,i[9]=f,i[10]=d,i[11]=m,i[12]=s*p+a*g+c*_+t[12],i[13]=r*p+l*g+f*_+t[13],i[14]=n*p+h*g+d*_+t[14],i[15]=o*p+u*g+m*_+t[15],i):(t[12]=t[0]*p+t[4]*g+t[8]*_+t[12],t[13]=t[1]*p+t[5]*g+t[9]*_+t[13],t[14]=t[2]*p+t[6]*g+t[10]*_+t[14],t[15]=t[3]*p+t[7]*g+t[11]*_+t[15],t)},scale:function(t,e,i){var s=e[0],r=e[1],n=e[2];return i&&t!==i?(i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[3]=t[3]*s,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*n,i[9]=t[9]*n,i[10]=t[10]*n,i[11]=t[11]*n,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i):(t[0]*=s,t[1]*=s,t[2]*=s,t[3]*=s,t[4]*=r,t[5]*=r,t[6]*=r,t[7]*=r,t[8]*=n,t[9]*=n,t[10]*=n,t[11]*=n,t)},rotate:function(t,e,i,s){var r,n,o,a,l,h,u,c,f,d,m,p,g,_,v,x,b,y,w,D,S,T,C,A,E=i[0],F=i[1],P=i[2],R=Math.sqrt(E*E+F*F+P*P);return R?(1!==R&&(E*=R=1/R,F*=R,P*=R),r=Math.sin(e),o=1-(n=Math.cos(e)),a=t[0],l=t[1],h=t[2],u=t[3],c=t[4],f=t[5],d=t[6],m=t[7],p=t[8],g=t[9],_=t[10],v=t[11],x=E*E*o+n,b=F*E*o+P*r,y=P*E*o-F*r,w=E*F*o-P*r,D=F*F*o+n,S=P*F*o+E*r,T=E*P*o+F*r,C=F*P*o-E*r,A=P*P*o+n,s?t!==s&&(s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]):s=t,s[0]=a*x+c*b+p*y,s[1]=l*x+f*b+g*y,s[2]=h*x+d*b+_*y,s[3]=u*x+m*b+v*y,s[4]=a*w+c*D+p*S,s[5]=l*w+f*D+g*S,s[6]=h*w+d*D+_*S,s[7]=u*w+m*D+v*S,s[8]=a*T+c*C+p*A,s[9]=l*T+f*C+g*A,s[10]=h*T+d*C+_*A,s[11]=u*T+m*C+v*A,s):null},rotateX:function(t,e,i){var s=Math.sin(e),r=Math.cos(e),n=t[4],o=t[5],a=t[6],l=t[7],h=t[8],u=t[9],c=t[10],f=t[11];return i?t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[4]=n*r+h*s,i[5]=o*r+u*s,i[6]=a*r+c*s,i[7]=l*r+f*s,i[8]=n*-s+h*r,i[9]=o*-s+u*r,i[10]=a*-s+c*r,i[11]=l*-s+f*r,i},rotateY:function(t,e,i){var s=Math.sin(e),r=Math.cos(e),n=t[0],o=t[1],a=t[2],l=t[3],h=t[8],u=t[9],c=t[10],f=t[11];return i?t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=n*r+h*-s,i[1]=o*r+u*-s,i[2]=a*r+c*-s,i[3]=l*r+f*-s,i[8]=n*s+h*r,i[9]=o*s+u*r,i[10]=a*s+c*r,i[11]=l*s+f*r,i},rotateZ:function(t,e,i){var s=Math.sin(e),r=Math.cos(e),n=t[0],o=t[1],a=t[2],l=t[3],h=t[4],u=t[5],c=t[6],f=t[7];return i?t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=n*r+h*s,i[1]=o*r+u*s,i[2]=a*r+c*s,i[3]=l*r+f*s,i[4]=n*-s+h*r,i[5]=o*-s+u*r,i[6]=a*-s+c*r,i[7]=l*-s+f*r,i},frustum:function(t,e,i,s,r,n,o){o||(o=D.create());var a=e-t,l=s-i,h=n-r;return o[0]=2*r/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r/l,o[6]=0,o[7]=0,o[8]=(e+t)/a,o[9]=(s+i)/l,o[10]=-(n+r)/h,o[11]=-1,o[12]=0,o[13]=0,o[14]=-n*r*2/h,o[15]=0,o},perspective:function(t,e,i,s,r){var n=i*Math.tan(t*Math.PI/360),o=n*e;return D.frustum(-o,o,-n,n,i,s,r)},ortho:function(t,e,i,s,r,n,o){o||(o=D.create());var a=e-t,l=s-i,h=n-r;return o[0]=2/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/h,o[11]=0,o[12]=-(t+e)/a,o[13]=-(s+i)/l,o[14]=-(n+r)/h,o[15]=1,o},lookAt:function(t,e,i,s){s||(s=D.create());var r,n,o,a,l,h,u,c,f,d,m=t[0],p=t[1],g=t[2],_=i[0],v=i[1],x=i[2],b=e[0],y=e[1],w=e[2];return m===b&&p===y&&g===w?D.identity(s):(u=m-b,c=p-y,f=g-w,r=v*(f*=d=1/Math.sqrt(u*u+c*c+f*f))-x*(c*=d),n=x*(u*=d)-_*f,o=_*c-v*u,(d=Math.sqrt(r*r+n*n+o*o))?(r*=d=1/d,n*=d,o*=d):o=n=r=0,a=c*o-f*n,l=f*r-u*o,h=u*n-c*r,(d=Math.sqrt(a*a+l*l+h*h))?(a*=d=1/d,l*=d,h*=d):h=l=a=0,s[0]=r,s[1]=a,s[2]=u,s[3]=0,s[4]=n,s[5]=l,s[6]=c,s[7]=0,s[8]=o,s[9]=h,s[10]=f,s[11]=0,s[12]=-(r*m+n*p+o*g),s[13]=-(a*m+l*p+h*g),s[14]=-(u*m+c*p+f*g),s[15]=1,s)},fromRotationTranslation:function(t,e,i){i||(i=D.create());var s=t[0],r=t[1],n=t[2],o=t[3],a=s+s,l=r+r,h=n+n,u=s*a,c=s*l,f=s*h,d=r*l,m=r*h,p=n*h,g=o*a,_=o*l,v=o*h;return i[0]=1-(d+p),i[1]=c+v,i[2]=f-_,i[3]=0,i[4]=c-v,i[5]=1-(u+p),i[6]=m+g,i[7]=0,i[8]=f+_,i[9]=m-g,i[10]=1-(u+d),i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+"]"}},m={create:function(t){var e=new _(4);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):e[0]=e[1]=e[2]=e[3]=0,e},createFrom:function(t,e,i,s){var r=new _(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=s,r},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i},identity:function(t){return t||(t=m.create()),t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}},p=m.identity();m.calculateW=function(t,e){var i=t[0],s=t[1],r=t[2];return e&&t!==e?(e[0]=i,e[1]=s,e[2]=r,e[3]=-Math.sqrt(Math.abs(1-i*i-s*s-r*r)),e):(t[3]=-Math.sqrt(Math.abs(1-i*i-s*s-r*r)),t)},m.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},m.inverse=function(t,e){var i=t[0],s=t[1],r=t[2],n=t[3],o=i*i+s*s+r*r+n*n,a=o?1/o:0;return e&&t!==e?(e[0]=-t[0]*a,e[1]=-t[1]*a,e[2]=-t[2]*a,e[3]=t[3]*a,e):(t[0]*=-a,t[1]*=-a,t[2]*=-a,t[3]*=a,t)},m.conjugate=function(t,e){return e&&t!==e?(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e):(t[0]*=-1,t[1]*=-1,t[2]*=-1,t)},m.length=function(t){var e=t[0],i=t[1],s=t[2],r=t[3];return Math.sqrt(e*e+i*i+s*s+r*r)},m.normalize=function(t,e){e||(e=t);var i=t[0],s=t[1],r=t[2],n=t[3],o=Math.sqrt(i*i+s*s+r*r+n*n);return 0===o?(e[0]=0,e[1]=0,e[2]=0,e[3]=0):(o=1/o,e[0]=i*o,e[1]=s*o,e[2]=r*o,e[3]=n*o),e},m.add=function(t,e,i){return i&&t!==i?(i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3],i):(t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],t)},m.multiply=function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=t[3],a=e[0],l=e[1],h=e[2],u=e[3];return i[0]=s*u+o*a+r*h-n*l,i[1]=r*u+o*l+n*a-s*h,i[2]=n*u+o*h+s*l-r*a,i[3]=o*u-s*a-r*l-n*h,i},m.multiplyVec3=function(t,e,i){i||(i=e);var s=e[0],r=e[1],n=e[2],o=t[0],a=t[1],l=t[2],h=t[3],u=h*s+a*n-l*r,c=h*r+l*s-o*n,f=h*n+o*r-a*s,d=-o*s-a*r-l*n;return i[0]=u*h+d*-o+c*-l-f*-a,i[1]=c*h+d*-a+f*-o-u*-l,i[2]=f*h+d*-l+u*-a-c*-o,i},m.scale=function(t,e,i){return i&&t!==i?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i):(t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t)},m.toMat3=function(t,e){e||(e=v.create());var i=t[0],s=t[1],r=t[2],n=t[3],o=i+i,a=s+s,l=r+r,h=i*o,u=i*a,c=i*l,f=s*a,d=s*l,m=r*l,p=n*o,g=n*a,_=n*l;return e[0]=1-(f+m),e[1]=u+_,e[2]=c-g,e[3]=u-_,e[4]=1-(h+m),e[5]=d+p,e[6]=c+g,e[7]=d-p,e[8]=1-(h+f),e},m.toMat4=function(t,e){e||(e=D.create());var i=t[0],s=t[1],r=t[2],n=t[3],o=i+i,a=s+s,l=r+r,h=i*o,u=i*a,c=i*l,f=s*a,d=s*l,m=r*l,p=n*o,g=n*a,_=n*l;return e[0]=1-(f+m),e[1]=u+_,e[2]=c-g,e[3]=0,e[4]=u-_,e[5]=1-(h+m),e[6]=d+p,e[7]=0,e[8]=c+g,e[9]=d-p,e[10]=1-(h+f),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.slerp=function(t,e,i,s){s||(s=t);var r,n,o,a,l=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];return 1<=Math.abs(l)?(s!==t&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3]),s):(r=Math.acos(l),n=Math.sqrt(1-l*l),Math.abs(n)<.001?(s[0]=.5*t[0]+.5*e[0],s[1]=.5*t[1]+.5*e[1],s[2]=.5*t[2]+.5*e[2],s[3]=.5*t[3]+.5*e[3]):(o=Math.sin((1-i)*r)/n,a=Math.sin(i*r)/n,s[0]=t[0]*o+e[0]*a,s[1]=t[1]*o+e[1]*a,s[2]=t[2]*o+e[2]*a,s[3]=t[3]*o+e[3]*a),s)},m.fromRotationMatrix=function(t,e){e||(e=m.create());var i,s=t[0]+t[4]+t[8];if(0<s)i=Math.sqrt(s+1),e[3]=.5*i,i=.5/i,e[0]=(t[7]-t[5])*i,e[1]=(t[2]-t[6])*i,e[2]=(t[3]-t[1])*i;else{var r=m.fromRotationMatrix.s_iNext=m.fromRotationMatrix.s_iNext||[1,2,0],n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var o=r[n],a=r[o];i=Math.sqrt(t[3*n+n]-t[3*o+o]-t[3*a+a]+1),e[n]=.5*i,i=.5/i,e[3]=(t[3*a+o]-t[3*o+a])*i,e[o]=(t[3*o+n]+t[3*n+o])*i,e[a]=(t[3*a+n]+t[3*n+a])*i}return e},v.toQuat4=m.fromRotationMatrix,r=v.create(),m.fromAxes=function(t,e,i,s){return r[0]=e[0],r[3]=e[1],r[6]=e[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=t[0],r[5]=t[1],r[8]=t[2],m.fromRotationMatrix(r,s)},m.identity=function(t){return t||(t=m.create()),t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},m.fromAngleAxis=function(t,e,i){i||(i=m.create());var s=.5*t,r=Math.sin(s);return i[3]=Math.cos(s),i[0]=r*e[0],i[1]=r*e[1],i[2]=r*e[2],i},m.toAngleAxis=function(t,e){e||(e=t);var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(0<i){e[3]=2*Math.acos(t[3]);var s=n.invsqrt(i);e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s}else e[3]=0,e[0]=1,e[1]=0,e[2]=0;return e},m.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"};var o={create:function(t){var e=new _(2);return t?(e[0]=t[0],e[1]=t[1]):(e[0]=0,e[1]=0),e},createFrom:function(t,e){var i=new _(2);return i[0]=t,i[1]=e,i},add:function(t,e,i){return i||(i=e),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i},subtract:function(t,e,i){return i||(i=e),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i},multiply:function(t,e,i){return i||(i=e),i[0]=t[0]*e[0],i[1]=t[1]*e[1],i},divide:function(t,e,i){return i||(i=e),i[0]=t[0]/e[0],i[1]=t[1]/e[1],i},scale:function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i},dist:function(t,e){var i=e[0]-t[0],s=e[1]-t[1];return Math.sqrt(i*i+s*s)},set:function(t,e){return e[0]=t[0],e[1]=t[1],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i},negate:function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e},normalize:function(t,e){e||(e=t);var i=t[0]*t[0]+t[1]*t[1];return 0<i?(i=Math.sqrt(i),e[0]=t[0]/i,e[1]=t[1]/i):e[0]=e[1]=0,e},cross:function(t,e,i){var s=t[0]*e[1]-t[1]*e[0];return i?(i[0]=i[1]=0,i[2]=s,i):s},length:function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},squaredLength:function(t){var e=t[0],i=t[1];return e*e+i*i},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},direction:function(t,e,i){i||(i=t);var s=t[0]-e[0],r=t[1]-e[1],n=s*s+r*r;return n?(n=1/Math.sqrt(n),i[0]=s*n,i[1]=r*n):(i[0]=0,i[1]=0,i[2]=0),i},lerp:function(t,e,i,s){return s||(s=t),s[0]=t[0]+i*(e[0]-t[0]),s[1]=t[1]+i*(e[1]-t[1]),s},str:function(t){return"["+t[0]+", "+t[1]+"]"}},g={create:function(t){var e=new _(4);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):e[0]=e[1]=e[2]=e[3]=0,e},createFrom:function(t,e,i,s){var r=new _(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=s,r},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i},identity:function(t){return t||(t=g.create()),t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3],e;var i=t[1];return t[1]=t[2],t[2]=i,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},inverse:function(t,e){e||(e=t);var i=t[0],s=t[1],r=t[2],n=t[3],o=i*n-r*s;return o?(o=1/o,e[0]=n*o,e[1]=-s*o,e[2]=-r*o,e[3]=i*o,e):null},multiply:function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=t[3];return i[0]=s*e[0]+r*e[2],i[1]=s*e[1]+r*e[3],i[2]=n*e[0]+o*e[2],i[3]=n*e[1]+o*e[3],i},rotate:function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=t[3],a=Math.sin(e),l=Math.cos(e);return i[0]=s*l+r*a,i[1]=s*-a+r*l,i[2]=n*l+o*a,i[3]=n*-a+o*l,i},multiplyVec2:function(t,e,i){i||(i=e);var s=e[0],r=e[1];return i[0]=s*t[0]+r*t[1],i[1]=s*t[2]+r*t[3],i},scale:function(t,e,i){i||(i=t);var s=t[0],r=t[1],n=t[2],o=t[3],a=e[0],l=e[1];return i[0]=s*a,i[1]=r*l,i[2]=n*a,i[3]=o*l,i},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"}},x={create:function(t){var e=new _(4);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e},createFrom:function(t,e,i,s){var r=new _(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=s,r},add:function(t,e,i){return i||(i=e),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3],i},subtract:function(t,e,i){return i||(i=e),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i[3]=t[3]-e[3],i},multiply:function(t,e,i){return i||(i=e),i[0]=t[0]*e[0],i[1]=t[1]*e[1],i[2]=t[2]*e[2],i[3]=t[3]*e[3],i},divide:function(t,e,i){return i||(i=e),i[0]=t[0]/e[0],i[1]=t[1]/e[1],i[2]=t[2]/e[2],i[3]=t[3]/e[3],i},scale:function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i},negate:function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},length:function(t){var e=t[0],i=t[1],s=t[2],r=t[3];return Math.sqrt(e*e+i*i+s*s+r*r)},squaredLength:function(t){var e=t[0],i=t[1],s=t[2],r=t[3];return e*e+i*i+s*s+r*r},lerp:function(t,e,i,s){return s||(s=t),s[0]=t[0]+i*(e[0]-t[0]),s[1]=t[1]+i*(e[1]-t[1]),s[2]=t[2]+i*(e[2]-t[2]),s[3]=t[3]+i*(e[3]-t[3]),s},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"}};return t&&(t.glMatrixArrayType=_,t.MatrixArray=_,t.setMatrixArrayType=e,t.determineMatrixArrayType=s,t.glMath=n,t.vec2=o,t.vec3=a,t.vec4=x,t.mat2=g,t.mat3=v,t.mat4=D,t.quat4=m),{glMatrixArrayType:_,MatrixArray:_,setMatrixArrayType:e,determineMatrixArrayType:s,glMath:n,vec2:o,vec3:a,vec4:x,mat2:g,mat3:v,mat4:D,quat4:m}},"object"===r(o)?n.exports=s(t):void 0===(e=function(){return s(i)}.apply(o,[]))||(n.exports=e)}).call(this,t(7))},function(t,e,i){"use strict";var s,v,x,c,b,d,f,m,p,g,_,y,h,r={};function o(t){return 0==t?0:0<t?1:-1}function n(t,e){for(var i=[],s=f(t,e),r=e.length-1,n=m(s,2*r-1,i,0),o=v(t,e[0]),a=c(o),l=0,h=0;h<n;h++){o=v(t,y(e,r,i[h],null,null));var u=c(o);u<a&&(a=u,l=i[h])}return o=v(t,e[r]),(u=c(o))<a&&(a=u,l=1),{location:l,distance:a}}function l(t,e){for(var i=function(e){var t=h[e];if(!t){var i=function(e){return function(t){return e}},s=function(){return function(t){return t}},r=function(){return function(t){return 1-t}},n=function(s){return function(t){for(var e=1,i=0;i<s.length;i++)e*=s[i](t);return e}};(t=[]).push(new function(){return function(t){return Math.pow(t,e)}});for(var o=1;o<e;o++){for(var a=[new i(e)],l=0;l<e-o;l++)a.push(new s);for(l=0;l<o;l++)a.push(new r);t.push(new n(a))}t.push(new function(){return function(t){return Math.pow(1-t,e)}}),h[e]=t}return t}(t.length-1),s=0,r=0,n=0;n<t.length;n++)s+=t[n].x*i[n](e),r+=t[n].y*i[n](e);return{x:s,y:r}}function u(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function w(t,e,i){for(var s=l(t,e),r=0,n=e,o=0<i?1:-1,a=null;r<Math.abs(i);)a=l(t,n+=.005*o),r+=u(a,s),s=a;return{point:a,location:n}}function D(t,e){var i=l(t,e),s=l(t.slice(0,t.length-1),e),r=s.y-i.y,n=s.x-i.x;return 0==r?1/0:Math.atan(r/n)}s=r,v=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},x=function(t,e){return t.x*e.x+t.y*e.y},c=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},b=function(t,e){return{x:t.x*e,y:t.y*e}},d=Math.pow(2,-65),f=function(t,e){for(var i=e.length-1,s=2*i-1,r=[],n=[],o=[],a=[],l=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],h=0;h<=i;h++)r[h]=v(e[h],t);for(h=0;h<=i-1;h++)n[h]=v(e[h+1],e[h]),n[h]=b(n[h],3);for(var u=0;u<=i-1;u++)for(var c=0;c<=i;c++)o[u]||(o[u]=[]),o[u][c]=x(n[u],r[c]);for(h=0;h<=s;h++)a[h]||(a[h]=[]),a[h].y=0,a[h].x=parseFloat(h)/s;for(var f=i,d=i-1,m=0;m<=f+d;m++){var p=Math.max(0,m-d),g=Math.min(m,f);for(h=p;h<=g;h++){var _=m-h;a[h+_].y+=o[_][h]*l[_][h]}}return a},m=function t(e,i,s,r){var n,o,a=[],l=[],h=[],u=[];switch(p(e,i)){case 0:return 0;case 1:if(64<=r)return s[0]=(e[0].x+e[i].x)/2,1;if(g(e,i))return s[0]=_(e,i),1}y(e,i,.5,a,l),n=t(a,i,h,r+1),o=t(l,i,u,r+1);for(var c=0;c<n;c++)s[c]=h[c];for(c=0;c<o;c++)s[c+n]=u[c];return n+o},p=function(t,e){var i,s,r=0;i=s=o(t[0].y);for(var n=1;n<=e;n++)(i=o(t[n].y))!=s&&r++,s=i;return r},g=function(t,e){var i,s,r,n,o,a,l;n=t[0].y-t[e].y,o=t[e].x-t[0].x,a=t[0].x*t[e].y-t[e].x*t[0].y;for(var h=0,u=0,c=1;c<e;c++){var f=n*t[c].x+o*t[c].y+a;h<f?h=f:f<u&&(u=f)}return i=(1*(a-h)-0*(l=o))*(1/(0*l-1*n)),s=(1*(a-u)-0*(l=o))*(1/(0*l-1*n)),r=Math.min(i,s),Math.max(i,s)-r<d?1:0},_=function(t,e){var i=t[e].x-t[0].x,s=t[e].y-t[0].y,r=t[0].x-0;return 0+1*((i*(t[0].y-0)-s*r)*(1/(0*i-1*s)))},y=function(t,e,i,s,r){for(var n=[[]],o=0;o<=e;o++)n[0][o]=t[o];for(var a=1;a<=e;a++)for(o=0;o<=e-a;o++)n[a]||(n[a]=[]),n[a][o]||(n[a][o]={}),n[a][o].x=(1-i)*n[a-1][o].x+i*n[a-1][o+1].x,n[a][o].y=(1-i)*n[a-1][o].y+i*n[a-1][o+1].y;if(null!=s)for(o=0;o<=e;o++)s[o]=n[o][0];if(null!=r)for(o=0;o<=e;o++)r[o]=n[e-o][o];return n[e][0]},h={},s.jsBezier={distanceFromCurve:n,gradientAtPoint:D,gradientAtPointAlongCurveFrom:function(t,e,i){var s=w(t,e,i);return 1<s.location&&(s.location=1),s.location<0&&(s.location=0),D(t,s.location)},nearestPointOnCurve:function(t,e){var i=n(t,e);return{point:y(e,e.length-1,i.location,null,null),location:i.location}},pointOnCurve:l,pointAlongCurveFrom:function(t,e,i){return w(t,e,i).point},perpendicularToCurveAt:function(t,e,i,s){var r=w(t,e,s=null==s?0:s),n=D(t,r.location),o=Math.atan(-1/n),a=i/2*Math.sin(o),l=i/2*Math.cos(o);return[{x:r.point.x+l,y:r.point.y+a},{x:r.point.x-l,y:r.point.y-a}]},locationAlongCurveFrom:function(t,e,i){return w(t,e,i).location},getLength:function(t){for(var e=l(t,0),i=0,s=0,r=null;s<1;)r=l(t,s+=.005),i+=u(r,e),e=r;return i}},e.a=r.jsBezier},function(t,e,i){"use strict";var w,D,S,T,s=(w=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),D=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],S=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],T=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],function(t,e){var i=[],s=[],r=0,n=new Float32Array(8),o=new Int32Array(12),a=new Int32Array(3);for(a[2]=0;a[2]<e[2]-1;++a[2],r+=e[0])for(a[1]=0;a[1]<e[1]-1;++a[1],++r)for(a[0]=0;a[0]<e[0]-1;++a[0],++r){for(var l=0,h=0;h<8;++h){var u=S[h],c=t[r+u[0]+e[0]*(u[1]+e[1]*u[2])];l|=0<(n[h]=c)?1<<h:0}var f=w[l];if(0!==f){for(h=0;h<12;++h)if(0!=(f&1<<h)){o[h]=i.length;var d=[0,0,0],m=T[h],p=S[m[0]],g=S[m[1]],_=n[m[0]],v=_-n[m[1]],x=0;1e-6<Math.abs(v)&&(x=_/v);for(var b=0;b<3;++b)d[b]=a[b]+p[b]+x*(g[b]-p[b]);i.push(d)}var y=D[l];for(h=0;h<y.length;h+=3)s.push([o[y[h]],o[y[h+1]],o[y[h+2]]])}}return{vertices:i,faces:s}});e.a=s},function(t,e,i){var s,r,n;r=[i(1)],void 0===(n="function"==typeof(s=function(f){var d,m,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],p=Array.prototype.slice;if(f.event.fixHooks)for(var i=t.length;i;)f.event.fixHooks[t[--i]]=f.event.mouseHooks;var g=f.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],s,!1);else this.onmousewheel=s;f.data(this,"mousewheel-line-height",g.getLineHeight(this)),f.data(this,"mousewheel-page-height",g.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],s,!1);else this.onmousewheel=null;f.removeData(this,"mousewheel-line-height"),f.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var e=f(t),i=e["offsetParent"in f.fn?"offsetParent":"parent"]();return i.length||(i=f("body")),parseInt(i.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(t){return f(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function s(t){var e=t||window.event,i=p.call(arguments,1),s=0,r=0,n=0,o=0,a=0,l=0;if((t=f.event.fix(e)).type="mousewheel","detail"in e&&(n=-1*e.detail),"wheelDelta"in e&&(n=e.wheelDelta),"wheelDeltaY"in e&&(n=e.wheelDeltaY),"wheelDeltaX"in e&&(r=-1*e.wheelDeltaX),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(r=-1*n,n=0),s=0===n?r:n,"deltaY"in e&&(n=-1*e.deltaY,s=n),"deltaX"in e&&(r=e.deltaX,0===n&&(s=-1*r)),0!==n||0!==r){if(1===e.deltaMode){var h=f.data(this,"mousewheel-line-height");s*=h,n*=h,r*=h}else if(2===e.deltaMode){var u=f.data(this,"mousewheel-page-height");s*=u,n*=u,r*=u}if(o=Math.max(Math.abs(n),Math.abs(r)),m&&!(o<m)||v(e,m=o)&&(m/=40),v(e,o)&&(s/=40,r/=40,n/=40),s=Math[1<=s?"floor":"ceil"](s/m),r=Math[1<=r?"floor":"ceil"](r/m),n=Math[1<=n?"floor":"ceil"](n/m),g.settings.normalizeOffset&&this.getBoundingClientRect){var c=this.getBoundingClientRect();a=t.clientX-c.left,l=t.clientY-c.top}return t.deltaX=r,t.deltaY=n,t.deltaFactor=m,t.offsetX=a,t.offsetY=l,t.deltaMode=0,i.unshift(t,s,r,n),d&&clearTimeout(d),d=setTimeout(_,200),(f.event.dispatch||f.event.handle).apply(this,i)}}function _(){m=null}function v(t,e){return g.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}f.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})?s.apply(e,r):s)||(t.exports=n)},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"stringStartsWith",function(){return c}),r.d(n,"vec3AngleFrom",function(){return f}),r.d(n,"contextRoundRect",function(){return d}),r.d(n,"contextEllipse",function(){return m}),r.d(n,"getFontString",function(){return p});var o={};r.r(o),r.d(o,"Point",function(){return _}),r.d(o,"Queue",function(){return x}),r.d(o,"Query",function(){return T}),r.d(o,"Ring",function(){return E});var a={};r.r(a),r.d(a,"getVersion",function(){return R}),r.d(a,"SYMBOLS",function(){return M}),r.d(a,"ELEMENT",function(){return I}),r.d(a,"RESIDUE",function(){return k});var l={};r.r(l),r.d(l,"Bounds",function(){return U}),r.d(l,"angleBetweenLargest",function(){return j}),r.d(l,"isBetween",function(){return G}),r.d(l,"getRGB",function(){return X}),r.d(l,"hsl2rgb",function(){return V}),r.d(l,"idx2color",function(){return Y}),r.d(l,"distanceFromPointToLineInclusive",function(){return Z}),r.d(l,"calculateDistanceInterior",function(){return $}),r.d(l,"intersectLines",function(){return Q}),r.d(l,"clamp",function(){return J}),r.d(l,"rainbowAt",function(){return K}),r.d(l,"angleBounds",function(){return tt}),r.d(l,"isPointInPoly",function(){return et});var h=r(0),u=Math;function c(t,e){return t.slice(0,e.length)===e}function f(t,e){var i=h.vec3.length(t),s=h.vec3.length(e),r=h.vec3.dot(t,e)/i/s;return u.acos(r)}function d(t,e,i,s,r,n){t.beginPath(),t.moveTo(e+n,i),t.lineTo(e+s-n,i),t.quadraticCurveTo(e+s,i,e+s,i+n),t.lineTo(e+s,i+r-n),t.quadraticCurveTo(e+s,i+r,e+s-n,i+r),t.lineTo(e+n,i+r),t.quadraticCurveTo(e,i+r,e,i+r-n),t.lineTo(e,i+n),t.quadraticCurveTo(e,i,e+n,i),t.closePath()}function m(t,e,i,s,r){var n=s/2*.5522848,o=r/2*.5522848,a=e+s,l=i+r,h=e+s/2,u=i+r/2;t.beginPath(),t.moveTo(e,u),t.bezierCurveTo(e,u-o,h-n,i,h,i),t.bezierCurveTo(h+n,i,a,u-o,a,u),t.bezierCurveTo(a,u+o,h+n,l,h,l),t.bezierCurveTo(h-n,l,e,u+o,e,u),t.closePath()}function p(t,e,i,s){var r=[];i&&r.push("bold "),s&&r.push("italic "),r.push(t+"px ");for(var n=0,o=e.length;n<o;n++){var a=e[n];-1!==a.indexOf(" ")&&(a='"'+a+'"'),r.push((0!==n?",":"")+a)}return r.join("")}var g=Math;function _(t,e){this.x=t||0,this.y=e||0}var v=_.prototype;function x(){this.queue=[]}v.sub=function(t){this.x-=t.x,this.y-=t.y},v.add=function(t){this.x+=t.x,this.y+=t.y},v.distance=function(t){var e=t.x-this.x,i=t.y-this.y;return g.sqrt(e*e+i*i)},v.angleForStupidCanvasArcs=function(t){var e=t.x-this.x,i=t.y-this.y,s=0;for(s=0==e?0==i?0:0<i?g.PI/2:3*g.PI/2:0==i?0<e?0:g.PI:e<0?g.atan(i/e)+g.PI:i<0?g.atan(i/e)+2*g.PI:g.atan(i/e);s<0;)s+=2*g.PI;return s%=2*g.PI},v.angle=function(t){var e=t.x-this.x,i=this.y-t.y,s=0;for(s=0==e?0==i?0:0<i?g.PI/2:3*g.PI/2:0==i?0<e?0:g.PI:e<0?g.atan(i/e)+g.PI:i<0?g.atan(i/e)+2*g.PI:g.atan(i/e);s<0;)s+=2*g.PI;return s%=2*g.PI};var b=x.prototype;b.queueSpace=0,b.getSize=function(){return this.queue.length-this.queueSpace},b.isEmpty=function(){return 0===this.queue.length},b.enqueue=function(t){this.queue.push(t)},b.dequeue=function(){var t;return this.queue.length&&(t=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)),t},b.getOldestElement=function(){var t;return this.queue.length&&(t=this.queue[this.queueSpace]),t};var y={getFontString:p},w=(Math,/[ ,]+/),D=/\-+/,S=["Helvetica","Arial","Dialog"];function T(t){this.type=t,this.elements={v:[],not:!1},this.charge=void 0,this.chirality=void 0,this.connectivity=void 0,this.connectivityNoH=void 0,this.hydrogens=void 0,this.saturation=void 0,this.orders={v:[],not:!1},this.stereo=void 0,this.aromatic=void 0,this.ringCount=void 0,this.cache=void 0}T.TYPE_ATOM=0,T.TYPE_BOND=1;var C=T.prototype;C.parseRange=function(t){for(var e=[],i=t.split(w),s=0,r=i.length;s<r;s++){var n=i[s],o=!1,a=!1;if("-"===n.charAt(0)&&(o=!0,n=n.substring(1)),-1!=n.indexOf("--")&&(a=!0),-1!=n.indexOf("-")){var l=n.split(D),h={x:parseInt(l[0])*(o?-1:1),y:parseInt(l[1])*(a?-1:1)};if(h.y<h.x){var u=h.y;h.y=h.x,h.x=u}e.push(h)}else e.push({x:parseInt(n)*(o?-1:1)})}return e},C.draw=function(t,e,i){this.cache||(this.cache=this.toString());var s=this.cache,r=void 0,n=s.indexOf("(");-1!=n&&(s=this.cache.substring(0,n),r=this.cache.substring(n,this.cache.length)),t.textAlign="center",t.textBaseline="middle",t.font=y.getFontString(12,S,!0,!1);var o=t.measureText(s).width;t.fillStyle=e.backgroundColor,t.fillRect(i.x-o/2,i.y-6,o,12),t.fillStyle="black",t.fillText(s,i.x,i.y),r&&(t.font=y.getFontString(10,S,!1,!0),o=t.measureText(r).width,t.fillStyle=e.backgroundColor,t.fillRect(i.x-o/2,i.y+6,o,11),t.fillStyle="black",t.fillText(r,i.x,i.y+11))},C.outputRange=function(t){for(var e=!1,i=[],s=0,r=t.length;s<r;s++){e&&i.push(","),e=!0;var n=t[s];n.y?(i.push(n.x),i.push("-"),i.push(n.y)):i.push(n.x)}return i.join("")},C.toString=function(){var t=[],e=[];return this.type===T.TYPE_ATOM?(this.elements&&0!==this.elements.v.length?(this.elements.not&&t.push("!"),t.push("["),t.push(this.elements.v.join(",")),t.push("]")):t.push("[a]"),this.chirality&&e.push((this.chirality.not?"!":"")+"@="+this.chirality.v),this.aromatic&&e.push((this.aromatic.not?"!":"")+"A"),this.charge&&e.push((this.charge.not?"!":"")+"C="+this.outputRange(this.charge.v)),this.hydrogens&&e.push((this.hydrogens.not?"!":"")+"H="+this.outputRange(this.hydrogens.v)),this.ringCount&&e.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v)),this.saturation&&e.push((this.saturation.not?"!":"")+"S"),this.connectivity&&e.push((this.connectivity.not?"!":"")+"X="+this.outputRange(this.connectivity.v)),this.connectivityNoH&&e.push((this.connectivityNoH.not?"!":"")+"x="+this.outputRange(this.connectivityNoH.v))):this.type===T.TYPE_BOND&&(this.orders&&0!==this.orders.v.length?(this.orders.not&&t.push("!"),t.push("["),t.push(this.orders.v.join(",")),t.push("]")):t.push("[a]"),this.stereo&&e.push((this.stereo.not?"!":"")+"@="+this.stereo.v),this.aromatic&&e.push((this.aromatic.not?"!":"")+"A"),this.ringCount&&e.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v))),0<e.length&&(t.push("("),t.push(e.join(",")),t.push(")")),t.join("")};var A=Math;function E(){this.atoms=[],this.bonds=[]}var F=E.prototype;F.center=void 0,F.setupBonds=function(){for(var t=0,e=this.bonds.length;t<e;t++)this.bonds[t].ring=this;this.center=this.getCenter()},F.getCenter=function(){for(var t=1/0,e=1/0,i=-1/0,s=-1/0,r=0,n=this.atoms.length;r<n;r++)t=A.min(this.atoms[r].x,t),e=A.min(this.atoms[r].y,e),i=A.max(this.atoms[r].x,i),s=A.max(this.atoms[r].y,s);return new _((i+t)/2,(s+e)/2)};var P="8.0.0";function R(){return P}var B,M=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"],I=((B=[]).H=new L("H","Hydrogen",1,!1,"#FFFFFF",.31,1.1,1,1),B.He=new L("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4),B.Li=new L("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7),B.Be=new L("Be","Beryllium",4,!1,"#C2FF00",.96,1.53,2,9),B.B=new L("B","Boron",5,!0,"#FFB5B5",.84,1.92,3,11),B.C=new L("C","Carbon",6,!0,"#909090",.76,1.7,4,12),B.N=new L("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14),B.O=new L("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16),B.F=new L("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19),B.Ne=new L("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20),B.Na=new L("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23),B.Mg=new L("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24),B.Al=new L("Al","Aluminum",13,!1,"#BFA6A6",1.21,1.84,0,27),B.Si=new L("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28),B.P=new L("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31),B.S=new L("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32),B.Cl=new L("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35),B.Ar=new L("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40),B.K=new L("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39),B.Ca=new L("Ca","Calcium",20,!1,"#3DFF00",1.76,2.31,0,40),B.Sc=new L("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45),B.Ti=new L("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48),B.V=new L("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51),B.Cr=new L("Cr","Chromium",24,!1,"#8A99C7",1.39,0,2,52),B.Mn=new L("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55),B.Fe=new L("Fe","Iron",26,!1,"#E06633",1.32,0,2,56),B.Co=new L("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59),B.Ni=new L("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58),B.Cu=new L("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63),B.Zn=new L("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64),B.Ga=new L("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69),B.Ge=new L("Ge","Germanium",32,!1,"#668F8F",1.2,2.11,4,74),B.As=new L("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75),B.Se=new L("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80),B.Br=new L("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79),B.Kr=new L("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84),B.Rb=new L("Rb","Rubidium",37,!1,"#702EB0",2.2,3.03,0,85),B.Sr=new L("Sr","Strontium",38,!1,"#00FF00",1.95,2.49,0,88),B.Y=new L("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89),B.Zr=new L("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90),B.Nb=new L("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93),B.Mo=new L("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98),B.Tc=new L("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0),B.Ru=new L("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102),B.Rh=new L("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103),B.Pd=new L("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106),B.Ag=new L("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107),B.Cd=new L("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114),B.In=new L("In","Indium",49,!1,"#A67573",1.42,1.93,0,115),B.Sn=new L("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120),B.Sb=new L("Sb","Antimony",51,!1,"#9E63B5",1.39,2.06,3,121),B.Te=new L("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130),B.I=new L("I","Iodine",53,!0,"#940094",1.39,1.98,1,127),B.Xe=new L("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132),B.Cs=new L("Cs","Cesium",55,!1,"#57178F",2.44,3.43,0,133),B.Ba=new L("Ba","Barium",56,!1,"#00C900",2.15,2.68,0,138),B.La=new L("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139),B.Ce=new L("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140),B.Pr=new L("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,0,0,141),B.Nd=new L("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142),B.Pm=new L("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0),B.Sm=new L("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152),B.Eu=new L("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153),B.Gd=new L("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158),B.Tb=new L("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159),B.Dy=new L("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164),B.Ho=new L("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165),B.Er=new L("Er","Erbium",68,!1,"#00E675",1.89,0,0,166),B.Tm=new L("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169),B.Yb=new L("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174),B.Lu=new L("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175),B.Hf=new L("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180),B.Ta=new L("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181),B.W=new L("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184),B.Re=new L("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187),B.Os=new L("Os","Osmium",76,!1,"#266696",1.44,0,2,192),B.Ir=new L("Ir","Iridium",77,!1,"#175487",1.41,0,3,193),B.Pt=new L("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195),B.Au=new L("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197),B.Hg=new L("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202),B.Tl=new L("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205),B.Pb=new L("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208),B.Bi=new L("Bi","Bismuth",83,!1,"#9E4FB5",1.48,2.07,3,209),B.Po=new L("Po","Polonium",84,!1,"#AB5C00",1.4,1.97,2,0),B.At=new L("At","Astatine",85,!0,"#754F45",1.5,2.02,1,0),B.Rn=new L("Rn","Radon",86,!1,"#428296",1.5,2.2,0,0),B.Fr=new L("Fr","Francium",87,!1,"#420066",2.6,3.48,0,0),B.Ra=new L("Ra","Radium",88,!1,"#007D00",2.21,2.83,0,0),B.Ac=new L("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0),B.Th=new L("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232),B.Pa=new L("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231),B.U=new L("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238),B.Np=new L("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0),B.Pu=new L("Pu","Plutonium",94,!1,"#006BFF",1.87,0,0,0),B.Am=new L("Am","Americium",95,!1,"#545CF2",1.8,0,0,0),B.Cm=new L("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0),B.Bk=new L("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0),B.Cf=new L("Cf","Californium",98,!1,"#A136D4",0,0,0,0),B.Es=new L("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0),B.Fm=new L("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0),B.Md=new L("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0),B.No=new L("No","Nobelium",102,!1,"#BD0D87",0,0,0,0),B.Lr=new L("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0),B.Rf=new L("Rf","Rutherfordium",104,!1,"#CC0059",0,0,0,0),B.Db=new L("Db","Dubnium",105,!1,"#D1004F",0,0,0,0),B.Sg=new L("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0),B.Bh=new L("Bh","Bohrium",107,!1,"#E00038",0,0,0,0),B.Hs=new L("Hs","Hassium",108,!1,"#E6002E",0,0,0,0),B.Mt=new L("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0),B.Ds=new L("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0),B.Rg=new L("Rg","Roentgenium",111,!1,"#000000",0,0,0,0),B.Cn=new L("Cn","Copernicium",112,!1,"#000000",0,0,0,0),B.Nh=new L("Nh","Nihonium",113,!1,"#000000",0,0,0,0),B.Fl=new L("Fl","Flerovium",114,!1,"#000000",0,0,0,0),B.Mc=new L("Mc","Moscovium",115,!1,"#000000",0,0,0,0),B.Lv=new L("Lv","Livermorium",116,!1,"#000000",0,0,0,0),B.Ts=new L("Ts","Tennessine",117,!1,"#000000",0,0,0,0),B.Og=new L("Og","Oganesson",118,!1,"#000000",0,0,0,0),B.H.pymolColor="#E6E6E6",B.C.pymolColor="#33FF33",B.N.pymolColor="#3333FF",B.O.pymolColor="#FF4D4D",B.F.pymolColor="#B3FFFF",B.S.pymolColor="#E6C640",B);function L(t,e,i,s,r,n,o,a,l){this.symbol=t,this.name=e,this.atomicNumber=i,this.addH=s,this.jmolColor=this.pymolColor=r,this.covalentRadius=n,this.vdWRadius=o,this.valency=a,this.mass=l}var N,k=((N=[]).Ala=new z("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0),N.Arg=new z("Arg","Arginine",!0,"#145AFF","#00007C",1),N.Asn=new z("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0),N.Asp=new z("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1),N.Cys=new z("Cys","Cysteine",!0,"#E6E600","#FFFF70",0),N.Gln=new z("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0),N.Glu=new z("Glu","Glutamic Acid",!0,"#E60A0A","#660000",-1),N.Gly=new z("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0),N.His=new z("His","Histidine",!0,"#8282D2","#7070FF",1),N.Ile=new z("Ile","Isoleucine",!1,"#0F820F","#004C00",0),N.Leu=new z("Leu","Leucine",!1,"#0F820F","#455E45",0),N.Lys=new z("Lys","Lysine",!0,"#145AFF","#4747B8",1),N.Met=new z("Met","Methionine",!1,"#E6E600","#B8A042",0),N.Phe=new z("Phe","Phenylalanine",!1,"#3232AA","#534C52",0),N.Pro=new z("Pro","Proline",!1,"#DC9682","#525252",0),N.Ser=new z("Ser","Serine",!0,"#FA9600","#FF7042",0),N.Thr=new z("Thr","Threonine",!0,"#FA9600","#B84C00",0),N.Trp=new z("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0),N.Tyr=new z("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0),N.Val=new z("Val","Valine",!1,"#0F820F","#FF8CFF",0),N.Asx=new z("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0),N.Glx=new z("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0),N["*"]=new z("*","Other",!1,"#BEA06E","#FF00FF",0),N.A=new z("A","Adenine",!1,"#BEA06E","#A0A0FF",0),N.G=new z("G","Guanine",!1,"#BEA06E","#FF7070",0),N.I=new z("I","",!1,"#BEA06E","#80FFFF",0),N.C=new z("C","Cytosine",!1,"#BEA06E","#FF8C4B",0),N.T=new z("T","Thymine",!1,"#BEA06E","#A0FFA0",0),N.U=new z("U","Uracil",!1,"#BEA06E","#FF8080",0),N);function z(t,e,i,s,r,n){this.symbol=t,this.name=e,this.polar=i,this.aminoColor=s,this.shapelyColor=r,this.acidity=n}var O=Math;function U(){}var H=U.prototype;H.minX=H.minY=H.minZ=1/0,H.maxX=H.maxY=H.maxZ=-1/0,H.expand=function(t,e,i,s){t instanceof U?(this.minX=O.min(this.minX,t.minX),this.minY=O.min(this.minY,t.minY),this.maxX=O.max(this.maxX,t.maxX),this.maxY=O.max(this.maxY,t.maxY),t.maxZ!==1/0&&(this.minZ=O.min(this.minZ,t.minZ),this.maxZ=O.max(this.maxZ,t.maxZ))):(this.minX=O.min(this.minX,t),this.maxX=O.max(this.maxX,t),this.minY=O.min(this.minY,e),this.maxY=O.max(this.maxY,e),void 0!==i&&void 0!==s&&(this.minX=O.min(this.minX,i),this.maxX=O.max(this.maxX,i),this.minY=O.min(this.minY,s),this.maxY=O.max(this.maxY,s)))},H.expand3D=function(t,e,i,s,r,n){this.minX=O.min(this.minX,t),this.maxX=O.max(this.maxX,t),this.minY=O.min(this.minY,e),this.maxY=O.max(this.maxY,e),this.minZ=O.min(this.minZ,i),this.maxZ=O.max(this.maxZ,i),void 0!==s&&void 0!==r&&void 0!==n&&(this.minX=O.min(this.minX,s),this.maxX=O.max(this.maxX,s),this.minY=O.min(this.minY,r),this.maxY=O.max(this.maxY,r),this.minZ=O.min(this.minZ,n),this.maxZ=O.max(this.maxZ,n))};var W=Math,q={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function j(t){if(0===t.length)return{angle:0,largest:2*W.PI};if(1===t.length)return{angle:t[0]+W.PI,largest:2*W.PI};for(var e=0,i=0,s=0,r=t.length-1;s<r;s++){var n=t[s+1]-t[s];e<n&&(e=n,i=(t[s+1]+t[s])/2)}var o=t[0]+2*W.PI-t[t.length-1];return e<o&&(e=o,(i=t[0]-o/2)<0&&(i+=2*W.PI)),{angle:i,largest:e}}function G(t,e,i){if(i<e){var s=e;e=i,i=s}return e<=t&&t<=i}function X(t,e){var i=[0,0,0];if(q[t.toLowerCase()]&&(t=q[t.toLowerCase()]),"#"===t.charAt(0))return 4===t.length&&(t="#"+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3)),[parseInt(t.substring(1,3),16)/255*e,parseInt(t.substring(3,5),16)/255*e,parseInt(t.substring(5,7),16)/255*e];if(c(t,"rgb")){var s=t.replace(/rgb\(|\)/g,"").split(",");return 3!==s.length?i:[parseInt(s[0])/255*e,parseInt(s[1])/255*e,parseInt(s[2])/255*e]}return i}function V(t,e,i){function s(t,e,i){return i<0?i+=1:1<i&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var r,n,o;if(0===e)r=n=o=i;else{var a=i<.5?i*(1+e):i+e-i*e,l=2*i-a;r=s(l,a,t+1/3),n=s(l,a,t),o=s(l,a,t-1/3)}return[255*r,255*n,255*o]}function Y(t){for(var e=t.toString(16),i=0,s=6-e.length;i<s;i++)e="0"+e;return"#"+e}function Z(t,e,i,s){var r=e.distance(i),n=e.angle(i),o=W.PI/2-n,a=e.angle(t)+o,l=e.distance(t),h=new _(l*W.cos(a),-l*W.sin(a)),u=s||0;return G(-h.y,u,r-u)?W.abs(h.x):-1}function $(t,e,i){if(G(e.x,i.x,i.x+i.w)&&G(e.y,i.y,i.y+i.h))return t.distance(e);var s=[];s.push({x1:i.x,y1:i.y,x2:i.x+i.w,y2:i.y}),s.push({x1:i.x,y1:i.y+i.h,x2:i.x+i.w,y2:i.y+i.h}),s.push({x1:i.x,y1:i.y,x2:i.x,y2:i.y+i.h}),s.push({x1:i.x+i.w,y1:i.y,x2:i.x+i.w,y2:i.y+i.h});for(var r=[],n=0;n<4;n++){var o=s[n];(h=Q(e.x,e.y,t.x,t.y,o.x1,o.y1,o.x2,o.y2))&&r.push(h)}if(0===r.length)return 0;for(var a=0,l=(n=0,r.length);n<l;n++){var h=r[n],u=t.x-h.x,c=t.y-h.y;a=W.max(a,W.sqrt(u*u+c*c))}return a}function Q(t,e,i,s,r,n,o,a){var l=(s-=e)*(o-=r)-(i-=t)*(a-=n);if(0==l)return!1;var h=(a*(t-r)-o*(e-n))/l,u=(s*(t-r)-i*(e-n))/l;return 0<=u&&u<=1&&0<=h&&h<=1&&{x:t+h*i,y:e+h*s}}function J(t,e,i){return t<e?e:i<t?i:t}function K(t,e,i){i.length<1?i.push("#000000","#FFFFFF"):i.length<2&&i.push("#FFFFFF");var s=e/(i.length-1),r=W.floor(t/s),n=(t-r*s)/s,o=X(i[r],1),a=X(i[r+1],1);return"rgb("+[255*(o[0]+(a[0]-o[0])*n),255*(o[1]+(a[1]-o[1])*n),255*(o[2]+(a[2]-o[2])*n)].join(",")+")"}function tt(t,e,i){for(var s=2*W.PI;t<0;)t+=s;for(;s<t;)t-=s;return i&&t>W.PI&&(t=2*W.PI-t),e&&(t=180*t/W.PI),t}function et(t,e){for(var i=!1,s=-1,r=t.length,n=r-1;++s<r;n=s)(t[s].y<=e.y&&e.y<t[n].y||t[n].y<=e.y&&e.y<t[s].y)&&e.x<(t[n].x-t[s].x)*(e.y-t[s].y)/(t[n].y-t[s].y)+t[s].x&&(i=!i);return i}Object(h.jQuery)(document).ready(function(){void 0});var it={};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)},it.requestInterval=function(i,s){if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setInterval(i,s);var r=(new Date).getTime(),n=new Object;return n.value=window.requestAnimFrame(function t(){var e=(new Date).getTime();s<=e-r&&(i.call(),r=(new Date).getTime()),n.value=window.requestAnimFrame(t)}),n},it.clearRequestInterval=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearInterval(t)},it.requestTimeout=function(i,s){if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setTimeout(i,s);var r=(new Date).getTime(),n=new Object;return n.value=window.requestAnimFrame(function t(){var e=(new Date).getTime();s<=e-r?i.call():n.value=window.requestAnimFrame(t)}),n},it.clearRequestTimeout=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearTimeout(t)};var st=it,rt={},nt=rt,ot=rt;ot.supports_canvas=function(){return!!document.createElement("canvas").getContext},ot.supports_canvas_text=function(){return!!ot.supports_canvas()&&"function"==typeof document.createElement("canvas").getContext("2d").fillText},ot.supports_webgl=function(){var t=document.createElement("canvas");try{if(t.getContext("webgl"))return!0;if(t.getContext("experimental-webgl"))return!0}catch(t){}return!1},ot.supports_xhr2=function(){return h.jQuery.support.cors},ot.supports_touch=function(){return"ontouchstart"in window&&!!navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i)},ot.supports_gesture=function(){return"ongesturestart"in window},r.d(e,"ChemDoodle",function(){return Te});var at,lt,ht,ut,ct,ft,dt,mt,pt,gt,_t,vt,xt,bt,yt,wt,Dt,St,Tt,Ct,At,Et,Ft,Pt,Rt,Bt,Mt,It,Lt,Nt,kt,zt,Ot,Ut,Ht,Wt,qt,jt,Gt,Xt,Vt,Yt,Zt,$t,Qt,Jt,Kt,te,ee,ie,se,re,ne,oe,ae,le,he,ue,ce,fe,de,me,pe,ge,_e,ve,xe,be,ye,we,De,Se,Te=a;function Ce(t,e,i,s){this.entire=t,this.name=e,this.indexes=i,this.pi=s}function Ae(t,e,i){var s=new Ct.Residue(-1);return s.cp1=s.cp2=new Ct.Atom("",t,e,i),s}function Ee(t,e){this.a1=t,this.a2=e}function Fe(t,e,i){this.a1=t,this.a2=e,this.vx=i}function Pe(t,e){t.bindBuffer(t.ARRAY_BUFFER,e.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,e.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.vertexNormalBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,e.vertexNormalBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)}function Re(t,e,i){var s=Ht.sqrt(e[1]*e[1]+e[2]*e[2]),r=[1,0,0,0,0,e[2]/s,-e[1]/s,0,0,e[1]/s,e[2]/s,0,0,0,0,1],n=[1,0,0,0,0,e[2]/s,e[1]/s,0,0,-e[1]/s,e[2]/s,0,0,0,0,1],o=[s,0,-e[0],0,0,1,0,0,e[0],0,s,0,0,0,0,1],a=[s,0,e[0],0,0,1,0,0,-e[0],0,s,0,0,0,0,1],l=[Ht.cos(i),-Ht.sin(i),0,0,Ht.sin(i),Ht.cos(i),0,0,0,0,1,0,0,0,0,1],h=Wt.multiply(r,Wt.multiply(o,Wt.multiply(l,Wt.multiply(a,n,[]))));this.rotate=function(){return Wt.multiplyVec3(h,t)}}Te.iChemLabs={},Te.informatics={},Te.io={},Te.lib=h,Te.notations={},Te.structures=o,Te.structures.d2={},Te.structures.d3={},Te.animations=st,Te.extensions=n,Te.math=l,Te.featureDetection=nt,function(A,E,F,P,R,a,B){P.Atom=function(t,e,i,s){this.label=t?t.replace(/\s/g,""):"C",this.x=e||0,this.y=i||0,this.z=s||0};var t=P.Atom.prototype=new P.Point(0,0);t.charge=0,t.numLonePair=0,t.numRadical=0,t.mass=-1,t.implicitH=-1,t.coordinationNumber=0,t.bondNumber=0,t.angleOfLeastInterference=0,t.isHidden=!1,t.altLabel=B,t.isLone=!1,t.isHover=!1,t.isSelected=!1,t.add3D=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},t.sub3D=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},t.distance3D=function(t){var e=t.x-this.x,i=t.y-this.y,s=t.z-this.z;return R.sqrt(e*e+i*i+s*s)},t.draw=function(t,e){if(!this.dontDraw){if(this.isLassoed){var i=t.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);i.addColorStop(0,"rgba(212, 99, 0, 0)"),i.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),t.fillStyle=i,t.beginPath(),t.arc(this.x,this.y,5,0,2*R.PI,!1),t.fill()}if(!this.query){this.textBounds=[],this.specs&&(e=this.specs);var s,r=E.getFontString(e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);t.font=r,t.fillStyle=this.getElementColor(e.atoms_useJMOLColors,e.atoms_usePYMOLColors,e.atoms_color,2),"H"===this.label&&e.atoms_HBlack_2D&&(t.fillStyle="black"),this.error&&(t.fillStyle=e.colorError);var n=this.isLabelVisible(e);if(this.isLone&&!n||e.atoms_circles_2D)this.isLone&&(t.fillStyle="#909090"),t.beginPath(),t.arc(this.x,this.y,e.atoms_circleDiameter_2D/2,0,2*R.PI,!1),t.fill(),0<e.atoms_circleBorderWidth_2D&&(t.lineWidth=e.atoms_circleBorderWidth_2D,t.strokeStyle="black",t.stroke());else if(n)if(t.textAlign="center",t.textBaseline="middle",this.altLabel!==B){t.fillText(this.altLabel,this.x,this.y);var o=t.measureText(this.altLabel).width;this.textBounds.push({x:this.x-o/2,y:this.y-e.atoms_font_size_2D/2+1,w:o,h:e.atoms_font_size_2D-2})}else if(A[this.label]){t.fillText(this.label,this.x,this.y);o=t.measureText(this.label).width;this.textBounds.push({x:this.x-o/2,y:this.y-e.atoms_font_size_2D/2+1,w:o,h:e.atoms_font_size_2D-2});var a=0;if(-1!==this.mass){var l=t.font;t.font=E.getFontString(.7*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D),a=t.measureText(this.mass).width,t.fillText(this.mass,this.x-a-.5,this.y-e.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-o/2-a-.5,y:this.y-1.7*e.atoms_font_size_2D/2+1,w:a,h:e.atoms_font_size_2D/2-1}),t.font=l}var h=o/2,u=this.getImplicitHydrogenCount();if(e.atoms_implicitHydrogens_2D&&0<u){s=0;var c=t.measureText("H").width,f=!0;if(1<u){var d=o/2+c/2,m=0,p=E.getFontString(.8*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);t.font=p;var g=t.measureText(u).width;1===this.bondNumber?this.angleOfLeastInterference>R.PI/2&&this.angleOfLeastInterference<3*R.PI/2&&(d=-o/2-g-c/2-a/2,f=!1,s=R.PI):this.angleOfLeastInterference<=R.PI/4||(this.angleOfLeastInterference<3*R.PI/4?(d=0,m=.9*-e.atoms_font_size_2D,0!==this.charge&&(m-=.3*e.atoms_font_size_2D),f=!1,s=R.PI/2):this.angleOfLeastInterference<=5*R.PI/4?(d=-o/2-g-c/2-a/2,f=!1,s=R.PI):this.angleOfLeastInterference<7*R.PI/4&&(d=0,m=.9*e.atoms_font_size_2D,f=!1,s=3*R.PI/2)),t.font=r,t.fillText("H",this.x+d,this.y+m),t.font=p,t.fillText(u,this.x+d+c/2+g/2,this.y+m+.3*e.atoms_font_size_2D),this.textBounds.push({x:this.x+d-c/2,y:this.y+m-e.atoms_font_size_2D/2+1,w:c,h:e.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+d+c/2,y:this.y+m+.3*e.atoms_font_size_2D-e.atoms_font_size_2D/2+1,w:g,h:.8*e.atoms_font_size_2D-2})}else{d=o/2+c/2,m=0;1===this.bondNumber?this.angleOfLeastInterference>R.PI/2&&this.angleOfLeastInterference<3*R.PI/2&&(d=-o/2-c/2-a/2,f=!1,s=R.PI):this.angleOfLeastInterference<=R.PI/4||(this.angleOfLeastInterference<3*R.PI/4?(d=0,m=.9*-e.atoms_font_size_2D,f=!1,s=R.PI/2):this.angleOfLeastInterference<=5*R.PI/4?(d=-o/2-c/2-a/2,f=!1,s=R.PI):this.angleOfLeastInterference<7*R.PI/4&&(d=0,m=.9*e.atoms_font_size_2D,f=!1,s=3*R.PI/2)),t.fillText("H",this.x+d,this.y+m),this.textBounds.push({x:this.x+d-c/2,y:this.y+m-e.atoms_font_size_2D/2+1,w:c,h:e.atoms_font_size_2D-2})}f&&(h+=c)}if(0!==this.charge){var _=this.charge.toFixed(0);"1"===_?_="+":"-1"===_?_="":E.stringStartsWith(_,"-")?_=_.substring(1)+"":_+="+";var v=t.measureText(_).width;h+=v/2,t.textAlign="center",t.textBaseline="middle",t.font=E.getFontString(R.floor(.8*e.atoms_font_size_2D),e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D),t.fillText(_,this.x+h-1,this.y-e.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+h-v/2-1,y:this.y-1.8*e.atoms_font_size_2D/2+5,w:v,h:e.atoms_font_size_2D/2-1})}}else if(P.CondensedLabel)this.condensed&&this.condensed.text===this.label||(this.condensed=new P.CondensedLabel(this,this.label)),this.condensed.draw(t,e);else{t.fillText(this.label,this.x,this.y);var o=t.measureText(this.label).width;this.textBounds.push({x:this.x-o/2,y:this.y-e.atoms_font_size_2D/2+1,w:o,h:e.atoms_font_size_2D-2})}if(0<this.numLonePair||0<this.numRadical){t.fillStyle="black";var x=this.angles.slice(0),b=this.angleOfLeastInterference,y=this.largestAngle;if(s!==B){x.push(s),x.sort(function(t,e){return t-e});var w=F.angleBetweenLargest(x);b=w.angle%(2*R.PI),y=w.largest}for(var D=[],S=0;S<this.numLonePair;S++)D.push({t:2});for(S=0;S<this.numRadical;S++)D.push({t:1});if(s===B&&R.abs(y-2*R.PI/x.length)<R.PI/60)for(var T=R.ceil(D.length/x.length),C=(S=0,D.length);S<C;S+=T,b+=y)this.drawElectrons(t,e,D.slice(S,R.min(D.length,S+T)),b,y,s);else this.drawElectrons(t,e,D,b,y,s)}}}},t.drawElectrons=function(t,e,i,s,r,n){for(var o=r/(i.length+(0===this.bonds.length&&n===B?0:1)),a=s-r/2+o,l=0;l<i.length;l++){var h=i[l],u=(s=a+l*o,this.x+Math.cos(s)*e.atoms_lonePairDistance_2D),c=this.y-Math.sin(s)*e.atoms_lonePairDistance_2D;if(2===h.t){var f=s+Math.PI/2,d=Math.cos(f)*e.atoms_lonePairSpread_2D/2,m=-Math.sin(f)*e.atoms_lonePairSpread_2D/2;t.beginPath(),t.arc(u+d,c+m,e.atoms_lonePairDiameter_2D,0,2*R.PI,!1),t.fill(),t.beginPath(),t.arc(u-d,c-m,e.atoms_lonePairDiameter_2D,0,2*R.PI,!1),t.fill()}else 1===h.t&&(t.beginPath(),t.arc(u,c,e.atoms_lonePairDiameter_2D,0,2*R.PI,!1),t.fill())}},t.drawDecorations=function(t,e){if(this.isHover||this.isSelected){t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1.2,t.beginPath();var i=this.isHover?7:15;t.arc(this.x,this.y,i,0,2*R.PI,!1),t.stroke()}this.isOverlap&&(t.strokeStyle=e.colorError,t.lineWidth=1.2,t.beginPath(),t.arc(this.x,this.y,7,0,2*R.PI,!1),t.stroke())},t.render=function(t,e,i){this.specs&&(e=this.specs);var s=a.translate(a.identity(),[this.x,this.y,this.z]),r=e.atoms_useVDWDiameters_3D?A[this.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D/2;if(0===r&&(r=1),a.scale(s,[r,r,r]),!i){var n=e.atoms_color;e.atoms_useJMOLColors?n=A[this.label].jmolColor:e.atoms_usePYMOLColors&&(n=A[this.label].pymolColor),t.material.setDiffuseColor(t,n)}t.shader.setMatrixUniforms(t,s);var o=this.renderAsStar?t.starBuffer:t.sphereBuffer;t.drawElements(t.TRIANGLES,o.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},t.renderHighlight=function(t,e){if(this.isSelected||this.isHover){this.specs&&(e=this.specs);var i=a.translate(a.identity(),[this.x,this.y,this.z]),s=e.atoms_useVDWDiameters_3D?A[this.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D/2;0===s&&(s=1),s*=1.3,a.scale(i,[s,s,s]),t.shader.setMatrixUniforms(t,i),t.material.setDiffuseColor(t,this.isHover?e.colorHover:e.colorSelect);var r=this.renderAsStar?t.starBuffer:t.sphereBuffer;t.drawElements(t.TRIANGLES,r.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}},t.isLabelVisible=function(t){return!!t.atoms_displayAllCarbonLabels_2D||("C"!==this.label||(!(!this.altLabel&&A[this.label])||(-1!==this.mass||-1!==this.implicitH||0!==this.charge||(!(!t.atoms_showAttributedCarbons_2D||0===this.numRadical&&0===this.numLonePair)||(!(!this.isHidden||!t.atoms_showHiddenCarbons_2D)||!(!t.atoms_displayTerminalCarbonLabels_2D||1!==this.bondNumber))))))},t.getImplicitHydrogenCount=function(){if(!A[this.label]||!A[this.label].addH)return 0;if(-1!==this.implicitH)return this.implicitH;if("H"===this.label)return 0;var t=A[this.label].valency,e=t-this.coordinationNumber;if(0<this.numRadical&&(e=R.max(0,e-this.numRadical)),0<this.charge){var i=4-t;this.charge<=i?e+=this.charge:e=4-this.coordinationNumber-this.charge+i}else e+=this.charge;return e<0?0:R.floor(e)},t.getBounds=function(){var t=new F.Bounds;if(t.expand(this.x,this.y),this.textBounds)for(var e=0,i=this.textBounds.length;e<i;e++){var s=this.textBounds[e];t.expand(s.x,s.y,s.x+s.w,s.y+s.h)}return t},t.getBounds3D=function(){var t=new F.Bounds;return t.expand3D(this.x,this.y,this.z),t},t.getElementColor=function(t,e,i){return A[this.label]?(t?i=A[this.label].jmolColor:e&&(i=A[this.label].pymolColor),i):"#000"}}(Te.ELEMENT,Te.extensions,Te.math,Te.structures,Math,Te.lib.mat4),function(t,L,rt,nt,ot,N,k,s){rt.Bond=function(t,e,i){this.a1=t,this.a2=e,this.bondOrder=i!==s?i:1},rt.Bond.STEREO_NONE="none",rt.Bond.STEREO_PROTRUDING="protruding",rt.Bond.STEREO_RECESSED="recessed",rt.Bond.STEREO_AMBIGUOUS="ambiguous";var e=rt.Bond.prototype;e.stereo=rt.Bond.STEREO_NONE,e.isHover=!1,e.ring=s,e.getCenter=function(){return new rt.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},e.getLength=function(){return this.a1.distance(this.a2)},e.getLength3D=function(){return this.a1.distance3D(this.a2)},e.contains=function(t){return t===this.a1||t===this.a2},e.getNeighbor=function(t){return t===this.a1?this.a2:t===this.a2?this.a1:s},e.draw=function(t,e){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.specs&&(e=this.specs);var i=this.a1.x,s=this.a2.x,r=this.a1.y,n=this.a2.y,o=this.a1.distance(this.a2),a=s-i,l=n-r;if(this.a1.isLassoed&&this.a2.isLassoed){var h=t.createLinearGradient(i,r,s,n);h.addColorStop(0,"rgba(212, 99, 0, 0)"),h.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),h.addColorStop(1,"rgba(212, 99, 0, 0)");var u=2.5,c=this.a1.angle(this.a2)+ot.PI/2,f=i-(Z=ot.cos(c))*u,d=r+($=ot.sin(c))*u,m=i+Z*u,p=r-$*u,g=s+Z*u,_=n-$*u,v=s-Z*u,x=n+$*u;t.fillStyle=h,t.beginPath(),t.moveTo(f,d),t.lineTo(m,p),t.lineTo(g,_),t.lineTo(v,x),t.closePath(),t.fill()}if(e.atoms_display&&!e.atoms_circles_2D&&this.a1.isLabelVisible(e)&&this.a1.textBounds){for(var b=0,y=0,w=this.a1.textBounds.length;y<w;y++)b=Math.max(b,nt.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[y]));i+=a*(D=(b+=e.bonds_atomLabelBuffer_2D)/o),r+=l*D}if(e.atoms_display&&!e.atoms_circles_2D&&this.a2.isLabelVisible(e)&&this.a2.textBounds){for(b=0,y=0,w=this.a2.textBounds.length;y<w;y++)b=Math.max(b,nt.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[y]));var D;s-=a*(D=(b+=e.bonds_atomLabelBuffer_2D)/o),n-=l*D}if(e.bonds_clearOverlaps_2D){var S=i+.15*a,T=r+.15*l,C=s-.15*a,A=n-.15*l;t.strokeStyle=e.backgroundColor,t.lineWidth=e.bonds_width_2D+2*e.bonds_overlapClearWidth_2D,t.lineCap="round",t.beginPath(),t.moveTo(S,T),t.lineTo(C,A),t.closePath(),t.stroke()}if(t.strokeStyle=this.error?e.colorError:e.bonds_color,t.fillStyle=this.error?e.colorError:e.bonds_color,t.lineWidth=e.bonds_width_2D,t.lineCap=e.bonds_ends_2D,e.bonds_splitColor){var E=t.createLinearGradient(i,r,s,n),F=this.a1.specs?this.a1.specs:e,P=this.a2.specs?this.a2.specs:e,R=this.a1.getElementColor(F.atoms_useJMOLColors,F.atoms_usePYMOLColors,F.atoms_color,2),B=this.a2.getElementColor(P.atoms_useJMOLColors,P.atoms_usePYMOLColors,P.atoms_color,2);E.addColorStop(0,R),e.bonds_colorGradient||(E.addColorStop(.5,R),E.addColorStop(.51,B)),E.addColorStop(1,B),t.strokeStyle=E,t.fillStyle=E}if(e.bonds_lewisStyle_2D&&this.bondOrder%1==0)this.drawLewisStyle(t,e,i,r,s,n);else switch(this.query?1:this.bondOrder){case 0:var M=s-i,I=n-r,L=ot.sqrt(M*M+I*I),N=ot.floor(L/e.bonds_dotSize_2D),k=(L-(N-1)*e.bonds_dotSize_2D)/2;N%2==1?k+=e.bonds_dotSize_2D/4:(k-=e.bonds_dotSize_2D/4,N+=2),N/=2;var z=this.a1.angle(this.a2);S=i+k*Math.cos(z),T=r-k*Math.sin(z);t.beginPath();for(y=0;y<N;y++)t.arc(S,T,e.bonds_dotSize_2D/2,0,2*ot.PI,!1),S+=2*e.bonds_dotSize_2D*Math.cos(z),T-=2*e.bonds_dotSize_2D*Math.sin(z);t.fill();break;case.5:t.beginPath(),t.moveTo(i,r),t.lineTo(s,n),t.setLineDash([e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([]);break;case 1:if(this.query||this.stereo!==rt.Bond.STEREO_PROTRUDING&&this.stereo!==rt.Bond.STEREO_RECESSED){if(!this.query&&this.stereo===rt.Bond.STEREO_AMBIGUOUS){t.beginPath(),t.moveTo(i,r);var O,U,H,W,q=ot.floor(ot.sqrt(a*a+l*l)/e.bonds_wavyLength_2D),j=i,G=r,X=(c=this.a1.angle(this.a2)+ot.PI/2,Z=ot.cos(c),$=ot.sin(c),a/q),V=l/q;for(y=0,w=q;y<w;y++)j+=X,G+=V,O=e.bonds_wavyLength_2D*Z+j-.5*X,H=e.bonds_wavyLength_2D*-$+G-.5*V,U=e.bonds_wavyLength_2D*-Z+j-.5*X,W=e.bonds_wavyLength_2D*$+G-.5*V,y%2==0?t.quadraticCurveTo(O,H,j,G):t.quadraticCurveTo(U,W,j,G);t.stroke();break}t.beginPath(),t.moveTo(i,r),t.lineTo(s,n),t.stroke(),this.query&&this.query.draw(t,e,this.getCenter())}else{var Y=e.bonds_width_2D/2,c=(u=e.bonds_wedgeThickness_2D/2,this.a1.angle(this.a2)+ot.PI/2);f=i-(Z=ot.cos(c))*Y,d=r+($=ot.sin(c))*Y,m=i+Z*Y,p=r-$*Y,g=s+Z*u,_=n-$*u,v=s-Z*u,x=n+$*u;if(t.beginPath(),t.moveTo(f,d),t.lineTo(m,p),t.lineTo(g,_),t.lineTo(v,x),t.closePath(),this.stereo===rt.Bond.STEREO_PROTRUDING)t.fill();else{t.save(),t.clip(),t.lineWidth=2*u,t.lineCap="butt",t.beginPath(),t.moveTo(i,r);M=s-i,I=n-r;t.lineTo(s+5*M,n+5*I),t.setLineDash([e.bonds_hashWidth_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([]),t.restore()}}break;case 1.5:case 2:c=(z=this.a1.angle(this.a2))+ot.PI/2;var Z=ot.cos(c),$=ot.sin(c);o=this.a1.distance(this.a2),u=e.bonds_useAbsoluteSaturationWidths_2D?e.bonds_saturationWidthAbs_2D/2:o*e.bonds_saturationWidth_2D/2;if(this.stereo===rt.Bond.STEREO_AMBIGUOUS){f=i-Z*u,d=r+$*u,m=i+Z*u,p=r-$*u,g=s+Z*u,_=n-$*u,v=s-Z*u,x=n+$*u;t.beginPath(),t.moveTo(f,d),t.lineTo(g,_),t.moveTo(m,p),t.lineTo(v,x),t.stroke()}else if(!e.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)){t.beginPath(),t.moveTo(i,r),t.lineTo(s,n),t.stroke();var Q=0;u*=2;var J=e.bonds_saturationAngle_2D;if(J<ot.PI/2&&(Q=-u/ot.tan(J)),ot.abs(Q)<o/2){var K=i-ot.cos(z)*Q,tt=s+ot.cos(z)*Q,et=r+ot.sin(z)*Q,it=n-ot.sin(z)*Q,st=(f=K-Z*u,d=et+$*u,m=K+Z*u,p=et-$*u,g=tt-Z*u,_=it+$*u,v=tt+Z*u,x=it-$*u,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>ot.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-ot.PI);t.beginPath(),st?(t.moveTo(f,d),t.lineTo(g,_)):(t.moveTo(m,p),t.lineTo(v,x)),2!==this.bondOrder&&t.setLineDash([e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([])}}else{f=i-Z*u,d=r+$*u,m=i+Z*u,p=r-$*u,g=s+Z*u,_=n-$*u,v=s-Z*u,x=n+$*u;t.beginPath(),t.moveTo(f,d),t.lineTo(v,x),t.stroke(),t.beginPath(),t.moveTo(m,p),t.lineTo(g,_),2!==this.bondOrder&&t.setLineDash([e.bonds_hashWidth_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([])}break;case 3:u=e.bonds_useAbsoluteSaturationWidths_2D?e.bonds_saturationWidthAbs_2D:this.a1.distance(this.a2)*e.bonds_saturationWidth_2D,c=this.a1.angle(this.a2)+ot.PI/2,f=i-(Z=ot.cos(c))*u,d=r+($=ot.sin(c))*u,m=i+Z*u,p=r-$*u,g=s+Z*u,_=n-$*u,v=s-Z*u,x=n+$*u;t.beginPath(),t.moveTo(f,d),t.lineTo(v,x),t.moveTo(m,p),t.lineTo(g,_),t.moveTo(i,r),t.lineTo(s,n),t.stroke()}}},e.drawDecorations=function(t,e){if(this.isHover||this.isSelected){var i=2*ot.PI,s=(this.a1.angleForStupidCanvasArcs(this.a2)+ot.PI/2)%i;t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1.2,t.beginPath();var r=(s+ot.PI)%i;r%=2*ot.PI,t.arc(this.a1.x,this.a1.y,7,s,r,!1),t.stroke(),t.beginPath(),r=((s+=ot.PI)+ot.PI)%i,t.arc(this.a2.x,this.a2.y,7,s,r,!1),t.stroke()}},e.drawLewisStyle=function(t,e,i,s,r,n){for(var o=this.a1.angle(this.a2),a=o+ot.PI/2,l=r-i,h=n-s,u=ot.sqrt(l*l+h*h)/(this.bondOrder+1),c=u*ot.cos(o),f=-u*ot.sin(o),d=i+c,m=s+f,p=0;p<this.bondOrder;p++){var g=e.atoms_lonePairSpread_2D/2,_=d-ot.cos(a)*g,v=m+ot.sin(a)*g,x=d+ot.cos(a)*g,b=m-ot.sin(a)*g;t.beginPath(),t.arc(_-e.atoms_lonePairDiameter_2D/2,v-e.atoms_lonePairDiameter_2D/2,e.atoms_lonePairDiameter_2D,0,2*ot.PI,!1),t.fill(),t.beginPath(),t.arc(x-e.atoms_lonePairDiameter_2D/2,b-e.atoms_lonePairDiameter_2D/2,e.atoms_lonePairDiameter_2D,0,2*ot.PI,!1),t.fill(),d+=c,m+=f}},e.render=function(t,e,i){this.specs&&(e=this.specs);var s=this.a1.distance3D(this.a2);if(0!==s){var r,n,o,a=e.bonds_cylinderDiameter_3D/2,l=e.bonds_color,h=N.translate(N.identity(),[this.a1.x,this.a1.y,this.a1.z]),u=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],c=[0,1,0],f=0;if(this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(o=[0,0,1],this.a2.y<this.a1.y&&(f=ot.PI)):(f=L.vec3AngleFrom(c,u),o=k.cross(c,u,[])),e.bonds_splitColor){var d=this.a1.specs?this.a1.specs:e,m=this.a2.specs?this.a2.specs:e;(l=this.a1.getElementColor(d.atoms_useJMOLColors,d.atoms_usePYMOLColors,d.atoms_color))!=(r=this.a2.getElementColor(m.atoms_useJMOLColors,m.atoms_usePYMOLColors,m.atoms_color))&&(n=N.translate(N.identity(),[this.a2.x,this.a2.y,this.a2.z]))}var p,g=[0];if(i){if(e.bonds_showBondOrders_3D&&1<this.bondOrder){g=[e.bonds_cylinderDiameter_3D];var _=[0,0,1],v=N.inverse(t.rotationMatrix,[]);N.multiplyVec3(v,_),p=k.cross(u,_,[]),k.normalize(p)}var x=1,b=e.bonds_pillSpacing_3D,y=e.bonds_pillHeight_3D;0==this.bondOrder&&(e.bonds_renderAsLines_3D?y=b:((y=e.bonds_pillDiameter_3D)<e.bonds_cylinderDiameter_3D&&(y/=2),s/=x=y/2,b/=x/2));var w=y+b,D=s/w,S=ot.floor(D),T=s-w*S,C=(b+e.bonds_pillDiameter_3D+T)/2,A=S;n&&(A=ot.floor(S/2));for(var E=0,F=g.length;E<F;E++){var P=N.set(h,[]);0!==g[E]&&N.translate(P,k.scale(p,g[E],[])),0!==f&&N.rotate(P,f,o),1!=x&&N.scale(P,[x,x,x]),l&&t.material.setDiffuseColor(t,l),N.translate(P,[0,C,0]);for(var R=0;R<A;R++)e.bonds_renderAsLines_3D?0==this.bondOrder?(t.shader.setMatrixUniforms(t,P),t.drawArrays(t.POINTS,0,1)):(N.scale(P,[1,y,1]),t.shader.setMatrixUniforms(t,P),t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems),N.scale(P,[1,1/y,1])):(t.shader.setMatrixUniforms(t,P),0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)),N.translate(P,[0,w,0]);if(n){var B,M;M=e.bonds_renderAsLines_3D?(B=y,B/=2,0):(1-(B=2/3))/2,S%2!=0&&(N.scale(P,[1,B,1]),t.shader.setMatrixUniforms(t,P),e.bonds_renderAsLines_3D?0==this.bondOrder?t.drawArrays(t.POINTS,0,1):t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0),N.translate(P,[0,w*(1+M),0]),N.scale(P,[1,1/B,1])),N.set(n,P),0!==g[E]&&N.translate(P,k.scale(p,g[E],[])),N.rotate(P,f+ot.PI,o),1!=x&&N.scale(P,[x,x,x]),r&&t.material.setDiffuseColor(t,r),N.translate(P,[0,C,0]);for(R=0;R<A;R++)e.bonds_renderAsLines_3D?0==this.bondOrder?(t.shader.setMatrixUniforms(t,P),t.drawArrays(t.POINTS,0,1)):(N.scale(P,[1,y,1]),t.shader.setMatrixUniforms(t,P),t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems),N.scale(P,[1,1/y,1])):(t.shader.setMatrixUniforms(t,P),0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)),N.translate(P,[0,w,0]);S%2!=0&&(N.scale(P,[1,B,1]),t.shader.setMatrixUniforms(t,P),e.bonds_renderAsLines_3D?0==this.bondOrder?t.drawArrays(t.POINTS,0,1):t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0),N.translate(P,[0,w*(1+M),0]),N.scale(P,[1,1/B,1]))}}}else{if(e.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:g=[-e.bonds_cylinderDiameter_3D];break;case 2:g=[-e.bonds_cylinderDiameter_3D,e.bonds_cylinderDiameter_3D];break;case 3:g=[-1.2*e.bonds_cylinderDiameter_3D,0,1.2*e.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){_=[0,0,1],v=N.inverse(t.rotationMatrix,[]);N.multiplyVec3(v,_),p=k.cross(u,_,[]),k.normalize(p)}}else switch(this.bondOrder){case 0:a*=.25;break;case.5:case 1.5:a*=.5}n&&(s/=2);var I=[a,s,a];for(E=0,F=g.length;E<F;E++){P=N.set(h,[]);0!==g[E]&&N.translate(P,k.scale(p,g[E],[])),0!==f&&N.rotate(P,f,o),N.scale(P,I),l&&t.material.setDiffuseColor(t,l),t.shader.setMatrixUniforms(t,P),e.bonds_renderAsLines_3D?t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems),n&&(N.set(n,P),0!==g[E]&&N.translate(P,k.scale(p,g[E],[])),N.rotate(P,f+ot.PI,o),N.scale(P,I),r&&t.material.setDiffuseColor(t,r),t.shader.setMatrixUniforms(t,P),e.bonds_renderAsLines_3D?t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems))}}}},e.renderHighlight=function(t,e){if(this.isSelected||this.isHover){this.specs&&(e=this.specs),this.specs&&(e=this.specs);var i=this.a1.distance3D(this.a2);if(0===i)return;var s,r=e.bonds_cylinderDiameter_3D/1.2,n=N.translate(N.identity(),[this.a1.x,this.a1.y,this.a1.z]),o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[0,1,0],l=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(s=[0,0,1],this.a2.y<this.a1.y&&(l=ot.PI)):(l=L.vec3AngleFrom(a,o),s=k.cross(a,o,[]));var h=[r,i,r];0!==l&&N.rotate(n,l,s),N.scale(n,h),t.shader.setMatrixUniforms(t,n),t.material.setDiffuseColor(t,this.isHover?e.colorHover:e.colorSelect),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems)}},e.renderPicker=function(t,e){this.specs&&(e=this.specs);var i=this.a1.distance3D(this.a2);if(0!==i){var s,r=e.bonds_cylinderDiameter_3D/2,n=N.translate(N.identity(),[this.a1.x,this.a1.y,this.a1.z]),o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[0,1,0],l=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(s=[0,0,1],this.a2.y<this.a1.y&&(l=ot.PI)):(l=L.vec3AngleFrom(a,o),s=k.cross(a,o,[]));var h,u=[0];if(e.bonds_showBondOrders_3D)if(e.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:u=[-e.bonds_cylinderDiameter_3D,e.bonds_cylinderDiameter_3D];break;case 3:u=[-1.2*e.bonds_cylinderDiameter_3D,0,1.2*e.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){var c=[0,0,1],f=N.inverse(t.rotationMatrix,[]);N.multiplyVec3(f,c),h=k.cross(o,c,[]),k.normalize(h)}}else switch(this.bondOrder){case 1.5:case 2:r*=3;break;case 3:r*=3.4}else switch(this.bondOrder){case 0:r*=.25;break;case.5:case 1.5:r*=.5}for(var d=[r,i,r],m=0,p=u.length;m<p;m++){var g=N.set(n,[]);0!==u[m]&&N.translate(g,k.scale(h,u[m],[])),0!==l&&N.rotate(g,l,s),N.scale(g,d),t.shader.setMatrixUniforms(t,g),e.bonds_renderAsLines_3D?t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems)}}}}(Te.ELEMENT,Te.extensions,Te.structures,Te.math,Math,Te.lib.mat4,Te.lib.vec3),function(l,w,D,S,f,T){D.Molecule=function(){this.atoms=[],this.bonds=[],this.rings=[]};var t=D.Molecule.prototype;t.findRings=!0,t.draw=function(t,e){if(this.specs&&(e=this.specs),e.atoms_display&&!e.atoms_circles_2D)for(var i=0,s=this.atoms.length;i<s;i++)this.atoms[i].draw(t,e);if(e.bonds_display)for(i=0,s=this.bonds.length;i<s;i++)this.bonds[i].draw(t,e);if(e.atoms_display)for(i=0,s=this.atoms.length;i<s;i++){var r=this.atoms[i];e.atoms_circles_2D&&r.draw(t,e),r.query&&r.query.draw(t,e,r)}},t.render=function(t,e){this.specs&&(e=this.specs);var i=0<this.atoms.length&&this.atoms[0].hetatm!==T;if(i){if(e.macro_displayBonds){0<this.bonds.length&&(e.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(t.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:e.bonds_width_2D),t.lineBuffer.bindBuffers(t)):t.cylinderBuffer.bindBuffers(t),t.material.setTempColors(t,e.bonds_materialAmbientColor_3D,T,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));for(var s=0,r=this.bonds.length;s<r;s++){!(a=this.bonds[s]).a1.hetatm&&(-1===e.macro_atomToLigandDistance||a.a1.closestDistance!==T&&e.macro_atomToLigandDistance>=a.a1.closestDistance&&e.macro_atomToLigandDistance>=a.a2.closestDistance)&&a.render(t,this.residueSpecs?this.residueSpecs:e)}}if(e.macro_displayAtoms){0<this.atoms.length&&(t.sphereBuffer.bindBuffers(t),t.material.setTempColors(t,e.atoms_materialAmbientColor_3D,T,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D));for(s=0,r=this.atoms.length;s<r;s++){!(h=this.atoms[s]).hetatm&&(-1===e.macro_atomToLigandDistance||h.closestDistance!==T&&e.macro_atomToLigandDistance>=h.closestDistance)&&h.render(t,this.residueSpecs?this.residueSpecs:e)}}}if(e.bonds_display){var n=[],o=[];0<this.bonds.length&&(e.bonds_renderAsLines_3D?(t.lineWidth(e.bonds_width_2D),t.lineBuffer.bindBuffers(t)):t.cylinderBuffer.bindBuffers(t),t.material.setTempColors(t,e.bonds_materialAmbientColor_3D,T,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));for(s=0,r=this.bonds.length;s<r;s++){var a=this.bonds[s];i&&!a.a1.hetatm||(e.bonds_showBondOrders_3D?0==a.bondOrder?o.push(a):.5==a.bondOrder?n.push(a):(1.5==a.bondOrder&&n.push(a),a.render(t,e)):a.render(t,e))}if(0<n.length){e.bonds_renderAsLines_3D||t.pillBuffer.bindBuffers(t);for(s=0,r=n.length;s<r;s++)n[s].render(t,e,!0)}if(0<o.length){e.bonds_renderAsLines_3D||t.sphereBuffer.bindBuffers(t);for(s=0,r=o.length;s<r;s++)o[s].render(t,e,!0)}}if(e.atoms_display){for(s=0,r=this.atoms.length;s<r;s++){(h=this.atoms[s]).bondNumber=0,h.renderAsStar=!1}for(s=0,r=this.bonds.length;s<r;s++){(a=this.bonds[s]).a1.bondNumber++,a.a2.bondNumber++}0<this.atoms.length&&(t.sphereBuffer.bindBuffers(t),t.material.setTempColors(t,e.atoms_materialAmbientColor_3D,T,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D));var l=[];for(s=0,r=this.atoms.length;s<r;s++){var h=this.atoms[s];i&&(!h.hetatm||!e.macro_showWater&&h.isWater)||(e.atoms_nonBondedAsStars_3D&&0===h.bondNumber?(h.renderAsStar=!0,l.push(h)):h.render(t,e))}if(0<l.length){t.starBuffer.bindBuffers(t);for(s=0,r=l.length;s<r;s++)l[s].render(t,e)}}if(this.chains){if(t.shader.setMatrixUniforms(t),e.proteins_displayRibbon){t.material.setTempColors(t,e.proteins_materialAmbientColor_3D,T,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D);for(var u=e.proteins_ribbonCartoonize?this.cartoons:this.ribbons,c=0,f=u.length;c<f;c++){var d=u[c];if("none"!==e.proteins_residueColor){d.front.bindBuffers(t);var m="rainbow"===e.proteins_residueColor;for(s=0,r=d.front.segments.length;s<r;s++)m&&t.material.setDiffuseColor(t,w.rainbowAt(s,r,e.macro_rainbowColors)),d.front.segments[s].render(t,e);d.back.bindBuffers(t);for(s=0,r=d.back.segments.length;s<r;s++)m&&t.material.setDiffuseColor(t,w.rainbowAt(s,r,e.macro_rainbowColors)),d.back.segments[s].render(t,e)}else d.front.render(t,e),d.back.render(t,e)}}if(e.proteins_displayPipePlank)for(c=0,f=this.pipePlanks.length;c<f;c++)this.pipePlanks[c].render(t,e);if(e.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace={nodes:[],edges:[]};for(c=0,f=this.chains.length;c<f;c++){var p=this.chains[c];if(!(2<p.length&&S[p[2].name]&&"#BEA06E"===S[p[2].name].aminoColor)&&0<p.length)for(s=0,r=p.length-2;s<r;s++){(_=p[s].cp1).chainColor=p.chainColor,this.alphaCarbonTrace.nodes.push(_),(a=new D.Bond(p[s].cp1,p[s+1].cp1)).residueName=p[s].name,a.chainColor=p.chainColor,this.alphaCarbonTrace.edges.push(a),s===p.length-3&&((_=p[s+1].cp1).chainColor=p.chainColor,this.alphaCarbonTrace.nodes.push(_))}}}if(0<this.alphaCarbonTrace.nodes.length){var g=new D.VisualSpecifications;g.atoms_display=!0,g.bonds_display=!0,g.atoms_sphereDiameter_3D=e.proteins_backboneThickness,g.bonds_cylinderDiameter_3D=e.proteins_backboneThickness,g.bonds_splitColor=!1,g.atoms_color=e.proteins_backboneColor,g.bonds_color=e.proteins_backboneColor,g.atoms_useVDWDiameters_3D=!1,t.material.setTempColors(t,e.proteins_materialAmbientColor_3D,T,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),t.material.setDiffuseColor(t,e.proteins_backboneColor);for(s=0,r=this.alphaCarbonTrace.nodes.length;s<r;s++){var _=this.alphaCarbonTrace.nodes[s];e.macro_colorByChain&&(g.atoms_color=_.chainColor),t.sphereBuffer.bindBuffers(t),_.render(t,g)}for(s=0,r=this.alphaCarbonTrace.edges.length;s<r;s++){var v,x=this.alphaCarbonTrace.edges[s],b=S[x.residueName]?S[x.residueName]:S["*"];e.macro_colorByChain?v=x.chainColor:"shapely"===e.proteins_residueColor?v=b.shapelyColor:"amino"===e.proteins_residueColor?v=b.aminoColor:"polarity"===e.proteins_residueColor?v=b.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?v=1===b.acidity?"#0000FF":-1===b.acidity?"#FF0000":b.polar?"#FFFFFF":"#773300":"rainbow"===e.proteins_residueColor&&(v=w.rainbowAt(s,r,e.macro_rainbowColors)),v&&(g.bonds_color=v),t.cylinderBuffer.bindBuffers(t),x.render(t,g)}}}if(e.nucleics_display){t.material.setTempColors(t,e.nucleics_materialAmbientColor_3D,T,e.nucleics_materialSpecularColor_3D,e.nucleics_materialShininess_3D);for(c=0,f=this.tubes.length;c<f;c++){t.shader.setMatrixUniforms(t),(d=this.tubes[c]).render(t,e)}}}if(e.atoms_display){var y=!1;for(s=0,r=this.atoms.length;s<r;s++){if((h=this.atoms[s]).isHover||h.isSelected){y=!0;break}}if(!y)for(s=0,r=this.bonds.length;s<r;s++){if((a=this.bonds[s]).isHover||a.isSelected){y=!0;break}}if(y){t.sphereBuffer.bindBuffers(t),t.blendFunc(t.SRC_ALPHA,t.ONE),t.material.setTempColors(t,e.atoms_materialAmbientColor_3D,T,"#000000",0),t.enable(t.BLEND),t.depthMask(!1),t.material.setAlpha(t,.4),t.sphereBuffer.bindBuffers(t);for(s=0,r=this.atoms.length;s<r;s++){((h=this.atoms[s]).isHover||h.isSelected)&&h.renderHighlight(t,e)}t.cylinderBuffer.bindBuffers(t);for(s=0,r=this.bonds.length;s<r;s++){((a=this.bonds[s]).isHover||a.isSelected)&&a.renderHighlight(t,e)}t.depthMask(!0),t.disable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)}}},t.renderPickFrame=function(t,e,i,s,r){this.specs&&(e=this.specs);var n=0<this.atoms.length&&this.atoms[0].hetatm!==T;if(r&&e.bonds_display){0<this.bonds.length&&(e.bonds_renderAsLines_3D?(t.lineWidth(e.bonds_width_2D),t.lineBuffer.bindBuffers(t)):t.cylinderBuffer.bindBuffers(t));for(var o=0,a=this.bonds.length;o<a;o++){var l=this.bonds[o];n&&!l.a1.hetatm||(t.material.setDiffuseColor(t,w.idx2color(i.length)),l.renderPicker(t,e),i.push(l))}}if(s&&e.atoms_display){for(o=0,a=this.atoms.length;o<a;o++){(u=this.atoms[o]).bondNumber=0,u.renderAsStar=!1}for(o=0,a=this.bonds.length;o<a;o++){(l=this.bonds[o]).a1.bondNumber++,l.a2.bondNumber++}0<this.atoms.length&&t.sphereBuffer.bindBuffers(t);var h=[];for(o=0,a=this.atoms.length;o<a;o++){var u=this.atoms[o];n&&(!u.hetatm||!e.macro_showWater&&u.isWater)||(e.atoms_nonBondedAsStars_3D&&0===u.bondNumber?(u.renderAsStar=!0,h.push(u)):(t.material.setDiffuseColor(t,w.idx2color(i.length)),u.render(t,e,!0),i.push(u)))}if(0<h.length){t.starBuffer.bindBuffers(t);for(o=0,a=h.length;o<a;o++){u=h[o];t.material.setDiffuseColor(t,w.idx2color(i.length)),u.render(t,e,!0),i.push(u)}}}},t.getCenter3D=function(){if(1===this.atoms.length)return new D.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var t=1/0,e=1/0,i=1/0,s=-1/0,r=-1/0,n=-1/0;if(this.chains)for(var o=0,a=this.chains.length;o<a;o++)for(var l=this.chains[o],h=0,u=l.length;h<u;h++){var c=l[h];t=f.min(c.cp1.x,c.cp2.x,t),e=f.min(c.cp1.y,c.cp2.y,e),i=f.min(c.cp1.z,c.cp2.z,i),s=f.max(c.cp1.x,c.cp2.x,s),r=f.max(c.cp1.y,c.cp2.y,r),n=f.max(c.cp1.z,c.cp2.z,n)}for(o=0,a=this.atoms.length;o<a;o++)t=f.min(this.atoms[o].x,t),e=f.min(this.atoms[o].y,e),i=f.min(this.atoms[o].z,i),s=f.max(this.atoms[o].x,s),r=f.max(this.atoms[o].y,r),n=f.max(this.atoms[o].z,n);return new D.Atom("C",(s+t)/2,(r+e)/2,(n+i)/2)},t.getCenter=function(){if(1===this.atoms.length)return new D.Point(this.atoms[0].x,this.atoms[0].y);for(var t=1/0,e=1/0,i=-1/0,s=-1/0,r=0,n=this.atoms.length;r<n;r++)t=f.min(this.atoms[r].x,t),e=f.min(this.atoms[r].y,e),i=f.max(this.atoms[r].x,i),s=f.max(this.atoms[r].y,s);return new D.Point((i+t)/2,(s+e)/2)},t.getDimension=function(){if(1===this.atoms.length)return new D.Point(0,0);var t=1/0,e=1/0,i=-1/0,s=-1/0;if(this.chains){for(var r=0,n=this.chains.length;r<n;r++)for(var o=this.chains[r],a=0,l=o.length;a<l;a++){var h=o[a];t=f.min(h.cp1.x,h.cp2.x,t),e=f.min(h.cp1.y,h.cp2.y,e),i=f.max(h.cp1.x,h.cp2.x,i),s=f.max(h.cp1.y,h.cp2.y,s)}t-=30,e-=30,i+=30,s+=30}for(r=0,n=this.atoms.length;r<n;r++)t=f.min(this.atoms[r].x,t),e=f.min(this.atoms[r].y,e),i=f.max(this.atoms[r].x,i),s=f.max(this.atoms[r].y,s);return new D.Point(i-t,s-e)},t.check=function(t){if(t&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){this.rings=new l.informatics.SSSRFinder(this).rings;for(var e=0,i=this.bonds.length;e<i;e++)this.bonds[e].ring=T;for(e=0,i=this.rings.length;e<i;e++)this.rings[e].setupBonds()}else for(e=0,i=this.rings.length;e<i;e++){var s=this.rings[e];s.center=s.getCenter()}for(e=0,i=this.atoms.length;e<i;e++)if(this.atoms[e].isLone=!1,"C"===this.atoms[e].label){for(var r=0,n=0,o=this.bonds.length;n<o;n++)this.bonds[n].a1!==this.atoms[e]&&this.bonds[n].a2!==this.atoms[e]||r++;0===r&&(this.atoms[e].isLone=!0)}var a=!1;for(e=0,i=this.atoms.length;e<i;e++)0!==this.atoms[e].z&&(a=!0);a&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!t},t.getAngles=function(t){for(var e=[],i=0,s=this.bonds.length;i<s;i++)this.bonds[i].contains(t)&&e.push(t.angle(this.bonds[i].getNeighbor(t)));return e.sort(function(t,e){return t-e}),e},t.getCoordinationNumber=function(t){for(var e=0,i=0,s=t.length;i<s;i++)e+=t[i].bondOrder;return e},t.getBonds=function(t){for(var e=[],i=0,s=this.bonds.length;i<s;i++)this.bonds[i].contains(t)&&e.push(this.bonds[i]);return e},t.sortAtomsByZ=function(){for(var t=1,e=this.atoms.length;t<e;t++)for(var i=t;0<i&&this.atoms[i].z<this.atoms[i-1].z;){var s=this.atoms[i];this.atoms[i]=this.atoms[i-1],this.atoms[i-1]=s,i--}},t.sortBondsByZ=function(){for(var t=1,e=this.bonds.length;t<e;t++)for(var i=t;0<i&&this.bonds[i].a1.z+this.bonds[i].a2.z<this.bonds[i-1].a1.z+this.bonds[i-1].a2.z;){var s=this.bonds[i];this.bonds[i]=this.bonds[i-1],this.bonds[i-1]=s,i--}},t.setupMetaData=function(){for(var t=this.getCenter(),e=0,i=this.atoms.length;e<i;e++){var s=this.atoms[e];s.bonds=this.getBonds(s),s.angles=this.getAngles(s),s.isHidden=2===s.bonds.length&&f.abs(f.abs(s.angles[1]-s.angles[0])-f.PI)<f.PI/30&&s.bonds[0].bondOrder===s.bonds[1].bondOrder;var r=w.angleBetweenLargest(s.angles);s.angleOfLeastInterference=r.angle%(2*f.PI),s.largestAngle=r.largest,s.coordinationNumber=this.getCoordinationNumber(s.bonds),s.bondNumber=s.bonds.length,s.molCenter=t}for(e=0,i=this.bonds.length;e<i;e++){this.bonds[e].molCenter=t}},t.scaleToAverageBondLength=function(t){var e=this.getAverageBondLength();if(0!==e)for(var i=t/e,s=0,r=this.atoms.length;s<r;s++)this.atoms[s].x*=i,this.atoms[s].y*=i},t.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var t=0,e=0,i=this.bonds.length;e<i;e++)t+=this.bonds[e].getLength();return t/=this.bonds.length},t.getBounds=function(){for(var t=new w.Bounds,e=0,i=this.atoms.length;e<i;e++)t.expand(this.atoms[e].getBounds());if(this.chains){for(e=0,i=this.chains.length;e<i;e++)for(var s=this.chains[e],r=0,n=s.length;r<n;r++){var o=s[r];t.expand(o.cp1.x,o.cp1.y),t.expand(o.cp2.x,o.cp2.y)}t.minX-=30,t.minY-=30,t.maxX+=30,t.maxY+=30}return t},t.getBounds3D=function(){for(var t=new w.Bounds,e=0,i=this.atoms.length;e<i;e++)t.expand(this.atoms[e].getBounds3D());if(this.chains)for(e=0,i=this.chains.length;e<i;e++)for(var s=this.chains[e],r=0,n=s.length;r<n;r++){var o=s[r];t.expand3D(o.cp1.x,o.cp1.y,o.cp1.z),t.expand3D(o.cp2.x,o.cp2.y,o.cp2.z)}return t},t.getAtomGroup=function(t){for(var e=!1,i=0,s=this.atoms.length;i<s;i++)this.atoms[i].visited=!1;for(i=0,s=this.bonds.length;i<s;i++){var r=this.bonds[i];!e&&r.contains(t)&&r.ring!==T&&(e=!0)}if(!e)return T;var n=[t];t.visited=!0;var o=new D.Queue;for(o.enqueue(t);!o.isEmpty();){var a=o.dequeue();for(i=0,s=this.bonds.length;i<s;i++){if((r=this.bonds[i]).contains(a)&&e===(r.ring!==T)){var l=r.getNeighbor(a);l.visited||(l.visited=!0,n.push(l),o.enqueue(l))}}}return n},t.getBondGroup=function(t){for(var e=t.ring!==T,i=!1,s=0,r=this.bonds.length;s<r;s++){var n=this.bonds[s];n===t&&(i=!0),n.visited=!1}if(!i)return T;var o=[t];t.visited=!0;var a=new D.Queue;for(a.enqueue(t);!a.isEmpty();){var l=a.dequeue();for(s=0,r=this.bonds.length;s<r;s++){var h=this.bonds[s];h.visited||h.a1!==l.a1&&h.a2!==l.a1&&h.a1!==l.a2&&h.a2!==l.a2||h.ring!==T!=e||(h.visited=!0,o.push(h),a.enqueue(h))}}return o}}(Te,Te.math,Te.structures,Te.RESIDUE,Math),function(A,E,F,P,t){var R,r=-1;A.Residue=function(t){this.resSeq=t};var e=A.Residue.prototype;e.setup=function(t,e){this.horizontalResolution=e;var i=[t.x-this.cp1.x,t.y-this.cp1.y,t.z-this.cp1.z],s=[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],r=P.cross(i,s,[]);this.D=P.cross(r,i,[]),P.normalize(r),P.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[];var n=[(t.x+this.cp1.x)/2,(t.y+this.cp1.y)/2,(t.z+this.cp1.z)/2];this.helix&&(P.scale(r,1.5),P.add(n,r)),this.guidePointsSmall[0]=new A.Atom("",n[0]-this.D[0]/2,n[1]-this.D[1]/2,n[2]-this.D[2]/2);for(var o=1;o<e;o++)this.guidePointsSmall[o]=new A.Atom("",this.guidePointsSmall[0].x+this.D[0]*o/e,this.guidePointsSmall[0].y+this.D[1]*o/e,this.guidePointsSmall[0].z+this.D[2]*o/e);P.scale(this.D,4),this.guidePointsLarge[0]=new A.Atom("",n[0]-this.D[0]/2,n[1]-this.D[1]/2,n[2]-this.D[2]/2);for(o=1;o<e;o++)this.guidePointsLarge[o]=new A.Atom("",this.guidePointsLarge[0].x+this.D[0]*o/e,this.guidePointsLarge[0].y+this.D[1]*o/e,this.guidePointsLarge[0].z+this.D[2]*o/e)},e.getGuidePointSet=function(t){return 0===t?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1===t?this.guidePointsSmall:2===t?this.guidePointsLarge:void 0},e.computeLineSegments=function(t,e,i,s,r){this.setVerticalResolution(r),this.split=i.helix!==this.helix||i.sheet!==this.sheet,this.lineSegments=this.innerCompute(0,t,e,i,!1,r),s&&(this.lineSegmentsCartoon=this.innerCompute(this.helix||this.sheet?2:1,t,e,i,!0,r))},e.innerCompute=function(t,e,i,s,r,n){for(var o=[],a=this.getGuidePointSet(t),l=e.getGuidePointSet(t),h=i.getGuidePointSet(t),u=s.getGuidePointSet(t),c=0,f=a.length;c<f;c++){for(var d=[l[c].x,l[c].y,l[c].z,1,h[c].x,h[c].y,h[c].z,1,a[c].x,a[c].y,a[c].z,1,u[c].x,u[c].y,u[c].z,1],m=F.multiply(d,R,[]),p=[],g=0;g<n;g++){for(var _=3;0<_;_--)for(var v=0;v<4;v++)m[4*_+v]+=m[4*(_-1)+v];p[g]=new A.Atom("",m[12]/m[15],m[13]/m[15],m[14]/m[15])}o[c]=p}if(r&&this.arrow){_=0;for(var x=n;_<x;_++)for(var b=1.5-1.3*_/n,y=E.floor(this.horizontalResolution/2),w=o[y],D=(v=0,o.length);v<D;v++)if(v!==y){var S=w[_],T=o[v][_],C=[T.x-S.x,T.y-S.y,T.z-S.z];P.scale(C,b),T.x=S.x+C[0],T.y=S.y+C[1],T.z=S.z+C[2]}}return o},e.setVerticalResolution=function(t){t!==r&&function(t){var e=t*t,i=t*t*t,s=[6/i,0,0,0,6/i,2/e,0,0,1/i,1/e,1/t,0,0,0,0,1];R=F.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],s,[]),r=t}(t)}}(Te.structures,Math,Te.lib.mat4,Te.lib.vec3),function(E,v,u,t,F,x){v.Spectrum=function(){this.data=[],this.metadata=[],this.dataDisplay=[],this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}};var e=v.Spectrum.prototype;e.title=x,e.xUnit=x,e.yUnit=x,e.continuous=!0,e.integrationSensitivity=.01,e.draw=function(t,e,i,s){this.specs&&(e=this.specs);var r=5,n=0,o=0;t.fillStyle=e.text_color,t.textAlign="center",t.textBaseline="alphabetic",t.font=E.getFontString(e.text_font_size,e.text_font_families),this.xUnit&&(o+=e.text_font_size,t.fillText(this.xUnit,i/2,s-2)),this.yUnit&&e.plots_showYAxis&&(n+=e.text_font_size,t.save(),t.translate(e.text_font_size,s/2),t.rotate(-F.PI/2),t.fillText(this.yUnit,0,0),t.restore()),this.title&&(r+=e.text_font_size,t.fillText(this.title,i/2,e.text_font_size)),t.lineCap="square",o+=5+e.text_font_size,e.plots_showYAxis&&(n+=5+t.measureText("1000").width),e.plots_showGrid&&(t.strokeStyle=e.plots_gridColor,t.lineWidth=e.plots_gridLineWidth,t.strokeRect(n,r,i-n,s-o-r)),t.textAlign="center",t.textBaseline="top";for(var a=this.maxX-this.minX,l=a/100,h=.001;h<l||25<a/h;)h*=10;for(var u=0,c=e.plots_flipXAxis?i:0,f=F.round(this.minX/h)*h;f<=this.maxX;f+=h/2){var d=this.getTransformedX(f,e,i,n);if(n<d)if(t.strokeStyle="black",t.lineWidth=1,u%2==0){t.beginPath(),t.moveTo(d,s-o),t.lineTo(d,s-o+2),t.stroke();for(var m=f.toFixed(5);"0"===m.charAt(m.length-1);)m=m.substring(0,m.length-1);"."===m.charAt(m.length-1)&&(m=m.substring(0,m.length-1));var p=t.measureText(m).width;e.plots_flipXAxis&&(p*=-1);var g=d-p/2;(e.plots_flipXAxis?g<c:c<g)&&(t.fillText(m,d,s-o+2),c=d+p/2),e.plots_showGrid&&(t.strokeStyle=e.plots_gridColor,t.lineWidth=e.plots_gridLineWidth,t.beginPath(),t.moveTo(d,s-o),t.lineTo(d,r),t.stroke())}else t.beginPath(),t.moveTo(d,s-o),t.lineTo(d,s-o+2),t.stroke();u++}if(e.plots_showYAxis||e.plots_showGrid){var _=1/e.scale;t.textAlign="right",t.textBaseline="middle";for(f=0;f<=10;f++){var v=_/10*f,x=r+(s-o-r)*(1-v*e.scale);if(e.plots_showGrid&&(t.strokeStyle=e.plots_gridColor,t.lineWidth=e.plots_gridLineWidth,t.beginPath(),t.moveTo(n,x),t.lineTo(i,x),t.stroke()),e.plots_showYAxis){t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(n,x),t.lineTo(n-3,x),t.stroke();var b=100*v,y=F.max(0,3-F.floor(b).toString().length);m=b.toFixed(y);if(0<y)for(;"0"===m.charAt(m.length-1);)m=m.substring(0,m.length-1);"."===m.charAt(m.length-1)&&(m=m.substring(0,m.length-1)),t.fillText(m,n-3,x)}}}if(t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(i,s-o),t.lineTo(n,s-o),e.plots_showYAxis&&t.lineTo(n,r),t.stroke(),0<this.dataDisplay.length){t.textAlign="left",t.textBaseline="top";for(var w=0,D=(f=0,this.dataDisplay.length);f<D;f++)if(this.dataDisplay[f].value)t.fillText([this.dataDisplay[f].display,": ",this.dataDisplay[f].value].join(""),n+10,r+10+w*(e.text_font_size+5)),w++;else if(this.dataDisplay[f].tag)for(var S=0,T=this.metadata.length;S<T;S++)if(E.stringStartsWith(this.metadata[S],this.dataDisplay[f].tag)){var C=this.metadata[S];if(this.dataDisplay[f].display){var A=this.metadata[S].indexOf("=");C=[this.dataDisplay[f].display,": ",-1<A?this.metadata[S].substring(A+2):this.metadata[S]].join("")}t.fillText(C,n+10,r+10+w*(e.text_font_size+5)),w++;break}}this.drawPlot(t,e,i,s,r,n,o),this.memory.offsetTop=r,this.memory.offsetLeft=n,this.memory.offsetBottom=o,this.memory.flipXAxis=e.plots_flipXAxis,this.memory.scale=e.scale,this.memory.width=i,this.memory.height=s},e.drawPlot=function(t,e,i,s,r,n,o){this.specs&&(e=this.specs),t.strokeStyle=e.plots_color,t.lineWidth=e.plots_width;var a=[];if(t.save(),t.rect(n,r,i-n,s-o-r),t.clip(),t.beginPath(),this.continuous)for(var l=!1,h=0,u=!1,c=0,f=this.data.length;c<f;c++){var d,m=this.getTransformedX(this.data[c].x,e,i,n);if(c<f&&!l&&this.data[c+1]&&(d=this.getTransformedX(this.data[c+1].x,e,i,n)),n<=m&&m<i||d!==x&&n<=d&&d<i){var p=this.getTransformedY(this.data[c].y,e,s,o,r);if(e.plots_showIntegration&&F.abs(this.data[c].y)>this.integrationSensitivity&&a.push(new v.Point(this.data[c].x,this.data[c].y)),l||(t.moveTo(m,p),l=!0),t.lineTo(m,p),++h%1e3==0&&(t.stroke(),t.beginPath(),t.moveTo(m,p)),u)break}else l&&(u=!0)}else for(c=0,f=this.data.length;c<f;c++){n<=(m=this.getTransformedX(this.data[c].x,e,i,n))&&m<i&&(t.moveTo(m,s-o),t.lineTo(m,this.getTransformedY(this.data[c].y,e,s,o,r)))}if(t.stroke(),e.plots_showIntegration&&1<a.length){t.strokeStyle=e.plots_integrationColor,t.lineWidth=e.plots_integrationLineWidth,t.beginPath();var g,_=a[1].x>a[0].x;if(this.flipXAxis&&!_||!this.flipXAxis&&_){for(c=a.length-2;0<=c;c--)a[c].y=a[c].y+a[c+1].y;g=a[0].y}else{for(c=1,f=a.length;c<f;c++)a[c].y=a[c].y+a[c-1].y;g=a[a.length-1].y}for(c=0,f=a.length;c<f;c++){m=this.getTransformedX(a[c].x,e,i,n),p=this.getTransformedY(a[c].y/e.scale/g,e,s,o,r);0===c?t.moveTo(m,p):t.lineTo(m,p)}t.stroke()}t.restore()},e.getTransformedY=function(t,e,i,s,r){return r+(i-s-r)*(1-t*e.scale)},e.getInverseTransformedY=function(t){return(1-(t-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100},e.getTransformedX=function(t,e,i,s){var r=s+(t-this.minX)/(this.maxX-this.minX)*(i-s);return e.plots_flipXAxis&&(r=i+s-r),r},e.getInverseTransformedX=function(t){return this.memory.flipXAxis&&(t=this.memory.width+this.memory.offsetLeft-t),(t-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},e.setup=function(){for(var t=Number.MAX_VALUE,e=Number.MIN_VALUE,i=Number.MIN_VALUE,s=0,r=this.data.length;s<r;s++)t=F.min(t,this.data[s].x),e=F.max(e,this.data[s].x),i=F.max(i,this.data[s].y);this.continuous?(this.minX=t,this.maxX=e):(this.minX=t-1,this.maxX=e+1);for(s=0,r=this.data.length;s<r;s++)this.data[s].y/=i},e.zoom=function(t,e,i,s){var r=this.getInverseTransformedX(t),n=this.getInverseTransformedX(e);if(this.minX=F.min(r,n),this.maxX=F.max(r,n),s){for(var o=Number.MIN_VALUE,a=0,l=this.data.length;a<l;a++)u.isBetween(this.data[a].x,this.minX,this.maxX)&&(o=F.max(o,this.data[a].y));return 1/o}},e.translate=function(t,e){var i=t/(e-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=i,this.maxX+=i},e.alertMetadata=function(){alert(this.metadata.join("\n"))},e.getInternalCoordinates=function(t,e){return new Te.structures.Point(this.getInverseTransformedX(t),this.getInverseTransformedY(e))},e.getClosestPlotInternalCoordinates=function(t){var e=this.getInverseTransformedX(t-1),i=this.getInverseTransformedX(t+1);if(i<e){var s=e;e=i,i=s}for(var r=-1,n=-1/0,o=!1,a=0,l=this.data.length;a<l;a++){var h=this.data[a];if(u.isBetween(h.x,e,i))h.y>n&&(o=!0,n=h.y,r=a);else if(o)break}if(-1===r)return x;h=this.data[r];return new Te.structures.Point(h.x,100*h.y)},e.getClosestPeakInternalCoordinates=function(t){for(var e=this.getInverseTransformedX(t),i=0,s=1/0,r=0,n=this.data.length;r<n;r++){var o=F.abs(this.data[r].x-e);if(!(o<=s))break;s=o,i=r}var a=i,l=i,h=this.data[i].y,u=this.data[i].y;for(r=i+1,n=this.data.length;r<n&&this.data[r].y+.05>u;r++)u=this.data[r].y,l=r;for(r=i-1;0<=r&&this.data[r].y+.05>h;r--)h=this.data[r].y,a=r;var c=this.data[l-i<a-i?l:a];return new Te.structures.Point(c.x,100*c.y)}}(Te.extensions,Te.structures,Te.math,Te.lib.jQuery,Math),function(n,t,r,e){t._Shape=function(){};var i=t._Shape.prototype;i.drawDecorations=function(t,e){if(this.isHover)for(var i=this.getPoints(),s=0,r=i.length;s<r;s++){var n=i[s];this.drawAnchor(t,e,n,n===this.hoverPoint)}},i.getBounds=function(){for(var t=new n.Bounds,e=this.getPoints(),i=0,s=e.length;i<s;i++){var r=e[i];t.expand(r.x,r.y)}return t},i.drawAnchor=function(t,e,i,s){t.save(),t.translate(i.x,i.y),t.rotate(r.PI/4),t.scale(1/e.scale,1/e.scale);t.beginPath(),t.moveTo(-4,-4),t.lineTo(4,-4),t.lineTo(4,4),t.lineTo(-4,4),t.closePath(),t.fillStyle=s?e.colorHover:"white",t.fill(),t.beginPath(),t.moveTo(-4,-2),t.lineTo(-4,-4),t.lineTo(-2,-4),t.moveTo(2,-4),t.lineTo(4,-4),t.lineTo(4,-2),t.moveTo(4,2),t.lineTo(4,4),t.lineTo(2,4),t.moveTo(-2,4),t.lineTo(-4,4),t.lineTo(-4,2),t.moveTo(-4,-2),t.strokeStyle="rgba(0,0,0,.2)",t.lineWidth=5,t.stroke(),t.strokeStyle="blue",t.lineWidth=1,t.stroke(),t.restore()}}(Te.math,Te.structures.d2,Math),function(n,t,e,i,o,s){i.AtomMapping=function(t,e){this.o1=t,this.o2=e,this.label="0",this.error=!1};var r=i.AtomMapping.prototype=new i._Shape;r.drawDecorations=function(t,e){(this.isHover||this.isSelected)&&(t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1,t.beginPath(),t.moveTo(this.o1.x,this.o1.y),t.lineTo(this.o2.x,this.o2.y),t.setLineDash([2]),t.stroke(),t.setLineDash([]))},r.draw=function(t,e){if(this.o1&&this.o2){this.x1=this.o1.x+14*o.cos(this.o1.angleOfLeastInterference),this.y1=this.o1.y-14*o.sin(this.o1.angleOfLeastInterference),this.x2=this.o2.x+14*o.cos(this.o2.angleOfLeastInterference),this.y2=this.o2.y-14*o.sin(this.o2.angleOfLeastInterference),t.font=n.getFontString(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic);var i=this.label,s=t.measureText(i).width;this.isLassoed&&(t.fillStyle=e.colorHover,t.fillRect(this.x1-s/2-3,this.y1-e.text_font_size/2-3,s+6,e.text_font_size+6),t.fillRect(this.x2-s/2-3,this.y2-e.text_font_size/2-3,s+6,e.text_font_size+6));var r=this.error?e.colorError:e.shapes_color;(this.isHover||this.isSelected)&&(r=this.isHover?e.colorHover:e.colorSelect),t.fillStyle=r,t.fillRect(this.x1-s/2-1,this.y1-e.text_font_size/2-1,s+2,e.text_font_size+2),t.fillRect(this.x2-s/2-1,this.y2-e.text_font_size/2-1,s+2,e.text_font_size+2),t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.backgroundColor,t.fillText(i,this.x1,this.y1),t.fillText(i,this.x2,this.y2)}},r.getPoints=function(){return[new e.Point(this.x1,this.y1),new e.Point(this.x2,this.y2)]},r.isOver=function(t,e){return!!this.x1&&(t.distance({x:this.x1,y:this.y1})<e||t.distance({x:this.x2,y:this.y2})<e)}}(Te.extensions,Te.math,Te.structures,Te.structures.d2,Math),function(u,i,s,t,c,e){t.Bracket=function(t,e){this.p1=t||new s.Point,this.p2=e||new s.Point};var r=t.Bracket.prototype=new t._Shape;r.charge=0,r.mult=0,r.repeat=0,r.draw=function(t,e){var i=c.min(this.p1.x,this.p2.x),s=c.max(this.p1.x,this.p2.x),r=c.min(this.p1.y,this.p2.y),n=c.max(this.p1.y,this.p2.y),o=n-r,a=o/10;if(t.beginPath(),t.moveTo(i+a,r),t.lineTo(i,r),t.lineTo(i,n),t.lineTo(i+a,n),t.moveTo(s-a,n),t.lineTo(s,n),t.lineTo(s,r),t.lineTo(s-a,r),this.isLassoed){var l=t.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);l.addColorStop(0,"rgba(212, 99, 0, 0)"),l.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),l.addColorStop(1,"rgba(212, 99, 0, 0)"),t.lineWidth=e.shapes_lineWidth+5,t.strokeStyle=l,t.lineJoin="miter",t.lineCap="square",t.stroke()}(t.strokeStyle=e.shapes_color,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt",t.stroke(),0!==this.charge)&&(t.fillStyle=e.text_color,t.textAlign="left",t.textBaseline="alphabetic",t.font=u.getFontString(e.text_font_size,e.text_font_families),"1"===(h=this.charge.toFixed(0))?h="+":"-1"===h?h="":u.stringStartsWith(h,"-")?h=h.substring(1)+"":h+="+",t.fillText(h,s+5,r+5));if(0!==this.mult&&(t.fillStyle=e.text_color,t.textAlign="right",t.textBaseline="middle",t.font=u.getFontString(e.text_font_size,e.text_font_families),t.fillText(this.mult.toFixed(0),i-5,r+o/2)),0!==this.repeat){t.fillStyle=e.text_color,t.textAlign="left",t.textBaseline="top",t.font=u.getFontString(e.text_font_size,e.text_font_families);var h=this.repeat.toFixed(0);t.fillText(h,s+5,n-5)}},r.getPoints=function(){return[this.p1,this.p2]},r.isOver=function(t,e){return i.isBetween(t.x,this.p1.x,this.p2.x)&&i.isBetween(t.y,this.p1.y,this.p2.y)}}(Te.extensions,Te.math,Te.structures,Te.structures.d2,Math),function(n,t,e,S,i,T,s){i.DynamicBracket=function(t,e){this.b1=t,this.b2=e,this.n1=1,this.n2=4,this.contents=[],this.ps=[]};var r=i.DynamicBracket.prototype=new i._Shape;r.drawDecorations=function(t,e){if(this.isHover)for(var i=0,s=this.contents.length;i<s;i++){var r=this.contents[i],n=t.createRadialGradient(r.x-1,r.y-1,0,r.x,r.y,7);n.addColorStop(0,"rgba(212, 99, 0, 0)"),n.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),t.fillStyle=n,t.beginPath(),t.arc(r.x,r.y,5,0,2*T.PI,!1),t.fill()}};function o(t,e,i,s,r){var n=[],o=0<r.length?-1===r.indexOf(i.a1)?i.a2:i.a1:i.a1.distance(s.getCenter())<i.a2.distance(s.getCenter())?i.a1:i.a2,a=o.angle(i.getNeighbor(o)),l=a+T.PI/2,h=i.getLength()/(1<r.length?4:2),u=o.x+h*T.cos(a),c=o.y-h*T.sin(a),f=10*T.cos(l),d=10*T.sin(l),m=u+f,p=c-d,g=u-f,_=c+d,v=-4*T.cos(a),x=-4*T.sin(a),b=m+v,y=p-x,w=g+v,D=_-x;return t.beginPath(),t.moveTo(b,y),t.lineTo(m,p),t.lineTo(g,_),t.lineTo(w,D),t.stroke(),n.push(new S.Point(m,p)),n.push(new S.Point(g,_)),n}r.draw=function(t,e){if(this.b1&&this.b2){var i=this.error?e.colorError:e.shapes_color;(this.isHover||this.isSelected)&&(i=this.isHover?e.colorHover:e.colorSelect),t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt";var s=o(t,0,this.b1,this.b2,this.contents),r=o(t,0,this.b2,this.b1,this.contents);this.ps=s.concat(r),this.b1.getCenter().x>this.b2.getCenter().x?this.ps[0].x>this.ps[1].x+5?this.textPos=this.ps[0]:this.textPos=this.ps[1]:this.ps[2].x>this.ps[3].x+5?this.textPos=this.ps[2]:this.textPos=this.ps[3],!this.error&&0<this.contents.length&&(t.font=n.getFontString(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic),t.fillStyle=this.isHover?e.colorHover:e.text_color,t.textAlign="left",t.textBaseline="bottom",t.fillText(this.n1+"-"+this.n2,this.textPos.x+2,this.textPos.y+2))}},r.getPoints=function(){return this.ps},r.isOver=function(t,e){return!1},r.setContents=function(t){this.contents=[];var e=t.getMoleculeByAtom(this.b1.a1),i=t.getMoleculeByAtom(this.b2.a1);if(e&&e===i){for(var s=0,r=0,n=0,o=e.rings.length;n<o;n++)for(var a=e.rings[n],l=0,h=a.bonds.length;l<h;l++){var u=a.bonds[l];u===this.b1?s++:u===this.b2&&r++}var c=1===s&&1===r&&this.b1.ring===this.b2.ring;if(this.contents.flippable=c,void 0===this.b1.ring&&void 0===this.b2.ring||c)for(n=0,o=e.atoms.length;n<o;n++){var f=!1,d=!1,m=!1;for(l=0,h=e.bonds.length;l<h;l++)e.bonds[l].visited=!1;var p=new S.Queue,g=e.atoms[n];for(p.enqueue(g);!(p.isEmpty()||f&&d);){var _=p.dequeue();c&&(!this.flip&&_===this.b1.a1||this.flip&&_===this.b1.a2)&&(m=!0);for(l=0,h=e.bonds.length;l<h;l++){var v=e.bonds[l];v.a1!==_&&v.a2!==_||(v===this.b1?f=!0:v===this.b2?d=!0:v.visited||(v.visited=!0,p.enqueue(v.getNeighbor(_))))}}f&&d&&(!c||m)&&this.contents.push(g)}}}}(Te.extensions,Te.math,Te.lib.jsBezier,Te.structures,Te.structures.d2,Math),function(C,s,i,A,E,t){A.Line=function(t,e){this.p1=t||new i.Point,this.p2=e||new i.Point},A.Line.ARROW_SYNTHETIC="synthetic",A.Line.ARROW_RETROSYNTHETIC="retrosynthetic",A.Line.ARROW_RESONANCE="resonance",A.Line.ARROW_EQUILIBRIUM="equilibrium";var e=A.Line.prototype=new A._Shape;e.arrowType=void 0,e.topText=void 0,e.bottomText=void 0,e.draw=function(t,e){if(this.isLassoed){var i=t.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);i.addColorStop(0,"rgba(212, 99, 0, 0)"),i.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),i.addColorStop(1,"rgba(212, 99, 0, 0)");var s=2.5,r=this.p1.angle(this.p2)+E.PI/2,n=E.cos(r),o=E.sin(r),a=this.p1.x-n*s,l=this.p1.y+o*s,h=this.p1.x+n*s,u=this.p1.y-o*s,c=this.p2.x+n*s,f=this.p2.y-o*s,d=this.p2.x-n*s,m=this.p2.y+o*s;t.fillStyle=i,t.beginPath(),t.moveTo(a,l),t.lineTo(h,u),t.lineTo(c,f),t.lineTo(d,m),t.closePath(),t.fill()}if(t.strokeStyle=e.shapes_color,t.fillStyle=e.shapes_color,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt",this.p1.x!==this.p2.x||this.p1.y!==this.p2.y){if(this.arrowType===A.Line.ARROW_RETROSYNTHETIC){var p=2*E.sqrt(2),g=(s=e.shapes_arrowLength_2D/p,r=(T=this.p1.angle(this.p2))+E.PI/2,e.shapes_arrowLength_2D/p),_=E.cos(T),v=E.sin(T),x=(n=E.cos(r),o=E.sin(r),a=this.p1.x-n*s,l=this.p1.y+o*s,h=this.p1.x+n*s,u=this.p1.y-o*s,c=this.p2.x+n*s-_*g,f=this.p2.y-o*s+v*g,d=this.p2.x-n*s-_*g,m=this.p2.y+o*s+v*g,this.p2.x+n*s*2-_*g*2),b=this.p2.y-o*s*2+v*g*2,y=this.p2.x-n*s*2-_*g*2,w=this.p2.y+o*s*2+v*g*2;t.beginPath(),t.moveTo(h,u),t.lineTo(c,f),t.moveTo(x,b),t.lineTo(this.p2.x,this.p2.y),t.lineTo(y,w),t.moveTo(d,m),t.lineTo(a,l),t.stroke()}else if(this.arrowType===A.Line.ARROW_EQUILIBRIUM){p=2*E.sqrt(2),s=e.shapes_arrowLength_2D/p/2,r=(T=this.p1.angle(this.p2))+E.PI/2,g=2*e.shapes_arrowLength_2D/E.sqrt(3),_=E.cos(T),v=E.sin(T),n=E.cos(r),o=E.sin(r),a=this.p1.x-n*s,l=this.p1.y+o*s,h=this.p1.x+n*s,u=this.p1.y-o*s,c=this.p2.x+n*s,f=this.p2.y-o*s,d=this.p2.x-n*s,m=this.p2.y+o*s;t.beginPath(),t.moveTo(h,u),t.lineTo(c,f),t.moveTo(d,m),t.lineTo(a,l),t.stroke();var D=c-_*g*.8,S=f+v*g*.8;x=c+n*e.shapes_arrowLength_2D/3-_*g,b=f-o*e.shapes_arrowLength_2D/3+v*g;t.beginPath(),t.moveTo(c,f),t.lineTo(x,b),t.lineTo(D,S),t.closePath(),t.fill(),t.stroke(),D=a+_*g*.8,S=l-v*g*.8,x=a-n*e.shapes_arrowLength_2D/3+_*g,b=l+o*e.shapes_arrowLength_2D/3-v*g,t.beginPath(),t.moveTo(a,l),t.lineTo(x,b),t.lineTo(D,S),t.closePath(),t.fill(),t.stroke()}else if(this.arrowType===A.Line.ARROW_SYNTHETIC){r=(T=this.p1.angle(this.p2))+E.PI/2,g=2*e.shapes_arrowLength_2D/E.sqrt(3),_=E.cos(T),v=E.sin(T),n=E.cos(r),o=E.sin(r);t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(this.p2.x-_*g/2,this.p2.y+v*g/2),t.stroke();D=this.p2.x-_*g*.8,S=this.p2.y+v*g*.8,x=this.p2.x+n*e.shapes_arrowLength_2D/3-_*g,b=this.p2.y-o*e.shapes_arrowLength_2D/3+v*g,y=this.p2.x-n*e.shapes_arrowLength_2D/3-_*g,w=this.p2.y+o*e.shapes_arrowLength_2D/3+v*g;t.beginPath(),t.moveTo(this.p2.x,this.p2.y),t.lineTo(y,w),t.lineTo(D,S),t.lineTo(x,b),t.closePath(),t.fill(),t.stroke()}else if(this.arrowType===A.Line.ARROW_RESONANCE){var T;r=(T=this.p1.angle(this.p2))+E.PI/2,g=2*e.shapes_arrowLength_2D/E.sqrt(3),_=E.cos(T),v=E.sin(T),n=E.cos(r),o=E.sin(r);t.beginPath(),t.moveTo(this.p1.x+_*g/2,this.p1.y-v*g/2),t.lineTo(this.p2.x-_*g/2,this.p2.y+v*g/2),t.stroke();D=this.p2.x-_*g*.8,S=this.p2.y+v*g*.8,x=this.p2.x+n*e.shapes_arrowLength_2D/3-_*g,b=this.p2.y-o*e.shapes_arrowLength_2D/3+v*g,y=this.p2.x-n*e.shapes_arrowLength_2D/3-_*g,w=this.p2.y+o*e.shapes_arrowLength_2D/3+v*g;t.beginPath(),t.moveTo(this.p2.x,this.p2.y),t.lineTo(y,w),t.lineTo(D,S),t.lineTo(x,b),t.closePath(),t.fill(),t.stroke(),D=this.p1.x+_*g*.8,S=this.p1.y-v*g*.8,x=this.p1.x-n*e.shapes_arrowLength_2D/3+_*g,b=this.p1.y+o*e.shapes_arrowLength_2D/3-v*g,y=this.p1.x+n*e.shapes_arrowLength_2D/3+_*g,w=this.p1.y-o*e.shapes_arrowLength_2D/3-v*g,t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(y,w),t.lineTo(D,S),t.lineTo(x,b),t.closePath(),t.fill(),t.stroke()}else t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(this.p2.x,this.p2.y),t.stroke();(this.topText||this.bottomText)&&(t.font=C.getFontString(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic),t.fillStyle=e.text_color),this.topText&&(t.textAlign="center",t.textBaseline="bottom",t.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5)),this.bottomText&&(t.textAlign="center",t.textBaseline="top",t.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(t,e){var i=s.distanceFromPointToLineInclusive(t,this.p1,this.p2);return-1!==i&&i<e}}(Te.extensions,Te.math,Te.structures,Te.structures.d2,Math),function(F,r,P,t,R,e){function B(t){var e=[];if(t instanceof P.Atom){if(0===t.bondNumber)e.push(R.PI);else if(t.angles){if(1===t.angles.length)e.push(t.angles[0]+R.PI);else{for(var i=1,s=t.angles.length;i<s;i++)e.push(t.angles[i-1]+(t.angles[i]-t.angles[i-1])/2);var r=t.angles[0]+2*R.PI,n=t.angles[t.angles.length-1];e.push(n+(r-n)/2)}if(t.largestAngle>R.PI&&(e=[t.angleOfLeastInterference]),t.bonds)for(i=0,s=t.bonds.length;i<s;i++){var o=t.bonds[i];if(2===o.bondOrder){var a=o.getNeighbor(t);if("O"===a.label){e=[a.angle(t)];break}}}}}else{var l=t.a1.angle(t.a2);e.push(l+R.PI/2),e.push(l+3*R.PI/2)}for(i=0,s=e.length;i<s;i++){for(;e[i]>2*R.PI;)e[i]-=2*R.PI;for(;e[i]<0;)e[i]+=2*R.PI}return e}function C(t,e){var i=3;return t instanceof P.Atom?(t.isLabelVisible(e)&&(i=8),0===t.charge&&0===t.numRadical&&0===t.numLonePair||(i=13)):t instanceof P.Point?i=0:1<t.bondOrder&&(i=5),i}function M(t,e,i,s,r,n,o,a,l,h){var u=n.angle(r),c=o.angle(a),f=R.cos(u),d=R.sin(u),m=C(i,e);r.x-=f*m,r.y+=d*m;var p=c+R.PI/2,g=2*e.shapes_arrowLength_2D/R.sqrt(3),_=(f=R.cos(c),d=R.sin(c),R.cos(p)),v=R.sin(p);a.x-=5*f,a.y+=5*d;var x=new P.Point(a.x,a.y);m=C(s,e)/3,x.x-=f*m,x.y+=d*m,a.x-=f*(.8*g+m),a.y+=d*(.8*g+m);var b=x.x-f*g*.8,y=x.y+d*g*.8,w=new P.Point(x.x+_*e.shapes_arrowLength_2D/3-f*g,x.y-v*e.shapes_arrowLength_2D/3+d*g),D=new P.Point(x.x-_*e.shapes_arrowLength_2D/3-f*g,x.y+v*e.shapes_arrowLength_2D/3+d*g),S=!0,T=!0;1===l&&(w.distance(n)>D.distance(n)?T=!1:S=!1),t.beginPath(),t.moveTo(x.x,x.y),T&&t.lineTo(D.x,D.y),t.lineTo(b,y),S&&t.lineTo(w.x,w.y),t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.moveTo(r.x,r.y),t.bezierCurveTo(n.x,n.y,o.x,o.y,a.x,a.y),t.stroke(),h.push([r,n,o,a])}t.Pusher=function(t,e,i){this.o1=t,this.o2=e,this.numElectron=i||1};var i=t.Pusher.prototype=new t._Shape;i.drawDecorations=function(t,e){if(this.isHover)for(var i=[this.o1 instanceof P.Atom?new P.Point(this.o1.x,this.o1.y):this.o1.getCenter(),this.o2 instanceof P.Atom?new P.Point(this.o2.x,this.o2.y):this.o2.getCenter()],s=0,r=i.length;s<r;s++){var n=i[s];this.drawAnchor(t,e,n,n===this.hoverPoint)}},i.draw=function(t,e){if(this.o1&&this.o2){t.strokeStyle=e.shapes_color,t.fillStyle=e.shapes_color,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt";for(var i,s,r=this.o1 instanceof P.Atom?new P.Point(this.o1.x,this.o1.y):this.o1.getCenter(),n=this.o2 instanceof P.Atom?new P.Point(this.o2.x,this.o2.y):this.o2.getCenter(),o=B(this.o1),a=B(this.o2),l=1/0,h=0,u=o.length;h<u;h++)for(var c=0,f=a.length;c<f;c++){var d=new P.Point(r.x+35*R.cos(o[h]),r.y-35*R.sin(o[h])),m=new P.Point(n.x+35*R.cos(a[c]),n.y-35*R.sin(a[c])),p=d.distance(m);p<l&&(l=p,i=d,s=m)}if(this.caches=[],-1===this.numElectron){var g=r.distance(n)/2,_=r.angle(n),v=_+R.PI/2,x=R.cos(_),b=R.sin(_),y=new P.Point(r.x+(g-1)*x,r.y-(g-1)*b),w=new P.Point(y.x+35*R.cos(v+R.PI/6),y.y-35*R.sin(v+R.PI/6)),D=new P.Point(r.x+(1+g)*x,r.y-(1+g)*b),S=new P.Point(D.x+35*R.cos(v-R.PI/6),D.y-35*R.sin(v-R.PI/6));M(t,e,this.o1,y,r,i,w,y,1,this.caches),M(t,e,this.o2,D,n,s,S,D,1,this.caches)}else{if(F.intersectLines(r.x,r.y,i.x,i.y,n.x,n.y,s.x,s.y)){var T=i;i=s,s=T}var C=i.angle(r),A=s.angle(n),E=R.max(C,A)-R.min(C,A);R.abs(E-R.PI)<.001&&this.o1.molCenter===this.o2.molCenter&&(C+=R.PI/2,A-=R.PI/2,i.x=r.x+35*R.cos(C+R.PI),i.y=r.y-35*R.sin(C+R.PI),s.x=n.x+35*R.cos(A+R.PI),s.y=n.y-35*R.sin(A+R.PI)),M(t,e,this.o1,this.o2,r,i,s,n,this.numElectron,this.caches)}}},i.getPoints=function(){return[]},i.isOver=function(t,e){for(var i=0,s=this.caches.length;i<s;i++){if(r.distanceFromCurve(t,this.caches[i]).distance<e)return!0}return!1}}(Te.math,Te.lib.jsBezier,Te.structures,Te.structures.d2,Math),function(t,i,e,o,s){var a=new i.Bond;e.VAP=function(t,e){this.asterisk=new i.Atom("O",t,e),this.substituent,this.bondType=1,this.attachments=[]};var r=e.VAP.prototype=new e._Shape;r.drawDecorations=function(t,e){if(this.isHover||this.isSelected){t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1.2;if(this.hoverBond){var i=2*o.PI,s=(this.asterisk.angleForStupidCanvasArcs(this.hoverBond)+o.PI/2)%i;t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.beginPath();var r=(s+o.PI)%i;r%=2*o.PI,t.arc(this.asterisk.x,this.asterisk.y,7,s,r,!1),t.stroke(),t.beginPath(),r=((s+=o.PI)+o.PI)%i,t.arc(this.hoverBond.x,this.hoverBond.y,7,s,r,!1),t.stroke()}else t.beginPath(),t.arc(this.asterisk.x,this.asterisk.y,7,0,2*o.PI,!1),t.stroke()}},r.draw=function(t,e){t.strokeStyle=this.error?e.colorError:e.shapes_color,t.lineWidth=1;var i=o.sqrt(3)/2;t.beginPath(),t.moveTo(this.asterisk.x,this.asterisk.y-4),t.lineTo(this.asterisk.x,this.asterisk.y+4),t.moveTo(this.asterisk.x-4*i,this.asterisk.y-2),t.lineTo(this.asterisk.x+4*i,this.asterisk.y+2),t.moveTo(this.asterisk.x-4*i,this.asterisk.y+2),t.lineTo(this.asterisk.x+4*i,this.asterisk.y-2),t.stroke(),this.asterisk.textBounds=[],this.asterisk.textBounds.push({x:this.asterisk.x-4,y:this.asterisk.y-4,w:8,h:8});var s=e.bonds_color;this.error&&(e.bonds_color=e.colorError),a.a1=this.asterisk,this.substituent&&(a.a2=this.substituent,a.bondOrder=this.bondType,a.draw(t,e)),a.bondOrder=0,this.error||(e.bonds_color=e.shapes_color);for(var r=0,n=this.attachments.length;r<n;r++)a.a2=this.attachments[r],a.draw(t,e);e.bonds_color=s},r.getPoints=function(){return[this.asterisk]},r.isOver=function(t,e){return!1}}(Te.math,Te.structures,Te.structures.d2,Math),function(t,e,i){t._Mesh=function(){};var s=t._Mesh.prototype;s.storeData=function(t,e,i){this.positionData=t,this.normalData=e,this.indexData=i},s.setupBuffers=function(t){if(this.vertexPositionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.positionData),t.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexNormalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.normalData),t.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),t.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(var e=0,i=this.partitions.length;e<i;e++){var s=this.partitions[e],r=this.generateBuffers(t,s.positionData,s.normalData,s.indexData);s.vertexPositionBuffer=r[0],s.vertexNormalBuffer=r[1],s.vertexIndexBuffer=r[2]}},s.generateBuffers=function(t,e,i,s){var r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),r.itemSize=3,r.numItems=e.length/3;var n,o=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),o.itemSize=3,o.numItems=i.length/3,s&&(n=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),t.STATIC_DRAW),n.itemSize=1,n.numItems=s.length),[r,o,n]},s.bindBuffers=function(t){this.vertexPositionBuffer||this.setupBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexNormalBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,t.FLOAT,!1,0,0),this.vertexIndexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(Te.structures.d3,Math),function(t,e){t._Measurement=function(){};var i=t._Measurement.prototype=new t._Mesh;i.render=function(t,e){t.shader.setMatrixUniforms(t),e.measurement_update_3D&&(this.vertexPositionBuffer=void 0,this.text=void 0),this.vertexPositionBuffer||this.calculateData(e),this.bindBuffers(t),t.material.setDiffuseColor(t,e.shapes_color),t.lineWidth(e.shapes_lineWidth),t.drawElements(t.LINES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},i.renderText=function(t,e){t.shader.setMatrixUniforms(t),this.text||(this.text=this.getText(e));var i={position:[],texCoord:[],translation:[]};t.textImage.pushVertexData(this.text.value,this.text.pos,1,i),t.textMesh.storeData(t,i.position,i.texCoord,i.translation),t.textImage.useTexture(t),t.textMesh.render(t)}}(Te.structures.d3),function(t,m,e,i,p,s,g,r){e.Angle=function(t,e,i){this.a1=t,this.a2=e,this.a3=i};var n=e.Angle.prototype=new e._Measurement;n.calculateData=function(t){var e=[],i=[],s=[],r=this.a2.distance3D(this.a1),n=this.a2.distance3D(this.a3);this.distUse=p.min(r,n)/2,this.vec1=g.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]),this.vec2=g.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]),this.angle=m.vec3AngleFrom(this.vec1,this.vec2);for(var o=g.normalize(g.cross(this.vec1,this.vec2,[])),a=g.normalize(g.cross(o,this.vec1,[])),l=t.measurement_angleBands_3D,h=0;h<=l;++h){var u=this.angle*h/l,c=g.scale(this.vec1,p.cos(u),[]),f=g.scale(a,p.sin(u),[]),d=g.scale(g.normalize(g.add(c,f,[])),this.distUse);e.push(this.a2.x+d[0],this.a2.y+d[1],this.a2.z+d[2]),i.push(0,0,0),h<l&&s.push(h,h+1)}this.storeData(e,i,s)},n.getText=function(t){var e=g.scale(g.normalize(g.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+e[0],this.a2.y+e[1],this.a2.z+e[2]],value:[i.angleBounds(this.angle,!0).toFixed(2)," "].join("")}}}(Te.ELEMENT,Te.extensions,Te.structures.d3,Te.math,Math,Te.lib.mat4,Te.lib.vec3),at=Te.structures.d3,lt=Math,at.Arrow=function(t,e){for(var i=[],s=[],r=0;r<=e;r++){var n=2*r*lt.PI/e,o=lt.sin(n),a=lt.cos(n),l=o;s.push(0,0,-1,0,0,-1,a,l,0,a,l,0,0,0,-1,0,0,-1,a,l,1,a,l,1),i.push(0,0,0,t*a,t*l,0,t*a,t*l,0,t*a,t*l,2,t*a,t*l,2,t*a*2,t*l*2,2,t*a*2,t*l*2,2,0,0,3)}for(var h=[],u=0;u<e;u++)for(var c=8*u,f=0;f<7;f++){var d=f+c,m=d+1,p=d+7+2,g=p-1;h.push(d,p,m,p,d,g)}this.storeData(i,s,h)},at.Arrow.prototype=new at._Mesh,ht=Te.structures.d3,Math,ht.Box=function(t,e,i){t/=2,i/=2;var s=[],r=[];s.push(t,e,-i),s.push(t,e,-i),s.push(-t,e,-i),s.push(t,e,i),s.push(-t,e,i),s.push(-t,e,i);for(var n=6;n--;r.push(0,1,0));for(s.push(-t,e,i),s.push(-t,e,i),s.push(-t,0,i),s.push(t,e,i),s.push(t,0,i),s.push(t,0,i),n=6;n--;r.push(0,0,1));for(s.push(t,e,i),s.push(t,e,i),s.push(t,0,i),s.push(t,e,-i),s.push(t,0,-i),s.push(t,0,-i),n=6;n--;r.push(1,0,0));for(s.push(t,e,-i),s.push(t,e,-i),s.push(t,0,-i),s.push(-t,e,-i),s.push(-t,0,-i),s.push(-t,0,-i),n=6;n--;r.push(0,0,-1));for(s.push(-t,e,-i),s.push(-t,e,-i),s.push(-t,0,-i),s.push(-t,e,i),s.push(-t,0,i),s.push(-t,0,i),n=6;n--;r.push(-1,0,0));for(s.push(-t,0,i),s.push(-t,0,i),s.push(-t,0,-i),s.push(t,0,i),s.push(t,0,-i),s.push(t,0,-i),n=6;n--;r.push(0,-1,0));this.storeData(s,r)},ht.Box.prototype=new ht._Mesh,function(t,e,i,s,r,n){e.Camera=function(){this.fieldOfView=45,this.aspect=1,this.near=.1,this.far=1e4,this.zoom=1,this.viewMatrix=s.identity([]),this.projectionMatrix=s.identity([])};var o=e.Camera.prototype;o.perspectiveProjectionMatrix=function(){var t=r.tan(this.fieldOfView/360*r.PI)*this.near*this.zoom,e=this.aspect*t;return s.frustum(-e,e,-t,t,this.near,this.far,this.projectionMatrix)},o.orthogonalProjectionMatrix=function(){var t=r.tan(this.fieldOfView/360*r.PI)*((this.far-this.near)/2+this.near)*this.zoom,e=this.aspect*t;return s.ortho(-e,e,-t,t,this.near,this.far,this.projectionMatrix)},o.updateProjectionMatrix=function(t){return t?this.perspectiveProjectionMatrix():this.orthogonalProjectionMatrix()},o.focalLength=function(){return(this.far-this.near)/2+this.near},o.zoomIn=function(){this.zoom=r.min(1.25*this.zoom,200)},o.zoomOut=function(){this.zoom=r.max(this.zoom/1.25,.0025)}}(Te.math,Te.structures.d3,Te.lib.vec3,Te.lib.mat4,window.Math),function(v,x,b,t){v.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},v.LineArrow.prototype=new v._Mesh,v.Compass=function(t,e){this.textImage=new v.TextImage,this.textImage.init(t),this.textImage.updateFont(t,e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic,e.text_font_stroke_3D),this.textMesh=new v.TextMesh,this.textMesh.init(t);var i,s,r=3/(e.compass_size_3D/t.canvas.clientHeight),n=x.tan(e.projectionPerspectiveVerticalFieldOfView_3D/360*x.PI),o=r/n,a=x.max(o-r,.1),l=o+r,h=t.canvas.clientWidth/t.canvas.clientHeight;i=e.projectionPerspective_3D?(s=a,b.frustum):(s=o,b.ortho);var u=s/t.canvas.clientHeight*2*n,c=n*s,f=-c,d=h*f,m=h*c;if(0===e.compass_type_3D){var p=(-(t.canvas.clientWidth-e.compass_size_3D)/2+this.textImage.charHeight)*u,g=(-(t.canvas.clientHeight-e.compass_size_3D)/2+this.textImage.charHeight)*u;d-=p,m-=p,f-=g,c-=g}this.projectionMatrix=i(d,m,f,c,a,l),this.translationMatrix=b.translate(b.identity([]),[0,0,-o]);var _={position:[],texCoord:[],translation:[]};this.textImage.pushVertexData("X",[3.5,0,0],0,_),this.textImage.pushVertexData("Y",[0,3.5,0],0,_),this.textImage.pushVertexData("Z",[0,0,3.5],0,_),this.textMesh.storeData(t,_.position,_.texCoord,_.translation)};var e=v.Compass.prototype;e.renderArrow=function(t,e,i,s){t.material.setDiffuseColor(t,i),t.shader.setModelViewMatrix(t,s),1===e?t.drawArrays(t.LINES,0,t.lineArrowBuffer.vertexPositionBuffer.numItems):t.drawElements(t.TRIANGLES,t.arrowBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},e.render=function(t,e){t.shader.setProjectionMatrix(t,this.projectionMatrix),1===e.compass_type_3D?t.lineArrowBuffer.bindBuffers(t):t.arrowBuffer.bindBuffers(t),t.material.setTempColors(t,e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D);var i=b.multiply(this.translationMatrix,t.rotationMatrix,[]),s=x.PI/2;this.renderArrow(t,e.compass_type_3D,e.compass_axisXColor_3D,b.rotateY(i,s,[])),this.renderArrow(t,e.compass_type_3D,e.compass_axisYColor_3D,b.rotateX(i,-s,[])),this.renderArrow(t,e.compass_type_3D,e.compass_axisZColor_3D,i)},e.renderAxis=function(t){t.shader.setProjectionMatrix(t,this.projectionMatrix);var e=b.multiply(this.translationMatrix,t.rotationMatrix,[]);t.shader.setModelViewMatrix(t,e),this.textImage.useTexture(t),this.textMesh.render(t)}}(Te.structures.d3,Math,Te.lib.mat4),ut=Te.structures.d3,ct=Math,ut.Cylinder=function(t,e,i,s){var r=[],n=[];if(s){for(var o=0;o<=i;o++){var a=o%i*2*ct.PI/i,l=ct.cos(a),h=ct.sin(a);n.push(0,-1,0),r.push(0,0,0),n.push(0,-1,0),r.push(t*l,0,t*h)}for(o=0;o<=i;o++)a=o%i*2*ct.PI/i,l=ct.cos(a),h=ct.sin(a),n.push(l,0,h),r.push(t*l,0,t*h),n.push(l,0,h),r.push(t*l,e,t*h);for(o=0;o<=i;o++)a=o%i*2*ct.PI/i,l=ct.cos(a),h=ct.sin(a),n.push(0,1,0),r.push(t*l,e,t*h),n.push(0,1,0),r.push(0,e,0)}else{for(o=0;o<i;o++)a=2*o*ct.PI/i,l=ct.cos(a),h=ct.sin(a),n.push(l,0,h),r.push(t*l,0,t*h),n.push(l,0,h),r.push(t*l,e,t*h);n.push(1,0,0),r.push(t,0,0),n.push(1,0,0),r.push(t,e,0)}this.storeData(r,n)},ut.Cylinder.prototype=new ut._Mesh,function(n,t,o,a,e){t.Distance=function(t,e,i,s){this.a1=t,this.a2=e,this.node=i,this.offset=s||0};var i=t.Distance.prototype=new t._Measurement;i.calculateData=function(t){var e=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];if(this.node){var i=t.atoms_useVDWDiameters_3D?n[this.a1.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2,s=t.atoms_useVDWDiameters_3D?n[this.a2.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2;this.move=this.offset+o.max(i,s),this.displacement=[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],a.normalize(this.displacement);var r=a.scale(this.displacement,this.move,[]);e[0]+=r[0],e[1]+=r[1],e[2]+=r[2],e[3]+=r[0],e[4]+=r[1],e[5]+=r[2]}this.storeData(e,[0,0,0,0,0,0],[0,1])},i.getText=function(t){var e=this.a1.distance3D(this.a2),i=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){var s=a.scale(this.displacement,this.move+.1,[]);i[0]+=s[0],i[1]+=s[1],i[2]+=s[2]}return{pos:i,value:[e.toFixed(2)," "].join("")}}}(Te.ELEMENT,Te.structures.d3,Math,Te.lib.vec3),ft=Te.math,dt=Te.structures.d3,Te.lib.vec3,dt.Fog=function(t,e,i,s){this.fogScene(t,e,i,s)},dt.Fog.prototype.fogScene=function(t,e,i,s){this.colorRGB=ft.getRGB(t,1),this.fogStart=e,this.fogEnd=i,this.density=s},function(y,t,e){t.Label=function(t){};var i=t.Label.prototype;i.updateVerticesBuffer=function(t,e,i){for(var s=0,r=e.length;s<r;s++){for(var n=e[s],o=n.labelMesh,a=n.atoms,l={position:[],texCoord:[],translation:[]},h=0<a.length&&null!=a[0].hetatm,u=0,c=a.length;u<c;u++){var f=(b=a[u]).label,d=.05;if(i.atoms_useVDWDiameters_3D){var m=y[f].vdWRadius*i.atoms_vdwMultiplier_3D;0===m&&(m=1),d+=m}else i.atoms_sphereDiameter_3D&&(d+=i.atoms_sphereDiameter_3D/2*1.5);if(h)if(b.hetatm){if(b.isWater&&!i.macro_showWaters)continue}else if(!i.macro_displayAtoms)continue;t.textImage.pushVertexData(b.altLabel?b.altLabel:b.label,[b.x,b.y,b.z],d,l)}var p=n.chains;if(p&&(i.proteins_displayRibbon||i.proteins_displayBackbone))for(u=0,c=p.length;u<c;u++)for(var g=p[u],_=0,v=g.length;_<v;_++){var x=g[_];if(x.name){var b=x.cp1;t.textImage.pushVertexData(x.name,[b.x,b.y,b.z],2,l)}}o.storeData(t,l.position,l.texCoord,l.translation,l.zDepth)}},i.render=function(t,e,i){t.shader.setMatrixUniforms(t),t.textImage.useTexture(t);for(var s=0,r=i.length;s<r;s++)i[s].labelMesh&&i[s].labelMesh.render(t)}}(Te.ELEMENT,Te.structures.d3),mt=Te.structures.d3,pt=Math,mt.Sphere=function(t,e,i){for(var s=[],r=[],n=0;n<=e;n++)for(var o=n*pt.PI/e,a=pt.sin(o),l=pt.cos(o),h=0;h<=i;h++){var u=2*h*pt.PI/i,c=pt.sin(u),f=pt.cos(u)*a,d=l,m=c*a;r.push(f,d,m),s.push(t*f,t*d,t*m)}var p=[];for(i+=1,n=0;n<e;n++)for(h=0;h<i;h++){var g=n*i+h%i,_=g+i;p.push(g,1+g,_),h<i-1&&p.push(_,1+g,_+1)}this.storeData(s,r,p)},mt.Sphere.prototype=new mt._Mesh,gt=Te.RESIDUE,_t=Te.structures.d3,vt=Math,xt=Te.lib.vec3,(yt=Ce.prototype).getColor=function(t){return t.macro_colorByChain?this.entire.chainColor:this.name?this.getResidueColor(gt[this.name]?this.name:"*",t):this.helix?this.entire.front?t.proteins_ribbonCartoonHelixPrimaryColor:t.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?t.proteins_ribbonCartoonSheetColor:this.entire.front?t.proteins_primaryColor:t.proteins_secondaryColor},yt.getResidueColor=function(t,e){var i=gt[t];return"shapely"===e.proteins_residueColor?i.shapelyColor:"amino"===e.proteins_residueColor?i.aminoColor:"polarity"===e.proteins_residueColor?i.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?1===i.acidity?"#0000FF":-1===i.acidity?"#FF0000":i.polar?"#FFFFFF":"#773300":"#FFFFFF"},yt.render=function(t,e,i){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(function(t,e){t.bindBuffer(t.ARRAY_BUFFER,e.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,e.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.vertexNormalBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,e.vertexNormalBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)}(t,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),t.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),i||"rainbow"===e.proteins_residueColor||t.material.setDiffuseColor(t,this.getColor(e)),t.drawElements(t.TRIANGLES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},_t.Ribbon=function(t,e,i){var s=t[0].lineSegments.length,r=t[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0,this.front=0<e;for(var n=0,o=t.length;n<o;n++){(!T||65e3<T.positionData.length)&&(0<this.partitions.length&&n--,T={count:0,positionData:[],normalData:[]},this.partitions.push(T));var a=t[n];T.count++;for(var l=0;l<s;l++)for(var h=i?a.lineSegmentsCartoon[l]:a.lineSegments[l],u=0===l,c=!1,f=0;f<r;f++){var d=h[f],m=n,p=f+1;n===t.length-1&&f===r-1?p--:f===r-1&&(m++,p=0);var g=i?t[m].lineSegmentsCartoon[l][p]:t[m].lineSegments[l][p],_=!1,v=l+1;l===s-1&&(v-=2,_=!0);var x=i?a.lineSegmentsCartoon[v][f]:a.lineSegments[v][f],b=[g.x-d.x,g.y-d.y,g.z-d.z],y=[x.x-d.x,x.y-d.y,x.z-d.z],w=xt.cross(b,y,[]);0===f&&(xt.normalize(b),xt.scale(b,-1),T.normalData.push(b[0],b[1],b[2]),T.positionData.push(d.x,d.y,d.z)),u||c?(xt.normalize(y),xt.scale(y,-1),T.normalData.push(y[0],y[1],y[2]),T.positionData.push(d.x,d.y,d.z),u&&f===r-1&&(u=!1,f=-1)):(xt.normalize(w),(_&&!this.front||!_&&this.front)&&xt.scale(w,-1),T.normalData.push(w[0],w[1],w[2]),xt.scale(w,vt.abs(e)),T.positionData.push(d.x+w[0],d.y+w[1],d.z+w[2]),l===s-1&&f===r-1&&(c=!0,f=-1)),-1!==f&&f!==r-1||(xt.normalize(b),T.normalData.push(b[0],b[1],b[2]),T.positionData.push(d.x,d.y,d.z))}}s+=2,r+=2,this.segments=[],this.partitionSegments=[];for(var D=0,S=this.partitions.length;D<S;D++){var T,C,A=[];for(n=0,o=(T=this.partitions[D]).count-1;n<o;n++){var E=n;for(l=0;l<D;l++)E+=this.partitions[l].count-1;for(var F=t[E],P=n*s*r,R=[],B=(l=0,s-1);l<B;l++){var M=P+l*r;for(f=0;f<r-1;f++){var I=1;n===o&&(I=0);var L=[M+f,M+r+f,M+r+f+I,M+f,M+f+I,M+r+f+I];if(f!==r-1&&(this.front?R.push(L[0],L[1],L[2],L[3],L[5],L[4]):R.push(L[0],L[2],L[1],L[3],L[4],L[5])),f===r-2&&(n!==T.count-2||D!==this.partitions.length-1)){var N=s*r-f;L[2]+=N,L[4]+=N,L[5]+=N}this.front?A.push(L[0],L[1],L[2],L[3],L[5],L[4]):A.push(L[0],L[2],L[1],L[3],L[4],L[5])}}i&&F.split&&((C=new Ce(this,bt,A,D)).helix=F.helix,C.sheet=F.sheet,this.partitionSegments.push(C),A=[]),this.segments.push(new Ce(this,F.name,R,D))}(C=new Ce(this,bt,A,D)).helix=F.helix,C.sheet=F.sheet,this.partitionSegments.push(C)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData),1===this.partitions.length&&(this.partitions=bt)},(_t.Ribbon.prototype=new _t._Mesh).render=function(t,e){this.bindBuffers(t);var i=e.macro_colorByChain?this.chainColor:bt;i||(i=this.front?e.proteins_primaryColor:e.proteins_secondaryColor),t.material.setDiffuseColor(t,i);for(var s=0,r=this.partitionSegments.length;s<r;s++)this.partitionSegments[s].render(t,e,!e.proteins_ribbonCartoonize)},function(s,r,n,o,t){r.Light=function(t,e,i){this.camera=new r.Camera,this.lightScene(t,e,i)};var e=r.Light.prototype;e.lightScene=function(t,e,i){this.diffuseRGB=s.getRGB(t,1),this.specularRGB=s.getRGB(e,1),this.direction=i,this.updateView()},e.updateView=function(){var t=n.normalize(this.direction,[]),e=n.scale(t,(this.camera.near-this.camera.far)/2-this.camera.near,[]),i=n.equal(t,[0,1,0])?[0,0,1]:[0,1,0];o.lookAt(e,[0,0,0],i,this.camera.viewMatrix),this.camera.orthogonalProjectionMatrix()}}(Te.math,Te.structures.d3,Te.lib.vec3,Te.lib.mat4),(wt=Te.structures.d3).Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])},wt.Line.prototype=new wt._Mesh,function(n,t,e){t.Material=function(){};var i=t.Material.prototype;i.setTempColors=function(t,e,i,s,r){e&&t.shader.setMaterialAmbientColor(t,n.getRGB(e,1)),i&&t.shader.setMaterialDiffuseColor(t,n.getRGB(i,1)),s&&t.shader.setMaterialSpecularColor(t,n.getRGB(s,1)),t.shader.setMaterialShininess(t,r),t.shader.setMaterialAlpha(t,1)},i.setDiffuseColor=function(t,e){t.shader.setMaterialDiffuseColor(t,n.getRGB(e,1))},i.setAlpha=function(t,e){t.shader.setMaterialAlpha(t,e)}}(Te.math,Te.structures.d3),function(t,e,i,s){t.Picker=function(){};var r=t.Picker.prototype;r.init=function(t){this.framebuffer=t.createFramebuffer();var e=t.createTexture(),i=t.createRenderbuffer();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindRenderbuffer(t.RENDERBUFFER,i),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,i),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setDimension=function(t,e,i){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer);var s=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);t.isRenderbuffer(s)&&(t.bindRenderbuffer(t.RENDERBUFFER,s),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e,i),t.bindRenderbuffer(t.RENDERBUFFER,null));var r=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);t.isTexture(r)&&(t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,null)),t.bindFramebuffer(t.FRAMEBUFFER,null)}}(Te.structures.d3,Te.math,document),Dt=Te.structures.d3,St=Math,Dt.Pill=function(t,e,i,s){var r=1,n=2*t;(e-=n)<0?(r=0,e+=n):e<n&&(r=e/n,e=n);for(var o=[],a=[],l=0;l<=i;l++)for(var h=l*St.PI/i,u=St.sin(h),c=St.cos(h)*r,f=0;f<=s;f++){var d=2*f*St.PI/s,m=St.sin(d),p=St.cos(d)*u,g=c,_=m*u;a.push(p,g,_),o.push(t*p,t*g+(l<i/2?e:0),t*_)}var v=[];for(s+=1,l=0;l<i;l++)for(f=0;f<s;f++){var x=l*s+f%s,b=x+s;v.push(x,1+x,b),f<s-1&&v.push(b,1+x,b+1)}this.storeData(o,a,v)},Dt.Pill.prototype=new Dt._Mesh,Tt=Te.extensions,Te.RESIDUE,Ct=Te.structures,At=Te.structures.d3,Et=Math,Ft=Te.lib.mat4,Pt=Te.lib.vec3,Te.math,Ee.prototype.render=function(t,e){var i,s=this.a1,r=this.a2,n=1.001*s.distance3D(r),o=e.proteins_cylinderHelixDiameter/2,a=[o,n,o],l=Ft.translate(Ft.identity(),[s.x,s.y,s.z]),h=[0,1,0],u=0;if(s.x===r.x&&s.z===r.z)i=[0,0,1],r.y<s.y&&(u=Et.PI);else{var c=[r.x-s.x,r.y-s.y,r.z-s.z];u=Tt.vec3AngleFrom(h,c),i=Pt.cross(h,c,[])}0!==u&&Ft.rotate(l,u,i),Ft.scale(l,a),t.shader.setMatrixUniforms(t,l),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderClosedBuffer.vertexPositionBuffer.numItems)},Fe.prototype.render=function(t,e){this.specs&&(e=this.specs);var i=1.001*this.a1.distance3D(this.a2),s=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=Pt.cross(s,this.vx,[]),n=Pt.cross(r,s,[]);Pt.normalize(n),Pt.normalize(s),Pt.normalize(r);var o=[n[0],n[1],n[2],0,s[0],s[1],s[2],0,r[0],r[1],r[2],0,this.a1.x,this.a1.y,this.a1.z,1],a=[e.proteins_plankSheetWidth,i,e.proteins_tubeThickness];Ft.scale(o,a),t.shader.setMatrixUniforms(t,o),t.drawArrays(t.TRIANGLE_STRIP,0,t.boxBuffer.vertexPositionBuffer.numItems)},At.PipePlank=function(t,e){this.tubes=[],this.helixCylinders=[],this.sheetPlanks=[],this.chainColor=t.chainColor;var i=[],s=[],r=[],n=[];if(1<t.length){var o=t[0],a=t[1];a.helix?r.push(o):a.sheet?n.push(o):s.push(o)}for(var l=1,h=t.length-1;l<=h;l++){var u=t[l];if(u.helix){if(r.push(u),u.arrow){var c=Pt.create(),f=Pt.create();if(2==r.length)c=[r[0].cp1.x,r[0].cp1.y,r[0].cp1.z],f=[r[1].cp1.x,r[1].cp1.y,r[1].cp1.z];else{3==r.length&&r.unshift(t[Et.max(l-3,0)]);for(var d=[],m=[],p=1,g=r.length-1;p<g;p++){var _=[r[p].cp1.x,r[p].cp1.y,r[p].cp1.z],v=[r[p-1].cp1.x,r[p-1].cp1.y,r[p-1].cp1.z],x=[r[p+1].cp1.x,r[p+1].cp1.y,r[p+1].cp1.z];Pt.subtract(v,_),Pt.subtract(x,_);var b=Pt.scale(v,Pt.length(x),[]),y=Pt.scale(x,Pt.length(v),[]),w=Pt.normalize(Pt.add(b,y,[]));d.push(_),m.push(w)}var D=[];for(p=0,g=d.length-1;p<g;p++){var S=d[p],T=m[p],C=d[p+1],A=m[p+1],E=Pt.normalize(Pt.cross(T,A,[])),F=Pt.subtract(C,S,[]),P=Pt.dot(F,E),R=Pt.scale(E,P,[]),B=Pt.length(R),M=Pt.length(F),I=-(B*B-M*M)/(2*Pt.dot(Pt.subtract(S,C,[]),A)),L=Pt.add(S,Pt.scale(T,I,[]),[]),N=Pt.add(C,Pt.scale(A,I,[]),[]);D.push([L,N])}var k=D[0][0],z=D[0][1],O=Pt.subtract(k,z,[]);Pt.add(k,O,c),k=D[D.length-1][1],z=D[D.length-1][0],O=Pt.subtract(k,z,[]),Pt.add(k,O,f)}var U=new Ct.Atom("",c[0],c[1],c[2]),H=new Ct.Atom("",f[0],f[1],f[2]);this.helixCylinders.push(new Ee(U,H)),r=[];var W=Pt.subtract(c,f,[]);if(Pt.normalize(W),Pt.scale(W,.5),0<s.length){var q=Pt.add(c,W,[]),j=s[s.length-1].cp1,G=Pt.subtract([j.x,j.y,j.z],q,[]);Pt.normalize(G),Pt.scale(G,.5),Pt.add(q,G),(X=new Ct.Residue(-1)).cp1=X.cp2=new Ct.Atom("",q[0],q[1],q[2]),s.push(X);var X=Ae(c[0],c[1],c[2]);s.push(X),i.push(s)}if(s=[],l<h)if(X=Ae(f[0],f[1],f[2]),s.push(X),(rt=t[l+1]).sheet)s.push(u),s.push(u),i.push(s),s=[],n.push(u);else{Pt.scale(W,-1),q=Pt.add(f,W,[]);var V=rt.cp1,Y=Pt.subtract([V.x,V.y,V.z],q,[]);Pt.normalize(Y),Pt.scale(Y,.5),Pt.add(q,Y),X=Ae(q[0],q[1],q[2]),s.push(X)}}}else if(u.sheet){if(n.push(u),u.arrow){var Z=[0,0,0],$=[0,0,0];for(p=0,g=n.length;p<g;p++){var Q=(nt=n[p].guidePointsLarge)[0],J=nt[nt.length-1];Pt.add(Z,[Q.x,Q.y,Q.z]),Pt.add($,[J.x,J.y,J.z])}Pt.scale(Z,1/g),Pt.scale($,1/g);var K=Pt.subtract(Z,$),tt=n[0],et=n[n.length-1],it=tt.guidePointsSmall[0],st=et.guidePointsSmall[0];this.sheetPlanks.push(new Fe(it,st,K)),n=[],l<h&&((rt=t[l+1]).sheet?n.push(u):(X=Ae(st.x,st.y,st.z),s.push(X)))}}else{var rt,nt;if(s.push(u),l<h&&(rt=t[l+1]).sheet)X=Ae((nt=u.guidePointsSmall[0]).x,nt.y,nt.z),s.push(X),i.push(s),s=[],n.push(u)}}1<s.length&&(2==s.length&&s.push(s[s.length-1]),i.push(s)),s=[];for(var ot=[],at=0,lt=i.length;at<lt;at++){var ht=i[at],ut=[];for(l=0,h=ht.length-1;l<=h;l++)ut.push(ht[l].cp1);ot.push(ut)}for(l=0,h=ot.length;l<h;l++){var ct=new At.CatmullTube(ot[l],e.proteins_tubeThickness,e.proteins_tubeResolution_3D,e.proteins_horizontalResolution);ct.chainColor=t.chainColor,this.tubes.push(ct)}},(At.PipePlank.prototype=new At._Mesh).render=function(t,e){t.material.setTempColors(t,e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),t.material.setDiffuseColor(t,e.macro_colorByChain?this.chainColor:e.proteins_tubeColor);for(var i=0,s=this.tubes.length;i<s;i++)t.shader.setMatrixUniforms(t),this.tubes[i].render(t,e);for(e.macro_colorByChain||t.material.setDiffuseColor(t,e.proteins_ribbonCartoonHelixSecondaryColor),t.cylinderClosedBuffer.bindBuffers(t),i=0,s=this.helixCylinders.length;i<s;i++)this.helixCylinders[i].render(t,e);for(e.macro_colorByChain||t.material.setDiffuseColor(t,e.proteins_ribbonCartoonSheetColor),t.boxBuffer.bindBuffers(t),i=0,s=this.sheetPlanks.length;i<s;i++)this.sheetPlanks[i].render(t,e)},(Rt=Te.structures.d3).Quad=function(){this.storeData([-1,1,0,-1,-1,0,1,1,0,1,-1,0],[0,0,0,0,0,0,0,0,0,0,0,0])},Rt.Quad.prototype=new Rt._Mesh,Bt=Te.structures,Mt=Te.structures.d3,It=Te.lib.vec3,Mt.Shape=function(t,e){for(var i=t.length,s=[],r=[],n=new Bt.Point,o=0,a=i;o<a;o++){var l=o+1;o===a-1&&(l=0);for(var h=t[o],u=t[l],c=[u.x-h.x,u.y-h.y,0],f=It.cross([0,0,1],c),d=0;d<2;d++)s.push(h.x,h.y,e/2),s.push(h.x,h.y,-e/2),s.push(u.x,u.y,e/2),s.push(u.x,u.y,-e/2);for(d=0;d<4;d++)r.push(f[0],f[1],f[2]);r.push(0,0,1),r.push(0,0,-1),r.push(0,0,1),r.push(0,0,-1),n.add(h)}n.x/=i,n.y/=i,r.push(0,0,1),s.push(n.x,n.y,e/2),r.push(0,0,-1),s.push(n.x,n.y,-e/2);var m=[],p=8*i;for(o=0,a=i;o<a;o++){var g=8*o;m.push(g),m.push(3+g),m.push(1+g),m.push(g),m.push(2+g),m.push(3+g),m.push(4+g),m.push(p),m.push(6+g),m.push(5+g),m.push(7+g),m.push(1+p)}this.storeData(s,r,m)},Mt.Shape.prototype=new Mt._Mesh,Lt=Te.structures.d3,Math,Nt=Te.lib.vec3,Lt.Star=function(){for(var t=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],e=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],i=[],s=[],r=[],n=0,o=e.length;n<o;n+=3){var a=3*e[n],l=3*e[n+1],h=3*e[n+2],u=[t[a],t[1+a],t[2+a]],c=[t[l],t[1+l],t[2+l]],f=[t[h],t[1+h],t[2+h]],d=[u[0]-c[0],u[1]-c[1],u[2]-c[2]],m=[f[0]-c[0],f[1]-c[1],f[2]-c[2]],p=Nt.cross(m,d,[]);Nt.normalize(p),i.push(u[0],u[1],u[2],c[0],c[1],c[2],f[0],f[1],f[2]),s.push(p[0],p[1],p[2],p[0],p[1],p[2],p[0],p[1],p[2]),r.push(n,n+1,n+2)}this.storeData(i,s,r)},Lt.Star.prototype=new Lt._Mesh,function(t,E,e,i,s){var F=1;i.devicePixelRatio&&(F=i.devicePixelRatio),t.TextImage=function(){this.ctx=e.createElement("canvas").getContext("2d"),this.data=[],this.text="",this.charHeight=0};var r=t.TextImage.prototype;r.init=function(t){this.textureImage=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.textureImage),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,null),this.updateFont(t,12,["Sans-serif"],!1,!1,!1)},r.charData=function(t){var e=this.text.indexOf(t);return 0<=e?this.data[e]:null},r.updateFont=function(t,e,i,s,r,n){var o=this.ctx,a=this.ctx.canvas,l=[],h="";e*=F;var u=E.getFontString(e,i,s,r);o.font=u,o.save();for(var c=0,f=1.5*e,d=32,m=127;d<m;d++){var p=String.fromCharCode(d),g=o.measureText(p).width;l.push({text:p,width:g,height:f}),c+=2*g}var _="".split("");for(d=0,m=_.length;d<m;d++){p=_[d],g=o.measureText(p).width;l.push({text:p,width:g,height:f}),c+=2*g}var v=c*f,x=Math.sqrt(v),b=Math.ceil(x/f),y=Math.ceil(c/(b-1));a.width=y,a.height=b*f,o.font=u,o.textAlign="left",o.textBaseline="middle",o.strokeStyle="#000",o.lineWidth=1.4,o.fillStyle="#fff";var w=0,D=0;for(d=0,m=l.length;d<m;d++){var S=l[d],T=2*S.width,C=(f=S.height,S.text);y<D+T&&(w++,D=0);var A=w*f;n&&o.strokeText(C,D,A+f/2),o.fillText(C,D,A+f/2),S.x=D,S.y=A,h+=C,D+=T}this.text=h,this.data=l,this.charHeight=f,t.bindTexture(t.TEXTURE_2D,this.textureImage),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.bindTexture(t.TEXTURE_2D,null)},r.pushVertexData=function(t,e,i,s){for(var r=t.toString().split(""),n=this.getHeight(),o=this.getWidth(),a=-this.textWidth(t)/2/F,l=-this.charHeight/2/F,h=0,u=r.length;h<u;h++){var c=this.charData(r[h]),f=c.width,d=c.x/o,m=d+1.8*c.width/o,p=c.y/n,g=p+c.height/n,_=a+1.8*f/F,v=this.charHeight/2/F;s.position.push(e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2]),s.texCoord.push(d,p,m,g,m,p,d,p,d,g,m,g),s.translation.push(a,v,i,_,l,i,_,v,i,a,v,i,a,l,i,_,l,i),a=_+(f-1.8*f)/F}},r.getCanvas=function(){return this.ctx.canvas},r.getHeight=function(){return this.getCanvas().height},r.getWidth=function(){return this.getCanvas().width},r.textWidth=function(t){return this.ctx.measureText(t).width},r.test=function(){e.body.appendChild(this.getCanvas())},r.useTexture=function(t){t.bindTexture(t.TEXTURE_2D,this.textureImage)}}(Te.structures.d3,Te.extensions,document,window),function(t,e,i){t.TextMesh=function(){};var s=t.TextMesh.prototype;s.init=function(t){this.vertexPositionBuffer=t.createBuffer(),this.vertexTexCoordBuffer=t.createBuffer(),this.vertexTranslationBuffer=t.createBuffer()},s.setVertexData=function(t,e,i,s){t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),e.itemSize=s,e.numItems=i.length/s},s.storeData=function(t,e,i,s){this.setVertexData(t,this.vertexPositionBuffer,e,3),this.setVertexData(t,this.vertexTexCoordBuffer,i,2),this.setVertexData(t,this.vertexTranslationBuffer,s,3)},s.bindBuffers=function(t){t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexTexCoordBuffer),t.vertexAttribPointer(t.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexTranslationBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,this.vertexTranslationBuffer.itemSize,t.FLOAT,!1,0,0)},s.render=function(t){var e=this.vertexPositionBuffer.numItems;e&&(this.bindBuffers(t),t.drawArrays(t.TRIANGLES,0,e))}}(Te.structures.d3,Math),function(t,e,i,y,s,w,r){i.Torsion=function(t,e,i,s){this.a1=t,this.a2=e,this.a3=i,this.a4=s};var n=i.Torsion.prototype=new i._Measurement;n.calculateData=function(t){var e=[],i=[],s=[],r=this.a2.distance3D(this.a1),n=this.a2.distance3D(this.a3);this.distUse=y.min(r,n)/2;var o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z],l=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],h=w.cross(o,a,[]),u=w.cross(a,l,[]);w.scale(o,w.length(a)),this.torsion=y.atan2(w.dot(o,u),w.dot(h,u));var c=w.normalize(w.cross(h,a,[])),f=w.normalize(w.cross(a,c,[]));this.pos=w.add([this.a2.x,this.a2.y,this.a2.z],w.scale(w.normalize(a,[]),this.distUse));for(var d=[],m=t.measurement_angleBands_3D,p=0;p<=m;++p){var g=this.torsion*p/m,_=w.scale(c,y.cos(g),[]),v=w.scale(f,y.sin(g),[]),x=w.scale(w.normalize(w.add(_,v,[])),this.distUse);0==p&&(d=x),e.push(this.pos[0]+x[0],this.pos[1]+x[1],this.pos[2]+x[2]),i.push(0,0,0),p<m&&s.push(p,p+1)}this.vecText=w.normalize(w.add(d,x,[]));var b=w.normalize(a,[]);w.scale(b,.0625);g=this.torsion-2*y.asin(.125)*this.torsion/y.abs(this.torsion),_=w.scale(c,y.cos(g),[]),v=w.scale(f,y.sin(g),[]),x=w.scale(w.normalize(w.add(_,v,[])),this.distUse);e.push(this.pos[0]+b[0]+x[0],this.pos[1]+b[1]+x[1],this.pos[2]+b[2]+x[2]),i.push(0,0,0),e.push(this.pos[0]-b[0]+x[0],this.pos[1]-b[1]+x[1],this.pos[2]-b[2]+x[2]),i.push(0,0,0),s.push(--p,p+1,p,p+2),this.storeData(e,i,s)},n.getText=function(t){return w.add(this.pos,w.scale(this.vecText,this.distUse+.3,[])),{pos:this.pos,value:[e.angleBounds(this.torsion,!0,!0).toFixed(2)," "].join("")}}}(Te.ELEMENT,Te.math,Te.structures.d3,Math,Te.lib.mat4,Te.lib.vec3),kt=Te.extensions,zt=Te.RESIDUE,Ot=Te.structures,Ut=Te.structures.d3,Ht=Math,Wt=Te.lib.mat4,qt=Te.lib.vec3,jt=Te.math,Ut.Tube=function(D,S,t){var e=D[0].lineSegments[0].length;this.partitions=[],this.ends=[],this.ends.push(D[0].lineSegments[0][0]),this.ends.push(D[D.length-1].lineSegments[0][0]);for(var i=[1,0,0],s=0,r=D.length;s<r;s++){(!b||65e3<b.positionData.length)&&(0<this.partitions.length&&s--,b={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(b));var n=D[s];b.count++;for(var o=1/0,a=new Ot.Atom("",D[s].cp1.x,D[s].cp1.y,D[s].cp1.z),l=0;l<e;l++){var h,u=n.lineSegments[0][l],c=[(h=l===e-1?s===D.length-1?n.lineSegments[0][l-1]:D[s+1].lineSegments[0][0]:n.lineSegments[0][l+1]).x-u.x,h.y-u.y,h.z-u.z];qt.normalize(c),s===D.length-1&&l===e-1&&qt.scale(c,-1);var f=qt.cross(c,i,[]);qt.normalize(f),qt.scale(f,S/2);for(var d=new Re(f,c,2*Math.PI/t),m=0,p=t;m<p;m++){var g=d.rotate();m===Ht.floor(t/4)&&(i=[g[0],g[1],g[2]]),b.normalData.push(g[0],g[1],g[2]),b.positionData.push(u.x+g[0],u.y+g[1],u.z+g[2])}if(a){var _=u.distance3D(a);_<o&&(o=_,D[s].pPoint=u)}}}for(var v=0,x=this.partitions.length;v<x;v++){var b;for(s=0,r=(b=this.partitions[v]).count-1;s<r;s++)for(var y=s*e*t,w=(l=0,e);l<w;l++){var T=y+l*t;for(m=0;m<t;m++){var C=T+m;b.indexData.push(C),b.indexData.push(C+t),b.indexData.push(C+t+1),b.indexData.push(C),b.indexData.push(C+t+1),b.indexData.push(C+1)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);var A=[new Ot.Point(2,0)];for(s=0;s<60;s++){var E=s/60*Ht.PI;A.push(new Ot.Point(2*Ht.cos(E),-2*Ht.sin(E)))}A.push(new Ot.Point(-2,0),new Ot.Point(-2,4),new Ot.Point(2,4));var F=new Ot.d3.Shape(A,1);this.render=function(t,e){if(this.bindBuffers(t),t.material.setDiffuseColor(t,e.macro_colorByChain?this.chainColor:e.nucleics_tubeColor),t.drawElements(t.TRIANGLES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0),this.partitions)for(var i=1,s=this.partitions.length;i<s;i++){var r=this.partitions[i];Pe(t,r),t.drawElements(t.TRIANGLES,r.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}for(t.sphereBuffer.bindBuffers(t),i=0;i<2;i++){r=this.ends[i];var n=Wt.translate(Wt.identity(),[r.x,r.y,r.z]),o=S/2;Wt.scale(n,[o,o,o]),t.shader.setMatrixUniforms(t,n),t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}for(t.cylinderBuffer.bindBuffers(t),i=0,s=D.length-1;i<s;i++){var a=(m=D[i]).pPoint,l=new Ot.Atom("",m.cp2.x,m.cp2.y,m.cp2.z),h=1.001*a.distance3D(l),u=[S/4,h,S/4],c=(n=Wt.translate(Wt.identity(),[a.x,a.y,a.z]),[0,1,0]),f=0,d=[l.x-a.x,l.y-a.y,l.z-a.z];a.x===l.x&&a.z===l.z?(p=[0,0,1],a.y<a.y&&(f=Ht.PI)):(f=kt.vec3AngleFrom(c,d),p=qt.cross(c,d,[])),0!==f&&Wt.rotate(n,f,p),Wt.scale(n,u),t.shader.setMatrixUniforms(t,n),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems)}for(F.bindBuffers(t),"none"!==e.nucleics_residueColor||e.macro_colorByChain||t.material.setDiffuseColor(t,e.nucleics_baseColor),i=0,s=D.length-1;i<s;i++){l=(m=D[i]).cp2,n=Wt.translate(Wt.identity(),[l.x,l.y,l.z]),c=[0,1,0],f=0;var m,p,g=m.cp3;if(g){d=[g.x-l.x,g.y-l.y,g.z-l.z],l.x===g.x&&l.z===g.z?(p=[0,0,1],l.y<l.y&&(f=Ht.PI)):(f=kt.vec3AngleFrom(c,d),p=qt.cross(c,d,[])),0!==f&&Wt.rotate(n,f,p);var _=[1,0,0],v=Wt.rotate(Wt.identity([]),f,p);Wt.multiplyVec3(v,_);var x=m.cp4,b=m.cp5;if(x.y!==b.y||x.z!==b.z){var y=[b.x-x.x,b.y-x.y,b.z-x.z],w=kt.vec3AngleFrom(_,y);qt.dot(d,qt.cross(_,y))<0&&(w*=-1),Wt.rotateY(n,w)}e.macro_colorByChain||("shapely"===e.nucleics_residueColor?zt[m.name]?t.material.setDiffuseColor(t,zt[m.name].shapelyColor):t.material.setDiffuseColor(t,zt["*"].shapelyColor):"rainbow"===e.nucleics_residueColor&&t.material.setDiffuseColor(t,jt.rainbowAt(i,s,e.macro_rainbowColors))),t.shader.setMatrixUniforms(t,n),t.drawElements(t.TRIANGLES,F.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}}}},Ut.Tube.prototype=new Ut._Mesh,Ut.CatmullTube=function(t,e,i,s){var r=[];t.push(t[t.length-1]);for(var n=0,o=t.length-2;n<=o;n++){for(var a=t[0==n?0:n-1],l=t[n+0],h=t[n+1],u=t[n==o?n+1:n+2],c=[],f=0;f<s;f++){var d=f/s;n==o&&(d=f/(s-1));var m=.5*(2*l.x+(h.x-a.x)*d+(2*a.x-5*l.x+4*h.x-u.x)*d*d+(3*l.x-a.x-3*h.x+u.x)*d*d*d),p=.5*(2*l.y+(h.y-a.y)*d+(2*a.y-5*l.y+4*h.y-u.y)*d*d+(3*l.y-a.y-3*h.y+u.y)*d*d*d),g=.5*(2*l.z+(h.z-a.z)*d+(2*a.z-5*l.z+4*h.z-u.z)*d*d+(3*l.z-a.z-3*h.z+u.z)*d*d*d),_=new Ot.Atom("C",m,p,g);c.push(_)}r.push(c)}var v=r[0].length;this.partitions=[],this.ends=[],this.ends.push(r[0][0]),this.ends.push(r[r.length-1][0]);var x=[1,0,0];for(n=0,o=r.length;n<o;n++){(!R||65e3<R.positionData.length)&&(0<this.partitions.length&&n--,R={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(R));var b=r[n];for(R.count++,f=0;f<v;f++){var y,w=b[f],D=[(y=f===v-1?n===r.length-1?b[f-1]:r[n+1][0]:b[f+1]).x-w.x,y.y-w.y,y.z-w.z];qt.normalize(D),n===r.length-1&&f===v-1&&qt.scale(D,-1);var S=qt.cross(D,x,[]);qt.normalize(S),qt.scale(S,e/2);for(var T=new Re(S,D,2*Math.PI/i),C=0,A=i;C<A;C++){var E=T.rotate();C===Ht.floor(i/4)&&(x=[E[0],E[1],E[2]]),R.normalData.push(E[0],E[1],E[2]),R.positionData.push(w.x+E[0],w.y+E[1],w.z+E[2])}}}for(var F=0,P=this.partitions.length;F<P;F++){var R;for(n=0,o=(R=this.partitions[F]).count-1;n<o;n++)for(var B=n*v*i,M=(f=0,v);f<M;f++){var I=B+f*i;for(C=0;C<=i;C++){var L=I+C%i;R.indexData.push(L,L+i)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData)},(Ut.CatmullTube.prototype=new Ut._Mesh).render=function(t,e){this.bindBuffers(t);for(var i=0,s=this.partitions.length;i<s;i++){var r=this.partitions[i];Pe(t,r),t.drawElements(t.TRIANGLE_STRIP,r.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}for(t.sphereBuffer.bindBuffers(t),i=0;i<2;i++){r=this.ends[i];var n=Wt.translate(Wt.identity(),[r.x,r.y,r.z]),o=e.proteins_tubeThickness/2;Wt.scale(n,[o,o,o]),t.shader.setMatrixUniforms(t,n),t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}},Gt=Te.structures.d3,Te.lib.vec3,Gt.UnitCell=function(t){function e(t,e,i,s){n.push(t[0],t[1],t[2]),n.push(e[0],e[1],e[2]),n.push(i[0],i[1],i[2]),n.push(s[0],s[1],s[2]);for(var r=0;r<4;r++)o.push(0,0,0)}this.unitCell=t;var n=[],o=[];e(t.o,t.x,t.xy,t.y),e(t.o,t.y,t.yz,t.z),e(t.o,t.z,t.xz,t.x),e(t.yz,t.y,t.xy,t.xyz),e(t.xyz,t.xz,t.z,t.yz),e(t.xy,t.x,t.xz,t.xyz);for(var i=[],s=0;s<6;s++){var r=4*s;i.push(r,1+r,1+r,2+r,2+r,3+r,3+r,r)}this.storeData(n,o,i)},(Gt.UnitCell.prototype=new Gt._Mesh).render=function(t,e){t.shader.setMatrixUniforms(t),this.bindBuffers(t),t.material.setDiffuseColor(t,e.shapes_color),t.lineWidth(e.shapes_lineWidth),t.drawElements(t.LINES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},function(t,e,i,s){t.Framebuffer=function(){};var r=t.Framebuffer.prototype;r.init=function(t){this.framebuffer=t.createFramebuffer()},r.setColorTexture=function(t,e,i){var s=void 0===i?0:i;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindTexture(t.TEXTURE_2D,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+s,t.TEXTURE_2D,e,0),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setColorRenderbuffer=function(t,e,i){var s=void 0===i?0:i;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+s,t.RENDERBUFFER,e),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setDepthTexture=function(t,e){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindTexture(t.TEXTURE_2D,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,e,0),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setDepthRenderbuffer=function(t,e){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.bind=function(t,e,i){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.viewport(0,0,e,i)}}(Te.structures.d3,Te.math,document),function(t,e,i,s){t.Renderbuffer=function(){};var r=t.Renderbuffer.prototype;r.init=function(t,e){this.renderbuffer=t.createRenderbuffer(),this.format=e},r.setParameter=function(t,e,i){this.width=e,this.height=i,t.bindRenderbuffer(t.RENDERBUFFER,this.renderbuffer),t.renderbufferStorage(t.RENDERBUFFER,this.format,this.width,this.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}}(Te.structures.d3,Te.math,document),function(t,e,l,i){e.SSAO=function(){};var s=e.SSAO.prototype;s.initSampleKernel=function(t){for(var e=[],i=0;i<t;i++){var s=2*l.random()-1,r=2*l.random()-1,n=2*l.random()-1,o=i/t,a=.1+.9*(o*o);s*=a,r*=a,n*=a,e.push(s,r,n)}this.sampleKernel=new Float32Array(e)},s.initNoiseTexture=function(t){for(var e=[],i=0;i<16;i++)e.push(2*l.random()-1),e.push(2*l.random()-1),e.push(0);this.noiseTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.noiseTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGB,4,4,0,t.RGB,t.FLOAT,new Float32Array(e)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null)}}(Te.math,Te.structures.d3,Math),function(t,e,i,s){t.Texture=function(){};var r=t.Texture.prototype;r.init=function(t,e,i,s){this.texture=t.createTexture(),this.type=e,this.internalFormat=i,this.format=void 0!==s?s:i,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)},r.setParameter=function(t,e,i){this.width=e,this.height=i,t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,null),t.bindTexture(t.TEXTURE_2D,null)}}(Te.structures.d3,Te.math,document),function(t,e,i,a,l){t._Shader=function(){};var s=t._Shader.prototype;s.useShaderProgram=function(t){t.useProgram(this.gProgram),t.shader=this},s.init=function(t){var e=this.getShader(t,"vertex-shader");e||(e=this.loadDefaultVertexShader(t));var i=this.getShader(t,"fragment-shader");i||(i=this.loadDefaultFragmentShader(t)),this.gProgram=t.createProgram(),t.attachShader(this.gProgram,e),t.attachShader(this.gProgram,i),this.onShaderAttached(t),t.linkProgram(this.gProgram),t.getProgramParameter(this.gProgram,t.LINK_STATUS)||alert("Could not initialize shaders: "+t.getProgramInfoLog(this.gProgram)),t.useProgram(this.gProgram),this.initUniformLocations(t),t.useProgram(null)},s.onShaderAttached=function(t){this.vertexPositionAttribute=0,this.vertexNormalAttribute=1,t.bindAttribLocation(this.gProgram,this.vertexPositionAttribute,"a_vertex_position"),t.bindAttribLocation(this.gProgram,this.vertexNormalAttribute,"a_vertex_normal")},s.getShaderFromStr=function(t,e,i){var s=t.createShader(e);return t.shaderSource(s,i),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS)?s:(alert(shaderScript.type+" "+t.getShaderInfoLog(s)),t.deleteShader(s),l)},s.enableAttribsArray=function(t){t.enableVertexAttribArray(this.vertexPositionAttribute)},s.disableAttribsArray=function(t){t.disableVertexAttribArray(this.vertexPositionAttribute)},s.getShader=function(t,e){var i=a.getElementById(e);if(!i)return l;for(var s=[],r=i.firstChild;r;)3===r.nodeType&&s.push(r.textContent),r=r.nextSibling;var n,o=s.join("");if("x-shader/x-fragment"===i.type)n=this.getShaderFromStr(t,t.FRAGMENT_SHADER,o);else{if("x-shader/x-vertex"!==i.type)return l;n=this.getShaderFromStr(t,t.VERTEX_SHADER,o)}return n},s.initUniformLocations=function(t){this.modelViewMatrixUniform=t.getUniformLocation(this.gProgram,"u_model_view_matrix"),this.projectionMatrixUniform=t.getUniformLocation(this.gProgram,"u_projection_matrix")},s.loadDefaultVertexShader=function(t){},s.loadDefaultFragmentShader=function(t){},s.setMatrixUniforms=function(t,e){e===l?this.setModelViewMatrix(t,t.modelViewMatrix):this.setModelViewMatrix(t,i.multiply(t.modelViewMatrix,e,[]))},s.setProjectionMatrix=function(t,e){t.uniformMatrix4fv(this.projectionMatrixUniform,!1,e)},s.setModelViewMatrix=function(t,e){t.uniformMatrix4fv(this.modelViewMatrixUniform,!1,e)},s.setMaterialAmbientColor=function(t,e){},s.setMaterialDiffuseColor=function(t,e){},s.setMaterialSpecularColor=function(t,e){},s.setMaterialShininess=function(t,e){},s.setMaterialAlpha=function(t,e){}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.FXAAShader=function(){};var n=t._Shader.prototype,o=t.FXAAShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.buffersizeUniform=t.getUniformLocation(this.gProgram,"u_buffersize"),this.antialiasUniform=t.getUniformLocation(this.gProgram,"u_antialias"),this.edgeThresholdUniform=t.getUniformLocation(this.gProgram,"u_edge_threshold"),this.edgeThresholdMinUniform=t.getUniformLocation(this.gProgram,"u_edge_threshold_min"),this.searchStepsUniform=t.getUniformLocation(this.gProgram,"u_search_steps"),this.searchThresholdUniform=t.getUniformLocation(this.gProgram,"u_search_threshold"),this.subpixCapUniform=t.getUniformLocation(this.gProgram,"u_subpix_cap"),this.subpixTrimUniform=t.getUniformLocation(this.gProgram,"u_subpix_trim")},o.setBuffersize=function(t,e,i){t.uniform2f(this.buffersizeUniform,e,i)},o.setAntialias=function(t,e){t.uniform1f(this.antialiasUniform,e)},o.setEdgeThreshold=function(t,e){t.uniform1f(this.edgeThresholdUniform,e)},o.setEdgeThresholdMin=function(t,e){t.uniform1f(this.edgeThresholdMinUniform,e)},o.setSearchSteps=function(t,e){t.uniform1i(this.searchStepsUniform,e)},o.setSearchThreshold=function(t,e){t.uniform1f(this.searchThresholdUniform,e)},o.setSubpixCap=function(t,e){t.uniform1f(this.subpixCapUniform,e)},o.setSubpixTrim=function(t,e){t.uniform1f(this.subpixTrimUniform,e)},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","const int fxaaMaxSearchSteps = 128;","uniform float u_edge_threshold;","uniform float u_edge_threshold_min;","uniform int u_search_steps;","uniform float u_search_threshold;","uniform float u_subpix_cap;","uniform float u_subpix_trim;","uniform sampler2D u_sampler0;","uniform vec2 u_buffersize;","uniform bool u_antialias;","varying vec2 v_texcoord;","float FxaaLuma(vec3 rgb) {","return rgb.y * (0.587/0.299) + rgb.x;","}","vec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {","return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);","}","vec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 off, vec2 rcpFrame) {","return texture2D(tex, pos + off * rcpFrame);","}","vec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {","float subpix_trim_scale = (1.0/(1.0 - u_subpix_trim));","vec3 rgbN = FxaaTexOff(tex, pos.xy, vec2( 0.,-1.), rcpFrame).xyz;","vec3 rgbW = FxaaTexOff(tex, pos.xy, vec2(-1., 0.), rcpFrame).xyz;","vec3 rgbM = FxaaTexOff(tex, pos.xy, vec2( 0., 0.), rcpFrame).xyz;","vec3 rgbE = FxaaTexOff(tex, pos.xy, vec2( 1., 0.), rcpFrame).xyz;","vec3 rgbS = FxaaTexOff(tex, pos.xy, vec2( 0., 1.), rcpFrame).xyz;","float lumaN = FxaaLuma(rgbN);","float lumaW = FxaaLuma(rgbW);","float lumaM = FxaaLuma(rgbM);","float lumaE = FxaaLuma(rgbE);","float lumaS = FxaaLuma(rgbS);","float rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));","float rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));","float range = rangeMax - rangeMin;","if(range < max(u_edge_threshold_min, rangeMax * u_edge_threshold)) {","return rgbM;","}","vec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;","float lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;","float rangeL = abs(lumaL - lumaM);","float blendL = max(0.0, (rangeL / range) - u_subpix_trim) * subpix_trim_scale;","blendL = min(u_subpix_cap, blendL);","vec3 rgbNW = FxaaTexOff(tex, pos.xy, vec2(-1.,-1.), rcpFrame).xyz;","vec3 rgbNE = FxaaTexOff(tex, pos.xy, vec2( 1.,-1.), rcpFrame).xyz;","vec3 rgbSW = FxaaTexOff(tex, pos.xy, vec2(-1., 1.), rcpFrame).xyz;","vec3 rgbSE = FxaaTexOff(tex, pos.xy, vec2( 1., 1.), rcpFrame).xyz;","rgbL += (rgbNW + rgbNE + rgbSW + rgbSE);","rgbL *= vec3(1.0/9.0);","float lumaNW = FxaaLuma(rgbNW);","float lumaNE = FxaaLuma(rgbNE);","float lumaSW = FxaaLuma(rgbSW);","float lumaSE = FxaaLuma(rgbSE);","float edgeVert =","abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +","abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +","abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));","float edgeHorz =","abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +","abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +","abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));","bool horzSpan = edgeHorz >= edgeVert;","float lengthSign = horzSpan ? -rcpFrame.y : -rcpFrame.x;","if(!horzSpan) {","lumaN = lumaW;","lumaS = lumaE;","}","float gradientN = abs(lumaN - lumaM);","float gradientS = abs(lumaS - lumaM);","lumaN = (lumaN + lumaM) * 0.5;","lumaS = (lumaS + lumaM) * 0.5;","if (gradientN < gradientS) {","lumaN = lumaS;","lumaN = lumaS;","gradientN = gradientS;","lengthSign *= -1.0;","}","vec2 posN;","posN.x = pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);","posN.y = pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);","gradientN *= u_search_threshold;","vec2 posP = posN;","vec2 offNP = horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);","float lumaEndN = lumaN;","float lumaEndP = lumaN;","bool doneN = false;","bool doneP = false;","posN += offNP * vec2(-1.0, -1.0);","posP += offNP * vec2( 1.0,  1.0);","for(int i = 0; i < fxaaMaxSearchSteps; i++) {","if(i >= u_search_steps) break;","if(!doneN) {","lumaEndN = FxaaLuma(texture2D(tex, posN.xy).xyz);","}","if(!doneP) {","lumaEndP = FxaaLuma(texture2D(tex, posP.xy).xyz);","}","doneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);","doneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);","if(doneN && doneP) {","break;","}","if(!doneN) {","posN -= offNP;","}","if(!doneP) {","posP += offNP;","}","}","float dstN = horzSpan ? pos.x - posN.x : pos.y - posN.y;","float dstP = horzSpan ? posP.x - pos.x : posP.y - pos.y;","bool directionN = dstN < dstP;","lumaEndN = directionN ? lumaEndN : lumaEndP;","if(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0)) {","lengthSign = 0.0;","}","float spanLength = (dstP + dstN);","dstN = directionN ? dstN : dstP;","float subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;","vec3 rgbF = texture2D(tex, vec2(","pos.x + (horzSpan ? 0.0 : subPixelOffset),","pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;","return FxaaLerp3(rgbL, rgbF, blendL);","}","void main() {","gl_FragColor = texture2D(u_sampler0, v_texcoord);","if(u_antialias) {","gl_FragColor.xyz = FxaaPixelShader(v_texcoord, u_sampler0, 1. / u_buffersize).xyz;","}","}"].join("\n");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.LabelShader=function(){};var n=t._Shader.prototype,o=t.LabelShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.dimensionUniform=t.getUniformLocation(this.gProgram,"u_dimension")},o.onShaderAttached=function(t){n.onShaderAttached.call(this,t),this.vertexTexCoordAttribute=2,t.bindAttribLocation(this.gProgram,this.vertexTexCoordAttribute,"a_vertex_texcoord")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","attribute vec3 a_vertex_normal;","attribute vec2 a_vertex_texcoord;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","uniform vec2 u_dimension;","varying vec2 v_texcoord;","void main() {","gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);","vec4 depth_pos = vec4(gl_Position);","depth_pos.z += a_vertex_normal.z;","gl_Position = u_projection_matrix * gl_Position;","depth_pos = u_projection_matrix * depth_pos;","gl_Position /= gl_Position.w;","gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;","gl_Position.z = depth_pos.z / depth_pos.w;","v_texcoord = a_vertex_texcoord;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=[t.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;","uniform sampler2D u_image;","varying vec2 v_texcoord;","void main(void) {","gl_FragColor = texture2D(u_image, v_texcoord);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.enableAttribsArray=function(t){n.enableAttribsArray.call(this,t),t.enableVertexAttribArray(this.vertexNormalAttribute),t.enableVertexAttribArray(this.vertexTexCoordAttribute)},o.disableAttribsArray=function(t){n.disableAttribsArray.call(this,t),t.disableVertexAttribArray(this.vertexNormalAttribute),t.disableVertexAttribArray(this.vertexTexCoordAttribute)},o.setDimension=function(t,e,i){t.uniform2f(this.dimensionUniform,e,i)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.LightingShader=function(){};var n=t._Shader.prototype,o=t.LightingShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.positionSampleUniform=t.getUniformLocation(this.gProgram,"u_position_sample"),this.colorSampleUniform=t.getUniformLocation(this.gProgram,"u_color_sample"),this.ssaoSampleUniform=t.getUniformLocation(this.gProgram,"u_ssao_sample"),this.outlineSampleUniform=t.getUniformLocation(this.gProgram,"u_outline_sample")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","uniform sampler2D u_position_sample;","uniform sampler2D u_color_sample;","uniform sampler2D u_ssao_sample;","uniform sampler2D u_outline_sample;","varying vec2 v_texcoord;","void main() {","vec4 position = texture2D(u_position_sample, v_texcoord);","vec4 color = texture2D(u_color_sample, v_texcoord);","vec4 ao = texture2D(u_ssao_sample, v_texcoord);","float outline = texture2D(u_outline_sample, v_texcoord).r;","if(position.w == 0. && outline == 1.) {","return;","}","gl_FragColor = vec4(color.rgb * ao.r * outline, 1.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,s,r,e,i){t.NormalShader=function(){};var n=t._Shader.prototype,o=t.NormalShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.normalMatrixUniform=t.getUniformLocation(this.gProgram,"u_normal_matrix")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","attribute vec3 a_vertex_normal;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","uniform mat3 u_normal_matrix;","varying vec3 v_normal;","void main() {","v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;","gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","varying vec3 v_normal;","void main(void) {","vec3 normal = length(v_normal)==0. ? vec3(0., 0., 1.) : normalize(v_normal);","gl_FragColor = vec4(normal, 0.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.enableAttribsArray=function(t){n.enableAttribsArray.call(this,t),t.enableVertexAttribArray(this.vertexNormalAttribute)},o.disableAttribsArray=function(t){n.disableAttribsArray.call(this,t),t.disableVertexAttribArray(this.vertexNormalAttribute)},o.setModelViewMatrix=function(t,e){n.setModelViewMatrix.call(this,t,e);var i=s.transpose(r.toInverseMat3(e,[]));t.uniformMatrix3fv(this.normalMatrixUniform,!1,i)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.OutlineShader=function(){};var n=t._Shader.prototype,o=t.OutlineShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.normalSampleUniform=t.getUniformLocation(this.gProgram,"u_normal_sample"),this.depthSampleUniform=t.getUniformLocation(this.gProgram,"u_depth_sample"),this.gbufferTextureSizeUniform=t.getUniformLocation(this.gProgram,"u_gbuffer_texture_size"),this.normalThresholdUniform=t.getUniformLocation(this.gProgram,"u_normal_threshold"),this.depthThresholdUniform=t.getUniformLocation(this.gProgram,"u_depth_threshold"),this.thicknessUniform=t.getUniformLocation(this.gProgram,"u_thickness")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","uniform sampler2D u_normal_sample;","uniform sampler2D u_depth_sample;","uniform float u_normal_threshold;","uniform float u_depth_threshold;","uniform float u_thickness;","uniform vec2 u_gbuffer_texture_size;","varying vec2 v_texcoord;","void main() {","vec3 normal = texture2D(u_normal_sample, v_texcoord).xyz;","float depth = texture2D(u_depth_sample, v_texcoord).r;","vec2 texelSize = u_thickness/u_gbuffer_texture_size * .5;","vec2 offsets[8];","offsets[0] = vec2(-texelSize.x, -texelSize.y);","offsets[1] = vec2(-texelSize.x, 0);","offsets[2] = vec2(-texelSize.x, texelSize.y);","offsets[3] = vec2(0, -texelSize.y);","offsets[4] = vec2(0,  texelSize.y);","offsets[5] = vec2(texelSize.x, -texelSize.y);","offsets[6] = vec2(texelSize.x, 0);","offsets[7] = vec2(texelSize.x, texelSize.y);","float edge = 0.;","for (int i = 0; i < 8; i++) {","vec3 sampleNorm = texture2D(u_normal_sample, v_texcoord + offsets[i]).xyz;","if(normal == vec3(.0, .0, .0)) {","if(sampleNorm != vec3(.0, .0, .0)) {","edge = 1.0;","break;","}","continue;","}","if (dot(sampleNorm, normal) < u_normal_threshold) {","edge = 1.0;","break;","}","float sampleDepth = texture2D(u_depth_sample, v_texcoord + offsets[i]).r;","if (abs(sampleDepth - depth) > u_depth_threshold) {","edge = 1.0;","break;","}","}","edge = 1. - edge;","gl_FragColor = vec4(edge, edge, edge, 1.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.setGbufferTextureSize=function(t,e,i){t.uniform2f(this.gbufferTextureSizeUniform,e,i)},o.setNormalThreshold=function(t,e){t.uniform1f(this.normalThresholdUniform,e)},o.setDepthThreshold=function(t,e){t.uniform1f(this.depthThresholdUniform,e)},o.setThickness=function(t,e){t.uniform1f(this.thicknessUniform,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,s,r,e,i){t.PhongShader=function(){};var n=t._Shader.prototype,o=t.PhongShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.shadowUniform=t.getUniformLocation(this.gProgram,"u_shadow"),this.flatColorUniform=t.getUniformLocation(this.gProgram,"u_flat_color"),this.normalMatrixUniform=t.getUniformLocation(this.gProgram,"u_normal_matrix"),this.lightModelViewMatrixUniform=t.getUniformLocation(this.gProgram,"u_light_model_view_matrix"),this.lightProjectionMatrixUniform=t.getUniformLocation(this.gProgram,"u_light_projection_matrix"),this.lightDiffuseColorUniform=t.getUniformLocation(this.gProgram,"u_light_diffuse_color"),this.lightSpecularColorUniform=t.getUniformLocation(this.gProgram,"u_light_specular_color"),this.lightDirectionUniform=t.getUniformLocation(this.gProgram,"u_light_direction"),this.materialAmbientColorUniform=t.getUniformLocation(this.gProgram,"u_material_ambient_color"),this.materialDiffuseColorUniform=t.getUniformLocation(this.gProgram,"u_material_diffuse_color"),this.materialSpecularColorUniform=t.getUniformLocation(this.gProgram,"u_material_specular_color"),this.materialShininessUniform=t.getUniformLocation(this.gProgram,"u_material_shininess"),this.materialAlphaUniform=t.getUniformLocation(this.gProgram,"u_material_alpha"),this.fogModeUniform=t.getUniformLocation(this.gProgram,"u_fog_mode"),this.fogColorUniform=t.getUniformLocation(this.gProgram,"u_fog_color"),this.fogStartUniform=t.getUniformLocation(this.gProgram,"u_fog_start"),this.fogEndUniform=t.getUniformLocation(this.gProgram,"u_fog_end"),this.fogDensityUniform=t.getUniformLocation(this.gProgram,"u_fog_density"),this.shadowDepthSampleUniform=t.getUniformLocation(this.gProgram,"u_shadow_depth_sample"),this.shadowTextureSizeUniform=t.getUniformLocation(this.gProgram,"u_shadow_texture_size"),this.shadowIntensityUniform=t.getUniformLocation(this.gProgram,"u_shadow_intensity"),this.gammaCorrectionUniform=t.getUniformLocation(this.gProgram,"u_gamma_inverted"),this.pointSizeUniform=t.getUniformLocation(this.gProgram,"u_point_size")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","attribute vec3 a_vertex_normal;","uniform vec3 u_light_diffuse_color;","uniform vec3 u_material_ambient_color;","uniform vec3 u_material_diffuse_color;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","uniform mat3 u_normal_matrix;","uniform mat4 u_light_model_view_matrix;","uniform mat4 u_light_projection_matrix;","uniform bool u_shadow;","varying vec3 v_viewpos;","varying vec4 v_shadcoord;","varying vec3 v_diffuse;","varying vec3 v_ambient;","varying vec3 v_normal;","uniform float u_point_size;","void main() {","v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;","v_ambient = u_material_ambient_color;","v_diffuse = u_material_diffuse_color * u_light_diffuse_color;","if(u_shadow) {","v_shadcoord = u_light_projection_matrix * u_light_model_view_matrix * vec4(a_vertex_position, 1.);","v_shadcoord /= v_shadcoord.w;","}","vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);","v_viewpos = viewPos.xyz / viewPos.w;","gl_Position = u_projection_matrix * viewPos;","gl_Position /= gl_Position.w;","gl_PointSize = u_point_size;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=[t.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;","uniform vec3 u_light_specular_color;","uniform vec3 u_light_direction;","uniform vec3 u_material_specular_color;","uniform float u_material_shininess;","uniform float u_material_alpha;","uniform int u_fog_mode;","uniform vec3 u_fog_color;","uniform float u_fog_density;","uniform float u_fog_start;","uniform float u_fog_end;","uniform bool u_shadow;","uniform float u_shadow_intensity;","uniform bool u_flat_color;","uniform float u_gamma_inverted;","uniform sampler2D u_shadow_depth_sample;","uniform vec2 u_shadow_texture_size;","varying vec3 v_viewpos;","varying vec4 v_shadcoord;","varying vec3 v_diffuse;","varying vec3 v_ambient;","varying vec3 v_normal;","\n#ifndef CWC_DEPTH_TEX\n","float unpack (vec4 colour) {","const vec4 bitShifts = vec4(1.,","1. / 255.,","1. / (255. * 255.),","1. / (255. * 255. * 255.));","return dot(colour, bitShifts);","}","\n#endif\n","float shadowMapDepth(vec4 shadowMapColor) {","float zShadowMap;","\n#ifdef CWC_DEPTH_TEX\n","zShadowMap = shadowMapColor.r;","\n#else\n","zShadowMap = unpack(shadowMapColor);","\n#endif\n","return zShadowMap;","}","void main(void) {","vec3 color = v_diffuse;","if(length(v_normal)!=0.){","vec3 normal = normalize(v_normal);","vec3 lightDir = normalize(-u_light_direction);","float nDotL = dot(normal, lightDir);","float shadow = 0.0;","if(u_shadow) {","vec3 depthCoord = .5 + v_shadcoord.xyz / v_shadcoord.w * .5;","if(depthCoord.z <= 1. && depthCoord.z >= 0.) {","float bias = max(.05 * (1. - nDotL), .005);","vec2 texelSize = 1. / u_shadow_texture_size;","for(int x = -1; x <= 1; ++x) {","for(int y = -1; y <= 1; ++y)  {","vec4 shadowMapColor = texture2D(u_shadow_depth_sample, depthCoord.xy + vec2(x, y) * texelSize);","float zShadowMap = shadowMapDepth(shadowMapColor);","shadow += zShadowMap + bias < depthCoord.z ? 1. : 0.;","}","}","shadow /= 9.;","shadow *= u_shadow_intensity;","}","}","if(!u_flat_color) {","vec3 viewDir = normalize(-v_viewpos);","vec3 halfDir = normalize(lightDir + viewDir);","float nDotHV = max(dot(halfDir, normal), 0.);","vec3 specular = u_material_specular_color * u_light_specular_color;","color*=max(nDotL, 0.);","color+=specular * pow(nDotHV, u_material_shininess);","}","color = (1.-shadow)*color+v_ambient;","}","gl_FragColor = vec4(pow(color, vec3(u_gamma_inverted)), u_material_alpha);","if(u_fog_mode != 0){","float fogCoord = 1.-clamp((u_fog_end - gl_FragCoord.z/gl_FragCoord.w) / (u_fog_end - u_fog_start), 0., 1.);","float fogFactor = 1.;","if(u_fog_mode == 1){","fogFactor = 1.-fogCoord;","}","else if(u_fog_mode == 2) {","fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);","}","else if(u_fog_mode == 3) {","fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);","}","gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);","}","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.enableAttribsArray=function(t){n.enableAttribsArray.call(this,t),t.enableVertexAttribArray(this.vertexNormalAttribute)},o.disableAttribsArray=function(t){n.disableAttribsArray.call(this,t),t.disableVertexAttribArray(this.vertexNormalAttribute)},o.setMatrixUniforms=function(t,e){if(void 0===e)this.setModelViewMatrix(t,t.modelViewMatrix),this.setLightModelViewMatrix(t,t.lightViewMatrix);else{var i=r.multiply(t.modelViewMatrix,e,[]),s=r.multiply(t.lightViewMatrix,e,[]);this.setModelViewMatrix(t,i),this.setLightModelViewMatrix(t,s)}},o.setModelViewMatrix=function(t,e){n.setModelViewMatrix.call(this,t,e);var i=s.transpose(r.toInverseMat3(e,[]));t.uniformMatrix3fv(this.normalMatrixUniform,!1,i)},o.setFlatColor=function(t,e){t.uniform1i(this.flatColorUniform,e)},o.setShadow=function(t,e){t.uniform1i(this.shadowUniform,e)},o.setFogMode=function(t,e){t.uniform1i(this.fogModeUniform,e)},o.setFogColor=function(t,e){t.uniform3fv(this.fogColorUniform,e)},o.setFogStart=function(t,e){t.uniform1f(this.fogStartUniform,e)},o.setFogEnd=function(t,e){t.uniform1f(this.fogEndUniform,e)},o.setFogDensity=function(t,e){t.uniform1f(this.fogDensityUniform,e)},o.setMaterialAmbientColor=function(t,e){t.uniform3fv(this.materialAmbientColorUniform,e)},o.setMaterialDiffuseColor=function(t,e){t.uniform3fv(this.materialDiffuseColorUniform,e)},o.setMaterialSpecularColor=function(t,e){t.uniform3fv(this.materialSpecularColorUniform,e)},o.setMaterialShininess=function(t,e){t.uniform1f(this.materialShininessUniform,e)},o.setMaterialAlpha=function(t,e){t.uniform1f(this.materialAlphaUniform,e)},o.setLightDiffuseColor=function(t,e){t.uniform3fv(this.lightDiffuseColorUniform,e)},o.setLightSpecularColor=function(t,e){t.uniform3fv(this.lightSpecularColorUniform,e)},o.setLightDirection=function(t,e){t.uniform3fv(this.lightDirectionUniform,e)},o.setLightModelViewMatrix=function(t,e){t.uniformMatrix4fv(this.lightModelViewMatrixUniform,!1,e)},o.setLightProjectionMatrix=function(t,e){t.uniformMatrix4fv(this.lightProjectionMatrixUniform,!1,e)},o.setShadowTextureSize=function(t,e,i){t.uniform2f(this.shadowTextureSizeUniform,e,i)},o.setShadowIntensity=function(t,e){t.uniform1f(this.shadowIntensityUniform,e)},o.setGammaCorrection=function(t,e){t.uniform1f(this.gammaCorrectionUniform,1/e)},o.setPointSize=function(t,e){t.uniform1f(this.pointSizeUniform,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.PickShader=function(){};var n=t._Shader.prototype,o=t.PickShader.prototype=new t._Shader;o.initUniformLocations=function(t){n.initUniformLocations.call(this,t),this.materialDiffuseColorUniform=t.getUniformLocation(this.gProgram,"u_material_diffuse_color")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","void main() {","gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);","gl_Position /= gl_Position.w;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=[t.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;","uniform vec3 u_material_diffuse_color;","void main(void) {","gl_FragColor = vec4(u_material_diffuse_color, 1.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.setMaterialDiffuseColor=function(t,e){t.uniform3fv(this.materialDiffuseColorUniform,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.PositionShader=function(){};t._Shader.prototype;var n=t.PositionShader.prototype=new t._Shader;n.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","varying vec4 v_position;","void main() {","vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);","gl_Position = u_projection_matrix * viewPos;","v_position = viewPos / viewPos.w;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},n.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","varying vec4 v_position;","void main(void) {","gl_FragColor = v_position;","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(t,e,i,s,r){t.QuadShader=function(){};var n=t.QuadShader.prototype=new t._Shader;n.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},n.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","uniform sampler2D u_image;","varying vec2 v_texcoord;","void main() {","gl_FragColor = texture2D(u_image, v_texcoord);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Te.structures.d3,Te.lib.mat3,Te.lib.mat4,document),function(W,t,e,q,j,G,i){function X(t,e,i){this.i1=t,this.i2=e,this.i3=i}function V(t,e,i,s,r,n){for(var o=t[0]*n+i-n,a=t[1]*n+s-n,l=t[2]*n+r-n,h=-1,u=0,c=e.length;u<c;u++){var f=e[u];if(G.abs(f.x-o)<.001&&G.abs(f.y-a)<.001&&G.abs(f.z-l)<.001){h=u;break}}return-1==h&&(h=e.length,e.push(new W.Atom("C",o,a,l))),h}t._Surface=function(){};var s=t._Surface.prototype=new t._Mesh;s.generate=function(t,e,i,s,r,n,o,a){for(var l=[],h=r[4]-s,u=0;u<a;u++){for(var c=r[2]-s,f=0;f<o;f++){for(var d=r[0]-s,m=0;m<n;m++)l.push(this.calculate(d,c,h)),d+=s;c+=s}h+=s}return l},s.build=function(t,e,i){for(var s=[],r=[],n=[],o=function(t,e){for(var i=[1/0,-1/0,1/0,-1/0,1/0,-1/0],s=e+2,r=0,n=t.length;r<n;r++){var o=t[r];i[0]=G.min(i[0],o.x-s),i[1]=G.max(i[1],o.x+s),i[2]=G.min(i[2],o.y-s),i[3]=G.max(i[3],o.y+s),i[4]=G.min(i[4],o.z-s),i[5]=G.max(i[5],o.z+s)}return i}(t,e),a=o[1]-o[0],l=o[3]-o[2],h=o[5]-o[4],u=G.min(a,G.min(l,h))/i,c=2+G.ceil(a/u),f=2+G.ceil(l/u),d=2+G.ceil(h/u),m=this.generate(a,l,h,u,o,c,f,d),p=q(m,[c,f,d]),g=[],_=[],v=0,x=p.vertices.length;v<x;v++)_.push(V(p.vertices[v],g,o[0],o[2],o[4],u));var b=[];for(v=0,x=p.faces.length;v<x;v++){var y=p.faces[v],w=_[y[0]],D=_[y[1]],S=_[y[2]];b.push(new X(w,D,S)),n.push(w,D,S)}var T=[];for(v=0,x=g.length;v<x;v++){for(var C=[],A=0,E=b.length;A<E;A++){(H=b[A]).i1!==v&&H.i2!==v&&H.i3!==v||(H.i1!=v&&-1===C.indexOf(H.i1)&&C.push(H.i1),H.i2!=v&&-1===C.indexOf(H.i2)&&C.push(H.i2),H.i3!=v&&-1===C.indexOf(H.i3)&&C.push(H.i3))}T.push(C)}var F=[];for(v=0,x=g.length;v<x;v++){var P=g[v],R=(C=T[v],new W.Atom);if(C.length<3)R.x=P.x,R.y=P.y,R.z=P.z;else{var B=1;C.length<5&&(B=.5);for(A=0,E=C.length;A<E;A++){var M=g[C[A]];R.x+=M.x,R.y+=M.y,R.z+=M.z}R.x+=P.x*B,R.y+=P.y*B,R.z+=P.z*B;var I=1/(B+C.length);R.x*=I,R.y*=I,R.z*=I}F.push(R)}for(v=0,x=(g=F).length;v<x;v++){P=g[v];s.push(P.x,P.y,P.z)}for(v=0,x=b.length;v<x;v++){var L=g[(H=b[v]).i1],N=g[H.i2],k=g[H.i3],z=[N.x-L.x,N.y-L.y,N.z-L.z],O=[k.x-L.x,k.y-L.y,k.z-L.z];j.cross(z,O),isNaN(z[0])&&(z=[0,0,0]),H.normal=z}for(v=0,x=g.length;v<x;v++){var U=[0,0,0];for(A=0,E=b.length;A<E;A++){var H;(H=b[A]).i1!==v&&H.i2!==v&&H.i3!==v||(U[0]+=H.normal[0],U[1]+=H.normal[1],U[2]+=H.normal[2])}j.normalize(U),r.push(U[0],U[1],U[2])}this.storeData(s,r,n)},s.render=function(t,e){this.specs&&(e=this.specs),e.surfaces_display&&(t.shader.setMatrixUniforms(t),this.bindBuffers(t),t.material.setTempColors(t,e.surfaces_materialAmbientColor_3D,e.surfaces_color,e.surfaces_materialSpecularColor_3D,e.surfaces_materialShininess_3D),t.material.setAlpha(t,e.surfaces_alpha),"Dots"===e.surfaces_style?(t.shader.setPointSize(t,e.shapes_pointSize),t.drawElements(t.POINTS,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)):"Mesh"===e.surfaces_style?(t.lineWidth(e.shapes_lineWidth),t.drawElements(t.LINES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)):t.drawElements(t.TRIANGLES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0))}}(Te.structures,Te.structures.d3,Te.ELEMENT,Te.lib.MarchingCubes,Te.lib.vec3,Math),Xt=Te.structures,Vt=Te.structures.d3,Yt=Te.ELEMENT,Zt=Math,Vt.SASSurface=function(t,e,i){this.atoms=t,this.probeRadius=e,this.resolution=i,this.build(t,e,i)},(Vt.SASSurface.prototype=new Vt._Surface).calculate=function(t,e,i){for(var s=1/0,r=new Xt.Atom("C",t,e,i),n=0,o=this.atoms.length;n<o;n++){var a=this.atoms[n],l=Yt[a.label]&&0!==Yt[a.label].vdWRadius?Yt[a.label].vdWRadius:2,h=a.distance3D(r)-this.probeRadius-l;s=Zt.min(s,h)}return s},$t=Te.structures,Qt=Te.structures.d3,Jt=Te.ELEMENT,Kt=Math,Qt.VDWSurface=function(t,e){this.atoms=t,this.probeRadius=0,this.resolution=e,this.build(t,0,e)},(Qt.VDWSurface.prototype=new Qt._Surface).calculate=function(t,e,i){for(var s=1/0,r=new $t.Atom("C",t,e,i),n=0,o=this.atoms.length;n<o;n++){var a=this.atoms[n],l=Jt[a.label]&&0!==Jt[a.label].vdWRadius?Jt[a.label].vdWRadius:2,h=a.distance3D(r)-l;s=Kt.min(s,h)}return s},function(t,l,h,e){t.Plate=function(t){for(this.lanes=new Array(t),i=0,ii=t;i<ii;i++)this.lanes[i]=[]};var r=t.Plate.prototype;r.sort=function(){for(i=0,ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(t,e){return t-e})},r.draw=function(t,e){var r=t.canvas.width,n=t.canvas.height;for(this.origin=9*n/10,this.front=n/10,this.laneLength=this.origin-this.front,t.strokeStyle="#000000",t.beginPath(),t.moveTo(0,this.front),t.lineTo(r,this.front),t.setLineDash([3]),t.stroke(),t.setLineDash([]),t.beginPath(),t.moveTo(0,this.origin),t.lineTo(r,this.origin),t.closePath(),t.stroke(),i=0,ii=this.lanes.length;i<ii;i++){var o=(i+1)*r/(ii+1);for(t.beginPath(),t.moveTo(o,this.origin),t.lineTo(o,this.origin+3),t.closePath(),t.stroke(),s=0,ss=this.lanes[i].length;s<ss;s++){var a=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case"compact":t.beginPath(),t.arc(o,a,3,0,2*h.PI,!1),t.closePath();break;case"expanded":t.beginPath(),t.arc(o,a,7,0,2*h.PI,!1),t.closePath();break;case"trailing":break;case"widened":l.contextEllipse(t,o-18,a-10,36,10);break;case"cresent":t.beginPath(),t.arc(o,a,9,0,h.PI,!0),t.closePath()}switch(this.lanes[i][s].style){case"solid":t.fillStyle="#000000",t.fill();break;case"transparent":t.stroke()}}}},t.Plate.Spot=function(t,e,i){this.type=t,this.rf=e,this.style=i||"solid"}}(Te.structures,Te.extensions,Math),function(e,t,i,s,r){e.default_backgroundColor="#FFFFFF",e.default_scale=1,e.default_rotateAngle=0,e.default_bondLength_2D=20,e.default_angstromsPerBondLength=1.25,e.default_lightDirection_3D=[-.1,-.1,-1],e.default_lightDiffuseColor_3D="#FFFFFF",e.default_lightSpecularColor_3D="#FFFFFF",e.default_projectionPerspective_3D=!0,e.default_projectionPerspectiveVerticalFieldOfView_3D=45,e.default_projectionOrthoWidth_3D=40,e.default_projectionWidthHeightRatio_3D=void 0,e.default_projectionFrontCulling_3D=.1,e.default_projectionBackCulling_3D=1e4,e.default_cullBackFace_3D=!0,e.default_fog_mode_3D=0,e.default_fog_color_3D="#000000",e.default_fog_start_3D=0,e.default_fog_end_3D=1,e.default_fog_density_3D=1,e.default_shadow_3D=!1,e.default_shadow_intensity_3D=.85,e.default_flat_color_3D=!1,e.default_antialias_3D=!0,e.default_gammaCorrection_3D=2.2,e.default_colorHover="#885110",e.default_colorSelect="#0060B2",e.default_colorError="#c10000",e.default_colorPreview="#00FF00",e.default_ssao_3D=!1,e.default_ssao_kernel_radius=17,e.default_ssao_kernel_samples=32,e.default_ssao_power=1,e.default_outline_3D=!1,e.default_outline_thickness=1,e.default_outline_normal_threshold=.85,e.default_outline_depth_threshold=.1,e.default_fxaa_edgeThreshold=1/16,e.default_fxaa_edgeThresholdMin=1/12,e.default_fxaa_searchSteps=64,e.default_fxaa_searchThreshold=.25,e.default_fxaa_subpixCap=1,e.default_fxaa_subpixTrim=0,e.default_atoms_display=!0,e.default_atoms_color="#000000",e.default_atoms_font_size_2D=12,e.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],e.default_atoms_font_bold_2D=!1,e.default_atoms_font_italic_2D=!1,e.default_atoms_circles_2D=!1,e.default_atoms_circleDiameter_2D=10,e.default_atoms_circleBorderWidth_2D=1,e.default_atoms_lonePairDistance_2D=8,e.default_atoms_lonePairSpread_2D=4,e.default_atoms_lonePairDiameter_2D=1,e.default_atoms_useJMOLColors=!1,e.default_atoms_usePYMOLColors=!1,e.default_atoms_HBlack_2D=!0,e.default_atoms_implicitHydrogens_2D=!0,e.default_atoms_displayTerminalCarbonLabels_2D=!1,e.default_atoms_showHiddenCarbons_2D=!0,e.default_atoms_showAttributedCarbons_2D=!0,e.default_atoms_displayAllCarbonLabels_2D=!1,e.default_atoms_resolution_3D=30,e.default_atoms_sphereDiameter_3D=.8,e.default_atoms_useVDWDiameters_3D=!1,e.default_atoms_vdwMultiplier_3D=1,e.default_atoms_materialAmbientColor_3D="#000000",e.default_atoms_materialSpecularColor_3D="#555555",e.default_atoms_materialShininess_3D=32,e.default_atoms_nonBondedAsStars_3D=!1,e.default_atoms_displayLabels_3D=!1,e.default_bonds_display=!0,e.default_bonds_color="#000000",e.default_bonds_width_2D=1,e.default_bonds_useAbsoluteSaturationWidths_2D=!0,e.default_bonds_saturationWidth_2D=.2,e.default_bonds_saturationWidthAbs_2D=5,e.default_bonds_ends_2D="round",e.default_bonds_splitColor=!1,e.default_bonds_colorGradient=!1,e.default_bonds_saturationAngle_2D=i.PI/3,e.default_bonds_symmetrical_2D=!1,e.default_bonds_clearOverlaps_2D=!1,e.default_bonds_overlapClearWidth_2D=.5,e.default_bonds_atomLabelBuffer_2D=1,e.default_bonds_wedgeThickness_2D=6,e.default_bonds_wavyLength_2D=4,e.default_bonds_hashWidth_2D=1,e.default_bonds_hashSpacing_2D=2.5,e.default_bonds_dotSize_2D=2,e.default_bonds_lewisStyle_2D=!1,e.default_bonds_showBondOrders_3D=!1,e.default_bonds_resolution_3D=30,e.default_bonds_renderAsLines_3D=!1,e.default_bonds_cylinderDiameter_3D=.3,e.default_bonds_pillLatitudeResolution_3D=10,e.default_bonds_pillLongitudeResolution_3D=20,e.default_bonds_pillHeight_3D=.3,e.default_bonds_pillSpacing_3D=.1,e.default_bonds_pillDiameter_3D=.3,e.default_bonds_materialAmbientColor_3D="#000000",e.default_bonds_materialSpecularColor_3D="#555555",e.default_bonds_materialShininess_3D=32,e.default_proteins_displayRibbon=!0,e.default_proteins_displayBackbone=!1,e.default_proteins_backboneThickness=1.5,e.default_proteins_backboneColor="#CCCCCC",e.default_proteins_ribbonCartoonize=!1,e.default_proteins_displayPipePlank=!1,e.default_proteins_residueColor="none",e.default_proteins_primaryColor="#FF0D0D",e.default_proteins_secondaryColor="#FFFF30",e.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",e.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",e.default_proteins_ribbonCartoonSheetColor="#E8BB99",e.default_proteins_tubeColor="#FF0D0D",e.default_proteins_tubeResolution_3D=15,e.default_proteins_ribbonThickness=.2,e.default_proteins_tubeThickness=.5,e.default_proteins_plankSheetWidth=3.5,e.default_proteins_cylinderHelixDiameter=4,e.default_proteins_verticalResolution=8,e.default_proteins_horizontalResolution=8,e.default_proteins_materialAmbientColor_3D="#000000",e.default_proteins_materialSpecularColor_3D="#555555",e.default_proteins_materialShininess_3D=32,e.default_nucleics_display=!0,e.default_nucleics_tubeColor="#CCCCCC",e.default_nucleics_baseColor="#C10000",e.default_nucleics_residueColor="none",e.default_nucleics_tubeThickness=1.5,e.default_nucleics_tubeResolution_3D=15,e.default_nucleics_verticalResolution=8,e.default_nucleics_materialAmbientColor_3D="#000000",e.default_nucleics_materialSpecularColor_3D="#555555",e.default_nucleics_materialShininess_3D=32,e.default_macro_displayAtoms=!1,e.default_macro_displayBonds=!1,e.default_macro_atomToLigandDistance=-1,e.default_macro_showWater=!1,e.default_macro_colorByChain=!1,e.default_macro_rainbowColors=["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],e.default_surfaces_display=!0,e.default_surfaces_alpha=.5,e.default_surfaces_style="Solid",e.default_surfaces_color="white",e.default_surfaces_materialAmbientColor_3D="#000000",e.default_surfaces_materialSpecularColor_3D="#000000",e.default_surfaces_materialShininess_3D=32,e.default_plots_color="#000000",e.default_plots_width=1,e.default_plots_showIntegration=!1,e.default_plots_integrationColor="#c10000",e.default_plots_integrationLineWidth=1,e.default_plots_showGrid=!1,e.default_plots_gridColor="gray",e.default_plots_gridLineWidth=.5,e.default_plots_showYAxis=!0,e.default_plots_flipXAxis=!1,e.default_text_font_size=12,e.default_text_font_families=["Helvetica","Arial","Dialog"],e.default_text_font_bold=!0,e.default_text_font_italic=!1,e.default_text_font_stroke_3D=!0,e.default_text_color="#000000",e.default_shapes_color="#000000",e.default_shapes_lineWidth=1,e.default_shapes_pointSize=2,e.default_shapes_arrowLength_2D=8,e.default_compass_display=!1,e.default_compass_axisXColor_3D="#FF0000",e.default_compass_axisYColor_3D="#00FF00",e.default_compass_axisZColor_3D="#0000FF",e.default_compass_size_3D=50,e.default_compass_resolution_3D=10,e.default_compass_displayText_3D=!0,e.default_compass_type_3D=0,e.default_measurement_update_3D=!1,e.default_measurement_angleBands_3D=10,e.default_measurement_displayText_3D=!0,t.VisualSpecifications=function(){this.backgroundColor=e.default_backgroundColor,this.scale=e.default_scale,this.rotateAngle=e.default_rotateAngle,this.bondLength_2D=e.default_bondLength_2D,this.angstromsPerBondLength=e.default_angstromsPerBondLength,this.lightDirection_3D=e.default_lightDirection_3D.slice(0),this.lightDiffuseColor_3D=e.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=e.default_lightSpecularColor_3D,this.projectionPerspective_3D=e.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=e.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=e.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=e.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=e.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=e.default_projectionBackCulling_3D,this.cullBackFace_3D=e.default_cullBackFace_3D,this.fog_mode_3D=e.default_fog_mode_3D,this.fog_color_3D=e.default_fog_color_3D,this.fog_start_3D=e.default_fog_start_3D,this.fog_end_3D=e.default_fog_end_3D,this.fog_density_3D=e.default_fog_density_3D,this.shadow_3D=e.default_shadow_3D,this.shadow_intensity_3D=e.default_shadow_intensity_3D,this.flat_color_3D=e.default_flat_color_3D,this.antialias_3D=e.default_antialias_3D,this.gammaCorrection_3D=e.default_gammaCorrection_3D,this.colorHover=e.default_colorHover,this.colorSelect=e.default_colorSelect,this.colorError=e.default_colorError,this.colorPreview=e.default_colorPreview,this.ssao_3D=e.default_ssao_3D,this.ssao_kernel_radius=e.default_ssao_kernel_radius,this.ssao_kernel_samples=e.default_ssao_kernel_samples,this.ssao_power=e.default_ssao_power,this.outline_3D=e.default_outline_3D,this.outline_normal_threshold=e.default_outline_normal_threshold,this.outline_depth_threshold=e.default_outline_depth_threshold,this.outline_thickness=e.default_outline_thickness,this.fxaa_edgeThreshold=e.default_fxaa_edgeThreshold,this.fxaa_edgeThresholdMin=e.default_fxaa_edgeThresholdMin,this.fxaa_searchSteps=e.default_fxaa_searchSteps,this.fxaa_searchThreshold=e.default_fxaa_searchThreshold,this.fxaa_subpixCap=e.default_fxaa_subpixCap,this.fxaa_subpixTrim=e.default_fxaa_subpixTrim,this.atoms_display=e.default_atoms_display,this.atoms_color=e.default_atoms_color,this.atoms_font_size_2D=e.default_atoms_font_size_2D,this.atoms_font_families_2D=e.default_atoms_font_families_2D.slice(0),this.atoms_font_bold_2D=e.default_atoms_font_bold_2D,this.atoms_font_italic_2D=e.default_atoms_font_italic_2D,this.atoms_circles_2D=e.default_atoms_circles_2D,this.atoms_circleDiameter_2D=e.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=e.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=e.default_atoms_lonePairDistance_2D,this.atoms_lonePairSpread_2D=e.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=e.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=e.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=e.default_atoms_usePYMOLColors,this.atoms_HBlack_2D=e.default_atoms_HBlack_2D,this.atoms_implicitHydrogens_2D=e.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=e.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=e.default_atoms_showHiddenCarbons_2D,this.atoms_showAttributedCarbons_2D=e.default_atoms_showAttributedCarbons_2D,this.atoms_displayAllCarbonLabels_2D=e.default_atoms_displayAllCarbonLabels_2D,this.atoms_resolution_3D=e.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=e.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=e.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=e.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=e.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=e.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=e.default_atoms_materialShininess_3D,this.atoms_nonBondedAsStars_3D=e.default_atoms_nonBondedAsStars_3D,this.atoms_displayLabels_3D=e.default_atoms_displayLabels_3D,this.bonds_display=e.default_bonds_display,this.bonds_color=e.default_bonds_color,this.bonds_width_2D=e.default_bonds_width_2D,this.bonds_useAbsoluteSaturationWidths_2D=e.default_bonds_useAbsoluteSaturationWidths_2D,this.bonds_saturationWidth_2D=e.default_bonds_saturationWidth_2D,this.bonds_saturationWidthAbs_2D=e.default_bonds_saturationWidthAbs_2D,this.bonds_ends_2D=e.default_bonds_ends_2D,this.bonds_splitColor=e.default_bonds_splitColor,this.bonds_colorGradient=e.default_bonds_colorGradient,this.bonds_saturationAngle_2D=e.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=e.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=e.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=e.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=e.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=e.default_bonds_wedgeThickness_2D,this.bonds_wavyLength_2D=e.default_bonds_wavyLength_2D,this.bonds_hashWidth_2D=e.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=e.default_bonds_hashSpacing_2D,this.bonds_dotSize_2D=e.default_bonds_dotSize_2D,this.bonds_lewisStyle_2D=e.default_bonds_lewisStyle_2D,this.bonds_showBondOrders_3D=e.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=e.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=e.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=e.default_bonds_cylinderDiameter_3D,this.bonds_pillHeight_3D=e.default_bonds_pillHeight_3D,this.bonds_pillLatitudeResolution_3D=e.default_bonds_pillLatitudeResolution_3D,this.bonds_pillLongitudeResolution_3D=e.default_bonds_pillLongitudeResolution_3D,this.bonds_pillSpacing_3D=e.default_bonds_pillSpacing_3D,this.bonds_pillDiameter_3D=e.default_bonds_pillDiameter_3D,this.bonds_materialAmbientColor_3D=e.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=e.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=e.default_bonds_materialShininess_3D,this.proteins_displayRibbon=e.default_proteins_displayRibbon,this.proteins_displayBackbone=e.default_proteins_displayBackbone,this.proteins_backboneThickness=e.default_proteins_backboneThickness,this.proteins_backboneColor=e.default_proteins_backboneColor,this.proteins_ribbonCartoonize=e.default_proteins_ribbonCartoonize,this.proteins_residueColor=e.default_proteins_residueColor,this.proteins_primaryColor=e.default_proteins_primaryColor,this.proteins_secondaryColor=e.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=e.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=e.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_tubeColor=e.default_proteins_tubeColor,this.proteins_tubeResolution_3D=e.default_proteins_tubeResolution_3D,this.proteins_displayPipePlank=e.default_proteins_displayPipePlank,this.proteins_ribbonCartoonSheetColor=e.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=e.default_proteins_ribbonThickness,this.proteins_tubeThickness=e.default_proteins_tubeThickness,this.proteins_plankSheetWidth=e.default_proteins_plankSheetWidth,this.proteins_cylinderHelixDiameter=e.default_proteins_cylinderHelixDiameter,this.proteins_verticalResolution=e.default_proteins_verticalResolution,this.proteins_horizontalResolution=e.default_proteins_horizontalResolution,this.proteins_materialAmbientColor_3D=e.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=e.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=e.default_proteins_materialShininess_3D,this.macro_displayAtoms=e.default_macro_displayAtoms,this.macro_displayBonds=e.default_macro_displayBonds,this.macro_atomToLigandDistance=e.default_macro_atomToLigandDistance,this.nucleics_display=e.default_nucleics_display,this.nucleics_tubeColor=e.default_nucleics_tubeColor,this.nucleics_baseColor=e.default_nucleics_baseColor,this.nucleics_residueColor=e.default_nucleics_residueColor,this.nucleics_tubeThickness=e.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=e.default_nucleics_tubeResolution_3D,this.nucleics_verticalResolution=e.default_nucleics_verticalResolution,this.nucleics_materialAmbientColor_3D=e.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=e.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=e.default_nucleics_materialShininess_3D,this.macro_showWater=e.default_macro_showWater,this.macro_colorByChain=e.default_macro_colorByChain,this.macro_rainbowColors=e.default_macro_rainbowColors.slice(0),this.surfaces_display=e.default_surfaces_display,this.surfaces_alpha=e.default_surfaces_alpha,this.surfaces_style=e.default_surfaces_style,this.surfaces_color=e.default_surfaces_color,this.surfaces_materialAmbientColor_3D=e.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=e.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=e.default_surfaces_materialShininess_3D,this.plots_color=e.default_plots_color,this.plots_width=e.default_plots_width,this.plots_showIntegration=e.default_plots_showIntegration,this.plots_integrationColor=e.default_plots_integrationColor,this.plots_integrationLineWidth=e.default_plots_integrationLineWidth,this.plots_showGrid=e.default_plots_showGrid,this.plots_gridColor=e.default_plots_gridColor,this.plots_gridLineWidth=e.default_plots_gridLineWidth,this.plots_showYAxis=e.default_plots_showYAxis,this.plots_flipXAxis=e.default_plots_flipXAxis,this.text_font_size=e.default_text_font_size,this.text_font_families=e.default_text_font_families.slice(0),this.text_font_bold=e.default_text_font_bold,this.text_font_italic=e.default_text_font_italic,this.text_font_stroke_3D=e.default_text_font_stroke_3D,this.text_color=e.default_text_color,this.shapes_color=e.default_shapes_color,this.shapes_lineWidth=e.default_shapes_lineWidth,this.shapes_pointSize=e.default_shapes_pointSize,this.shapes_arrowLength_2D=e.default_shapes_arrowLength_2D,this.compass_display=e.default_compass_display,this.compass_axisXColor_3D=e.default_compass_axisXColor_3D,this.compass_axisYColor_3D=e.default_compass_axisYColor_3D,this.compass_axisZColor_3D=e.default_compass_axisZColor_3D,this.compass_size_3D=e.default_compass_size_3D,this.compass_resolution_3D=e.default_compass_resolution_3D,this.compass_displayText_3D=e.default_compass_displayText_3D,this.compass_type_3D=e.default_compass_type_3D,this.measurement_update_3D=e.default_measurement_update_3D,this.measurement_angleBands_3D=e.default_measurement_angleBands_3D,this.measurement_displayText_3D=e.default_measurement_displayText_3D};var n=t.VisualSpecifications.prototype;n.set3DRepresentation=function(t){this.atoms_display=!0,this.bonds_display=!0,this.bonds_color="#777777",this.atoms_useVDWDiameters_3D=!0,this.atoms_useJMOLColors=!0,this.bonds_splitColor=!0,this.bonds_showBondOrders_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"===t?(this.atoms_vdwMultiplier_3D=.3,this.bonds_splitColor=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=e.default_atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===t?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===t?(this.atoms_useVDWDiameters_3D=!1,this.bonds_showBondOrders_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===t?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=e.default_atoms_materialAmbientColor_3D):"Line"===t?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+t+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')},n.copy=function(){var t=s.parse(s.stringify(this));return t.set3DRepresentation=n.set3DRepresentation,t}}(Te,Te.structures,Math,JSON),function(t,l,h,u,e){h.getPointsPerAngstrom=function(){return t.default_bondLength_2D/t.default_angstromsPerBondLength},h.BondDeducer=function(){};var i=h.BondDeducer.prototype;i.margin=1.1,i.deduceCovalentBonds=function(t,e){var i=h.getPointsPerAngstrom();e&&(i=e);for(var s=0,r=t.atoms.length;s<r;s++)for(var n=s+1;n<r;n++){var o=t.atoms[s],a=t.atoms[n];o.distance3D(a)<(l[o.label].covalentRadius+l[a.label].covalentRadius)*i*this.margin&&t.bonds.push(new u.Bond(o,a,1))}}}(Te,Te.ELEMENT,Te.informatics,Te.structures),te=Te.informatics,ee=Te.structures,te.HydrogenDeducer=function(){},te.HydrogenDeducer.prototype.removeHydrogens=function(t,e){for(var i=[],s=[],r=0,n=t.bonds.length;r<n;r++){var o=t.bonds[r],a="H"!==o.a1.label&&"H"!==o.a2.label;a||e||o.stereo===ee.Bond.STEREO_NONE||(a=!0),a?(o.a1.tag=!0,s.push(o)):("H"===o.a1.label&&(o.a1.remove=!0),"H"===o.a2.label&&(o.a2.remove=!0))}for(r=0,n=t.atoms.length;r<n;r++){var l=t.atoms[r];l.remove?l.remove=void 0:i.push(l)}t.atoms=i,t.bonds=s},ie=Te.informatics,se=Te.structures,ie.Splitter=function(){},ie.Splitter.prototype.split=function(t){for(var e=[],i=0,s=t.atoms.length;i<s;i++)t.atoms[i].visited=!1;for(i=0,s=t.bonds.length;i<s;i++)t.bonds[i].visited=!1;for(i=0,s=t.atoms.length;i<s;i++){var r=t.atoms[i];if(!r.visited){var n=new se.Molecule;n.atoms.push(r),r.visited=!0;var o=new se.Queue;for(o.enqueue(r);!o.isEmpty();)for(var a=o.dequeue(),l=0,h=t.bonds.length;l<h;l++){var u=t.bonds[l];if(u.contains(a)&&!u.visited){u.visited=!0,n.bonds.push(u);var c=u.getNeighbor(a);c.visited||(c.visited=!0,n.atoms.push(c),o.enqueue(c))}}e.push(n)}}return e},re=Te.informatics,ne=Te.io,Te.structures,re.StructureBuilder=function(){},re.StructureBuilder.prototype.copy=function(t){var e=new ne.JSONInterpreter;return e.molFrom(e.molTo(t))},function(t,e){t._Counter=function(){};var i=t._Counter.prototype;i.value=0,i.molecule=void 0,i.setMolecule=function(t){this.value=0,this.molecule=t,this.innerCalculate&&this.innerCalculate()}}(Te.informatics),(oe=Te.informatics).FrerejacqueNumberCounter=function(t){this.setMolecule(t)},(oe.FrerejacqueNumberCounter.prototype=new oe._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new oe.NumberOfMoleculesCounter(this.molecule).value},ae=Te.structures,(le=Te.informatics).NumberOfMoleculesCounter=function(t){this.setMolecule(t)},(le.NumberOfMoleculesCounter.prototype=new le._Counter).innerCalculate=function(){for(var t=0,e=this.molecule.atoms.length;t<e;t++)this.molecule.atoms[t].visited=!1;for(t=0,e=this.molecule.atoms.length;t<e;t++)if(!this.molecule.atoms[t].visited){this.value++;var i=new ae.Queue;for(this.molecule.atoms[t].visited=!0,i.enqueue(this.molecule.atoms[t]);!i.isEmpty();)for(var s=i.dequeue(),r=0,n=this.molecule.bonds.length;r<n;r++){var o=this.molecule.bonds[r];if(o.contains(s)){var a=o.getNeighbor(s);a.visited||(a.visited=!0,i.enqueue(a))}}}},function(t,e){t._RingFinder=function(){};var i=t._RingFinder.prototype;i.atoms=void 0,i.bonds=void 0,i.rings=void 0,i.reduce=function(t){for(var e=0,i=t.atoms.length;e<i;e++)t.atoms[e].visited=!1;for(e=0,i=t.bonds.length;e<i;e++)t.bonds[e].visited=!1;for(var s=!0;s;){s=!1;for(e=0,i=t.atoms.length;e<i;e++){for(var r,n=0,o=0,a=t.bonds.length;o<a;o++)if(t.bonds[o].contains(t.atoms[e])&&!t.bonds[o].visited){if(2===++n)break;r=t.bonds[o]}1===n&&(s=!0,r.visited=!0,t.atoms[e].visited=!0)}}for(e=0,i=t.atoms.length;e<i;e++)t.atoms[e].visited||this.atoms.push(t.atoms[e]);for(e=0,i=t.bonds.length;e<i;e++)t.bonds[e].visited||this.bonds.push(t.bonds[e]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])},i.setMolecule=function(t){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(t),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},i.fuse=function(){for(var t=0,e=this.rings.length;t<e;t++)for(var i=0,s=this.bonds.length;i<s;i++)-1!==this.rings[t].atoms.indexOf(this.bonds[i].a1)&&-1!==this.rings[t].atoms.indexOf(this.bonds[i].a2)&&this.rings[t].bonds.push(this.bonds[i])}}(Te.informatics),function(t,h,e){function y(t,e){if(this.atoms=[],e)for(var i=0,s=e.atoms.length;i<s;i++)this.atoms[i]=e.atoms[i];this.atoms.push(t)}var i=y.prototype;i.grow=function(t,e){for(var i=this.atoms[this.atoms.length-1],s=[],r=0,n=t.length;r<n;r++)if(t[r].contains(i)){var o=t[r].getNeighbor(i);-1===e.indexOf(o)&&s.push(o)}var a=[];for(r=0,n=s.length;r<n;r++)a.push(new y(s[r],this));return a},i.check=function(t,e,i){for(var s=0,r=e.atoms.length-1;s<r;s++)if(-1!==this.atoms.indexOf(e.atoms[s]))return;var n;if(e.atoms[e.atoms.length-1]===this.atoms[this.atoms.length-1]){(n=new h.Ring).atoms[0]=i;for(s=0,r=this.atoms.length;s<r;s++)n.atoms.push(this.atoms[s]);for(s=e.atoms.length-2;0<=s;s--)n.atoms.push(e.atoms[s])}else{var o=[];for(s=0,r=t.length;s<r;s++)t[s].contains(e.atoms[e.atoms.length-1])&&o.push(t[s]);for(s=0,r=o.length;s<r;s++)if((1===e.atoms.length||!o[s].contains(e.atoms[e.atoms.length-2]))&&o[s].contains(this.atoms[this.atoms.length-1])){(n=new h.Ring).atoms[0]=i;for(var a=0,l=this.atoms.length;a<l;a++)n.atoms.push(this.atoms[a]);for(a=e.atoms.length-1;0<=a;a--)n.atoms.push(e.atoms[a]);break}}return n},t.EulerFacetRingFinder=function(t){this.setMolecule(t)};var s=t.EulerFacetRingFinder.prototype=new t._RingFinder;s.fingerBreak=5,s.innerGetRings=function(){for(var t=0,e=this.atoms.length;t<e;t++){for(var i=[],s=0,r=this.bonds.length;s<r;s++)this.bonds[s].contains(this.atoms[t])&&i.push(this.bonds[s].getNeighbor(this.atoms[t]));for(s=0,r=i.length;s<r;s++)for(var n=s+1;n<i.length;n++){var o=[];o[0]=new y(i[s]),o[1]=new y(i[n]);var a=[];a[0]=this.atoms[t];for(var l=0,h=i.length;l<h;l++)l!==s&&l!==n&&a.push(i[l]);var u=[],c=o[0].check(this.bonds,o[1],this.atoms[t]);for(c&&(u[0]=c);0===u.length&&0<o.length&&o[0].atoms.length<this.fingerBreak;){var f=[];for(l=0,h=o.length;l<h;l++)for(var d=o[l].grow(this.bonds,a),m=0,p=d.length;m<p;m++)f.push(d[m]);for(l=0,h=(o=f).length;l<h;l++)for(m=l+1;m<h;m++){var g=o[l].check(this.bonds,o[m],this.atoms[t]);g&&u.push(g)}if(0===u.length){var _=[];for(l=0,h=a.length;l<h;l++)for(m=0,p=this.bonds.length;m<p;m++)if(this.bonds[m].contains(a[l])){i=this.bonds[m].getNeighbor(a[l]);-1===a.indexOf(i)&&-1===_.indexOf(i)&&_.push(i)}for(l=0,h=_.length;l<h;l++)a.push(_[l])}}if(0<u.length){var v=void 0;for(l=0,h=u.length;l<h;l++)(!v||v.atoms.length>u[l].atoms.length)&&(v=u[l]);var x=!1;for(l=0,h=this.rings.length;l<h;l++){var b=!0;for(m=0,p=v.atoms.length;m<p;m++)if(-1===this.rings[l].atoms.indexOf(v.atoms[m])){b=!1;break}if(b){x=!0;break}}x||this.rings.push(v)}}}this.fuse()}}(Te.informatics,Te.structures),(he=Te.informatics).SSSRFinder=function(t){if(this.rings=[],0<t.atoms.length){var e=new he.FrerejacqueNumberCounter(t).value,i=new he.EulerFacetRingFinder(t).rings;i.sort(function(t,e){return t.atoms.length-e.atoms.length});for(var s=0,r=t.bonds.length;s<r;s++)t.bonds[s].visited=!1;for(s=0,r=i.length;s<r;s++){for(var n=!1,o=0,a=i[s].bonds.length;o<a;o++)if(!i[s].bonds[o].visited){n=!0;break}if(n){for(o=0,a=i[s].bonds.length;o<a;o++)i[s].bonds[o].visited=!0;this.rings.push(i[s])}if(this.rings.length===e)break}}},(ue=Te.io)._Interpreter=function(){},ue._Interpreter.prototype.fit=function(t,e,i){for(var s=t.length,r=[],n=0;n<e-s;n++)r.push(" ");return i?t+r.join(""):r.join("")+t},function(ht,ut,t,ct,ft,dt,mt,e,pt){function gt(t){return 0!==t.length}function _t(t){var e=0,i=0,s=0,r=0,n=t.indexOf("x"),o=t.indexOf("y"),a=t.indexOf("z");if(-1!==n&&(i++,0<n&&"+"!==t.charAt(n-1)&&(i*=-1)),-1!==o&&(s++,0<o&&"+"!==t.charAt(o-1)&&(s*=-1)),-1!==a&&(r++,0<a&&"+"!==t.charAt(a-1)&&(r*=-1)),2<t.length)for(var l="+",h=0,u=t.length;h<u;h++){var c=t.charAt(h);"-"!==c&&"/"!==c||h!==t.length-1&&!t.charAt(h+1).match(f)||(l=c),c.match(f)&&("+"===l?e+=parseInt(c):"-"===l?e-=parseInt(c):"/"===l&&(e/=parseInt(c)))}return[e,i,s,r]}var vt=/\s+/g,xt=/\(|\)|\s+/g,bt=/\'|\s+/g,yt=/,|\'|\s+/g,wt=/^\s+/,f=/[0-9]/g,Dt=/[0-9]|\+|\-/g,St={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]};t.CIFInterpreter=function(){},(t.CIFInterpreter.prototype=new t._Interpreter).read=function(t,e,i,s){e=e||1,i=i||1,s=s||1;var r=new ct.Molecule;if(!t)return r;for(var n,o,a,l,h=t.split("\n"),u=0,c=0,f=0,d=0,m=0,p=0,g="P",_=!0;0<h.length;)if(_?l=h.shift():_=!0,0<l.length)if(ut.stringStartsWith(l,"_cell_length_a"))u=parseFloat(l.split(xt)[1]);else if(ut.stringStartsWith(l,"_cell_length_b"))c=parseFloat(l.split(xt)[1]);else if(ut.stringStartsWith(l,"_cell_length_c"))f=parseFloat(l.split(xt)[1]);else if(ut.stringStartsWith(l,"_cell_angle_alpha"))d=dt.PI*parseFloat(l.split(xt)[1])/180;else if(ut.stringStartsWith(l,"_cell_angle_beta"))m=dt.PI*parseFloat(l.split(xt)[1])/180;else if(ut.stringStartsWith(l,"_cell_angle_gamma"))p=dt.PI*parseFloat(l.split(xt)[1])/180;else if(ut.stringStartsWith(l,"_symmetry_space_group_name_H-M"))g=l.split(bt)[1];else if(ut.stringStartsWith(l,"loop_")){for(var v={fields:[],lines:[]},x=!1;(l=h.shift())!==pt&&!ut.stringStartsWith(l=l.replace(wt,""),"loop_")&&0<l.length;)if(ut.stringStartsWith(l,"_")){if(x)break;v.fields=v.fields.concat(l.split(vt).filter(gt))}else x=!0,v.lines.push(l);0!==h.length&&(ut.stringStartsWith(l,"loop_")||ut.stringStartsWith(l,"_"))&&(_=!1),-1!==v.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==v.fields.indexOf("_space_group_symop_operation_xyz")?n=v:-1!==v.fields.indexOf("_atom_site_label")?o=v:-1!==v.fields.indexOf("_geom_bond_atom_site_label_1")&&(a=v)}var b=function(t,e,i,s,r,n){var o=(dt.cos(s)-dt.cos(n)*dt.cos(r))/dt.sin(n);return[t,0,0,0,e*dt.cos(n),e*dt.sin(n),0,0,i*dt.cos(r),i*o,i*dt.sqrt(1-dt.pow(dt.cos(r),2)-o*o),0,0,0,0,1]}(u,c,f,d,m,p);if(o){for(var y=-1,w=-1,D=-1,S=-1,T=-1,C=0,A=o.fields.length;C<A;C++){"_atom_site_type_symbol"===(it=o.fields[C])?y=C:"_atom_site_label"===it?w=C:"_atom_site_fract_x"===it?D=C:"_atom_site_fract_y"===it?S=C:"_atom_site_fract_z"===it&&(T=C)}for(C=0,A=o.lines.length;C<A;C++){var E=(l=o.lines[C]).split(vt).filter(gt),F=new ct.Atom(E[-1===y?w:y].split(Dt)[0],parseFloat(E[D]),parseFloat(E[S]),parseFloat(E[T]));r.atoms.push(F),-1!==w&&(F.cifId=E[w],F.cifPart=0)}}if(n&&!a){var P=0;for(C=0,A=n.fields.length;C<A;C++){"_symmetry_equiv_pos_as_xyz"!==(it=n.fields[C])&&"_space_group_symop_operation_xyz"!==it||(P=C)}var R=St[g],B=[];for(C=0,A=n.lines.length;C<A;C++)for(var M=n.lines[C].split(yt).filter(gt),I=_t(M[P]),L=_t(M[P+1]),N=_t(M[P+2]),k=0,z=r.atoms.length;k<z;k++){var O=(F=r.atoms[k]).x*I[1]+F.y*I[2]+F.z*I[3]+I[0],U=F.x*L[1]+F.y*L[2]+F.z*L[3]+L[0],H=F.x*N[1]+F.y*N[2]+F.z*N[3]+N[0],W=new ct.Atom(F.label,O,U,H);if(B.push(W),F.cifId!==pt&&(W.cifId=F.cifId,W.cifPart=C+1),R)for(var q=0,j=R.length;q<j;q++){var G=R[q],X=new ct.Atom(F.label,O+G[0],U+G[1],H+G[2]);B.push(X),F.cifId!==pt&&(X.cifId=F.cifId,X.cifPart=C+1)}}for(C=0,A=B.length;C<A;C++){for(F=B[C];1<=F.x;)F.x--;for(;F.x<0;)F.x++;for(;1<=F.y;)F.y--;for(;F.y<0;)F.y++;for(;1<=F.z;)F.z--;for(;F.z<0;)F.z++}var V=[];for(C=0,A=B.length;C<A;C++){var Y=!1;for(F=B[C],k=0,z=r.atoms.length;k<z;k++)if(r.atoms[k].distance3D(F)<1e-4){Y=!0;break}if(!Y){for(k=0,z=V.length;k<z;k++)if(V[k].distance3D(F)<1e-4){Y=!0;break}Y||V.push(F)}}r.atoms=r.atoms.concat(V)}var Z=[];for(C=0;C<e;C++)for(k=0;k<i;k++)for(q=0;q<s;q++)if(0!==C||0!==k||0!==q)for(var $=0,Q=r.atoms.length;$<Q;$++){F=r.atoms[$];var J=new ct.Atom(F.label,F.x+C,F.y+k,F.z+q);Z.push(J),F.cifId!==pt&&(J.cifId=F.cifId,J.cifPart=F.cifPart+(n?n.lines.length:0)+C+10*k+100*q)}r.atoms=r.atoms.concat(Z);for(C=0,A=r.atoms.length;C<A;C++){F=r.atoms[C];var K=mt.multiplyVec3(b,[F.x,F.y,F.z]);F.x=K[0],F.y=K[1],F.z=K[2]}if(a){var tt=-1,et=-1;for(C=0,A=a.fields.length;C<A;C++){var it;"_geom_bond_atom_site_label_1"===(it=a.fields[C])?tt=C:"_geom_bond_atom_site_label_2"===it&&(et=C)}for(q=0,j=a.lines.length;q<j;q++){var st=(E=a.lines[q].split(vt).filter(gt))[tt],rt=E[et];for(C=0,A=r.atoms.length;C<A;C++)for(k=C+1;k<A;k++){var nt=r.atoms[C],ot=r.atoms[k];if(nt.cifPart!==ot.cifPart)break;(nt.cifId===st&&ot.cifId===rt||nt.cifId===rt&&ot.cifId===st)&&r.bonds.push(new ct.Bond(nt,ot))}}}else(new ht.informatics.BondDeducer).deduceCovalentBonds(r,1);var at=[-e/2,-i/2,-s/2],lt={o:mt.multiplyVec3(b,at,[]),x:mt.multiplyVec3(b,[at[0]+1,at[1],at[2]]),y:mt.multiplyVec3(b,[at[0],at[1]+1,at[2]]),z:mt.multiplyVec3(b,[at[0],at[1],at[2]+1]),xy:mt.multiplyVec3(b,[at[0]+1,at[1]+1,at[2]]),xz:mt.multiplyVec3(b,[at[0]+1,at[1],at[2]+1]),yz:mt.multiplyVec3(b,[at[0],at[1]+1,at[2]+1]),xyz:mt.multiplyVec3(b,[at[0]+1,at[1]+1,at[2]+1])};return{molecule:r,unitCell:new ft.UnitCell(lt)}};var r=new t.CIFInterpreter;ht.readCIF=function(t,e,i,s){return r.read(t,e,i,s)}}(Te,Te.extensions,Te.io,Te.structures,Te.structures.d3,Math,Te.lib.mat4,Te.lib.vec3),function(t,e,A,E,i){e.CMLInterpreter=function(){};var s=e.CMLInterpreter.prototype=new e._Interpreter;s.read=function(t){for(var e=[],i=E.parseXML(t),s=E(i).find("cml"),r=0,n=s.length;r<n;r++)for(var o=E(s[r]).find("molecule"),a=0,l=o.length;a<l;a++){for(var h=e[a]=new A.Molecule,u=[],c=E(o[a]).find("atom"),f=0,d=c.length;f<d;f++){var m,p,g,_,v=E(c[f]),x=v.attr("elementType");g=null==v.attr("x2")?(m=v.attr("x3"),p=v.attr("y3"),v.attr("z3")):(m=v.attr("x2"),p=v.attr("y2"),0),_=e[a].atoms[f]=new A.Atom(x,m,p,g),u[f]=v.attr("id"),null!=v.attr("formalCharge")&&(_.charge=v.attr("formalCharge"))}var b=E(o[a]).find("bond");for(f=0,d=b.length;f<d;f++){var y,w,D,S=E(b[f]),T=S.attr("atomRefs2").split(" ");switch(y=h.atoms[E.inArray(T[0],u)],w=h.atoms[E.inArray(T[1],u)],S.attr("order")){case"2":case"D":D=2;break;case"3":case"T":D=3;break;case"A":D=1.5;break;default:D=1}var C=e[a].bonds[f]=new A.Bond(y,w,D);switch(S.find("bondStereo").text()){case"W":C.stereo=A.Bond.STEREO_PROTRUDING;break;case"H":C.stereo=A.Bond.STEREO_RECESSED}}}return e},s.write=function(t){var e=[];e.push('<?xml version="1.0" encoding="UTF-8"?>\n'),e.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var i=0,s=t.length;i<s;i++){e.push('<molecule id="m'),e.push(i),e.push('">'),e.push("<atomArray>");for(var r=0,n=t[i].atoms.length;r<n;r++){var o=t[i].atoms[r];e.push('<atom elementType="'),e.push(o.label),e.push('" id="a'),e.push(r),e.push('" '),e.push('x3="'),e.push(o.x),e.push('" y3="'),e.push(o.y),e.push('" z3="'),e.push(o.z),e.push('" '),0!=o.charge&&(e.push('formalCharge="'),e.push(o.charge),e.push('" ')),e.push("/>")}e.push("</atomArray>"),e.push("<bondArray>");for(r=0,n=t[i].bonds.length;r<n;r++){var a=t[i].bonds[r];switch(e.push('<bond atomRefs2="a'),e.push(t[i].atoms.indexOf(a.a1)),e.push(" a"),e.push(t[i].atoms.indexOf(a.a2)),e.push('" order="'),a.bondOrder){case 1.5:e.push("A");break;case 1:case 2:case 3:e.push(a.bondOrder);break;case.5:default:e.push("S")}e.push('"/>')}e.push("</bondArray>"),e.push("</molecule>")}return e.push("</cml>"),e.join("")};var r=new e.CMLInterpreter;t.readCML=function(t){return r.read(t)},t.writeCML=function(t){return r.write(t)}}(Te,Te.io,Te.structures,Te.lib.jQuery),function(d,m,t,p,e){t.MOLInterpreter=function(){};var i=t.MOLInterpreter.prototype=new t._Interpreter;i.read=function(t,e){e||(e=d.default_bondLength_2D);var i=new p.Molecule;if(!t)return i;for(var s=t.split("\n"),r=s[3],n=parseInt(r.substring(0,3)),o=parseInt(r.substring(3,6)),a=0;a<n;a++){var l=s[4+a];i.atoms[a]=new p.Atom(l.substring(31,34),parseFloat(l.substring(0,10))*e,(1===e?1:-1)*parseFloat(l.substring(10,20))*e,parseFloat(l.substring(20,30))*e);var h=parseInt(l.substring(34,36));switch(0!==h&&m[i.atoms[a].label]&&(i.atoms[a].mass=m[i.atoms[a].label].mass+h),parseInt(l.substring(36,39))){case 1:i.atoms[a].charge=3;break;case 2:i.atoms[a].charge=2;break;case 3:i.atoms[a].charge=1;break;case 5:i.atoms[a].charge=-1;break;case 6:i.atoms[a].charge=-2;break;case 7:i.atoms[a].charge=-3}}for(a=0;a<o;a++){l=s[4+n+a];var u=parseInt(l.substring(6,9)),c=parseInt(l.substring(9,12));if(3<u)switch(u){case 4:u=1.5;break;default:u=1}var f=new p.Bond(i.atoms[parseInt(l.substring(0,3))-1],i.atoms[parseInt(l.substring(3,6))-1],u);switch(c){case 3:f.stereo=p.Bond.STEREO_AMBIGUOUS;break;case 1:f.stereo=p.Bond.STEREO_PROTRUDING;break;case 6:f.stereo=p.Bond.STEREO_RECESSED}i.bonds[a]=f}return i},i.write=function(t){var e=[];e.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),e.push(this.fit(t.atoms.length.toString(),3)),e.push(this.fit(t.bonds.length.toString(),3)),e.push("  0  0  0  0            999 V2000\n");for(var i=t.getCenter(),s=0,r=t.atoms.length;s<r;s++){var n=t.atoms[s],o=" 0";if(-1!==n.mass&&m[n.label]){var a=n.mass-m[n.label].mass;a<5&&-4<a&&(o=(-1<a?" ":"")+a)}var l="  0";if(0!==n.charge)switch(n.charge){case 3:l="  1";break;case 2:l="  2";break;case 1:l="  3";break;case-1:l="  5";break;case-2:l="  6";break;case-3:l="  7"}e.push(this.fit(((n.x-i.x)/d.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((-(n.y-i.y)/d.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((n.z/d.default_bondLength_2D).toFixed(4),10)),e.push(" "),e.push(this.fit(n.label,3,!0)),e.push(o),e.push(l),e.push("  0  0  0  0\n")}for(s=0,r=t.bonds.length;s<r;s++){var h=t.bonds[s],u=0;h.stereo===p.Bond.STEREO_AMBIGUOUS?u=3:h.stereo===p.Bond.STEREO_PROTRUDING?u=1:h.stereo===p.Bond.STEREO_RECESSED&&(u=6),e.push(this.fit((t.atoms.indexOf(h.a1)+1).toString(),3)),e.push(this.fit((t.atoms.indexOf(h.a2)+1).toString(),3));var c=h.bondOrder;1.5==c?c=4:(3<c||c%1!=0)&&(c=1),e.push(this.fit(c.toString(),3)),e.push("  "),e.push(u),e.push("  0  0  0\n")}return e.push("M  END"),e.join("")};var s=new t.MOLInterpreter;d.readMOL=function(t,e){return s.read(t,e)},d.writeMOL=function(t){return s.write(t)}}(Te,Te.ELEMENT,Te.io,Te.structures),function(z,O,t,U,H,W,q,e){function j(t,e,i,s,r){for(var n=0,o=e.length;n<o;n++){var a=e[n];if(a.id===i&&s>=a.start&&s<=a.end)return r?t.helix=!0:t.sheet=!0,void(s===a.end&&(t.arrow=!0))}}t.PDBInterpreter=function(){};var i=t.PDBInterpreter.prototype=new t._Interpreter;i.calculateRibbonDistances=!1,i.deduceResidueBonds=!1,i.read=function(t,e){var i=new U.Molecule;if(i.chains=[],!t)return i;var s=t.split("\n");e||(e=1);for(var r,n=[],o=[],a=[],l=[],h=[],u=0,c=s.length;u<c;u++){var f=s[u];if(O.stringStartsWith(f,"HELIX"))n.push({id:f.substring(19,20),start:parseInt(f.substring(21,25)),end:parseInt(f.substring(33,37))});else if(O.stringStartsWith(f,"SHEET"))o.push({id:f.substring(21,22),start:parseInt(f.substring(22,26)),end:parseInt(f.substring(33,37))});else if(O.stringStartsWith(f,"ATOM")){var d=f.substring(16,17);if(" "===d||"A"===d){var m=W(f.substring(76,78));if(0===m.length){var p=W(f.substring(12,14));"HD"===p?m="H":0<p.length&&(m=1<p.length?p.charAt(0)+p.substring(1).toLowerCase():p)}var g=new U.Atom(m,parseFloat(f.substring(30,38))*e,parseFloat(f.substring(38,46))*e,parseFloat(f.substring(46,54))*e);g.hetatm=!1,l.push(g);var _=parseInt(f.substring(22,26));if(0===a.length)for(var v=0;v<3;v++){var x=new U.Residue(-1);x.cp1=g,x.cp2=g,a.push(x)}if(_!==Number.NaN&&a[a.length-1].resSeq!==_){var b=new U.Residue(_);b.name=W(f.substring(17,20)),3===b.name.length?b.name=b.name.substring(0,1)+b.name.substring(1).toLowerCase():2===b.name.length&&"D"===b.name.charAt(0)&&(b.name=b.name.substring(1)),a.push(b);var y=f.substring(21,22);j(b,n,y,_,!0),j(b,o,y,_,!1)}var w=W(f.substring(12,16)),D=a[a.length-1];"CA"===w||"P"===w||"O5'"===w?D.cp1||(D.cp1=g):"N3"===w&&("C"===D.name||"U"===D.name||"T"===D.name)||"N1"===w&&("A"===D.name||"G"===D.name)?D.cp3=g:"C2"===w?D.cp4=g:"C4"===w&&("C"===D.name||"U"===D.name||"T"===D.name)||"C6"===w&&("A"===D.name||"G"===D.name)?D.cp5=g:"O"===w||"C6"===w&&("C"===D.name||"U"===D.name||"T"===D.name)||"N9"===w?a[a.length-1].cp2||("C6"!==w&&"N9"!==w||(r=g),D.cp2=g):"C"===w&&(r=g)}}else if(O.stringStartsWith(f,"HETATM")){var S=W(f.substring(76,78));0===S.length&&(S=W(f.substring(12,16))),1<S.length&&(S=S.substring(0,1)+S.substring(1).toLowerCase());var T=new U.Atom(S,parseFloat(f.substring(30,38))*e,parseFloat(f.substring(38,46))*e,parseFloat(f.substring(46,54))*e);T.hetatm=!0,"HOH"===W(f.substring(17,20))&&(T.isWater=!0),i.atoms.push(T),h[parseInt(W(f.substring(6,11)))]=T}else if(O.stringStartsWith(f,"CONECT")){var C=parseInt(W(f.substring(6,11)));if(h[C])for(var A=h[C],E=0;E<4;E++){var F=W(f.substring(11+5*E,16+5*E));if(0!==F.length){var P=parseInt(F);if(h[P]){for(var R=h[P],B=!1,M=(v=0,i.bonds.length);v<M;v++){var I=i.bonds[v];if(I.a1===A&&I.a2===R||I.a1===R&&I.a2===A){B=!0;break}}B||i.bonds.push(new U.Bond(A,R))}}}}else if(O.stringStartsWith(f,"TER"))this.endChain(i,a,r,l),a=[];else if(O.stringStartsWith(f,"ENDMDL"))break}if(this.endChain(i,a,r,l),0===i.bonds.size&&(new z.informatics.BondDeducer).deduceCovalentBonds(i,e),this.deduceResidueBonds)for(u=0,c=l.length;u<c;u++){var L=q.min(c,u+20);for(v=u+1;v<L;v++){var N=l[u],k=l[v];N.distance3D(k)<1.1*(H[N.label].covalentRadius+H[k.label].covalentRadius)&&i.bonds.push(new U.Bond(N,k,1))}}return i.atoms=i.atoms.concat(l),this.calculateRibbonDistances&&this.calculateDistances(i,l),i},i.endChain=function(t,e,i,s){if(0<e.length){var r=e[e.length-1];r.cp1||(r.cp1=s[s.length-2]),r.cp2||(r.cp2=s[s.length-1]);for(var n=0;n<4;n++){var o=new U.Residue(-1);o.cp1=i,o.cp2=e[e.length-1].cp2,e.push(o)}t.chains.push(e)}},i.calculateDistances=function(t,e){for(var i=[],s=0,r=t.atoms.length;s<r;s++){(n=t.atoms[s]).hetatm&&(n.isWater||i.push(n))}for(s=0,r=e.length;s<r;s++){var n;if((n=e[s]).closestDistance=Number.POSITIVE_INFINITY,0===i.length)n.closestDistance=0;else for(var o=0,a=i.length;o<a;o++)n.closestDistance=Math.min(n.closestDistance,n.distance3D(i[o]))}};var s=new t.PDBInterpreter;z.readPDB=function(t,e){return s.read(t,e)}}(Te,Te.extensions,Te.io,Te.structures,Te.ELEMENT,Te.lib.jQuery.trim,Math),function(i,V,t,Y,e,Z){var $={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},Q={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},J={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};t.JCAMPInterpreter=function(){};var s=t.JCAMPInterpreter.prototype=new t._Interpreter;s.convertHZ2PPM=!1,s.read=function(t){this.isBreak=function(t){return $[t]!==Z||Q[t]!==Z||J[t]!==Z||" "===t||"-"===t||"+"===t},this.getValue=function(t,e){var i=t.charAt(0),s=t.substring(1);return $[i]!==Z?parseFloat($[i]+s):Q[i]!==Z?parseFloat(Q[i]+s)+e:parseFloat(s)};var e=new Y.Spectrum;if(t===Z||0===t.length)return e;for(var i,s,r,n,o=t.split("\n"),a=[],l=1,h=1,u=1,c=-1,f=-1,d=!0,m=!1,p=0,g=o.length;p<g;p++){var _=o[p].trim(),v=_.indexOf("$$");if(-1!==v&&(_=_.substring(0,v)),0!==a.length&&V.stringStartsWith(o[p],"##")){var x=a.join("");if(d&&x.length<100&&e.metadata.push(x),a=[_],V.stringStartsWith(x,"##TITLE="))e.title=x.substring(8).trim();else if(V.stringStartsWith(x,"##XUNITS="))e.xUnit=x.substring(9).trim(),this.convertHZ2PPM&&"HZ"===e.xUnit.toUpperCase()&&(e.xUnit="PPM",m=!0);else if(V.stringStartsWith(x,"##YUNITS="))e.yUnit=x.substring(9).trim();else if(V.stringStartsWith(x,"##XYPAIRS="));else if(V.stringStartsWith(x,"##FIRSTX="))s=parseFloat(x.substring(9).trim());else if(V.stringStartsWith(x,"##LASTX="))i=parseFloat(x.substring(8).trim());else if(V.stringStartsWith(x,"##FIRSTY="))r=parseFloat(x.substring(9).trim());else if(V.stringStartsWith(x,"##NPOINTS="))n=parseFloat(x.substring(10).trim());else if(V.stringStartsWith(x,"##XFACTOR="))l=parseFloat(x.substring(10).trim());else if(V.stringStartsWith(x,"##YFACTOR="))h=parseFloat(x.substring(10).trim());else if(V.stringStartsWith(x,"##DELTAX="))parseFloat(x.substring(9).trim());else if(V.stringStartsWith(x,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(u=parseFloat(x.substring(21).trim()));else if(V.stringStartsWith(x,"##.SHIFT REFERENCE=")){if(this.convertHZ2PPM){var b=x.substring(19).split(",");c=parseInt(b[2].trim()),f=parseFloat(b[3].trim())}}else if(V.stringStartsWith(x,"##XYDATA=")){m||(u=1);for(var y,w=d=!1,D=(i-s)/(n-1),S=s-D,T=r,C=0,A=1,E=(U=x.split("\n")).length;A<E;A++){for(var F=[],P=U[A].trim(),R=(a=[],0),B=P.length;R<B;R++)this.isBreak(P.charAt(R))?(0<a.length&&(1!==a.length||" "!==a[0])&&F.push(a.join("")),a=[P.charAt(R)]):a.push(P.charAt(R));F.push(a.join("")),S=parseFloat(F[0])*l-D;for(R=1,B=F.length;R<B;R++){var M=F[R];if(J[M.charAt(0)]!==Z)for(var I=parseInt(J[M.charAt(0)]+M.substring(1))-1,L=0;L<I;L++)S+=D,T=(C=this.getValue(y,C))*h,0,e.data[e.data.length-1]=new Y.Point(S/u,T);else $[M.charAt(0)]!==Z&&w?T=this.getValue(M,C)*h:(w=Q[M.charAt(0)]!==Z,y=M,S+=D,T=(C=this.getValue(M,C))*h,0,e.data.push(new Y.Point(S/u,T)))}}if(-1!==c){var N=f-e.data[c-1].x;for(p=0,g=e.data.length;p<g;p++)e.data[p].x+=N}}else if(V.stringStartsWith(x,"##PEAK TABLE=")){d=!1,e.continuous=!1;var k=/[\s,]+/;for(A=1,E=(U=x.split("\n")).length;A<E;A++){(z=U[A].split(k)).length/2;for(R=0,B=z.length;R+1<B;R+=2)e.data.push(new Y.Point(parseFloat(z[R].trim()),parseFloat(z[R+1].trim())))}}else if(V.stringStartsWith(x,"##ATOMLIST=")){e.molecule=new Y.Molecule;for(k=/[\s]+/,A=1,E=(U=x.split("\n")).length;A<E;A++){var z=U[A].split(k);e.molecule.atoms.push(new Y.Atom(z[1]))}}else if(V.stringStartsWith(x,"##BONDLIST="))for(k=/[\s]+/,A=1,E=(U=x.split("\n")).length;A<E;A++){var O=1;"D"===(z=U[A].split(k))[2]?O=2:"T"===z[2]&&(O=3),e.molecule.bonds.push(new Y.Bond(e.molecule.atoms[parseInt(z[0])-1],e.molecule.atoms[parseInt(z[1])-1],O))}else if(e.molecule&&V.stringStartsWith(x,"##XY_RASTER=")){for(k=/[\s]+/,A=1,E=(U=x.split("\n")).length;A<E;A++){z=U[A].split(k);(q=e.molecule.atoms[parseInt(z[0])-1]).x=parseInt(z[1]),q.y=parseInt(z[2]),4==z.length&&(q.z=parseInt(z[3]))}e.molecule.scaleToAverageBondLength(20)}else if(V.stringStartsWith(x,"##PEAK ASSIGNMENTS=")){var U=x.split("\n");k=/[\s,()<>]+/;e.assignments=[];for(A=1,E=U.length;A<E;A++){z=U[A].split(k);var H=parseFloat(z[1]),W=parseFloat(z[2]),q=e.molecule.atoms[parseInt(z[3])-1],j=!1;for(R=0,B=e.assignments.length;R<B;R++){if((G=e.assignments[R]).x===H){G.as.push(q),q.assigned=G,j=!0;break}}if(!j){var G={x:H,y:W,as:[q]};q.assigned=G,e.assignments.push(G)}}}}else{var X=_.trim();0!==a.length&&0!==X.length&&a.push("\n"),a.push(X)}}return e.setup(),e},s.makeStructureSpectrumSet=function(t,e){this.convertHZ2PPM=!0;var n=this.read(e),o=new i.ViewerCanvas(t+"_molecule",200,200);o.specs.atoms_displayTerminalCarbonLabels_2D=!0,o.specs.atoms_displayImplicitHydrogens_2D=!0,o.mouseout=function(t){if(0!==this.molecules.length){for(var e=0,i=this.molecules[0].atoms.length;e<i;e++)this.molecules[0].atoms[e].isHover=!1;n.hovered=Z,this.repaint(),a.repaint()}},o.touchend=o.mouseout,o.mousemove=function(t){if(0!==this.molecules.length){for(var e=Z,i=0,s=this.molecules[0].atoms.length;i<s;i++){var r=this.molecules[0].atoms[i];r.isHover=!1,r.assigned&&(e===Z||t.p.distance(r)<t.p.distance(e))&&(e=r)}if(n.hovered=Z,t.p.distance(e)<20){for(i=0,s=e.assigned.as.length;i<s;i++)e.assigned.as[i].isHover=!0;a.spectrum.hovered=e.assigned}this.repaint(),a.repaint()}},o.touchmove=o.mousemove,o.drawChildExtras=function(t,e){if(0!==this.molecules.length)for(var i=0,s=this.molecules[0].atoms.length;i<s;i++)this.molecules[0].atoms[i].drawDecorations(t,e)};var a=new i.ObserverCanvas(t+"_spectrum",400,200);return a.specs.plots_showYAxis=!1,a.specs.plots_flipXAxis=!0,a.mouseout=function(t){if(this.spectrum&&this.spectrum.assignments){for(var e=0,i=o.molecules[0].atoms.length;e<i;e++)o.molecules[0].atoms[e].isHover=!1;this.spectrum.hovered=Z,o.repaint(),this.repaint()}},a.touchend=a.mouseout,a.mousemove=function(t){if(this.spectrum&&this.spectrum.assignments){for(var e=Z,i=0,s=o.molecules[0].atoms.length;i<s;i++)o.molecules[0].atoms[i].isHover=!1;this.spectrum.hovered=Z;for(i=0,s=this.spectrum.assignments.length;i<s;i++){var r=this.spectrum.assignments[i];(e===Z||Math.abs(this.spectrum.getTransformedX(r.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-t.p.x)<Math.abs(this.spectrum.getTransformedX(e.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-t.p.x))&&(e=r)}if(Math.abs(this.spectrum.getTransformedX(e.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-t.p.x)<20){for(i=0,s=e.as.length;i<s;i++)e.as[i].isHover=!0;this.spectrum.hovered=e}o.repaint(),this.repaint()}},a.touchmove=a.mousemove,a.drawChildExtras=function(t){if(this.spectrum&&this.spectrum.hovered){var e=this.spectrum.getTransformedX(this.spectrum.hovered.x,a.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft);e>=this.spectrum.memory.offsetLeft&&e<this.spectrum.memory.width&&(t.save(),t.strokeStyle="#885110",t.lineWidth=3,t.beginPath(),t.moveTo(e,this.spectrum.memory.height-this.spectrum.memory.offsetBottom),t.lineTo(e,this.spectrum.getTransformedY(this.spectrum.hovered.y,a.specs,this.spectrum.memory.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)),t.stroke(),t.restore())}},n&&(a.loadSpectrum(n),n.molecule&&o.loadMolecule(n.molecule)),[o,a]};var r=new t.JCAMPInterpreter;r.convertHZ2PPM=!0,i.readJCAMP=function(t){return r.read(t)}}(Te,Te.extensions,Te.io,Te.structures,Te.lib.jQuery),function(t,e,T,C,A,i,E){e.JSONInterpreter=function(){};var s=e.JSONInterpreter.prototype;s.contentTo=function(t,e){t||(t=[]),e||(e=[]);for(var i=0,s=0,r=0,n=t.length;r<n;r++){for(var o=0,a=(h=t[r]).atoms.length;o<a;o++)h.atoms[o].tmpid="a"+i++;for(o=0,a=h.bonds.length;o<a;o++)h.bonds[o].tmpid="b"+s++}for(r=i=0,n=e.length;r<n;r++)e[r].tmpid="s"+i++;var l={};if(t&&0<t.length){l.m=[];for(r=0,n=t.length;r<n;r++)l.m.push(this.molTo(t[r]))}if(e&&0<e.length){l.s=[];for(r=0,n=e.length;r<n;r++)l.s.push(this.shapeTo(e[r]))}for(r=0,n=t.length;r<n;r++){var h;for(o=0,a=(h=t[r]).atoms.length;o<a;o++)h.atoms[o].tmpid=E;for(o=0,a=h.bonds.length;o<a;o++)h.bonds[o].tmpid=E}for(r=0,n=e.length;r<n;r++)e[r].tmpid=E;return l},s.contentFrom=function(t){var e={molecules:[],shapes:[]};if(t.m)for(var i=0,s=t.m.length;i<s;i++)e.molecules.push(this.molFrom(t.m[i]));if(t.s)for(i=0,s=t.s.length;i<s;i++)e.shapes.push(this.shapeFrom(t.s[i],e.molecules));for(i=0,s=e.molecules.length;i<s;i++){for(var r=e.molecules[i],n=0,o=r.atoms.length;n<o;n++)r.atoms[n].tmpid=E;for(n=0,o=r.bonds.length;n<o;n++)r.bonds[n].tmpid=E}for(i=0,s=e.shapes.length;i<s;i++)e.shapes[i].tmpid=E;return e},s.queryTo=function(r){function t(t,e,i,s){e&&(t[i]={v:s?r.outputRange(e.v):e.v,n:e.not})}var e={};return r.type===T.Query.TYPE_ATOM?(t(e,r.elements,"as"),t(e,r.chirality,"@"),t(e,r.aromatic,"A"),t(e,r.charge,"C",!0),t(e,r.hydrogens,"H",!0),t(e,r.ringCount,"R",!0),t(e,r.saturation,"S"),t(e,r.connectivity,"X",!0),t(e,r.connectivityNoH,"x",!0)):(t(e,r.orders,"bs"),t(e,r.stereo,"@"),t(e,r.aromatic,"A"),t(e,r.ringCount,"R",!0)),e},s.molTo=function(t){for(var e={a:[]},i=0,s=t.atoms.length;i<s;i++){var r=t.atoms[i],n={x:r.x,y:r.y};r.tmpid&&(n.i=r.tmpid),"C"!==r.label&&(n.l=r.label),0!==r.z&&(n.z=r.z),0!==r.charge&&(n.c=r.charge),-1!==r.mass&&(n.m=r.mass),-1!==r.implicitH&&(n.h=r.implicitH),0!==r.numRadical&&(n.r=r.numRadical),0!==r.numLonePair&&(n.p=r.numLonePair),r.query&&(n.q=this.queryTo(r.query)),e.a.push(n)}if(0<t.bonds.length){e.b=[];for(i=0,s=t.bonds.length;i<s;i++){var o=t.bonds[i],a={b:t.atoms.indexOf(o.a1),e:t.atoms.indexOf(o.a2)};o.tmpid&&(a.i=o.tmpid),1!==o.bondOrder&&(a.o=o.bondOrder),o.stereo!==T.Bond.STEREO_NONE&&(a.s=o.stereo),o.query&&(a.q=this.queryTo(o.query)),e.b.push(a)}}return e},s.queryFrom=function(t){function e(t,e,i,s){e&&(t[i]={},t[i].v=s?t.parseRange(e.v):e.v,e.n&&(t[i].not=!0))}var i=new T.Query(t.as?T.Query.TYPE_ATOM:T.Query.TYPE_BOND);return i.type===T.Query.TYPE_ATOM?(e(i,t.as,"elements"),e(i,t["@"],"chirality"),e(i,t.A,"aromatic"),e(i,t.C,"charge",!0),e(i,t.H,"hydrogens",!0),e(i,t.R,"ringCount",!0),e(i,t.S,"saturation"),e(i,t.X,"connectivity",!0),e(i,t.x,"connectivityNoH",!0)):(e(i,t.bs,"orders"),e(i,t["@"],"stereo"),e(i,t.A,"aromatic"),e(i,t.R,"ringCount",!0)),i},s.molFrom=function(t){for(var e=new T.Molecule,i=0,s=t.a.length;i<s;i++){var r=t.a[i],n=new T.Atom(r.l?r.l:"C",r.x,r.y);r.i&&(n.tmpid=r.i),r.z&&(n.z=r.z),r.c&&(n.charge=r.c),r.m&&(n.mass=r.m),r.h&&(n.implicitH=r.h),r.r&&(n.numRadical=r.r),r.p&&(n.numLonePair=r.p),r.q&&(n.query=this.queryFrom(r.q)),r.p_h!==E&&(n.hetatm=r.p_h),r.p_w!==E&&(n.isWater=r.p_w),r.p_d!==E&&(n.closestDistance=r.p_d),e.atoms.push(n)}if(t.b)for(i=0,s=t.b.length;i<s;i++){r=t.b[i];var o=new T.Bond(e.atoms[r.b],e.atoms[r.e],r.o===E?1:r.o);r.i&&(o.tmpid=r.i),r.s&&(o.stereo=r.s),r.q&&(o.query=this.queryFrom(r.q)),e.bonds.push(o)}return e},s.shapeTo=function(t){var e={};if(t.tmpid&&(e.i=t.tmpid),t instanceof C.Line)e.t="Line",e.x1=t.p1.x,e.y1=t.p1.y,e.x2=t.p2.x,e.y2=t.p2.y,e.a=t.arrowType;else if(t instanceof C.Pusher)e.t="Pusher",e.o1=t.o1.tmpid,e.o2=t.o2.tmpid,1!==t.numElectron&&(e.e=t.numElectron);else if(t instanceof C.AtomMapping)e.t="AtomMapping",e.a1=t.o1.tmpid,e.a2=t.o2.tmpid;else if(t instanceof C.Bracket)e.t="Bracket",e.x1=t.p1.x,e.y1=t.p1.y,e.x2=t.p2.x,e.y2=t.p2.y,0!==t.charge&&(e.c=t.charge),0!==t.mult&&(e.m=t.mult),0!==t.repeat&&(e.r=t.repeat);else if(t instanceof C.DynamicBracket)e.t="DynamicBracket",e.b1=t.b1.tmpid,e.b2=t.b2.tmpid,e.n1=t.n1,e.n2=t.n2,!0===t.flip&&(e.f=!0);else if(t instanceof C.VAP){e.t="VAP",e.x=t.asterisk.x,e.y=t.asterisk.y,1!==t.bondType&&(e.o=t.bondType),t.substituent&&(e.s=t.substituent.tmpid),e.a=[];for(var i=0,s=t.attachments.length;i<s;i++)e.a.push(t.attachments[i].tmpid)}else if(t instanceof A.Distance)e.t="Distance",e.a1=t.a1.tmpid,e.a2=t.a2.tmpid,t.node&&(e.n=t.node,e.o=t.offset);else if(t instanceof A.Angle)e.t="Angle",e.a1=t.a1.tmpid,e.a2=t.a2.tmpid,e.a3=t.a3.tmpid;else if(t instanceof A.Torsion)e.t="Torsion",e.a1=t.a1.tmpid,e.a2=t.a2.tmpid,e.a3=t.a3.tmpid,e.a4=t.a4.tmpid;else if(t instanceof A._Surface){e.t="Surface",e.a=[];for(i=0,s=t.atoms.length;i<s;i++)e.a.push(t.atoms[i].tmpid);t instanceof A.VDWSurface||(e.p=t.probeRadius),e.r=t.resolution;var r="vdw";t instanceof A.SASSurface?r="sas":A.SESSurface&&t instanceof A.SESSurface&&(r="ses"),e.f=r}else if(t instanceof A.UnitCell)for(var n in e.t="UnitCell",t.unitCell)e[n]=t.unitCell[n];return e},s.shapeFrom=function(t,e){var i;if("Line"===t.t)(i=new C.Line(new T.Point(t.x1,t.y1),new T.Point(t.x2,t.y2))).arrowType=t.a;else if("Pusher"===t.t){for(var s,r,n=0,o=e.length;n<o;n++){for(var a=0,l=(x=e[n]).atoms.length;a<l;a++){(b=x.atoms[a]).tmpid===t.o1?s=b:b.tmpid===t.o2&&(r=b)}for(a=0,l=x.bonds.length;a<l;a++){(c=x.bonds[a]).tmpid===t.o1?s=c:c.tmpid===t.o2&&(r=c)}}i=new C.Pusher(s,r),t.e&&(i.numElectron=t.e)}else if("AtomMapping"===t.t){for(n=0,o=e.length;n<o;n++)for(a=0,l=(x=e[n]).atoms.length;a<l;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2&&(p=b)}i=new C.AtomMapping(m,p)}else if("Bracket"===t.t)i=new C.Bracket(new T.Point(t.x1,t.y1),new T.Point(t.x2,t.y2)),t.c!==E&&(i.charge=t.c),t.m!==E&&(i.mult=t.m),t.r!==E&&(i.repeat=t.r);else if("DynamicBracket"===t.t){var h,u;for(n=0,o=e.length;n<o;n++)for(a=0,l=(x=e[n]).bonds.length;a<l;a++){var c;(c=x.bonds[a]).tmpid===t.b1?h=c:c.tmpid===t.b2&&(u=c)}(i=new C.DynamicBracket(h,u)).n1=t.n1,i.n2=t.n2,t.f&&(i.flip=!0)}else if("VAP"===t.t){i=new C.VAP(t.x,t.y),t.o&&(i.bondType=t.o);for(n=0,o=e.length;n<o;n++)for(a=0,l=(x=e[n]).atoms.length;a<l;a++){if((b=x.atoms[a]).tmpid===t.s)i.substituent=b;else for(var f=0,d=t.a.length;f<d;f++)b.tmpid===t.a[f]&&i.attachments.push(b)}}else if("Distance"===t.t){for(n=0,o=e.length;n<o;n++)for(a=0,l=(x=e[n]).atoms.length;a<l;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2&&(p=b)}i=new A.Distance(m,p,t.n,t.o)}else if("Angle"===t.t){for(n=0,o=e.length;n<o;n++)for(a=0,l=(x=e[n]).atoms.length;a<l;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2?p=b:b.tmpid===t.a3&&(g=b)}i=new A.Angle(m,p,g)}else if("Torsion"===t.t){var m,p,g,_;for(n=0,o=e.length;n<o;n++)for(a=0,l=(x=e[n]).atoms.length;a<l;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2?p=b:b.tmpid===t.a3?g=b:b.tmpid===t.a4&&(_=b)}i=new A.Torsion(m,p,g,_)}else if("Surface"===t.t){var v=[];for(n=0,o=e.length;n<o;n++){var x;for(a=0,l=(x=e[n]).atoms.length;a<l;a++){var b=x.atoms[a];for(f=0,d=t.a.length;f<d;f++)b.tmpid===t.a[f]&&v.push(b)}}var y=t.p?t.p:1.4,w=t.r?t.r:30;"vdw"===t.f?i=new A.VDWSurface(v,w):"sas"===t.f?i=new A.SASSurface(v,y,w):"ses"===t.f&&(i=new A.SESSurface(v,y,w))}else if("UnitCell"===t.t){var D={};for(var S in t)D[S]=t[S];i=new A.UnitCell(D)}return i},s.pdbFrom=function(t){var e=this.molFrom(t.mol);return e.findRings=!1,e.fromJSON=!0,e.chains=this.chainsFrom(t.ribbons),e},s.chainsFrom=function(t){for(var e=[],i=0,s=t.cs.length;i<s;i++){for(var r=t.cs[i],n=[],o=0,a=r.length;o<a;o++){var l=r[o],h=new T.Residue;h.name=l.n,h.cp1=new T.Atom("",l.x1,l.y1,l.z1),h.cp2=new T.Atom("",l.x2,l.y2,l.z2),l.x3&&(h.cp3=new T.Atom("",l.x3,l.y3,l.z3),h.cp4=new T.Atom("",l.x4,l.y4,l.z4),h.cp5=new T.Atom("",l.x5,l.y5,l.z5)),h.helix=l.h,h.sheet=l.s,h.arrow=0<o&&r[o-1].a,n.push(h)}e.push(n)}return e};var r=new e.JSONInterpreter;t.readJSON=function(t){var e;try{e=i.parse(t)}catch(t){return E}return e?e.m||e.s?r.contentFrom(e):e.a?{molecules:[r.molFrom(e)],shapes:[]}:{molecules:[],shapes:[]}:E},t.writeJSON=function(t,e){return i.stringify(r.contentTo(t,e))}}(Te,Te.io,Te.structures,Te.structures.d2,Te.structures.d3,JSON),function(v,t,x,e){t.RXNInterpreter=function(){};var i=t.RXNInterpreter.prototype=new t._Interpreter;i.read=function(t,e){e||(e=v.default_bondLength_2D);var i,s=[];if(t){for(var r=t.split("$MOL\n"),n=r[0].split("\n")[4],o=parseInt(n.substring(0,3)),a=parseInt(n.substring(3,6)),l=1,h=0,u=0,c=o+a;u<c;u++){s[u]=v.readMOL(r[l],e),h-=(f=(g=s[u].getBounds()).maxX-g.minX)+40,l++}for(u=0,c=o;u<c;u++){for(var f=(g=s[u].getBounds()).maxX-g.minX,d=s[u].getCenter(),m=0,p=s[u].atoms.length;m<p;m++){(_=s[u].atoms[m]).x+=h+f/2-d.x,_.y-=d.y}h+=f+40}i=new x.d2.Line(new x.Point(h,0),new x.Point(h+40,0)),h+=80;for(u=o,c=o+a;u<c;u++){var g;for(f=(g=s[u].getBounds()).maxX-g.minX,d=s[u].getCenter(),m=0;m<s[u].atoms.length;m++){var _;(_=s[u].atoms[m]).x+=h+f/2-d.x,_.y-=d.y}h+=f+40}}else s.push(new x.Molecule),i=new x.d2.Line(new x.Point(-20,0),new x.Point(20,0));return i.arrowType=x.d2.Line.ARROW_SYNTHETIC,{molecules:s,shapes:[i]}},i.write=function(t,e){var i=[[],[]],s=void 0;if(t&&e){for(r=0,n=e.length;r<n;r++)if(e[r]instanceof x.d2.Line){s=e[r].getPoints();break}if(!s)return"";for(var r=0,n=t.length;r<n;r++){t[r].getCenter().x<s[1].x?i[0].push(t[r]):i[1].push(t[r])}var o=[];o.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),o.push(this.fit(i[0].length.toString(),3)),o.push(this.fit(i[1].length.toString(),3)),o.push("\n");for(r=0;r<2;r++)for(var a=0,l=i[r].length;a<l;a++)o.push("$MOL\n"),o.push(v.writeMOL(i[r][a])),o.push("\n");return o.join("")}};var s=new t.RXNInterpreter;v.readRXN=function(t,e){return s.read(t,e)},v.writeRXN=function(t,e){return s.write(t,e)}}(Te,Te.io,Te.structures),function(o,t,a,e,l,h,i){e.XYZInterpreter=function(){};var s=e.XYZInterpreter.prototype=new e._Interpreter;s.deduceCovalentBonds=!0,s.read=function(t){var e=new l.Molecule;if(!t)return e;for(var i=t.split("\n"),s=parseInt(h(i[0])),r=0;r<s;r++){var n=i[r+2].split(/\s+/g);e.atoms[r]=new l.Atom(isNaN(n[0])?n[0]:a[parseInt(n[0])-1],parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]))}return this.deduceCovalentBonds&&(new o.informatics.BondDeducer).deduceCovalentBonds(e,1),e};var r=new e.XYZInterpreter;o.readXYZ=function(t){return r.read(t)}}(Te,Te.ELEMENT,Te.SYMBOLS,Te.io,Te.structures,Te.lib.jQuery.trim),Te.monitor=(ce=Te.featureDetection,fe=Te.lib.jQuery,de=document,me={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1},ce.supports_touch()||fe(de).ready(function(){fe(de).mousemove(function(t){!me.CANVAS_DRAGGING||me.CANVAS_DRAGGING.drag&&(me.CANVAS_DRAGGING.prehandleEvent(t),me.CANVAS_DRAGGING.drag(t))}),fe(de).mouseup(function(t){!me.CANVAS_DRAGGING||me.CANVAS_DRAGGING===me.CANVAS_OVER||me.CANVAS_DRAGGING.mouseup&&(me.CANVAS_DRAGGING.prehandleEvent(t),me.CANVAS_DRAGGING.mouseup(t)),me.CANVAS_DRAGGING=void 0}),fe(de).keydown(function(t){me.SHIFT=t.shiftKey,me.ALT=t.altKey,me.META=t.metaKey||t.ctrlKey;var e=me.CANVAS_OVER;me.CANVAS_DRAGGING&&(e=me.CANVAS_DRAGGING),!e||e.keydown&&(e.prehandleEvent(t),e.keydown(t))}),fe(de).keypress(function(t){var e=me.CANVAS_OVER;me.CANVAS_DRAGGING&&(e=me.CANVAS_DRAGGING),!e||e.keypress&&(e.prehandleEvent(t),e.keypress(t))}),fe(de).keyup(function(t){me.SHIFT=t.shiftKey,me.ALT=t.altKey,me.META=t.metaKey||t.ctrlKey;var e=me.CANVAS_OVER;me.CANVAS_DRAGGING&&(e=me.CANVAS_DRAGGING),!e||e.keyup&&(e.prehandleEvent(t),e.keyup(t))})}),me),function(a,u,s,n,c,l,f,o,d,m,p){a._Canvas=function(){};var t=a._Canvas.prototype;t.molecules=p,t.shapes=p,t.emptyMessage=p,t.image=p,t.repaint=function(){if(!this.test){var t=o.getElementById(this.id);if(t.getContext){var e=t.getContext("2d");if(1!==this.pixelRatio&&t.width===this.width&&(t.width=this.width*this.pixelRatio,t.height=this.height*this.pixelRatio,e.scale(this.pixelRatio,this.pixelRatio)),this.image?e.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==t.style.backgroundColor&&(t.style.backgroundColor=this.specs.backgroundColor,this.bgCache=t.style.backgroundColor),e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.innerRepaint)this.innerRepaint(e);else if(0!==this.molecules.length||0!==this.shapes.length){e.save(),e.translate(this.width/2,this.height/2),e.rotate(this.specs.rotateAngle),e.scale(this.specs.scale,this.specs.scale),e.translate(-this.width/2,-this.height/2);for(var i=0,s=this.molecules.length;i<s;i++)this.molecules[i].check(!0),this.molecules[i].draw(e,this.specs);this.checksOnAction&&this.checksOnAction(!0);for(i=0,s=this.shapes.length;i<s;i++)this.shapes[i].draw(e,this.specs);e.restore()}else this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(e,this.specs)}}},t.resize=function(t,e){var i=l("#"+this.id);if(i.attr({width:t,height:e}),i.css("width",t),i.css("height",e),this.width=t,this.height=e,a._Canvas3D&&this instanceof a._Canvas3D){var s=t,r=e;1!==this.pixelRatio&&(s*=this.pixelRatio,r*=this.pixelRatio,this.gl.canvas.width=s,this.gl.canvas.height=r),this.gl.viewport(0,0,s,r),this.afterLoadContent()}else if(0<this.molecules.length){this.center();for(var n=0,o=this.molecules.length;n<o;n++)this.molecules[n].check()}this.repaint()},t.setBackgroundImage=function(t){this.image=new Image;var e=this;this.image.onload=function(){e.repaint()},this.image.src=t},t.loadMolecule=function(t){this.clear(),this.molecules.push(t);for(var e=0;e<2;e++)this.center(),a._Canvas3D&&this instanceof a._Canvas3D||t.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()},t.loadContent=function(t,e){this.molecules=t||[],this.shapes=e||[];for(var i=0;i<2;i++){if(this.center(),!(a._Canvas3D&&this instanceof a._Canvas3D)){i=0;for(var s=this.molecules.length;i<s;i++)this.molecules[i].check()}this.afterLoadContent&&this.afterLoadContent(),this.repaint()}},t.addMolecule=function(t){this.molecules.push(t),a._Canvas3D&&this instanceof a._Canvas3D||t.check(),this.repaint()},t.removeMolecule=function(e){this.molecules=l.grep(this.molecules,function(t){return t!==e}),this.repaint()},t.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:p},t.getMolecules=function(){return this.molecules},t.addShape=function(t){this.shapes.push(t),this.repaint()},t.removeShape=function(e){this.shapes=l.grep(this.shapes,function(t){return t!==e}),this.repaint()},t.getShapes=function(){return this.shapes},t.clear=function(){this.molecules=[],this.shapes=[],this.specs.scale=1,this.repaint()},t.center=function(){for(var t=this.getContentBounds(),e=new c.Point((this.width-t.minX-t.maxX)/2,(this.height-t.minY-t.maxY)/2),i=0,s=this.molecules.length;i<s;i++)for(var r=this.molecules[i],n=0,o=r.atoms.length;n<o;n++)r.atoms[n].add(e);for(i=0,s=this.shapes.length;i<s;i++){var a=this.shapes[i].getPoints();for(n=0,o=a.length;n<o;n++)a[n].add(e)}this.specs.scale=1;var l=t.maxX-t.minX,h=t.maxY-t.minY;(l>this.width-20||h>this.height-20)&&(this.specs.scale=.85*f.min(this.width/l,this.height/h))},t.bondExists=function(t,e){for(var i=0,s=this.molecules.length;i<s;i++)for(var r=this.molecules[i],n=0,o=r.bonds.length;n<o;n++){var a=r.bonds[n];if(a.contains(t)&&a.contains(e))return!0}return!1},t.getBond=function(t,e){for(var i=0,s=this.molecules.length;i<s;i++)for(var r=this.molecules[i],n=0,o=r.bonds.length;n<o;n++){var a=r.bonds[n];if(a.contains(t)&&a.contains(e))return a}return p},t.getMoleculeByAtom=function(t){for(var e=0,i=this.molecules.length;e<i;e++){var s=this.molecules[e];if(-1!==s.atoms.indexOf(t))return s}return p},t.getAllAtoms=function(){for(var t=[],e=0,i=this.molecules.length;e<i;e++)t=t.concat(this.molecules[e].atoms);return t},t.getAllBonds=function(){for(var t=[],e=0,i=this.molecules.length;e<i;e++)t=t.concat(this.molecules[e].bonds);return t},t.getAllPoints=function(){for(var t=[],e=0,i=this.molecules.length;e<i;e++)t=t.concat(this.molecules[e].atoms);for(e=0,i=this.shapes.length;e<i;e++)t=t.concat(this.shapes[e].getPoints());return t},t.getContentBounds=function(){for(var t=new s.Bounds,e=0,i=this.molecules.length;e<i;e++)t.expand(this.molecules[e].getBounds());for(e=0,i=this.shapes.length;e<i;e++)t.expand(this.shapes[e].getBounds());return t},t.create=function(t,e,i){if(this.id=t,this.width=e,this.height=i,this.molecules=[],this.shapes=[],o.getElementById(t)){var s=l("#"+t);e?s.attr("width",e):this.width=s.attr("width"),i?s.attr("height",i):this.height=s.attr("height"),s.attr("class","ChemDoodleWebComponent")}else{if(!a.featureDetection.supports_canvas_text()&&-1!=m.indexOf("MSIE"))return void o.writeln('<div style="border: 1px solid black;" width="'+e+'" height="'+i+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');o.writeln('<canvas class="ChemDoodleWebComponent" id="'+t+'" width="'+e+'" height="'+i+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}var r=l("#"+t);r.css("width",this.width),r.css("height",this.height),this.pixelRatio=d.devicePixelRatio?d.devicePixelRatio:1,this.specs=new c.VisualSpecifications;var h=this;u.supports_touch()?(r.bind("touchstart",function(t){var e=(new Date).getTime();if(!u.supports_gesture()&&2===t.originalEvent.touches.length){var i=t.originalEvent.touches,s=new c.Point(i[0].pageX,i[0].pageY),r=new c.Point(i[1].pageX,i[1].pageY);h.implementedGestureDist=s.distance(r),h.implementedGestureAngle=s.angle(r),h.gesturestart&&(h.prehandleEvent(t),h.gesturestart(t))}h.lastTouch&&1===t.originalEvent.touches.length&&e-h.lastTouch<500?h.dbltap?(h.prehandleEvent(t),h.dbltap(t)):h.dblclick?(h.prehandleEvent(t),h.dblclick(t)):h.touchstart?(h.prehandleEvent(t),h.touchstart(t)):h.mousedown&&(h.prehandleEvent(t),h.mousedown(t)):h.touchstart?(h.prehandleEvent(t),h.touchstart(t),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){h.touchhold(t)},1e3))):h.mousedown&&(h.prehandleEvent(t),h.mousedown(t)),h.lastTouch=e}),r.bind("touchmove",function(t){if(this.hold&&(clearTimeout(this.hold),this.hold=p),!u.supports_gesture()&&2===t.originalEvent.touches.length&&h.gesturechange){var e=t.originalEvent.touches,i=new c.Point(e[0].pageX,e[0].pageY),s=new c.Point(e[1].pageX,e[1].pageY),r=i.distance(s),n=i.angle(s);t.originalEvent.scale=r/h.implementedGestureDist,t.originalEvent.rotation=180*(h.implementedGestureAngle-n)/f.PI,h.prehandleEvent(t),h.gesturechange(t)}if(1<t.originalEvent.touches.length&&h.multitouchmove){var o=t.originalEvent.touches.length;h.prehandleEvent(t);for(var a=new c.Point(-t.offset.left*o,-t.offset.top*o),l=0;l<o;l++)a.x+=t.originalEvent.changedTouches[l].pageX,a.y+=t.originalEvent.changedTouches[l].pageY;a.x/=o,a.y/=o,t.p=a,h.multitouchmove(t,o)}else h.touchmove?(h.prehandleEvent(t),h.touchmove(t)):h.drag&&(h.prehandleEvent(t),h.drag(t))}),r.bind("touchend",function(t){this.hold&&(clearTimeout(this.hold),this.hold=p),!u.supports_gesture()&&h.implementedGestureDist&&(h.implementedGestureDist=p,h.implementedGestureAngle=p,h.gestureend&&(h.prehandleEvent(t),h.gestureend(t))),h.touchend?(h.prehandleEvent(t),h.touchend(t)):h.mouseup&&(h.prehandleEvent(t),h.mouseup(t)),(new Date).getTime()-h.lastTouch<250&&(h.tap?(h.prehandleEvent(t),h.tap(t)):h.click&&(h.prehandleEvent(t),h.click(t)))}),r.bind("gesturestart",function(t){h.gesturestart&&(h.prehandleEvent(t),h.gesturestart(t))}),r.bind("gesturechange",function(t){h.gesturechange&&(h.prehandleEvent(t),h.gesturechange(t))}),r.bind("gestureend",function(t){h.gestureend&&(h.prehandleEvent(t),h.gestureend(t))})):(r.click(function(t){switch(t.which){case 1:h.click&&(h.prehandleEvent(t),h.click(t));break;case 2:h.middleclick&&(h.prehandleEvent(t),h.middleclick(t));break;case 3:h.rightclick&&(h.prehandleEvent(t),h.rightclick(t))}}),r.dblclick(function(t){h.dblclick&&(h.prehandleEvent(t),h.dblclick(t))}),r.mousedown(function(t){switch(t.which){case 1:(n.CANVAS_DRAGGING=h).mousedown&&(h.prehandleEvent(t),h.mousedown(t));break;case 2:h.middlemousedown&&(h.prehandleEvent(t),h.middlemousedown(t));break;case 3:h.rightmousedown&&(h.prehandleEvent(t),h.rightmousedown(t))}}),r.mousemove(function(t){!n.CANVAS_DRAGGING&&h.mousemove&&(h.prehandleEvent(t),h.mousemove(t))}),r.mouseout(function(t){n.CANVAS_OVER=p,h.mouseout&&(h.prehandleEvent(t),h.mouseout(t))}),r.mouseover(function(t){(n.CANVAS_OVER=h).mouseover&&(h.prehandleEvent(t),h.mouseover(t))}),r.mouseup(function(t){switch(t.which){case 1:h.mouseup&&(h.prehandleEvent(t),h.mouseup(t));break;case 2:h.middlemouseup&&(h.prehandleEvent(t),h.middlemouseup(t));break;case 3:h.rightmouseup&&(h.prehandleEvent(t),h.rightmouseup(t))}}),r.mousewheel(function(t,e){h.mousewheel&&(h.prehandleEvent(t),h.mousewheel(t,e))})),this.subCreate&&this.subCreate()},t.prehandleEvent=function(t){t.originalEvent.changedTouches&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY),this.doEventDefault||(t.preventDefault(),t.returnValue=!1),t.offset=l("#"+this.id).offset(),t.p=new c.Point(t.pageX-t.offset.left,t.pageY-t.offset.top)}}(Te,Te.featureDetection,Te.math,Te.monitor,Te.structures,Te.lib.jQuery,Math,document,window,navigator.userAgent),function(t,i,e){t._AnimatorCanvas=function(t,e,i){t&&this.create(t,e,i)};var s=t._AnimatorCanvas.prototype=new t._Canvas;s.timeout=33,s.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var e=this;this.nextFrame&&(this.handle=i.requestInterval(function(){var t=(new Date).getTime();e.nextFrame(t-e.lastTime),e.repaint(),e.lastTime=t},this.timeout))},s.stopAnimation=function(){this.handle&&(i.clearRequestInterval(this.handle),this.handle=void 0)},s.isRunning=function(){return void 0!==this.handle}}(Te,Te.animations),pe=Te,ge=document,pe.FileCanvas=function(t,e,i,s){t&&this.create(t,e,i);var r='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+s+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+t+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+t+"', "+t+')"></iframe>';ge.writeln(r),this.emptyMessage="Click below to load file",this.repaint()},pe.FileCanvas.prototype=new pe._Canvas,function(t,e){t.HyperlinkCanvas=function(t,e,i,s,r,n){t&&this.create(t,e,i),this.urlOrFunction=s,this.color=r||"blue",this.size=n||2};var i=t.HyperlinkCanvas.prototype=new t._Canvas;i.openInNewWindow=!0,i.hoverImage=void 0,i.drawChildExtras=function(t){this.e&&(this.hoverImage?t.drawImage(this.hoverImage,0,0):(t.strokeStyle=this.color,t.lineWidth=2*this.size,t.strokeRect(0,0,this.width,this.height)))},i.setHoverImage=function(t){this.hoverImage=new Image,this.hoverImage.src=t},i.click=function(t){this.e=void 0,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},i.mouseout=function(t){this.e=void 0,this.repaint()},i.mouseover=function(t){this.e=t,this.repaint()}}(Te),function(t,i,n,o,e){t.MolGrabberCanvas=function(t,e,i){t&&this.create(t,e,i);var s=[];s.push('<br><input type="text" id="'),s.push(t),s.push('_query" size="32" value="" />'),s.push(this.getInputFields()),o.getElementById(t),n("#"+t).after(s.join(""));var r=this;n("#"+t+"_submit").click(function(){r.search()}),n("#"+t+"_query").keypress(function(t){13===t.which&&r.search()}),this.emptyMessage="Enter search term below",this.repaint()};var s=t.MolGrabberCanvas.prototype=new t._Canvas;s.setSearchTerm=function(t){n("#"+this.id+"_query").val(t),this.search()},s.getInputFields=function(){var t=[];return t.push("<br><nobr>"),t.push('<select id="'),t.push(this.id),t.push('_select">'),t.push('<option value="chemexper">ChemExper'),t.push('<option value="chemspider">ChemSpider'),t.push('<option value="pubchem" selected>PubChem'),t.push("</select>"),t.push('<button id="'),t.push(this.id),t.push('_submit">Show Molecule</button>'),t.push("</nobr>"),t.join("")},s.search=function(){this.emptyMessage="Searching...",this.clear();var e=this;i.getMoleculeFromDatabase(n("#"+this.id+"_query").val(),{database:n("#"+this.id+"_select").val()},function(t){e.loadMolecule(t)})}}(Te,Te.iChemLabs,Te.lib.jQuery,document),function(t,e,u,i){var c=[],f=[1,0,0],d=[0,1,0],m=[0,0,1];t.RotatorCanvas=function(t,e,i,s){t&&this.create(t,e,i),this.rotate3D=s};var s=t.RotatorCanvas.prototype=new t._AnimatorCanvas,r=e.PI/15;s.xIncrement=r,s.yIncrement=r,s.zIncrement=r,s.nextFrame=function(t){if(0!==this.molecules.length||0!==this.shapes.length){var e=t/1e3;if(this.rotate3D){u.identity(c),u.rotate(c,this.xIncrement*e,f),u.rotate(c,this.yIncrement*e,d),u.rotate(c,this.zIncrement*e,m);for(var i=0,s=this.molecules.length;i<s;i++){for(var r=this.molecules[i],n=0,o=r.atoms.length;n<o;n++){var a=[(h=r.atoms[n]).x-this.width/2,h.y-this.height/2,h.z];u.multiplyVec3(c,a),h.x=a[0]+this.width/2,h.y=a[1]+this.height/2,h.z=a[2]}for(n=0,o=r.rings.length;n<o;n++)r.rings[n].center=r.rings[n].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&r.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&r.sortBondsByZ()}for(i=0,s=this.shapes.length;i<s;i++){var l=this.shapes[i].getPoints();for(n=0,o=l.length;n<o;n++){var h;a=[(h=l[n]).x-this.width/2,h.y-this.height/2,0];u.multiplyVec3(c,a),h.x=a[0]+this.width/2,h.y=a[1]+this.height/2}}}else this.specs.rotateAngle+=this.zIncrement*e}else this.stopAnimation()},s.dblclick=function(t){this.isRunning()?this.stopAnimation():this.startAnimation()}}(Te,Math,Te.lib.mat4),function(t,e,i,s){t.SlideshowCanvas=function(t,e,i){t&&this.create(t,e,i)};var r=t.SlideshowCanvas.prototype=new t._AnimatorCanvas;r.frames=[],r.curIndex=0,r.timeout=5e3,r.alpha=0,r.innerHandle=void 0,r.phase=0,r.drawChildExtras=function(t){var e=i.getRGB(this.specs.backgroundColor,255);t.fillStyle="rgba("+e[0]+", "+e[1]+", "+e[2]+", "+this.alpha+")",t.fillRect(0,0,this.width,this.height)},r.nextFrame=function(t){if(0!==this.frames.length){this.phase=0;var e=this,i=1;this.innerHandle=setInterval(function(){e.alpha=i/15,e.repaint(),15===i&&e.breakInnerHandle(),i++},33)}else this.stopAnimation()},r.breakInnerHandle=function(){if(this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0),0===this.phase){this.curIndex++,this.curIndex>this.frames.length-1&&(this.curIndex=0),this.alpha=1;var t=this.frames[this.curIndex];this.loadContent(t.mols,t.shapes),this.phase=1;var e=this,i=1;this.innerHandle=setInterval(function(){e.alpha=(15-i)/15,e.repaint(),15===i&&e.breakInnerHandle(),i++},33)}else 1===this.phase&&(this.alpha=0,this.repaint())},r.addFrame=function(t,e){0===this.frames.length&&this.loadContent(t,e),this.frames.push({mols:t,shapes:e})}}(Te,Te.animations,Te.math),function(t,x,b,y,w,e){t.TransformCanvas=function(t,e,i,s){t&&this.create(t,e,i),this.rotate3D=s};var i=t.TransformCanvas.prototype=new t._Canvas;i.lastPoint=void 0,i.rotationMultMod=1.3,i.lastPinchScale=1,i.lastGestureRotate=0,i.mousedown=function(t){this.lastPoint=t.p},i.dblclick=function(t){this.center(),this.repaint()},i.drag=function(t){if(!this.lastPoint.multi)if(x.ALT){var e=new b.Point(t.p.x,t.p.y);e.sub(this.lastPoint);for(var i=0,s=this.molecules.length;i<s;i++){for(var r=0,n=(d=this.molecules[i]).atoms.length;r<n;r++)d.atoms[r].add(e);d.check()}for(i=0,s=this.shapes.length;i<s;i++){var o=this.shapes[i].getPoints();for(r=0,n=o.length;r<n;r++)o[r].add(e)}this.lastPoint=t.p,this.repaint()}else if(!0===this.rotate3D){var a=y.max(this.width/4,this.height/4),l=t.p.x-this.lastPoint.x,h=t.p.y-this.lastPoint.y,u=l/a*this.rotationMultMod,c=-h/a*this.rotationMultMod,f=[];w.identity(f),w.rotate(f,c,[1,0,0]),w.rotate(f,u,[0,1,0]);for(i=0,s=this.molecules.length;i<s;i++){var d;for(r=0,n=(d=this.molecules[i]).atoms.length;r<n;r++){var m=d.atoms[r],p=[m.x-this.width/2,m.y-this.height/2,m.z];w.multiplyVec3(f,p),m.x=p[0]+this.width/2,m.y=p[1]+this.height/2,m.z=p[2]}for(i=0,s=d.rings.length;i<s;i++)d.rings[i].center=d.rings[i].getCenter();this.lastPoint=t.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&d.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&d.sortBondsByZ()}this.repaint()}else{var g=new b.Point(this.width/2,this.height/2),_=g.angle(this.lastPoint),v=g.angle(t.p);this.specs.rotateAngle-=v-_,this.lastPoint=t.p,this.repaint()}},i.mousewheel=function(t,e){this.specs.scale+=e/50,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},i.multitouchmove=function(t,e){if(2===e)if(this.lastPoint.multi){var i=new b.Point(t.p.x,t.p.y);i.sub(this.lastPoint);for(var s=0,r=this.molecules.length;s<r;s++){for(var n=this.molecules[s],o=0,a=n.atoms.length;o<a;o++)n.atoms[o].add(i);n.check()}for(s=0,r=this.shapes.length;s<r;s++){var l=this.shapes[s].getPoints();for(o=0,a=l.length;o<a;o++)l[o].add(i)}this.lastPoint=t.p,this.lastPoint.multi=!0,this.repaint()}else this.lastPoint=t.p,this.lastPoint.multi=!0},i.gesturechange=function(t){if(t.originalEvent.scale-this.lastPinchScale!=0&&(this.specs.scale*=t.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=t.originalEvent.scale),this.lastGestureRotate-t.originalEvent.rotation!=0){for(var e=(this.lastGestureRotate-t.originalEvent.rotation)/180*y.PI,i=new b.Point(this.width/2,this.height/2),s=0,r=this.molecules.length;s<r;s++){for(var n=this.molecules[s],o=0,a=n.atoms.length;o<a;o++){var l=n.atoms[o],h=i.distance(l),u=i.angle(l)+e;l.x=i.x+h*y.cos(u),l.y=i.y-h*y.sin(u)}n.check()}this.lastGestureRotate=t.originalEvent.rotation}this.repaint()},i.gestureend=function(t){this.lastPinchScale=1,this.lastGestureRotate=0}}(Te,Te.monitor,Te.structures,Math,Te.lib.mat4),(_e=Te).ViewerCanvas=function(t,e,i){t&&this.create(t,e,i)},_e.ViewerCanvas.prototype=new _e._Canvas,function(t,e,i){t._SpectrumCanvas=function(t,e,i){t&&this.create(t,e,i)};var s=t._SpectrumCanvas.prototype=new t._Canvas;s.spectrum=void 0,s.emptyMessage="No Spectrum Loaded or Recognized",s.loadMolecule=void 0,s.getMolecule=void 0,s.innerRepaint=function(t){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(t,this.specs,this.width,this.height):this.emptyMessage&&(t.fillStyle="#737683",t.textAlign="center",t.textBaseline="middle",t.font="18px Helvetica, Verdana, Arial, Sans-serif",t.fillText(this.emptyMessage,this.width/2,this.height/2))},s.loadSpectrum=function(t){this.spectrum=t,this.repaint()},s.getSpectrum=function(){return this.spectrum},s.getSpectrumCoordinates=function(t,e){return spectrum.getInternalCoordinates(t,e,this.width,this.height)}}(Te,document),(ve=Te).ObserverCanvas=function(t,e,i){t&&this.create(t,e,i)},ve.ObserverCanvas.prototype=new ve._SpectrumCanvas,function(t,e){t.OverlayCanvas=function(t,e,i){t&&this.create(t,e,i)};var i=t.OverlayCanvas.prototype=new t._SpectrumCanvas;i.overlaySpectra=[],i.superRepaint=i.innerRepaint,i.innerRepaint=function(t){if(this.superRepaint(t),this.spectrum&&0<this.spectrum.data.length)for(var e=0,i=this.overlaySpectra.length;e<i;e++){var s=this.overlaySpectra[e];s&&0<s.data.length&&(s.minX=this.spectrum.minX,s.maxX=this.spectrum.maxX,s.drawPlot(t,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}},i.addSpectrum=function(t){this.spectrum?this.overlaySpectra.push(t):this.spectrum=t}}(Te),function(i,e,r,t){i.PerspectiveCanvas=function(t,e,i){t&&this.create(t,e,i)};var s=i.PerspectiveCanvas.prototype=new i._SpectrumCanvas;s.dragRange=void 0,s.rescaleYAxisOnZoom=!0,s.lastPinchScale=1,s.mousedown=function(t){this.dragRange=new i.structures.Point(t.p.x,t.p.x)},s.mouseup=function(t){if(this.dragRange&&this.dragRange.x!==this.dragRange.y){if(!this.dragRange.multi){var e=this.spectrum.zoom(this.dragRange.x,t.p.x,this.width,this.rescaleYAxisOnZoom);this.rescaleYAxisOnZoom&&(this.specs.scale=e)}this.dragRange=void 0,this.repaint()}},s.drag=function(t){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(e.SHIFT&&(this.spectrum.translate(t.p.x-this.dragRange.x,this.width),this.dragRange.x=t.p.x),this.dragRange.y=t.p.x),this.repaint())},s.drawChildExtras=function(t){if(this.dragRange){var e=r.min(this.dragRange.x,this.dragRange.y),i=r.max(this.dragRange.x,this.dragRange.y);t.strokeStyle="gray",t.lineStyle=1,t.beginPath(),t.moveTo(e,this.height/2);for(var s=e;s<=i;s++)s%10<5?t.lineTo(s,r.round(this.height/2)):t.moveTo(s,r.round(this.height/2));t.stroke()}},s.mousewheel=function(t,e){this.specs.scale+=e/10,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},s.dblclick=function(t){this.spectrum.setup(),this.specs.scale=1,this.repaint()},s.multitouchmove=function(t,e){2===e&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(t.p.x-this.dragRange.x,this.width),this.dragRange.x=t.p.x,this.dragRange.y=t.p.x,this.repaint()):(this.dragRange=new i.structures.Point(t.p.x,t.p.x),this.dragRange.multi=!0))},s.gesturechange=function(t){this.specs.scale*=t.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=t.originalEvent.scale,this.repaint()},s.gestureend=function(t){this.lastPinchScale=1}}(Te,Te.monitor,Math),function(a,l,h,t){a.SeekerCanvas=function(t,e,i,s){t&&this.create(t,e,i),this.seekType=s};var e=a.SeekerCanvas.prototype=new a._SpectrumCanvas;e.superRepaint=e.innerRepaint,e.innerRepaint=function(t){if(this.superRepaint(t),this.spectrum&&0<this.spectrum.data.length&&this.p){var e,i;if(this.seekType===a.SeekerCanvas.SEEK_POINTER)e=this.p,i=this.spectrum.getInternalCoordinates(e.x,e.y);else if(this.seekType===a.SeekerCanvas.SEEK_PLOT||this.seekType===a.SeekerCanvas.SEEK_PEAK){if(!(i=this.seekType===a.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x)))return;e={x:this.spectrum.getTransformedX(i.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(i.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}t.fillStyle="white",t.strokeStyle=this.specs.plots_color,t.lineWidth=this.specs.plots_width,t.beginPath(),t.arc(e.x,e.y,3,0,2*h.PI,!1),t.fill(),t.stroke(),t.font=l.getFontString(this.specs.text_font_size,this.specs.text_font_families),t.textAlign="left",t.textBaseline="bottom";var s="x:"+i.x.toFixed(3)+", y:"+i.y.toFixed(3),r=e.x+3,n=t.measureText(s).width;r+n>this.width-2&&(r-=6+n);var o=e.y;o-this.specs.text_font_size-2<0&&(o+=this.specs.text_font_size),t.fillRect(r,o-this.specs.text_font_size,n,this.specs.text_font_size),t.fillStyle="black",t.fillText(s,r,o)}},e.mouseout=function(t){this.p=void 0,this.repaint()},e.mousemove=function(t){this.p={x:t.p.x-2,y:t.p.y-3},this.repaint()},e.touchstart=function(t){this.mousemove(t)},e.touchmove=function(t){this.mousemove(t)},e.touchend=function(t){this.mouseout(t)},a.SeekerCanvas.SEEK_POINTER="pointer",a.SeekerCanvas.SEEK_PLOT="plot",a.SeekerCanvas.SEEK_PEAK="peak"}(Te,Te.extensions,Math),function(_,v,x,b,y,w,D,r,f,t,S,T,e,d){_._Canvas3D=function(t,e,i){t&&this.create(t,e,i)};var i=_._Canvas3D.prototype=new _._Canvas,n=_._Canvas.prototype;i.rotationMatrix=d,i.lastPoint=d,i.emptyMessage="WebGL is Unavailable!",i.lastPinchScale=1,i.lastGestureRotate=0,i.afterLoadContent=function(){for(var t=new x.Bounds,e=0,i=this.molecules.length;e<i;e++)t.expand(this.molecules[e].getBounds3D());var s=S.dist([t.maxX,t.maxY,t.maxZ],[t.minX,t.minY,t.minZ])/2+1.5;s===1/0&&(s=10),this.maxDimension=D.max(t.maxX-t.minX,t.maxY-t.minY);var r=D.min(179.9,D.max(this.specs.projectionPerspectiveVerticalFieldOfView_3D,.1)),n=r/360*D.PI,o=s,a=o/(D.tan(n)/.8),l=a-o,h=a+o,u=this.width/this.height;this.camera.fieldOfView=r,this.camera.near=l,this.camera.far=h,this.camera.aspect=u,f.translate(f.identity(this.camera.viewMatrix),[0,0,-a]);var c=o/D.tan(n);this.lighting.camera.fieldOfView=r,this.lighting.camera.near=c-o,this.lighting.camera.far=c+o,this.lighting.updateView(),this.setupScene()},i.renderDepthMap=function(){if(this.specs.shadow_3D&&y.DepthShader){var t=this.gl.isEnabled(this.gl.CULL_FACE);t||this.gl.enable(this.gl.CULL_FACE),this.depthShader.useShaderProgram(this.gl);var e=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0),this.lightDepthMapFramebuffer.bind(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.depthShader.setProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix),this.depthShader.enableAttribsArray(this.gl);for(var i=0,s=this.molecules.length;i<s;i++)this.molecules[i].render(this.gl,this.specs);this.gl.flush(),this.depthShader.disableAttribsArray(this.gl),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(e[0],e[1],e[2],e[3]),t||this.gl.disable(this.gl.CULL_FACE)}},i.renderExtras=function(){this.phongShader.useShaderProgram(this.gl),this.phongShader.enableAttribsArray(this.gl);for(var t=[],e=0,i=this.shapes.length;e<i;e++){(s=this.shapes[e])instanceof y._Surface&&(!s.specs&&1!==this.specs.surfaces_alpha||s.specs&&1!==s.specs.surfaces_alpha)?t.push(s):s.render(this.gl,this.specs)}if(0!==t.length){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1);for(e=0,i=t.length;e<i;e++){(s=t[e]).render(this.gl,this.specs)}this.gl.depthMask(!0),this.gl.disable(this.gl.BLEND),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}if(this.phongShader.setShadow(this.gl,!1),this.phongShader.setFogMode(this.gl,0),this.phongShader.setFlatColor(this.gl,!1),this.specs.compass_display&&(this.phongShader.setLightDirection(this.gl,[0,0,-1]),this.compass.render(this.gl,this.specs)),this.phongShader.disableAttribsArray(this.gl),this.gl.flush(),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.labelShader.useShaderProgram(this.gl),this.labelShader.setMatrixUniforms(this.gl,this.gl.modelViewMatrix),this.labelShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.labelShader.setDimension(this.gl,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.labelShader.enableAttribsArray(this.gl),this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules()),this.specs.measurement_displayText_3D)for(e=0,i=this.shapes.length;e<i;e++){var s;(s=this.shapes[e]).renderText&&s.renderText(this.gl,this.specs)}this.specs.compass_display&&this.specs.compass_displayText_3D&&this.compass.renderAxis(this.gl),this.labelShader.disableAttribsArray(this.gl),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0),this.gl.flush(),this.drawChildExtras&&this.drawChildExtras(this.gl),this.gl.flush()},i.renderColor=function(){this.phongShader.useShaderProgram(this.gl),this.gl.uniform1i(this.phongShader.shadowDepthSampleUniform,0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lightDepthMapTexture.texture),this.phongShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.phongShader.setShadow(this.gl,this.specs.shadow_3D),this.phongShader.setFlatColor(this.gl,this.specs.flat_color_3D),this.phongShader.setGammaCorrection(this.gl,this.specs.gammaCorrection_3D),this.phongShader.setShadowTextureSize(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.phongShader.setShadowIntensity(this.gl,this.specs.shadow_intensity_3D),this.phongShader.setFogMode(this.gl,this.specs.fog_mode_3D),this.phongShader.setFogColor(this.gl,this.fogging.colorRGB),this.phongShader.setFogStart(this.gl,this.fogging.fogStart),this.phongShader.setFogEnd(this.gl,this.fogging.fogEnd),this.phongShader.setFogDensity(this.gl,this.fogging.density),this.phongShader.setLightProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix),this.phongShader.setLightDiffuseColor(this.gl,this.lighting.diffuseRGB),this.phongShader.setLightSpecularColor(this.gl,this.lighting.specularRGB),this.phongShader.setLightDirection(this.gl,this.lighting.direction),this.phongShader.enableAttribsArray(this.gl);for(var t=0,e=this.molecules.length;t<e;t++)this.molecules[t].render(this.gl,this.specs);this.phongShader.disableAttribsArray(this.gl),this.gl.flush()},i.renderPosition=function(){this.positionShader.useShaderProgram(this.gl),this.positionShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.positionShader.enableAttribsArray(this.gl);for(var t=0,e=this.molecules.length;t<e;t++)this.molecules[t].render(this.gl,this.specs);this.positionShader.disableAttribsArray(this.gl),this.gl.flush()},i.renderNormal=function(){this.normalShader.useShaderProgram(this.gl),this.normalShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.normalShader.enableAttribsArray(this.gl);for(var t=0,e=this.molecules.length;t<e;t++)this.molecules[t].render(this.gl,this.specs);this.normalShader.disableAttribsArray(this.gl),this.gl.flush()},i.renderSSAO=function(){this.ssaoShader.useShaderProgram(this.gl),this.ssaoShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.ssaoShader.setSampleKernel(this.gl,this.ssao.sampleKernel),this.ssaoShader.setKernelRadius(this.gl,this.specs.ssao_kernel_radius),this.ssaoShader.setPower(this.gl,this.specs.ssao_power),this.ssaoShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.uniform1i(this.ssaoShader.positionSampleUniform,0),this.gl.uniform1i(this.ssaoShader.normalSampleUniform,1),this.gl.uniform1i(this.ssaoShader.noiseSampleUniform,2),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssao.noiseTexture),this.gl.activeTexture(this.gl.TEXTURE0),this.ssaoShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.ssaoShader.disableAttribsArray(this.gl),this.gl.flush(),this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.ssaoBlurShader.useShaderProgram(this.gl),this.ssaoBlurShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.uniform1i(this.ssaoBlurShader.aoSampleUniform,0),this.gl.uniform1i(this.ssaoBlurShader.depthSampleUniform,1),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.ssaoBlurShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.ssaoBlurShader.disableAttribsArray(this.gl),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.flush()},i.renderOutline=function(){this.outlineShader.useShaderProgram(this.gl),this.outlineShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.outlineShader.setNormalThreshold(this.gl,this.specs.outline_normal_threshold),this.outlineShader.setDepthThreshold(this.gl,this.specs.outline_depth_threshold),this.outlineShader.setThickness(this.gl,this.specs.outline_thickness),this.gl.uniform1i(this.outlineShader.normalSampleUniform,0),this.gl.uniform1i(this.outlineShader.depthSampleUniform,1),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.outlineShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.outlineShader.disableAttribsArray(this.gl),this.gl.flush()},i.deferredRender=function(){var t=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(0,0,0,0),this.colorFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.renderColor(),this.positionFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.renderPosition(),this.normalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.renderNormal(),this.specs.ssao_3D&&y.SSAOShader?(this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.renderSSAO()):(this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this.outlineFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.specs.outline_3D&&this.renderOutline(),this.gl.clearColor(t[0],t[1],t[2],t[3]),this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.lightingShader.useShaderProgram(this.gl),this.gl.uniform1i(this.lightingShader.positionSampleUniform,0),this.gl.uniform1i(this.lightingShader.colorSampleUniform,1),this.gl.uniform1i(this.lightingShader.ssaoSampleUniform,2),this.gl.uniform1i(this.lightingShader.outlineSampleUniform,3),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colorTexture.texture),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssaoTexture.texture),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outlineTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.lightingShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.lightingShader.disableAttribsArray(this.gl),this.gl.flush(),this.fxaaFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.fxaaShader.useShaderProgram(this.gl),this.fxaaShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaShader.setAntialias(this.gl,this.specs.antialias_3D),this.fxaaShader.setEdgeThreshold(this.gl,this.specs.fxaa_edgeThreshold),this.fxaaShader.setEdgeThresholdMin(this.gl,this.specs.fxaa_edgeThresholdMin),this.fxaaShader.setSearchSteps(this.gl,this.specs.fxaa_searchSteps),this.fxaaShader.setSearchThreshold(this.gl,this.specs.fxaa_searchThreshold),this.fxaaShader.setSubpixCap(this.gl,this.specs.fxaa_subpixCap),this.fxaaShader.setSubpixTrim(this.gl,this.specs.fxaa_subpixTrim),this.fxaaShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.fxaaShader.disableAttribsArray(this.gl),this.gl.flush(),this.finalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.renderExtras(),this.gl.clearColor(t[0],t[1],t[2],t[3]),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.fxaaTexture.texture),this.quadShader.useShaderProgram(this.gl),this.quadShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.quadShader.disableAttribsArray(this.gl),this.gl.flush()},i.forwardRender=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.renderColor(),this.renderExtras()},i.repaint=function(){this.gl&&(this.gl.lightViewMatrix=f.multiply(this.lighting.camera.viewMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,this.gl.modelViewMatrix=this.gl.lightViewMatrix,this.renderDepthMap(),this.gl.modelViewMatrix=f.multiply(this.camera.viewMatrix,this.rotationMatrix,[]),this.isSupportDeferred()&&(this.specs.ssao_3D||this.specs.outline_3D)?this.deferredRender():this.forwardRender())},i.pick=function(t,e,i,s){if(this.gl){var r=t,n=this.height-e;1!==this.pixelRatio&&(r*=this.pixelRatio,n*=this.pixelRatio),f.multiply(this.camera.viewMatrix,this.rotationMatrix,this.gl.modelViewMatrix),this.gl.rotationMatrix=this.rotationMatrix,this.pickShader.useShaderProgram(this.gl);var o=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0),this.pickerFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.pickShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.pickShader.enableAttribsArray(this.gl);for(var a=[],l=0,h=this.molecules.length;l<h;l++)this.molecules[l].renderPickFrame(this.gl,this.specs,a,i,s);this.pickShader.disableAttribsArray(this.gl),this.gl.flush();var u=new Uint8Array(4);this.gl.readPixels(r-2,n+2,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,u);var c=d;if(0<u[3])c=a[u[2]|u[1]<<8|u[0]<<16];return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(o[0],o[1],o[2],o[3]),c}return d},i.center=function(){for(var t=new b.Atom,e=0,i=this.molecules.length;e<i;e++){var s=this.molecules[e];t.add3D(s.getCenter3D())}t.x/=this.molecules.length,t.y/=this.molecules.length;for(e=0,i=this.molecules.length;e<i;e++){for(var r=0,n=(s=this.molecules[e]).atoms.length;r<n;r++)s.atoms[r].sub3D(t);if(s.chains&&s.fromJSON)for(r=0,n=s.chains.length;r<n;r++)for(var o=s.chains[r],a=0,l=o.length;a<l;a++){var h=o[a];h.cp1.sub3D(t),h.cp2.sub3D(t),h.cp3&&(h.cp3.sub3D(t),h.cp4.sub3D(t),h.cp5.sub3D(t))}}},i.isSupportDeferred=function(){return this.gl.textureFloatExt&&this.gl.depthTextureExt},i.create=function(t,e,i){n.create.call(this,t,e,i);try{var s=r.getElementById(this.id);this.gl=s.getContext("webgl"),this.gl||(this.gl=s.getContext("experimental-webgl"))}catch(t){}this.gl?(1!==this.pixelRatio&&this.gl.canvas.width===this.width&&(this.gl.canvas.style.width=this.width+"px",this.gl.canvas.style.height=this.height+"px",this.gl.canvas.width=this.width*this.pixelRatio,this.gl.canvas.height=this.height*this.pixelRatio),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearDepth(1),this.shadowTextureSize=1024,this.rotationMatrix=f.identity([]),this.camera=new y.Camera,this.label3D=new y.Label,this.lighting=new y.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.fogging=new y.Fog(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.gl.depthTextureExt=this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture"),this.gl.textureFloatExt=this.gl.getExtension("OES_texture_float")||this.gl.getExtension("WEBKIT_OES_texture_float")||this.gl.getExtension("MOZ_OES_texture_float"),this.ssao=new y.SSAO,this.pickerColorTexture=new y.Texture,this.pickerColorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.pickerDepthRenderbuffer=new y.Renderbuffer,this.pickerDepthRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.pickerFramebuffer=new y.Framebuffer,this.pickerFramebuffer.init(this.gl),this.pickerFramebuffer.setColorTexture(this.gl,this.pickerColorTexture.texture),this.pickerFramebuffer.setDepthRenderbuffer(this.gl,this.pickerDepthRenderbuffer.renderbuffer),this.lightDepthMapTexture=new y.Texture,this.lightDepthMapRenderbuffer=new y.Renderbuffer,this.lightDepthMapFramebuffer=new y.Framebuffer,this.lightDepthMapFramebuffer.init(this.gl),this.gl.depthTextureExt?(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.RGBA4),this.lightDepthMapFramebuffer.setColorRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer),this.lightDepthMapFramebuffer.setDepthTexture(this.gl,this.lightDepthMapTexture.texture)):(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.lightDepthMapFramebuffer.setColorTexture(this.gl,this.lightDepthMapTexture.texture),this.lightDepthMapFramebuffer.setDepthRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer)),this.isSupportDeferred()&&(this.depthTexture=new y.Texture,this.depthTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.colorTexture=new y.Texture,this.colorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.positionTexture=new y.Texture,this.positionTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.normalTexture=new y.Texture,this.normalTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.ssaoTexture=new y.Texture,this.ssaoTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.outlineTexture=new y.Texture,this.outlineTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.fxaaTexture=new y.Texture,this.fxaaTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.imageTexture=new y.Texture,this.imageTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.colorFramebuffer=new y.Framebuffer,this.colorFramebuffer.init(this.gl),this.colorFramebuffer.setColorTexture(this.gl,this.colorTexture.texture),this.colorFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalFramebuffer=new y.Framebuffer,this.normalFramebuffer.init(this.gl),this.normalFramebuffer.setColorTexture(this.gl,this.normalTexture.texture),this.normalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.positionFramebuffer=new y.Framebuffer,this.positionFramebuffer.init(this.gl),this.positionFramebuffer.setColorTexture(this.gl,this.positionTexture.texture),this.positionFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.ssaoFramebuffer=new y.Framebuffer,this.ssaoFramebuffer.init(this.gl),this.ssaoFramebuffer.setColorTexture(this.gl,this.ssaoTexture.texture),this.outlineFramebuffer=new y.Framebuffer,this.outlineFramebuffer.init(this.gl),this.outlineFramebuffer.setColorTexture(this.gl,this.outlineTexture.texture),this.fxaaFramebuffer=new y.Framebuffer,this.fxaaFramebuffer.init(this.gl),this.fxaaFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.quadFramebuffer=new y.Framebuffer,this.quadFramebuffer.init(this.gl),this.quadFramebuffer.setColorTexture(this.gl,this.imageTexture.texture),this.finalFramebuffer=new y.Framebuffer,this.finalFramebuffer.init(this.gl),this.finalFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.finalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalShader=new y.NormalShader,this.normalShader.init(this.gl),this.positionShader=new y.PositionShader,this.positionShader.init(this.gl),y.SSAOShader&&(this.ssaoShader=new y.SSAOShader,this.ssaoShader.init(this.gl),this.ssaoBlurShader=new y.SSAOBlurShader,this.ssaoBlurShader.init(this.gl)),this.outlineShader=new y.OutlineShader,this.outlineShader.init(this.gl),this.lightingShader=new y.LightingShader,this.lightingShader.init(this.gl),this.fxaaShader=new y.FXAAShader,this.fxaaShader.init(this.gl),this.quadShader=new y.QuadShader,this.quadShader.init(this.gl)),this.labelShader=new y.LabelShader,this.labelShader.init(this.gl),this.pickShader=new y.PickShader,this.pickShader.init(this.gl),this.phongShader=new y.PhongShader,this.phongShader.init(this.gl),y.DepthShader&&(this.depthShader=new y.DepthShader,this.depthShader.init(this.gl)),this.textTextImage=new y.TextImage,this.textTextImage.init(this.gl),this.gl.textImage=new y.TextImage,this.gl.textImage.init(this.gl),this.gl.textMesh=new y.TextMesh,this.gl.textMesh.init(this.gl),this.gl.material=new y.Material,this.setupScene()):this.displayMessage()},i.displayMessage=function(){var t=r.getElementById(this.id);if(t.getContext){var e=t.getContext("2d");this.specs.backgroundColor&&(e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2))}},i.renderText=function(t,e){var i={position:[],texCoord:[],translation:[]};this.textTextImage.pushVertexData(t,e,0,i),this.gl.textMesh.storeData(this.gl,i.position,i.texCoord,i.translation),this.textTextImage.useTexture(this.gl),this.gl.textMesh.render(this.gl)},i.setupScene=function(){if(this.gl){T("#"+this.id).css("background-color",this.specs.backgroundColor);var t=x.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(t[0],t[1],t[2],1),this.specs.cullBackFace_3D?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.sphereBuffer=new y.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new y.Star,this.gl.cylinderBuffer=new y.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.cylinderClosedBuffer=new y.Cylinder(1,1,this.specs.bonds_resolution_3D,!0),this.gl.boxBuffer=new y.Box(1,1,1),this.gl.pillBuffer=new y.Pill(this.specs.bonds_pillDiameter_3D/2,this.specs.bonds_pillHeight_3D,this.specs.bonds_pillLatitudeResolution_3D,this.specs.bonds_pillLongitudeResolution_3D),this.gl.lineBuffer=new y.Line,this.gl.lineArrowBuffer=new y.LineArrow,this.gl.arrowBuffer=new y.Arrow(.3,this.specs.compass_resolution_3D),this.gl.quadBuffer=new y.Quad,this.gl.textImage.updateFont(this.gl,this.specs.text_font_size,this.specs.text_font_families,this.specs.text_font_bold,this.specs.text_font_italic,this.specs.text_font_stroke_3D),this.lighting.lightScene(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.fogging.fogScene(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.compass=new y.Compass(this.gl,this.specs),this.lightDepthMapTexture.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.lightDepthMapRenderbuffer.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.pickerColorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.pickerDepthRenderbuffer.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.isSupportDeferred()&&(this.depthTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.colorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.imageTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.positionTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.normalTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssaoTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.outlineTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssao.initSampleKernel(this.specs.ssao_kernel_samples),this.ssao.initNoiseTexture(this.gl)),this.camera.updateProjectionMatrix(this.specs.projectionPerspective_3D);for(var e=0,i=this.molecules.length;e<i;e++){if((g=this.molecules[e]).labelMesh instanceof y.TextMesh||(g.labelMesh=new y.TextMesh,g.labelMesh.init(this.gl)),g.chains){g.ribbons=[],g.cartoons=[],g.tubes=[],g.pipePlanks=[];for(var s=0,r=g.chains.length;s<r;s++){for(var n=g.chains[s],o=0,a=n.length-1;o<a;o++)n[o].Test=o;var l=3<n.length&&w[n[3].name]&&"#BEA06E"===w[n[3].name].aminoColor;if(0<n.length&&!n[0].lineSegments){for(o=0,a=n.length-1;o<a;o++)n[o].setup(n[o+1].cp1,l?1:this.specs.proteins_horizontalResolution);if(!l)for(o=1,a=n.length-1;o<a;o++)v.vec3AngleFrom(n[o-1].D,n[o].D)>D.PI/2&&(n[o].guidePointsSmall.reverse(),n[o].guidePointsLarge.reverse(),S.scale(n[o].D,-1));for(o=2,a=n.length-3;o<a;o++)n[o].computeLineSegments(n[o-2],n[o-1],n[o+1],!l,l?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);n.pop(),n.pop(),n.pop(),n.shift(),n.shift()}var h=x.hsl2rgb(1===r?.5:s/r,1,.5),u="rgb("+h[0]+","+h[1]+","+h[2]+")";if(n.chainColor=u,l){(c=new y.Tube(n,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D)).chainColor=u,g.tubes.push(c)}else{var c=new y.PipePlank(n,this.specs);g.pipePlanks.push(c);var f=n.shift(),d={front:new y.Ribbon(n,this.specs.proteins_ribbonThickness,!1),back:new y.Ribbon(n,-this.specs.proteins_ribbonThickness,!1)};d.front.chainColor=u,d.back.chainColor=u,g.ribbons.push(d);var m={front:new y.Ribbon(n,this.specs.proteins_ribbonThickness,!0),back:new y.Ribbon(n,-this.specs.proteins_ribbonThickness,!0)};m.front.chainColor=u,m.back.chainColor=u,g.cartoons.push(m),n.unshift(f)}}}}if(this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs),this instanceof _.MovieCanvas3D&&this.frames)for(o=0,a=this.frames.length;o<a;o++){var p=this.frames[o];for(s=0,r=p.mols.length;s<r;s++){var g;(g=p.mols[s]).labelMesh instanceof b.d3.TextMesh||(g.labelMesh=new b.d3.TextMesh,g.labelMesh.init(this.gl))}this.label3D.updateVerticesBuffer(this.gl,p.mols,this.specs)}}},i.updateScene=function(){this.camera.updateProjectionMatrix(this.specs.projectionPerspective_3D),this.lighting.lightScene(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.fogging.fogScene(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.repaint()},i.mousedown=function(t){this.lastPoint=t.p},i.mouseup=function(t){this.lastPoint=d},i.rightmousedown=function(t){this.lastPoint=t.p},i.drag=function(t){if(this.lastPoint){if(_.monitor.ALT){var e=new b.Point(t.p.x,t.p.y);e.sub(this.lastPoint);var i=this.camera.fieldOfView/360*D.PI,s=D.tan(i),r=this.height/2/this.camera.zoom/s,n=this.camera.focalLength()/r;f.translate(this.camera.viewMatrix,[e.x*n,-e.y*n,0])}else{var o=t.p.x-this.lastPoint.x,a=t.p.y-this.lastPoint.y,l=f.rotate(f.identity([]),o*D.PI/180,[0,1,0]);f.rotate(l,a*D.PI/180,[1,0,0]),this.rotationMatrix=f.multiply(l,this.rotationMatrix)}this.lastPoint=t.p,this.repaint()}},i.mousewheel=function(t,e){0<e?this.camera.zoomIn():this.camera.zoomOut(),this.updateScene()},i.multitouchmove=function(t,e){if(2===e)if(this.lastPoint&&this.lastPoint.multi){var i=new b.Point(t.p.x,t.p.y);i.sub(this.lastPoint);var s=this.camera.fieldOfView/360*D.PI,r=D.tan(s),n=this.height/2/this.camera.zoom/r,o=this.camera.focalLength()/n;f.translate(this.camera.viewMatrix,[i.x*o,-i.y*o,0]),this.lastPoint=t.p,this.repaint()}else this.lastPoint=t.p,this.lastPoint.multi=!0},i.gesturechange=function(t){if(t.originalEvent.scale-this.lastPinchScale!=0){var e=30*-(t.originalEvent.scale/this.lastPinchScale-1);if(isNaN(e))return;0<e?this.camera.zoomIn():this.camera.zoomOut(),this.updateScene(),this.lastPinchScale=t.originalEvent.scale}this.repaint()},i.gestureend=function(t){this.lastPinchScale=1,this.lastGestureRotate=0}}(Te,Te.extensions,Te.math,Te.structures,Te.structures.d3,Te.RESIDUE,Math,document,Te.lib.mat4,Te.lib.mat3,Te.lib.vec3,Te.lib.jQuery,window),function(t,i,n,o,e){t.MolGrabberCanvas3D=function(t,e,i){t&&this.create(t,e,i);var s=[];s.push('<br><input type="text" id="'),s.push(t),s.push('_query" size="32" value="" />'),s.push("<br><nobr>"),s.push('<select id="'),s.push(t),s.push('_select">'),s.push('<option value="pubchem" selected>PubChem'),s.push("</select>"),s.push('<button id="'),s.push(t),s.push('_submit">Show Molecule</button>'),s.push("</nobr>"),o.writeln(s.join(""));var r=this;n("#"+t+"_submit").click(function(){r.search()}),n("#"+t+"_query").keypress(function(t){13===t.which&&r.search()})};var s=t.MolGrabberCanvas3D.prototype=new t._Canvas3D;s.setSearchTerm=function(t){n("#"+this.id+"_query").val(t),this.search()},s.search=function(){var e=this;i.getMoleculeFromDatabase(n("#"+this.id+"_query").val(),{database:n("#"+this.id+"_select").val(),dimension:3},function(t){e.loadMolecule(t)})}}(Te,Te.iChemLabs,Te.lib.jQuery,document),function(t,c,e){t.MovieCanvas3D=function(t,e,i){t&&this.create(t,e,i),this.frames=[]},t.MovieCanvas3D.PLAY_ONCE=0,t.MovieCanvas3D.PLAY_LOOP=1,t.MovieCanvas3D.PLAY_SPRING=2;var i=t.MovieCanvas3D.prototype=new t._Canvas3D;i.timeout=50,i.frameNumber=0,i.playMode=2,i.reverse=!1,i.startAnimation=t._AnimatorCanvas.prototype.startAnimation,i.stopAnimation=t._AnimatorCanvas.prototype.stopAnimation,i.isRunning=t._AnimatorCanvas.prototype.isRunning,i.dblclick=t.RotatorCanvas.prototype.dblclick,i.nextFrame=function(t){var e=this.frames[this.frameNumber];this.molecules=e.mols,this.shapes=e.shapes,2===this.playMode&&this.reverse?(this.frameNumber--,this.frameNumber<0&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0)===this.playMode&&this.stopAnimation()))},i.center=function(){for(var t=new c.Atom,e=this.frames[0],i=0,s=e.mols.length;i<s;i++)t.add3D(e.mols[i].getCenter3D());t.x/=e.mols.length,t.y/=e.mols.length;var r=new c.Atom;r.sub3D(t);for(var n=0,o=this.frames.length;n<o;n++){var a=this.frames[n];for(i=0,s=a.mols.length;i<s;i++)for(var l=a.mols[i],h=0,u=l.atoms.length;h<u;h++)l.atoms[h].add3D(r)}},i.addFrame=function(t,e){this.frames.push({mols:t,shapes:e})}}(Te,Te.structures),function(t,e,i,s){var r=[],n=[1,0,0],o=[0,1,0],a=[0,0,1];t.RotatorCanvas3D=function(t,e,i){t&&this.create(t,e,i)};var l=t.RotatorCanvas3D.prototype=new t._Canvas3D;l.timeout=33;var h=e.PI/15;l.xIncrement=h,l.yIncrement=h,l.zIncrement=h,l.startAnimation=t._AnimatorCanvas.prototype.startAnimation,l.stopAnimation=t._AnimatorCanvas.prototype.stopAnimation,l.isRunning=t._AnimatorCanvas.prototype.isRunning,l.dblclick=t.RotatorCanvas.prototype.dblclick,l.mousedown=s,l.rightmousedown=s,l.drag=s,l.mousewheel=s,l.nextFrame=function(t){if(0!==this.molecules.length||0!==this.shapes.length){i.identity(r);var e=t/1e3;i.rotate(r,this.xIncrement*e,n),i.rotate(r,this.yIncrement*e,o),i.rotate(r,this.zIncrement*e,a),i.multiply(this.rotationMatrix,r)}else this.stopAnimation()}}(Te,Math,Te.lib.mat4),(xe=Te).TransformCanvas3D=function(t,e,i){t&&this.create(t,e,i)},xe.TransformCanvas3D.prototype=new xe._Canvas3D,function(t,e){t.ViewerCanvas3D=function(t,e,i){t&&this.create(t,e,i)};var i=t.ViewerCanvas3D.prototype=new t._Canvas3D;i.mousedown=e,i.rightmousedown=e,i.drag=e,i.mousewheel=e}(Te),function(o,r,a,t,l){function h(t,e,i,s){this.element=t,this.x=e,this.y=i,this.dimension=s,this.allowMultipleSelections=!1}o.PeriodicTableCanvas=function(t,e){this.padding=5,t&&this.create(t,18*e+2*this.padding,10*e+2*this.padding),this.cellDimension=e||20,this.setupTable(),this.repaint()};var e=o.PeriodicTableCanvas.prototype=new o._Canvas;e.loadMolecule=l,e.getMolecule=l,e.getHoveredElement=function(){return this.hovered?this.hovered.element:l},e.innerRepaint=function(t){for(var e=0,i=this.cells.length;e<i;e++)this.drawCell(t,this.specs,this.cells[e]);this.hovered&&this.drawCell(t,this.specs,this.hovered),this.selected&&this.drawCell(t,this.specs,this.selected)},e.setupTable=function(){this.cells=[];for(var t=this.padding,e=this.padding,i=0,s=0,r=o.SYMBOLS.length;s<r;s++){18===i&&(i=0,e+=this.cellDimension,t=this.padding),2===(n=o.ELEMENT[o.SYMBOLS[s]]).atomicNumber?(t+=16*this.cellDimension,i+=16):5!==n.atomicNumber&&13!==n.atomicNumber||(t+=10*this.cellDimension,i+=10),(n.atomicNumber<58||71<n.atomicNumber&&n.atomicNumber<90||103<n.atomicNumber)&&n.atomicNumber<=118&&(this.cells.push(new h(n,t,e,this.cellDimension)),t+=this.cellDimension,i++)}e+=2*this.cellDimension,t=3*this.cellDimension+this.padding;for(s=57;s<104;s++){var n;90===(n=o.ELEMENT[o.SYMBOLS[s]]).atomicNumber&&(e+=this.cellDimension,t=3*this.cellDimension+this.padding),(58<=n.atomicNumber&&n.atomicNumber<=71||90<=n.atomicNumber&&n.atomicNumber<=103)&&(this.cells.push(new h(n,t,e,this.cellDimension)),t+=this.cellDimension)}},e.drawCell=function(t,e,i){var s=t.createRadialGradient(i.x+i.dimension/3,i.y+i.dimension/3,1.5*i.dimension,i.x+i.dimension/3,i.y+i.dimension/3,i.dimension/10);s.addColorStop(0,"#000000"),s.addColorStop(.7,i.element.jmolColor),s.addColorStop(1,"#FFFFFF"),t.fillStyle=s,r.contextRoundRect(t,i.x,i.y,i.dimension,i.dimension,i.dimension/8),i!==this.hovered&&i!==this.selected&&!i.selected||(t.lineWidth=2,t.strokeStyle="#c10000",t.stroke(),t.fillStyle="white"),t.fill(),t.font=r.getFontString(e.text_font_size,e.text_font_families),t.fillStyle=e.text_color,t.textAlign="center",t.textBaseline="middle",t.fillText(i.element.symbol,i.x+i.dimension/2,i.y+i.dimension/2)},e.click=function(t){this.hovered&&(this.allowMultipleSelections?this.hovered.selected=!this.hovered.selected:this.selected=this.hovered,this.repaint())},e.touchstart=function(t){this.mousemove(t)},e.mousemove=function(t){var e=t.p.x,i=t.p.y;this.hovered=l;for(var s=0,r=this.cells.length;s<r;s++){var n=this.cells[s];if(a.isBetween(e,n.x,n.x+n.dimension)&&a.isBetween(i,n.y,n.y+n.dimension)){this.hovered=n;break}}this.repaint()},e.mouseout=function(t){this.hovered=l,this.repaint()}}(Te,Te.extensions,Te.math,document),be=Te.io,ye=document,we=window,be.png={},be.png.string=function(t){return ye.getElementById(t.id).toDataURL("image/png")},be.png.open=function(t){we.open(this.string(t))},De=Te.io,Se=Te.lib.jQuery,De.file={},De.file.content=function(t,e){Se.get(t,"",e)},function(r,o,t,n,i,e,s){o.SERVER_URL="https://ichemlabs.cloud.chemdoodle.com/icl_cdc_v070001/WebHQ",o.inRelay=!1,o.asynchronous=!0,o.INFO={userAgent:navigator.userAgent,v_cwc:r.getVersion(),v_jQuery:i.fn.jquery,v_jQuery_ui:i.ui?i.ui.version:"N/A"};var a=new t.JSONInterpreter,l=new n.Queue;o._contactServer=function(r,t,e,s,n){this.inRelay?l.enqueue({call:r,content:t,options:e,callback:s,errorback:n}):(o.inRelay=!0,i.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:r,content:t,options:e,info:o.INFO}),url:this.SERVER_URL,success:function(t){var e=JSON.parse(t);if(e.message&&alert(e.message),o.inRelay=!1,s&&e.content&&!e.stop&&s(e.content),e.stop&&n&&n(),!l.isEmpty()){var i=l.dequeue();o._contactServer(i.call,i.content,i.options,i.callback,i.errorback)}},error:function(t,e,i){if("checkForUpdates"!=r&&alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support."),o.inRelay=!1,n&&n(),!l.isEmpty()){var s=l.dequeue();o._contactServer(s.call,s.content,s.options,s.callback,s.errorback)}},xhrFields:{withCredentials:!0},async:o.asynchronous}))},o.authenticate=function(t,e,i,s){this._contactServer("authenticate",{credential:t},e,function(t){i(t)},s)},o.calculate=function(t,e,i,s){this._contactServer("calculate",{mol:a.molTo(t)},e,function(t){i(t)},s)},o.createLewisDotStructure=function(t,e,i,s){this._contactServer("createLewisDot",{mol:a.molTo(t)},e,function(t){i(a.molFrom(t.mol))},s)},o.generateImage=function(t,e,i,s){this._contactServer("generateImage",{mol:a.molTo(t)},e,function(t){i(t.link)},s)},o.generateIUPACName=function(t,e,i,s){this._contactServer("generateIUPACName",{mol:a.molTo(t)},e,function(t){i(t.iupac)},s)},o.getAd=function(e,t){this._contactServer("getAd",{},{},function(t){e(t.image_url,t.target_url)},t)},o.getMoleculeFromContent=function(t,e,r,i){this._contactServer("getMoleculeFromContent",{content:t},e,function(t){for(var e=!1,i=0,s=t.mol.a.length;i<s;i++)if(0!==t.mol.a[i].z){e=!0;break}if(e)for(i=0,s=t.mol.a.length;i<s;i++)t.mol.a[i].x/=20,t.mol.a[i].y/=20,t.mol.a[i].z/=20;r(a.molFrom(t.mol))},i)},o.getMoleculeFromDatabase=function(t,s,r,e){this._contactServer("getMoleculeFromDatabase",{query:t},s,function(t){if(3===s.dimension)for(var e=0,i=t.mol.a.length;e<i;e++)t.mol.a[e].x/=20,t.mol.a[e].y/=-20,t.mol.a[e].z/=20;r(a.molFrom(t.mol))},e)},o.getOptimizedPDBStructure=function(t,e,i,s){this._contactServer("getOptimizedPDBStructure",{id:t},e,function(t){var e;(e=t.mol?a.molFrom(t.mol):new n.Molecule).chains=a.chainsFrom(t.ribbons),e.fromJSON=!0,i(e)},s)},o.getZeoliteFromIZA=function(t,e,i,s){this._contactServer("getZeoliteFromIZA",{query:t},e,function(t){i(Te.readCIF(t.cif,e.xSuper,e.ySuper,e.zSuper))},s)},o.isGraphIsomorphism=function(t,e,i,s,r){this._contactServer("isGraphIsomorphism",{arrow:a.molTo(t),target:a.molTo(e)},i,function(t){s(t.value)},r)},o.isSubgraphIsomorphism=function(t,e,i,s,r){this._contactServer("isSubgraphIsomorphism",{arrow:a.molTo(t),target:a.molTo(e)},i,function(t){s(t.value)},r)},o.isSupergraphIsomorphism=function(t,e,i,s,r){this._contactServer("isSupergraphIsomorphism",{arrow:a.molTo(t),target:a.molTo(e)},i,function(t){s(t.value)},r)},o.getSimilarityMeasure=function(t,e,i,s,r){this._contactServer("getSimilarityMeasure",{first:a.molTo(t),second:a.molTo(e)},i,function(t){s(t.value)},r)},o.kekulize=function(t,e,i,s){this._contactServer("kekulize",{mol:a.molTo(t)},e,function(t){i(a.molFrom(t.mol))},s)},o.mechanismMatch=function(t,e,i,s,r){this._contactServer("matchMechanism",{arrow:t,targets:e},i,function(t){s(t)},r)},o.optimize=function(r,n,o,t){this._contactServer("optimize",{mol:a.molTo(r)},n,function(t){var e=a.molFrom(t.mol);if(2===n.dimension){for(var i=0,s=e.atoms.length;i<s;i++)r.atoms[i].x=e.atoms[i].x,r.atoms[i].y=e.atoms[i].y;o()}else if(3===n.dimension){for(i=0,s=e.atoms.length;i<s;i++)e.atoms[i].x/=20,e.atoms[i].y/=-20,e.atoms[i].z/=20;o(e)}},t)},o.readIUPACName=function(t,e,i,s){this._contactServer("readIUPACName",{iupac:t},e,function(t){i(a.molFrom(t.mol))},s)},o.readSMILES=function(t,e,i,s){this._contactServer("readSMILES",{smiles:t},e,function(t){i(a.molFrom(t.mol))},s)},o.saveFile=function(t,e,i,s){this._contactServer("saveFile",{mol:a.molTo(t)},e,function(t){i(t.link)},s)},o.simulate13CNMR=function(t,e,i,s){e.nucleus="C",e.isotope=13,this._contactServer("simulateNMR",{mol:a.molTo(t)},e,function(t){i(r.readJCAMP(t.jcamp))},s)},o.simulate1HNMR=function(t,e,i,s){e.nucleus="H",e.isotope=1,this._contactServer("simulateNMR",{mol:a.molTo(t)},e,function(t){i(r.readJCAMP(t.jcamp))},s)},o.simulateMassParentPeak=function(t,e,i,s){this._contactServer("simulateMassParentPeak",{mol:a.molTo(t)},e,function(t){i(r.readJCAMP(t.jcamp))},s)},o.writeSMILES=function(t,e,i,s){this._contactServer("writeSMILES",{mol:a.molTo(t)},e,function(t){i(t.smiles)},s)},o.version=function(t,e,i){this._contactServer("version",{},t,function(t){e(t.value)},i)},o.checkForUpdates=function(t){this._contactServer("checkForUpdates",{value:e.href},t,function(t){},function(){})}}(Te,Te.iChemLabs,Te.io,Te.structures,Te.lib.jQuery,location)}],r.c=o,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)).ChemDoodle;function r(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,o});