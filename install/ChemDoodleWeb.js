//
// ChemDoodle Web Components 8.0.0
//
// http://web.chemdoodle.com
//
// Copyright 2009-2017 iChemLabs, LLC.  All rights reserved.
//
// The ChemDoodle Web Components library is licensed under version 3
// of the GNU GENERAL PUBLIC LICENSE.
//
// You may redistribute it and/or modify it under the terms of the
// GNU General Public License as published by the Free Software Foundation,
// either version 3 of the License, or (at your option) any later version.
//
// As an exception to the GPL, you may distribute this packed form of
// the code without the copy of the GPL license normally required,
// provided you include this license notice and a URL through which
// recipients can access the corresponding unpacked source code. 
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// ChemDoodle Web Components employs 3rd party libraries under the MIT
// license. For a full list with links to the original source, go to:
// https://web.chemdoodle.com/installation/download/#libraries
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact-us> for
// alternate licensing options.
//
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ChemDoodle",[],e):"object"==typeof exports?exports.ChemDoodle=e():t.ChemDoodle=e()}(window,function(){return(o={},r.m=n=[function(t,e,i){"use strict";i.r(e);var n=i(2);i.d(e,"jQuery",function(){return n.a});var r=i(3);for(var s in r)["jQuery","jsBezier","MarchingCubes","default"].indexOf(s)<0&&function(t){i.d(e,t,function(){return r[t]})}(s);var o=i(4);i.d(e,"jsBezier",function(){return o.a});var a=i(5);i.d(e,"MarchingCubes",function(){return a.a})},function(We,Ge,t){var Xe,e,i;e="undefined"!=typeof window?window:this,i=function(T,t){function e(t,e){return e.toUpperCase()}var i=[],D=T.document,u=i.slice,p=i.concat,a=i.push,r=i.indexOf,n={},s=n.toString,m=n.hasOwnProperty,g={},S=function(t,e){return new S.fn.init(t,e)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,h=/^-ms-/,l=/-([\da-z])/gi;function c(t){var e=!!t&&"length"in t&&t.length,i=S.type(t);return"function"!==i&&!S.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}S.fn=S.prototype={jquery:"2.2.4",constructor:S,selector:"",length:0,toArray:function(){return u.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:u.call(this)},pushStack:function(t){var e=S.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return S.each(this,t)},map:function(i){return this.pushStack(S.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(0<=i&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},S.extend=S.fn.extend=function(){var t,e,i,n,r,s,o=arguments[0]||{},a=1,h=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||S.isFunction(o)||(o={}),a===h&&(o=this,a--);a<h;a++)if(null!=(t=arguments[a]))for(e in t)i=o[e],o!==(n=t[e])&&(l&&n&&(S.isPlainObject(n)||(r=S.isArray(n)))?(s=r?(r=!1,i&&S.isArray(i)?i:[]):i&&S.isPlainObject(i)?i:{},o[e]=S.extend(l,s,n)):void 0!==n&&(o[e]=n));return o},S.extend({expando:"jQuery"+("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===S.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!S.isArray(t)&&0<=e-parseFloat(e)+1},isPlainObject:function(t){var e;if("object"!==S.type(t)||t.nodeType||S.isWindow(t))return!1;if(t.constructor&&!m.call(t,"constructor")&&!m.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||m.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?n[s.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;(t=S.trim(t))&&(1===t.indexOf("use strict")?((e=D.createElement("script")).text=t,D.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(h,"ms-").replace(l,e)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,n=0;if(c(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(o,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(c(Object(t))?S.merge(i,"string"==typeof t?[t]:t):a.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,s=t.length,o=!i;r<s;r++)!e(t[r],r)!=o&&n.push(t[r]);return n},map:function(t,e,i){var n,r,s=0,o=[];if(c(t))for(n=t.length;s<n;s++)null!=(r=e(t[s],s,i))&&o.push(r);else for(s in t)null!=(r=e(t[s],s,i))&&o.push(r);return p.apply([],o)},guid:1,proxy:function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),S.isFunction(t))return n=u.call(arguments,2),(r=function(){return t.apply(e||this,n.concat(u.call(arguments)))}).guid=t.guid=t.guid||S.guid++,r},now:Date.now,support:g}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=i[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){n["[object "+e+"]"]=e.toLowerCase()});var f=function(i){function c(t,e,i){var n="0x"+e-65536;return n!=n||i?e:n<0?String.fromCharCode(65536+n):String.fromCharCode(n>>10|55296,1023&n|56320)}function r(){w()}var t,m,b,s,o,p,f,g,y,h,l,w,T,a,D,v,u,d,_,S="sizzle"+1*new Date,x=i.document,C=0,n=0,A=rt(),E=rt(),F=rt(),R=function(t,e){return t===e&&(l=!0),0},P={}.hasOwnProperty,e=[],B=e.pop,M=e.push,I=e.push,L=e.slice,N=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},k="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="[\\x20\\t\\r\\n\\f]",z="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",U="\\["+O+"*("+z+")(?:"+O+"*([*^$|!~]?=)"+O+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+z+"))|)"+O+"*\\]",H=":("+z+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",j=new RegExp(O+"+","g"),q=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),W=new RegExp("^"+O+"*,"+O+"*"),G=new RegExp("^"+O+"*([>+~]|"+O+")"+O+"*"),X=new RegExp("="+O+"*([^\\]'\"]*?)"+O+"*\\]","g"),V=new RegExp(H),Y=new RegExp("^"+z+"$"),Z={ID:new RegExp("^#("+z+")"),CLASS:new RegExp("^\\.("+z+")"),TAG:new RegExp("^("+z+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),bool:new RegExp("^(?:"+k+")$","i"),needsContext:new RegExp("^"+O+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,$=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=/'|\\/g,it=new RegExp("\\\\([\\da-f]{1,6}"+O+"?|("+O+")|.)","ig");try{I.apply(e=L.call(x.childNodes),x.childNodes),e[x.childNodes.length].nodeType}catch(t){I={apply:e.length?function(t,e){M.apply(t,L.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function nt(t,e,i,n){var r,s,o,a,h,l,u,c,f=e&&e.ownerDocument,d=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return i;if(!n&&((e?e.ownerDocument||e:x)!==T&&w(e),e=e||T,D)){if(11!==d&&(l=K.exec(t)))if(r=l[1]){if(9===d){if(!(o=e.getElementById(r)))return i;if(o.id===r)return i.push(o),i}else if(f&&(o=f.getElementById(r))&&_(e,o)&&o.id===r)return i.push(o),i}else{if(l[2])return I.apply(i,e.getElementsByTagName(t)),i;if((r=l[3])&&m.getElementsByClassName&&e.getElementsByClassName)return I.apply(i,e.getElementsByClassName(r)),i}if(m.qsa&&!F[t+" "]&&(!v||!v.test(t))){if(1!==d)f=e,c=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(et,"\\$&"):e.setAttribute("id",a=S),s=(u=p(t)).length,h=Y.test(a)?"#"+a:"[id='"+a+"']";s--;)u[s]=h+" "+mt(u[s]);c=u.join(","),f=tt.test(t)&&ft(e.parentNode)||e}if(c)try{return I.apply(i,f.querySelectorAll(c)),i}catch(t){}finally{a===S&&e.removeAttribute("id")}}}return g(t.replace(q,"$1"),e,i,n)}function rt(){var n=[];return function t(e,i){return n.push(e+" ")>b.cacheLength&&delete t[n.shift()],t[e+" "]=i}}function st(t){return t[S]=!0,t}function ot(t){var e=T.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function at(t,e){for(var i=t.split("|"),n=i.length;n--;)b.attrHandle[i[n]]=e}function ht(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function lt(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ut(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}function ct(o){return st(function(s){return s=+s,st(function(t,e){for(var i,n=o([],t.length,s),r=n.length;r--;)t[i=n[r]]&&(t[i]=!(e[i]=t[i]))})})}function ft(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in m=nt.support={},o=nt.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},w=nt.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:x;return n!==T&&9===n.nodeType&&n.documentElement&&(a=(T=n).documentElement,D=!o(T),(i=T.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",r,!1):i.attachEvent&&i.attachEvent("onunload",r)),m.attributes=ot(function(t){return t.className="i",!t.getAttribute("className")}),m.getElementsByTagName=ot(function(t){return t.appendChild(T.createComment("")),!t.getElementsByTagName("*").length}),m.getElementsByClassName=J.test(T.getElementsByClassName),m.getById=ot(function(t){return a.appendChild(t).id=S,!T.getElementsByName||!T.getElementsByName(S).length}),m.getById?(b.find.ID=function(t,e){if(void 0!==e.getElementById&&D){var i=e.getElementById(t);return i?[i]:[]}},b.filter.ID=function(t){var e=t.replace(it,c);return function(t){return t.getAttribute("id")===e}}):(delete b.find.ID,b.filter.ID=function(t){var i=t.replace(it,c);return function(t){var e=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===i}}),b.find.TAG=m.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):m.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"!==t)return s;for(;i=s[r++];)1===i.nodeType&&n.push(i);return n},b.find.CLASS=m.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&D)return e.getElementsByClassName(t)},u=[],v=[],(m.qsa=J.test(T.querySelectorAll))&&(ot(function(t){a.appendChild(t).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+O+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||v.push("\\["+O+"*(?:value|"+k+")"),t.querySelectorAll("[id~="+S+"-]").length||v.push("~="),t.querySelectorAll(":checked").length||v.push(":checked"),t.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]")}),ot(function(t){var e=T.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&v.push("name"+O+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),v.push(",.*:")})),(m.matchesSelector=J.test(d=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ot(function(t){m.disconnectedMatch=d.call(t,"div"),d.call(t,"[s!='']:x"),u.push("!=",H)}),v=v.length&&new RegExp(v.join("|")),u=u.length&&new RegExp(u.join("|")),e=J.test(a.compareDocumentPosition),_=e||J.test(a.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},R=e?function(t,e){if(t===e)return l=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!m.sortDetached&&e.compareDocumentPosition(t)===i?t===T||t.ownerDocument===x&&_(x,t)?-1:e===T||e.ownerDocument===x&&_(x,e)?1:h?N(h,t)-N(h,e):0:4&i?-1:1)}:function(t,e){if(t===e)return l=!0,0;var i,n=0,r=t.parentNode,s=e.parentNode,o=[t],a=[e];if(!r||!s)return t===T?-1:e===T?1:r?-1:s?1:h?N(h,t)-N(h,e):0;if(r===s)return ht(t,e);for(i=t;i=i.parentNode;)o.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;o[n]===a[n];)n++;return n?ht(o[n],a[n]):o[n]===x?-1:a[n]===x?1:0}),T},nt.matches=function(t,e){return nt(t,null,null,e)},nt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==T&&w(t),e=e.replace(X,"='$1']"),m.matchesSelector&&D&&!F[e+" "]&&(!u||!u.test(e))&&(!v||!v.test(e)))try{var i=d.call(t,e);if(i||m.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return 0<nt(e,T,null,[t]).length},nt.contains=function(t,e){return(t.ownerDocument||t)!==T&&w(t),_(t,e)},nt.attr=function(t,e){(t.ownerDocument||t)!==T&&w(t);var i=b.attrHandle[e.toLowerCase()],n=i&&P.call(b.attrHandle,e.toLowerCase())?i(t,e,!D):void 0;return void 0!==n?n:m.attributes||!D?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},nt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},nt.uniqueSort=function(t){var e,i=[],n=0,r=0;if(l=!m.detectDuplicates,h=!m.sortStable&&t.slice(0),t.sort(R),l){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return h=null,t},s=nt.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=s(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=s(e);return i},(b=nt.selectors={cacheLength:50,createPseudo:st,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(it,c),t[3]=(t[3]||t[4]||t[5]||"").replace(it,c),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||nt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&nt.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&V.test(i)&&(e=p(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(it,c).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=A[t+" "];return e||(e=new RegExp("(^|"+O+")"+t+"("+O+"|$)"))&&A(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(t){var e=nt.attr(t,i);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(j," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(m,t,e,p,g){var v="nth"!==m.slice(0,3),_="last"!==m.slice(-4),x="of-type"===t;return 1===p&&0===g?function(t){return!!t.parentNode}:function(t,e,i){var n,r,s,o,a,h,l=v!=_?"nextSibling":"previousSibling",u=t.parentNode,c=x&&t.nodeName.toLowerCase(),f=!i&&!x,d=!1;if(u){if(v){for(;l;){for(o=t;o=o[l];)if(x?o.nodeName.toLowerCase()===c:1===o.nodeType)return!1;h=l="only"===m&&!h&&"nextSibling"}return!0}if(h=[_?u.firstChild:u.lastChild],_&&f){for(d=(a=(n=(r=(s=(o=u)[S]||(o[S]={}))[o.uniqueID]||(s[o.uniqueID]={}))[m]||[])[0]===C&&n[1])&&n[2],o=a&&u.childNodes[a];o=++a&&o&&o[l]||(d=a=0)||h.pop();)if(1===o.nodeType&&++d&&o===t){r[m]=[C,a,d];break}}else if(f&&(d=a=(n=(r=(s=(o=t)[S]||(o[S]={}))[o.uniqueID]||(s[o.uniqueID]={}))[m]||[])[0]===C&&n[1]),!1===d)for(;(o=++a&&o&&o[l]||(d=a=0)||h.pop())&&((x?o.nodeName.toLowerCase()!==c:1!==o.nodeType)||!++d||(f&&((r=(s=o[S]||(o[S]={}))[o.uniqueID]||(s[o.uniqueID]={}))[m]=[C,d]),o!==t)););return(d-=g)===p||d%p==0&&0<=d/p}}},PSEUDO:function(t,s){var e,o=b.pseudos[t]||b.setFilters[t.toLowerCase()]||nt.error("unsupported pseudo: "+t);return o[S]?o(s):1<o.length?(e=[t,t,"",s],b.setFilters.hasOwnProperty(t.toLowerCase())?st(function(t,e){for(var i,n=o(t,s),r=n.length;r--;)t[i=N(t,n[r])]=!(e[i]=n[r])}):function(t){return o(t,0,e)}):o}},pseudos:{not:st(function(t){var n=[],r=[],a=f(t.replace(q,"$1"));return a[S]?st(function(t,e,i,n){for(var r,s=a(t,null,n,[]),o=t.length;o--;)(r=s[o])&&(t[o]=!(e[o]=r))}):function(t,e,i){return n[0]=t,a(n,null,i,r),n[0]=null,!r.pop()}}),has:st(function(e){return function(t){return 0<nt(e,t).length}}),contains:st(function(e){return e=e.replace(it,c),function(t){return-1<(t.textContent||t.innerText||s(t)).indexOf(e)}}),lang:st(function(i){return Y.test(i||"")||nt.error("unsupported lang: "+i),i=i.replace(it,c).toLowerCase(),function(t){var e;do{if(e=D?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===a},focus:function(t){return t===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return $.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ct(function(){return[0]}),last:ct(function(t,e){return[e-1]}),eq:ct(function(t,e,i){return[i<0?i+e:i]}),even:ct(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:ct(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:ct(function(t,e,i){for(var n=i<0?i+e:i;0<=--n;)t.push(n);return t}),gt:ct(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[t]=lt(t);for(t in{submit:!0,reset:!0})b.pseudos[t]=ut(t);function dt(){}function mt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function pt(a,t,e){var h=t.dir,l=e&&"parentNode"===h,u=n++;return t.first?function(t,e,i){for(;t=t[h];)if(1===t.nodeType||l)return a(t,e,i)}:function(t,e,i){var n,r,s,o=[C,u];if(i){for(;t=t[h];)if((1===t.nodeType||l)&&a(t,e,i))return!0}else for(;t=t[h];)if(1===t.nodeType||l){if((n=(r=(s=t[S]||(t[S]={}))[t.uniqueID]||(s[t.uniqueID]={}))[h])&&n[0]===C&&n[1]===u)return o[2]=n[2];if((r[h]=o)[2]=a(t,e,i))return!0}}}function gt(r){return 1<r.length?function(t,e,i){for(var n=r.length;n--;)if(!r[n](t,e,i))return!1;return!0}:r[0]}function vt(t,e,i,n,r){for(var s,o=[],a=0,h=t.length,l=null!=e;a<h;a++)(s=t[a])&&(i&&!i(s,n,r)||(o.push(s),l&&e.push(a)));return o}function _t(d,m,p,g,v,t){return g&&!g[S]&&(g=_t(g)),v&&!v[S]&&(v=_t(v,t)),st(function(t,e,i,n){var r,s,o,a=[],h=[],l=e.length,u=t||function(t,e,i){for(var n=0,r=e.length;n<r;n++)nt(t,e[n],i);return i}(m||"*",i.nodeType?[i]:i,[]),c=!d||!t&&m?u:vt(u,a,d,i,n),f=p?v||(t?d:l||g)?[]:e:c;if(p&&p(c,f,i,n),g)for(r=vt(f,h),g(r,[],i,n),s=r.length;s--;)(o=r[s])&&(f[h[s]]=!(c[h[s]]=o));if(t){if(v||d){if(v){for(r=[],s=f.length;s--;)(o=f[s])&&r.push(c[s]=o);v(null,f=[],r,n)}for(s=f.length;s--;)(o=f[s])&&-1<(r=v?N(t,o):a[s])&&(t[r]=!(e[r]=o))}}else f=vt(f===e?f.splice(l,f.length):f),v?v(null,e,f,n):I.apply(e,f)})}function xt(t){for(var r,e,i,n=t.length,s=b.relative[t[0].type],o=s||b.relative[" "],a=s?1:0,h=pt(function(t){return t===r},o,!0),l=pt(function(t){return-1<N(r,t)},o,!0),u=[function(t,e,i){var n=!s&&(i||e!==y)||((r=e).nodeType?h(t,e,i):l(t,e,i));return r=null,n}];a<n;a++)if(e=b.relative[t[a].type])u=[pt(gt(u),e)];else{if((e=b.filter[t[a].type].apply(null,t[a].matches))[S]){for(i=++a;i<n&&!b.relative[t[i].type];i++);return _t(1<a&&gt(u),1<a&&mt(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(q,"$1"),e,a<i&&xt(t.slice(a,i)),i<n&&xt(t=t.slice(i)),i<n&&mt(t))}u.push(e)}return gt(u)}return dt.prototype=b.filters=b.pseudos,b.setFilters=new dt,p=nt.tokenize=function(t,e){var i,n,r,s,o,a,h,l=E[t+" "];if(l)return e?0:l.slice(0);for(o=t,a=[],h=b.preFilter;o;){for(s in i&&!(n=W.exec(o))||(n&&(o=o.slice(n[0].length)||o),a.push(r=[])),i=!1,(n=G.exec(o))&&(i=n.shift(),r.push({value:i,type:n[0].replace(q," ")}),o=o.slice(i.length)),b.filter)!(n=Z[s].exec(o))||h[s]&&!(n=h[s](n))||(i=n.shift(),r.push({value:i,type:s,matches:n}),o=o.slice(i.length));if(!i)break}return e?o.length:o?nt.error(t):E(t,a).slice(0)},f=nt.compile=function(t,e){var i,n=[],r=[],s=F[t+" "];if(!s){for(e||(e=p(t)),i=e.length;i--;)(s=xt(e[i]))[S]?n.push(s):r.push(s);(s=F(t,function(g,v){function t(t,e,i,n,r){var s,o,a,h=0,l="0",u=t&&[],c=[],f=y,d=t||x&&b.find.TAG("*",r),m=C+=null==f?1:Math.random()||.1,p=d.length;for(r&&(y=e===T||e||r);l!==p&&null!=(s=d[l]);l++){if(x&&s){for(o=0,e||s.ownerDocument===T||(w(s),i=!D);a=g[o++];)if(a(s,e||T,i)){n.push(s);break}r&&(C=m)}_&&((s=!a&&s)&&h--,t&&u.push(s))}if(h+=l,_&&l!==h){for(o=0;a=v[o++];)a(u,c,e,i);if(t){if(0<h)for(;l--;)u[l]||c[l]||(c[l]=B.call(n));c=vt(c)}I.apply(n,c),r&&!t&&0<c.length&&1<h+v.length&&nt.uniqueSort(n)}return r&&(C=m,y=f),u}var _=0<v.length,x=0<g.length;return _?st(t):t}(r,n))).selector=t}return s},g=nt.select=function(t,e,i,n){var r,s,o,a,h,l="function"==typeof t&&t,u=!n&&p(t=l.selector||t);if(i=i||[],1===u.length){if(2<(s=u[0]=u[0].slice(0)).length&&"ID"===(o=s[0]).type&&m.getById&&9===e.nodeType&&D&&b.relative[s[1].type]){if(!(e=(b.find.ID(o.matches[0].replace(it,c),e)||[])[0]))return i;l&&(e=e.parentNode),t=t.slice(s.shift().value.length)}for(r=Z.needsContext.test(t)?0:s.length;r--&&(o=s[r],!b.relative[a=o.type]);)if((h=b.find[a])&&(n=h(o.matches[0].replace(it,c),tt.test(s[0].type)&&ft(e.parentNode)||e))){if(s.splice(r,1),!(t=n.length&&mt(s)))return I.apply(i,n),i;break}}return(l||f(t,u))(n,e,!D,i,!e||tt.test(t)&&ft(e.parentNode)||e),i},m.sortStable=S.split("").sort(R).join("")===S,m.detectDuplicates=!!l,w(),m.sortDetached=ot(function(t){return 1&t.compareDocumentPosition(T.createElement("div"))}),ot(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||at("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),m.attributes&&ot(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||at("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ot(function(t){return null==t.getAttribute("disabled")})||at(k,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),nt}(T);S.find=f,S.expr=f.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=f.uniqueSort,S.text=f.getText,S.isXMLDoc=f.isXML,S.contains=f.contains;function d(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&S(t).is(i))break;n.push(t)}return n}function v(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}var _=S.expr.match.needsContext,x=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,b=/^.[^:#\[\.,]*$/;function y(t,i,n){if(S.isFunction(i))return S.grep(t,function(t,e){return!!i.call(t,e,t)!==n});if(i.nodeType)return S.grep(t,function(t){return t===i!==n});if("string"==typeof i){if(b.test(i))return S.filter(i,t,n);i=S.filter(i,t)}return S.grep(t,function(t){return-1<r.call(i,t)!==n})}S.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?S.find.matchesSelector(n,t)?[n]:[]:S.find.matches(t,S.grep(e,function(t){return 1===t.nodeType}))},S.fn.extend({find:function(t){var e,i=this.length,n=[],r=this;if("string"!=typeof t)return this.pushStack(S(t).filter(function(){for(e=0;e<i;e++)if(S.contains(r[e],this))return!0}));for(e=0;e<i;e++)S.find(t,r[e],n);return(n=this.pushStack(1<i?S.unique(n):n)).selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(y(this,t||[],!1))},not:function(t){return this.pushStack(y(this,t||[],!0))},is:function(t){return!!y(this,"string"==typeof t&&_.test(t)?S(t):t||[],!1).length}});var w,C=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(S.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||w,"string"!=typeof t)return t.nodeType?(this.context=this[0]=t,this.length=1,this):S.isFunction(t)?void 0!==i.ready?i.ready(t):t(S):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),S.makeArray(t,this));if(!(n="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:C.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof S?e[0]:e,S.merge(this,S.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:D,!0)),x.test(n[1])&&S.isPlainObject(e))for(n in e)S.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(r=D.getElementById(n[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=D,this.selector=t,this}).prototype=S.fn,w=S(D);var A=/^(?:parents|prev(?:Until|All))/,E={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}S.fn.extend({has:function(t){var e=S(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(S.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,s=[],o=_.test(t)||"string"!=typeof t?S(t,e||this.context):0;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?-1<o.index(i):1===i.nodeType&&S.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(1<s.length?S.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?r.call(S(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),S.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return d(t,"parentNode")},parentsUntil:function(t,e,i){return d(t,"parentNode",i)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return d(t,"nextSibling")},prevAll:function(t){return d(t,"previousSibling")},nextUntil:function(t,e,i){return d(t,"nextSibling",i)},prevUntil:function(t,e,i){return d(t,"previousSibling",i)},siblings:function(t){return v((t.parentNode||{}).firstChild,t)},children:function(t){return v(t.firstChild)},contents:function(t){return t.contentDocument||S.merge([],t.childNodes)}},function(n,r){S.fn[n]=function(t,e){var i=S.map(this,r,t);return"Until"!==n.slice(-5)&&(e=t),e&&"string"==typeof e&&(i=S.filter(e,i)),1<this.length&&(E[n]||S.uniqueSort(i),A.test(n)&&i.reverse()),this.pushStack(i)}});var R,P=/\S+/g;function B(){D.removeEventListener("DOMContentLoaded",B),T.removeEventListener("load",B),S.ready()}S.Callbacks=function(n){n="string"==typeof n?function(t){var i={};return S.each(t.match(P)||[],function(t,e){i[e]=!0}),i}(n):S.extend({},n);function i(){for(s=n.once,e=r=!0;a.length;h=-1)for(t=a.shift();++h<o.length;)!1===o[h].apply(t[0],t[1])&&n.stopOnFalse&&(h=o.length,t=!1);n.memory||(t=!1),r=!1,s&&(o=t?[]:"")}var r,t,e,s,o=[],a=[],h=-1,l={add:function(){return o&&(t&&!r&&(h=o.length-1,a.push(t)),function i(t){S.each(t,function(t,e){S.isFunction(e)?n.unique&&l.has(e)||o.push(e):e&&e.length&&"string"!==S.type(e)&&i(e)})}(arguments),t&&!r&&i()),this},remove:function(){return S.each(arguments,function(t,e){for(var i;-1<(i=S.inArray(e,o,i));)o.splice(i,1),i<=h&&h--}),this},has:function(t){return t?-1<S.inArray(t,o):0<o.length},empty:function(){return o&&(o=[]),this},disable:function(){return s=a=[],o=t="",this},disabled:function(){return!o},lock:function(){return s=a=[],t||(o=t=""),this},locked:function(){return!!s},fireWith:function(t,e){return s||(e=[t,(e=e||[]).slice?e.slice():e],a.push(e),r||i()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!e}};return l},S.extend({Deferred:function(t){var s=[["resolve","done",S.Callbacks("once memory"),"resolved"],["reject","fail",S.Callbacks("once memory"),"rejected"],["notify","progress",S.Callbacks("memory")]],r="pending",o={state:function(){return r},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var r=arguments;return S.Deferred(function(n){S.each(s,function(t,e){var i=S.isFunction(r[t])&&r[t];a[e[1]](function(){var t=i&&i.apply(this,arguments);t&&S.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[e[0]+"With"](this===o?n.promise():this,i?[t]:arguments)})}),r=null}).promise()},promise:function(t){return null!=t?S.extend(t,o):o}},a={};return o.pipe=o.then,S.each(s,function(t,e){var i=e[2],n=e[3];o[e[1]]=i.add,n&&i.add(function(){r=n},s[1^t][2].disable,s[2][2].lock),a[e[0]]=function(){return a[e[0]+"With"](this===a?o:this,arguments),this},a[e[0]+"With"]=i.fireWith}),o.promise(a),t&&t.call(a,a),a},when:function(t){function e(e,i,n){return function(t){i[e]=this,n[e]=1<arguments.length?u.call(arguments):t,n===r?l.notifyWith(i,n):--h||l.resolveWith(i,n)}}var r,i,n,s=0,o=u.call(arguments),a=o.length,h=1!==a||t&&S.isFunction(t.promise)?a:0,l=1===h?t:S.Deferred();if(1<a)for(r=new Array(a),i=new Array(a),n=new Array(a);s<a;s++)o[s]&&S.isFunction(o[s].promise)?o[s].promise().progress(e(s,i,r)).done(e(s,n,o)).fail(l.reject):--h;return h||l.resolveWith(n,o),l.promise()}}),S.fn.ready=function(t){return S.ready.promise().done(t),this},S.extend({isReady:!1,readyWait:1,holdReady:function(t){t?S.readyWait++:S.ready(!0)},ready:function(t){(!0===t?--S.readyWait:S.isReady)||(S.isReady=!0)!==t&&0<--S.readyWait||(R.resolveWith(D,[S]),S.fn.triggerHandler&&(S(D).triggerHandler("ready"),S(D).off("ready")))}}),S.ready.promise=function(t){return R||(R=S.Deferred(),"complete"===D.readyState||"loading"!==D.readyState&&!D.documentElement.doScroll?T.setTimeout(S.ready):(D.addEventListener("DOMContentLoaded",B),T.addEventListener("load",B))),R.promise(t)},S.ready.promise();function M(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}var I=function(t,e,i,n,r,s,o){var a=0,h=t.length,l=null==i;if("object"===S.type(i))for(a in r=!0,i)I(t,e,a,i[a],!0,s,o);else if(void 0!==n&&(r=!0,S.isFunction(n)||(o=!0),l&&(e=o?(e.call(t,n),null):(l=e,function(t,e,i){return l.call(S(t),i)})),e))for(;a<h;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return r?t:l?e.call(t):h?e(t[0],i):s};function L(){this.expando=S.expando+L.uid++}L.uid=1,L.prototype={register:function(t,e){var i=e||{};return t.nodeType?t[this.expando]=i:Object.defineProperty(t,this.expando,{value:i,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!M(t))return{};var e=t[this.expando];return e||(e={},M(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[e]=i;else for(n in e)r[n]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?void 0!==(n=this.get(t,e))?n:this.get(t,S.camelCase(e)):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,r,s=t[this.expando];if(void 0!==s){if(void 0===e)this.register(t);else{i=(n=S.isArray(e)?e.concat(e.map(S.camelCase)):(r=S.camelCase(e),e in s?[e,r]:(n=r)in s?[n]:n.match(P)||[])).length;for(;i--;)delete s[n[i]]}void 0!==e&&!S.isEmptyObject(s)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var N=new L,k=new L,O=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,z=/[A-Z]/g;function U(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(z,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:O.test(i)?S.parseJSON(i):i)}catch(t){}k.set(t,e,i)}else i=void 0;return i}S.extend({hasData:function(t){return k.hasData(t)||N.hasData(t)},data:function(t,e,i){return k.access(t,e,i)},removeData:function(t,e){k.remove(t,e)},_data:function(t,e,i){return N.access(t,e,i)},_removeData:function(t,e){N.remove(t,e)}}),S.fn.extend({data:function(n,t){var e,i,r,s=this[0],o=s&&s.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){k.set(this,n)}):I(this,function(e){var t,i;if(s&&void 0===e)return void 0!==(t=k.get(s,n)||k.get(s,n.replace(z,"-$&").toLowerCase()))?t:(i=S.camelCase(n),void 0!==(t=k.get(s,i))?t:void 0!==(t=U(s,i,void 0))?t:void 0);i=S.camelCase(n),this.each(function(){var t=k.get(this,i);k.set(this,i,e),-1<n.indexOf("-")&&void 0!==t&&k.set(this,n,e)})},null,t,1<arguments.length,null,!0);if(this.length&&(r=k.get(s),1===s.nodeType&&!N.get(s,"hasDataAttrs"))){for(e=o.length;e--;)!o[e]||0===(i=o[e].name).indexOf("data-")&&(i=S.camelCase(i.slice(5)),U(s,i,r[i]));N.set(s,"hasDataAttrs",!0)}return r},removeData:function(t){return this.each(function(){k.remove(this,t)})}}),S.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=N.get(t,e),i&&(!n||S.isArray(i)?n=N.access(t,e,S.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=S.queue(t,e),n=i.length,r=i.shift(),s=S._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,function(){S.dequeue(t,e)},s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return N.get(t,i)||N.access(t,i,{empty:S.Callbacks("once memory").add(function(){N.remove(t,[e+"queue",i])})})}}),S.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?S.queue(this[0],e):void 0===i?this:this.each(function(){var t=S.queue(this,e,i);S._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&S.dequeue(this,e)})},dequeue:function(t){return this.each(function(){S.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--r||s.resolveWith(o,[o])}var n,r=1,s=S.Deferred(),o=this,a=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=N.get(o[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(i));return i(),s.promise(e)}});function H(t,e){return t=e||t,"none"===S.css(t,"display")||!S.contains(t.ownerDocument,t)}var j=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,q=new RegExp("^(?:([+-])=|)("+j+")([a-z%]*)$","i"),W=["Top","Right","Bottom","Left"];function G(t,e,i,n){var r,s=1,o=20,a=n?function(){return n.cur()}:function(){return S.css(t,e,"")},h=a(),l=i&&i[3]||(S.cssNumber[e]?"":"px"),u=(S.cssNumber[e]||"px"!==l&&+h)&&q.exec(S.css(t,e));if(u&&u[3]!==l)for(l=l||u[3],i=i||[],u=+h||1;u/=s=s||".5",S.style(t,e,u+l),s!==(s=a()/h)&&1!==s&&--o;);return i&&(u=+u||+h||0,r=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=u,n.end=r)),r}var X=/^(?:checkbox|radio)$/i,V=/<([\w:-]+)/,Y=/^$|\/(?:java|ecma)script/i,Z={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Q(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&S.nodeName(t,e)?S.merge([t],i):i}function $(t,e){for(var i=0,n=t.length;i<n;i++)N.set(t[i],"globalEval",!e||N.get(e[i],"globalEval"))}Z.optgroup=Z.option,Z.tbody=Z.tfoot=Z.colgroup=Z.caption=Z.thead,Z.th=Z.td;var J,K,tt=/<|&#?\w+;/;function et(t,e,i,n,r){for(var s,o,a,h,l,u,c=e.createDocumentFragment(),f=[],d=0,m=t.length;d<m;d++)if((s=t[d])||0===s)if("object"===S.type(s))S.merge(f,s.nodeType?[s]:s);else if(tt.test(s)){for(o=o||c.appendChild(e.createElement("div")),a=(V.exec(s)||["",""])[1].toLowerCase(),h=Z[a]||Z._default,o.innerHTML=h[1]+S.htmlPrefilter(s)+h[2],u=h[0];u--;)o=o.lastChild;S.merge(f,o.childNodes),(o=c.firstChild).textContent=""}else f.push(e.createTextNode(s));for(c.textContent="",d=0;s=f[d++];)if(n&&-1<S.inArray(s,n))r&&r.push(s);else if(l=S.contains(s.ownerDocument,s),o=Q(c.appendChild(s),"script"),l&&$(o),i)for(u=0;s=o[u++];)Y.test(s.type||"")&&i.push(s);return c}J=D.createDocumentFragment().appendChild(D.createElement("div")),(K=D.createElement("input")).setAttribute("type","radio"),K.setAttribute("checked","checked"),K.setAttribute("name","t"),J.appendChild(K),g.checkClone=J.cloneNode(!0).cloneNode(!0).lastChild.checked,J.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!J.cloneNode(!0).lastChild.defaultValue;var it=/^key/,nt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rt=/^([^.]*)(?:\.(.+)|)/;function st(){return!0}function ot(){return!1}function at(){try{return D.activeElement}catch(t){}}function ht(t,e,i,n,r,s){var o,a;if("object"==typeof e){for(a in"string"!=typeof i&&(n=n||i,i=void 0),e)ht(t,a,i,n,e[a],s);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=ot;else if(!r)return t;return 1===s&&(o=r,(r=function(t){return S().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=S.guid++)),t.each(function(){S.event.add(this,e,r,n,i)})}S.event={global:{},add:function(e,t,i,n,r){var s,o,a,h,l,u,c,f,d,m,p,g=N.get(e);if(g)for(i.handler&&(i=(s=i).handler,r=s.selector),i.guid||(i.guid=S.guid++),(h=g.events)||(h=g.events={}),(o=g.handle)||(o=g.handle=function(t){return void 0!==S&&S.event.triggered!==t.type?S.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(P)||[""]).length;l--;)d=p=(a=rt.exec(t[l])||[])[1],m=(a[2]||"").split(".").sort(),d&&(c=S.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,c=S.event.special[d]||{},u=S.extend({type:d,origType:p,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&S.expr.match.needsContext.test(r),namespace:m.join(".")},s),(f=h[d])||((f=h[d]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,n,m,o)||e.addEventListener&&e.addEventListener(d,o)),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),r?f.splice(f.delegateCount++,0,u):f.push(u),S.event.global[d]=!0)},remove:function(t,e,i,n,r){var s,o,a,h,l,u,c,f,d,m,p,g=N.hasData(t)&&N.get(t);if(g&&(h=g.events)){for(l=(e=(e||"").match(P)||[""]).length;l--;)if(d=p=(a=rt.exec(e[l])||[])[1],m=(a[2]||"").split(".").sort(),d){for(c=S.event.special[d]||{},f=h[d=(n?c.delegateType:c.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=f.length;s--;)u=f[s],!r&&p!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(f.splice(s,1),u.selector&&f.delegateCount--,c.remove&&c.remove.call(t,u));o&&!f.length&&(c.teardown&&!1!==c.teardown.call(t,m,g.handle)||S.removeEvent(t,d,g.handle),delete h[d])}else for(d in h)S.event.remove(t,d+e[l],i,n,!0);S.isEmptyObject(h)&&N.remove(t,"handle events")}},dispatch:function(t){t=S.event.fix(t);var e,i,n,r,s,o,a=u.call(arguments),h=(N.get(this,"events")||{})[t.type]||[],l=S.event.special[t.type]||{};if((a[0]=t).delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,t)){for(o=S.event.handlers.call(this,t,h),e=0;(r=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,i=0;(s=r.handlers[i++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(s.namespace)||(t.handleObj=s,t.data=s.data,void 0===(n=((S.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,a))||!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,s,o=[],a=e.delegateCount,h=t.target;if(a&&h.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;h!==this;h=h.parentNode||this)if(1===h.nodeType&&(!0!==h.disabled||"click"!==t.type)){for(n=[],i=0;i<a;i++)void 0===n[r=(s=e[i]).selector+" "]&&(n[r]=s.needsContext?-1<S(r,this).index(h):S.find(r,this,null,[h]).length),n[r]&&n.push(s);n.length&&o.push({elem:h,handlers:n})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,s=e.button;return null==t.pageX&&null!=e.clientX&&(n=(i=t.target.ownerDocument||D).documentElement,r=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),t.which||void 0===s||(t.which=1&s?1:2&s?3:4&s?2:0),t}},fix:function(t){if(t[S.expando])return t;var e,i,n,r=t.type,s=t,o=this.fixHooks[r];for(o||(this.fixHooks[r]=o=nt.test(r)?this.mouseHooks:it.test(r)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new S.Event(s),e=n.length;e--;)t[i=n[e]]=s[i];return t.target||(t.target=D),3===t.target.nodeType&&(t.target=t.target.parentNode),o.filter?o.filter(t,s):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===at()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&S.nodeName(this,"input"))return this.click(),!1},_default:function(t){return S.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},S.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},S.Event=function(t,e){if(!(this instanceof S.Event))return new S.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?st:ot):this.type=t,e&&S.extend(this,e),this.timeStamp=t&&t.timeStamp||S.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=st,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=st,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=st,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,r){S.event.special[t]={delegateType:r,bindType:r,handle:function(t){var e,i=t.relatedTarget,n=t.handleObj;return i&&(i===this||S.contains(this,i))||(t.type=n.origType,e=n.handler.apply(this,arguments),t.type=r),e}}}),S.fn.extend({on:function(t,e,i,n){return ht(this,t,e,i,n)},one:function(t,e,i,n){return ht(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,S(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=ot),this.each(function(){S.event.remove(this,t,i,e)});for(r in t)this.off(r,e,t[r]);return this}});var lt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ut=/<script|<style|<link/i,ct=/checked\s*(?:[^=]|=\s*.checked.)/i,ft=/^true\/(.*)/,dt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function mt(t,e){return S.nodeName(t,"table")&&S.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function pt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function gt(t){var e=ft.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function vt(t,e){var i,n,r,s,o,a,h,l;if(1===e.nodeType){if(N.hasData(t)&&(s=N.access(t),o=N.set(e,s),l=s.events))for(r in delete o.handle,o.events={},l)for(i=0,n=l[r].length;i<n;i++)S.event.add(e,r,l[r][i]);k.hasData(t)&&(a=k.access(t),h=S.extend({},a),k.set(e,h))}}function _t(i,n,r,s){n=p.apply([],n);var t,e,o,a,h,l,u=0,c=i.length,f=c-1,d=n[0],m=S.isFunction(d);if(m||1<c&&"string"==typeof d&&!g.checkClone&&ct.test(d))return i.each(function(t){var e=i.eq(t);m&&(n[0]=d.call(this,t,e.html())),_t(e,n,r,s)});if(c&&(e=(t=et(n,i[0].ownerDocument,!1,i,s)).firstChild,1===t.childNodes.length&&(t=e),e||s)){for(a=(o=S.map(Q(t,"script"),pt)).length;u<c;u++)h=t,u!==f&&(h=S.clone(h,!0,!0),a&&S.merge(o,Q(h,"script"))),r.call(i[u],h,u);if(a)for(l=o[o.length-1].ownerDocument,S.map(o,gt),u=0;u<a;u++)h=o[u],Y.test(h.type||"")&&!N.access(h,"globalEval")&&S.contains(l,h)&&(h.src?S._evalUrl&&S._evalUrl(h.src):S.globalEval(h.textContent.replace(dt,"")))}return i}function xt(t,e,i){for(var n,r=e?S.filter(e,t):t,s=0;null!=(n=r[s]);s++)i||1!==n.nodeType||S.cleanData(Q(n)),n.parentNode&&(i&&S.contains(n.ownerDocument,n)&&$(Q(n,"script")),n.parentNode.removeChild(n));return t}S.extend({htmlPrefilter:function(t){return t.replace(lt,"<$1></$2>")},clone:function(t,e,i){var n,r,s,o,a,h,l,u=t.cloneNode(!0),c=S.contains(t.ownerDocument,t);if(!(g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||S.isXMLDoc(t)))for(o=Q(u),n=0,r=(s=Q(t)).length;n<r;n++)a=s[n],h=o[n],void 0,"input"===(l=h.nodeName.toLowerCase())&&X.test(a.type)?h.checked=a.checked:"input"!==l&&"textarea"!==l||(h.defaultValue=a.defaultValue);if(e)if(i)for(s=s||Q(t),o=o||Q(u),n=0,r=s.length;n<r;n++)vt(s[n],o[n]);else vt(t,u);return 0<(o=Q(u,"script")).length&&$(o,!c&&Q(t,"script")),u},cleanData:function(t){for(var e,i,n,r=S.event.special,s=0;void 0!==(i=t[s]);s++)if(M(i)){if(e=i[N.expando]){if(e.events)for(n in e.events)r[n]?S.event.remove(i,n):S.removeEvent(i,n,e.handle);i[N.expando]=void 0}i[k.expando]&&(i[k.expando]=void 0)}}}),S.fn.extend({domManip:_t,detach:function(t){return xt(this,t,!0)},remove:function(t){return xt(this,t)},text:function(t){return I(this,function(t){return void 0===t?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return _t(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||mt(this,t).appendChild(t)})},prepend:function(){return _t(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=mt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return _t(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return _t(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(S.cleanData(Q(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return S.clone(this,t,e)})},html:function(t){return I(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!ut.test(t)&&!Z[(V.exec(t)||["",""])[1].toLowerCase()]){t=S.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(S.cleanData(Q(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return _t(this,arguments,function(t){var e=this.parentNode;S.inArray(this,i)<0&&(S.cleanData(Q(this)),e&&e.replaceChild(t,this))},i)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,o){S.fn[t]=function(t){for(var e,i=[],n=S(t),r=n.length-1,s=0;s<=r;s++)e=s===r?this:this.clone(!0),S(n[s])[o](e),a.apply(i,e.get());return this.pushStack(i)}});var bt,yt={HTML:"block",BODY:"block"};function wt(t,e){var i=S(e.createElement(t)).appendTo(e.body),n=S.css(i[0],"display");return i.detach(),n}function Tt(t){var e=D,i=yt[t];return i||("none"!==(i=wt(t,e))&&i||((e=(bt=(bt||S("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),i=wt(t,e),bt.detach()),yt[t]=i),i}function Dt(t,e,i,n){var r,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];for(s in r=i.apply(t,n||[]),e)t.style[s]=o[s];return r}var St,Ct,At,Et,Ft,Rt,Pt=/^margin/,Bt=new RegExp("^("+j+")(?!px)[a-z%]+$","i"),Mt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=T),e.getComputedStyle(t)},It=D.documentElement;function Lt(){Rt.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Rt.innerHTML="",It.appendChild(Ft);var t=T.getComputedStyle(Rt);St="1%"!==t.top,Et="2px"===t.marginLeft,Ct="4px"===t.width,Rt.style.marginRight="50%",At="4px"===t.marginRight,It.removeChild(Ft)}function Nt(t,e,i){var n,r,s,o,a=t.style;return""!==(o=(i=i||Mt(t))?i.getPropertyValue(e)||i[e]:void 0)&&void 0!==o||S.contains(t.ownerDocument,t)||(o=S.style(t,e)),!i||!g.pixelMarginRight()&&Bt.test(o)&&Pt.test(e)&&(n=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=r,a.maxWidth=s),void 0!==o?o+"":o}function kt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}Ft=D.createElement("div"),(Rt=D.createElement("div")).style&&(Rt.style.backgroundClip="content-box",Rt.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===Rt.style.backgroundClip,Ft.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Ft.appendChild(Rt),S.extend(g,{pixelPosition:function(){return Lt(),St},boxSizingReliable:function(){return null==Ct&&Lt(),Ct},pixelMarginRight:function(){return null==Ct&&Lt(),At},reliableMarginLeft:function(){return null==Ct&&Lt(),Et},reliableMarginRight:function(){var t,e=Rt.appendChild(D.createElement("div"));return e.style.cssText=Rt.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",Rt.style.width="1px",It.appendChild(Ft),t=!parseFloat(T.getComputedStyle(e).marginRight),It.removeChild(Ft),Rt.removeChild(e),t}}));var Ot=/^(none|table(?!-c[ea]).+)/,zt={position:"absolute",visibility:"hidden",display:"block"},Ut={letterSpacing:"0",fontWeight:"400"},Ht=["Webkit","O","Moz","ms"],jt=D.createElement("div").style;function qt(t){if(t in jt)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=Ht.length;i--;)if((t=Ht[i]+e)in jt)return t}function Wt(t,e,i){var n=q.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function Gt(t,e,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,o=0;s<4;s+=2)"margin"===i&&(o+=S.css(t,i+W[s],!0,r)),n?("content"===i&&(o-=S.css(t,"padding"+W[s],!0,r)),"margin"!==i&&(o-=S.css(t,"border"+W[s]+"Width",!0,r))):(o+=S.css(t,"padding"+W[s],!0,r),"padding"!==i&&(o+=S.css(t,"border"+W[s]+"Width",!0,r)));return o}function Xt(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,s=Mt(t),o="border-box"===S.css(t,"boxSizing",!1,s);if(r<=0||null==r){if(((r=Nt(t,e,s))<0||null==r)&&(r=t.style[e]),Bt.test(r))return r;n=o&&(g.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+Gt(t,e,i||(o?"border":"content"),n,s)+"px"}function Vt(t,e){for(var i,n,r,s=[],o=0,a=t.length;o<a;o++)(n=t[o]).style&&(s[o]=N.get(n,"olddisplay"),i=n.style.display,e?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&H(n)&&(s[o]=N.access(n,"olddisplay",Tt(n.nodeName)))):(r=H(n),"none"===i&&r||N.set(n,"olddisplay",r?i:S.css(n,"display"))));for(o=0;o<a;o++)(n=t[o]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[o]||"":"none"));return t}function Yt(t,e,i,n,r){return new Yt.prototype.init(t,e,i,n,r)}S.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Nt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=S.camelCase(e),h=t.style;if(e=S.cssProps[a]||(S.cssProps[a]=qt(a)||a),o=S.cssHooks[e]||S.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(t,!1,n))?r:h[e];"string"===(s=typeof i)&&(r=q.exec(i))&&r[1]&&(i=G(t,e,r),s="number"),null!=i&&i==i&&("number"===s&&(i+=r&&r[3]||(S.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,n))||(h[e]=i))}},css:function(t,e,i,n){var r,s,o,a=S.camelCase(e);return e=S.cssProps[a]||(S.cssProps[a]=qt(a)||a),(o=S.cssHooks[e]||S.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,i)),void 0===r&&(r=Nt(t,e,n)),"normal"===r&&e in Ut&&(r=Ut[e]),""===i||i?(s=parseFloat(r),!0===i||isFinite(s)?s||0:r):r}}),S.each(["height","width"],function(t,o){S.cssHooks[o]={get:function(t,e,i){if(e)return Ot.test(S.css(t,"display"))&&0===t.offsetWidth?Dt(t,zt,function(){return Xt(t,o,i)}):Xt(t,o,i)},set:function(t,e,i){var n,r=i&&Mt(t),s=i&&Gt(t,o,i,"border-box"===S.css(t,"boxSizing",!1,r),r);return s&&(n=q.exec(e))&&"px"!==(n[3]||"px")&&(t.style[o]=e,e=S.css(t,o)),Wt(0,e,s)}}}),S.cssHooks.marginLeft=kt(g.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Nt(t,"marginLeft"))||t.getBoundingClientRect().left-Dt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),S.cssHooks.marginRight=kt(g.reliableMarginRight,function(t,e){if(e)return Dt(t,{display:"inline-block"},Nt,[t,"marginRight"])}),S.each({margin:"",padding:"",border:"Width"},function(r,s){S.cssHooks[r+s]={expand:function(t){for(var e=0,i={},n="string"==typeof t?t.split(" "):[t];e<4;e++)i[r+W[e]+s]=n[e]||n[e-2]||n[0];return i}},Pt.test(r)||(S.cssHooks[r+s].set=Wt)}),S.fn.extend({css:function(t,e){return I(this,function(t,e,i){var n,r,s={},o=0;if(S.isArray(e)){for(n=Mt(t),r=e.length;o<r;o++)s[e[o]]=S.css(t,e[o],!1,n);return s}return void 0!==i?S.style(t,e,i):S.css(t,e)},t,e,1<arguments.length)},show:function(){return Vt(this,!0)},hide:function(){return Vt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){H(this)?S(this).show():S(this).hide()})}}),((S.Tween=Yt).prototype={constructor:Yt,init:function(t,e,i,n,r,s){this.elem=t,this.prop=i,this.easing=r||S.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(S.cssNumber[i]?"":"px")},cur:function(){var t=Yt.propHooks[this.prop];return t&&t.get?t.get(this):Yt.propHooks._default.get(this)},run:function(t){var e,i=Yt.propHooks[this.prop];return this.options.duration?this.pos=e=S.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Yt.propHooks._default.set(this),this}}).init.prototype=Yt.prototype,(Yt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=S.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){S.fx.step[t.prop]?S.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[S.cssProps[t.prop]]&&!S.cssHooks[t.prop]?t.elem[t.prop]=t.now:S.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=Yt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},S.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},S.fx=Yt.prototype.init,S.fx.step={};var Zt,Qt,$t,Jt,Kt,te=/^(?:toggle|show|hide)$/,ee=/queueHooks$/;function ie(){return T.setTimeout(function(){Zt=void 0}),Zt=S.now()}function ne(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)r["margin"+(i=W[n])]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function re(t,e,i){for(var n,r=(se.tweeners[e]||[]).concat(se.tweeners["*"]),s=0,o=r.length;s<o;s++)if(n=r[s].call(i,e,t))return n}function se(s,t,e){var i,o,n=0,r=se.prefilters.length,a=S.Deferred().always(function(){delete h.elem}),h=function(){if(o)return!1;for(var t=Zt||ie(),e=Math.max(0,l.startTime+l.duration-t),i=1-(e/l.duration||0),n=0,r=l.tweens.length;n<r;n++)l.tweens[n].run(i);return a.notifyWith(s,[l,i,e]),i<1&&r?e:(a.resolveWith(s,[l]),!1)},l=a.promise({elem:s,props:S.extend({},t),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},e),originalProperties:t,originalOptions:e,startTime:Zt||ie(),duration:e.duration,tweens:[],createTween:function(t,e){var i=S.Tween(s,l.opts,t,e,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var e=0,i=t?l.tweens.length:0;if(o)return this;for(o=!0;e<i;e++)l.tweens[e].run(1);return t?(a.notifyWith(s,[l,1,0]),a.resolveWith(s,[l,t])):a.rejectWith(s,[l,t]),this}}),u=l.props;for(!function(t,e){var i,n,r,s,o;for(i in t)if(r=e[n=S.camelCase(i)],s=t[i],S.isArray(s)&&(r=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(o=S.cssHooks[n])&&"expand"in o)for(i in s=o.expand(s),delete t[n],s)i in t||(t[i]=s[i],e[i]=r);else e[n]=r}(u,l.opts.specialEasing);n<r;n++)if(i=se.prefilters[n].call(l,s,u,l.opts))return S.isFunction(i.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=S.proxy(i.stop,i)),i;return S.map(u,re,l),S.isFunction(l.opts.start)&&l.opts.start.call(s,l),S.fx.timer(S.extend(h,{elem:s,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}S.Animation=S.extend(se,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return G(i.elem,t,q.exec(e),i),i}]},tweener:function(t,e){for(var i,n=0,r=(t=S.isFunction(t)?(e=t,["*"]):t.match(P)).length;n<r;n++)i=t[n],se.tweeners[i]=se.tweeners[i]||[],se.tweeners[i].unshift(e)},prefilters:[function(e,t,i){var n,r,s,o,a,h,l,u=this,c={},f=e.style,d=e.nodeType&&H(e),m=N.get(e,"fxshow");for(n in i.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,h=a.empty.fire,a.empty.fire=function(){a.unqueued||h()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(l=S.css(e,"display"))?N.get(e,"olddisplay")||Tt(e.nodeName):l)&&"none"===S.css(e,"float")&&(f.display="inline-block")),i.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),t)if(r=t[n],te.exec(r)){if(delete t[n],s=s||"toggle"===r,r===(d?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;d=!0}c[n]=m&&m[n]||S.style(e,n)}else l=void 0;if(S.isEmptyObject(c))"inline"===("none"===l?Tt(e.nodeName):l)&&(f.display=l);else for(n in m?"hidden"in m&&(d=m.hidden):m=N.access(e,"fxshow",{}),s&&(m.hidden=!d),d?S(e).show():u.done(function(){S(e).hide()}),u.done(function(){var t;for(t in N.remove(e,"fxshow"),c)S.style(e,t,c[t])}),c)o=re(d?m[n]:0,n,u),n in m||(m[n]=o.start,d&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}],prefilter:function(t,e){e?se.prefilters.unshift(t):se.prefilters.push(t)}}),S.speed=function(t,e,i){var n=t&&"object"==typeof t?S.extend({},t):{complete:i||!i&&e||S.isFunction(t)&&t,duration:t,easing:i&&e||e&&!S.isFunction(e)&&e};return n.duration=S.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in S.fx.speeds?S.fx.speeds[n.duration]:S.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){S.isFunction(n.old)&&n.old.call(this),n.queue&&S.dequeue(this,n.queue)},n},S.fn.extend({fadeTo:function(t,e,i,n){return this.filter(H).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(e,t,i,n){function r(){var t=se(this,S.extend({},e),o);(s||N.get(this,"finish"))&&t.stop(!0)}var s=S.isEmptyObject(e),o=S.speed(t,i,n);return r.finish=r,s||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(r,t,s){function o(t){var e=t.stop;delete t.stop,e(s)}return"string"!=typeof r&&(s=t,t=r,r=void 0),t&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var t=!0,e=null!=r&&r+"queueHooks",i=S.timers,n=N.get(this);if(e)n[e]&&n[e].stop&&o(n[e]);else for(e in n)n[e]&&n[e].stop&&ee.test(e)&&o(n[e]);for(e=i.length;e--;)i[e].elem!==this||null!=r&&i[e].queue!==r||(i[e].anim.stop(s),t=!1,i.splice(e,1));!t&&s||S.dequeue(this,r)})},finish:function(o){return!1!==o&&(o=o||"fx"),this.each(function(){var t,e=N.get(this),i=e[o+"queue"],n=e[o+"queueHooks"],r=S.timers,s=i?i.length:0;for(e.finish=!0,S.queue(this,o,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===o&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),S.each(["toggle","show","hide"],function(t,n){var r=S.fn[n];S.fn[n]=function(t,e,i){return null==t||"boolean"==typeof t?r.apply(this,arguments):this.animate(ne(n,!0),t,e,i)}}),S.each({slideDown:ne("show"),slideUp:ne("hide"),slideToggle:ne("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,n){S.fn[t]=function(t,e,i){return this.animate(n,t,e,i)}}),S.timers=[],S.fx.tick=function(){var t,e=0,i=S.timers;for(Zt=S.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||S.fx.stop(),Zt=void 0},S.fx.timer=function(t){S.timers.push(t),t()?S.fx.start():S.timers.pop()},S.fx.interval=13,S.fx.start=function(){Qt||(Qt=T.setInterval(S.fx.tick,S.fx.interval))},S.fx.stop=function(){T.clearInterval(Qt),Qt=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(n,t){return n=S.fx&&S.fx.speeds[n]||n,t=t||"fx",this.queue(t,function(t,e){var i=T.setTimeout(t,n);e.stop=function(){T.clearTimeout(i)}})},$t=D.createElement("input"),Jt=D.createElement("select"),Kt=Jt.appendChild(D.createElement("option")),$t.type="checkbox",g.checkOn=""!==$t.value,g.optSelected=Kt.selected,Jt.disabled=!0,g.optDisabled=!Kt.disabled,($t=D.createElement("input")).value="t",$t.type="radio",g.radioValue="t"===$t.value;var oe,ae=S.expr.attrHandle;S.fn.extend({attr:function(t,e){return I(this,S.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){S.removeAttr(this,t)})}}),S.extend({attr:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?S.prop(t,e,i):(1===s&&S.isXMLDoc(t)||(e=e.toLowerCase(),r=S.attrHooks[e]||(S.expr.match.bool.test(e)?oe:void 0)),void 0!==i?null===i?void S.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:null==(n=S.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!g.radioValue&&"radio"===e&&S.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n,r=0,s=e&&e.match(P);if(s&&1===t.nodeType)for(;i=s[r++];)n=S.propFix[i]||i,S.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)}}),oe={set:function(t,e,i){return!1===e?S.removeAttr(t,i):t.setAttribute(i,i),i}},S.each(S.expr.match.bool.source.match(/\w+/g),function(t,e){var s=ae[e]||S.find.attr;ae[e]=function(t,e,i){var n,r;return i||(r=ae[e],ae[e]=n,n=null!=s(t,e,i)?e.toLowerCase():null,ae[e]=r),n}});var he=/^(?:input|select|textarea|button)$/i,le=/^(?:a|area)$/i;S.fn.extend({prop:function(t,e){return I(this,S.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[S.propFix[t]||t]})}}),S.extend({prop:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&S.isXMLDoc(t)||(e=S.propFix[e]||e,r=S.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=S.find.attr(t,"tabindex");return e?parseInt(e,10):he.test(t.nodeName)||le.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(S.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this});var ue=/[\t\r\n\f]/g;function ce(t){return t.getAttribute&&t.getAttribute("class")||""}S.fn.extend({addClass:function(e){var t,i,n,r,s,o,a,h=0;if(S.isFunction(e))return this.each(function(t){S(this).addClass(e.call(this,t,ce(this)))});if("string"==typeof e&&e)for(t=e.match(P)||[];i=this[h++];)if(r=ce(i),n=1===i.nodeType&&(" "+r+" ").replace(ue," ")){for(o=0;s=t[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");r!==(a=S.trim(n))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,r,s,o,a,h=0;if(S.isFunction(e))return this.each(function(t){S(this).removeClass(e.call(this,t,ce(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(P)||[];i=this[h++];)if(r=ce(i),n=1===i.nodeType&&(" "+r+" ").replace(ue," ")){for(o=0;s=t[o++];)for(;-1<n.indexOf(" "+s+" ");)n=n.replace(" "+s+" "," ");r!==(a=S.trim(n))&&i.setAttribute("class",a)}return this},toggleClass:function(r,e){var s=typeof r;return"boolean"==typeof e&&"string"==s?e?this.addClass(r):this.removeClass(r):S.isFunction(r)?this.each(function(t){S(this).toggleClass(r.call(this,t,ce(this),e),e)}):this.each(function(){var t,e,i,n;if("string"==s)for(e=0,i=S(this),n=r.match(P)||[];t=n[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==r&&"boolean"!=s||((t=ce(this))&&N.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===r?"":N.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&-1<(" "+ce(i)+" ").replace(ue," ").indexOf(e))return!0;return!1}});var fe=/\r/g,de=/[\x20\t\r\n\f]+/g;S.fn.extend({val:function(i){var n,t,r,e=this[0];return arguments.length?(r=S.isFunction(i),this.each(function(t){var e;1===this.nodeType&&(null==(e=r?i.call(this,t,S(this).val()):i)?e="":"number"==typeof e?e+="":S.isArray(e)&&(e=S.map(e,function(t){return null==t?"":t+""})),(n=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value")||(this.value=e))})):e?(n=S.valHooks[e.type]||S.valHooks[e.nodeName.toLowerCase()])&&"get"in n&&void 0!==(t=n.get(e,"value"))?t:"string"==typeof(t=e.value)?t.replace(fe,""):null==t?"":t:void 0}}),S.extend({valHooks:{option:{get:function(t){var e=S.find.attr(t,"value");return null!=e?e:S.trim(S.text(t)).replace(de," ")}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,s="select-one"===t.type||r<0,o=s?null:[],a=s?r+1:n.length,h=r<0?a:s?r:0;h<a;h++)if(((i=n[h]).selected||h===r)&&(g.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!S.nodeName(i.parentNode,"optgroup"))){if(e=S(i).val(),s)return e;o.push(e)}return o},set:function(t,e){for(var i,n,r=t.options,s=S.makeArray(e),o=r.length;o--;)((n=r[o]).selected=-1<S.inArray(S.valHooks.option.get(n),s))&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(t,e){if(S.isArray(e))return t.checked=-1<S.inArray(S(t).val(),e)}},g.checkOn||(S.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var me=/^(?:focusinfocus|focusoutblur)$/;S.extend(S.event,{trigger:function(t,e,i,n){var r,s,o,a,h,l,u,c=[i||D],f=m.call(t,"type")?t.type:t,d=m.call(t,"namespace")?t.namespace.split("."):[];if(s=o=i=i||D,3!==i.nodeType&&8!==i.nodeType&&!me.test(f+S.event.triggered)&&(-1<f.indexOf(".")&&(f=(d=f.split(".")).shift(),d.sort()),h=f.indexOf(":")<0&&"on"+f,(t=t[S.expando]?t:new S.Event(f,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=d.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:S.makeArray(e,[t]),u=S.event.special[f]||{},n||!u.trigger||!1!==u.trigger.apply(i,e))){if(!n&&!u.noBubble&&!S.isWindow(i)){for(a=u.delegateType||f,me.test(a+f)||(s=s.parentNode);s;s=s.parentNode)c.push(s),o=s;o===(i.ownerDocument||D)&&c.push(o.defaultView||o.parentWindow||T)}for(r=0;(s=c[r++])&&!t.isPropagationStopped();)t.type=1<r?a:u.bindType||f,(l=(N.get(s,"events")||{})[t.type]&&N.get(s,"handle"))&&l.apply(s,e),(l=h&&s[h])&&l.apply&&M(s)&&(t.result=l.apply(s,e),!1===t.result&&t.preventDefault());return t.type=f,n||t.isDefaultPrevented()||u._default&&!1!==u._default.apply(c.pop(),e)||!M(i)||h&&S.isFunction(i[f])&&!S.isWindow(i)&&((o=i[h])&&(i[h]=null),i[S.event.triggered=f](),S.event.triggered=void 0,o&&(i[h]=o)),t.result}},simulate:function(t,e,i){var n=S.extend(new S.Event,i,{type:t,isSimulated:!0});S.event.trigger(n,null,e)}}),S.fn.extend({trigger:function(t,e){return this.each(function(){S.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return S.event.trigger(t,e,i,!0)}}),S.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,i){S.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}}),S.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),g.focusin="onfocusin"in T,g.focusin||S.each({focus:"focusin",blur:"focusout"},function(i,n){function r(t){S.event.simulate(n,t.target,S.event.fix(t))}S.event.special[n]={setup:function(){var t=this.ownerDocument||this,e=N.access(t,n);e||t.addEventListener(i,r,!0),N.access(t,n,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=N.access(t,n)-1;e?N.access(t,n,e):(t.removeEventListener(i,r,!0),N.remove(t,n))}}});var pe=T.location,ge=S.now(),ve=/\?/;S.parseJSON=function(t){return JSON.parse(t+"")},S.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new T.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+t),e};var _e=/#.*$/,xe=/([?&])_=[^&]*/,be=/^(.*?):[ \t]*([^\r\n]*)$/gm,ye=/^(?:GET|HEAD)$/,we=/^\/\//,Te={},De={},Se="*/".concat("*"),Ce=D.createElement("a");function Ae(s){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,n=0,r=t.toLowerCase().match(P)||[];if(S.isFunction(e))for(;i=r[n++];)"+"===i[0]?(i=i.slice(1)||"*",(s[i]=s[i]||[]).unshift(e)):(s[i]=s[i]||[]).push(e)}}function Ee(e,r,s,o){var a={},h=e===De;function l(t){var n;return a[t]=!0,S.each(e[t]||[],function(t,e){var i=e(r,s,o);return"string"!=typeof i||h||a[i]?h?!(n=i):void 0:(r.dataTypes.unshift(i),l(i),!1)}),n}return l(r.dataTypes[0])||!a["*"]&&l("*")}function Fe(t,e){var i,n,r=S.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&S.extend(!0,t,n),t}Ce.href=pe.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Se,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":S.parseJSON,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Fe(Fe(t,S.ajaxSettings),e):Fe(S.ajaxSettings,t)},ajaxPrefilter:Ae(Te),ajaxTransport:Ae(De),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var u,c,f,i,d,n,m,r,p=S.ajaxSetup({},e),g=p.context||p,v=p.context&&(g.nodeType||g.jquery)?S(g):S.event,_=S.Deferred(),x=S.Callbacks("once memory"),b=p.statusCode||{},s={},o={},y=0,a="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!i)for(i={};e=be.exec(f);)i[e[1].toLowerCase()]=e[2];e=i[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?f:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return y||(t=o[i]=o[i]||t,s[t]=e),this},overrideMimeType:function(t){return y||(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(y<2)for(e in t)b[e]=[b[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||a;return u&&u.abort(e),h(0,e),this}};if(_.promise(w).complete=x.add,w.success=w.done,w.error=w.fail,p.url=((t||p.url||pe.href)+"").replace(_e,"").replace(we,pe.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=S.trim(p.dataType||"*").toLowerCase().match(P)||[""],null==p.crossDomain){n=D.createElement("a");try{n.href=p.url,n.href=n.href,p.crossDomain=Ce.protocol+"//"+Ce.host!=n.protocol+"//"+n.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=S.param(p.data,p.traditional)),Ee(Te,p,e,w),2===y)return w;for(r in(m=S.event&&p.global)&&0==S.active++&&S.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!ye.test(p.type),c=p.url,p.hasContent||(p.data&&(c=p.url+=(ve.test(c)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=xe.test(c)?c.replace(xe,"$1_="+ge++):c+(ve.test(c)?"&":"?")+"_="+ge++)),p.ifModified&&(S.lastModified[c]&&w.setRequestHeader("If-Modified-Since",S.lastModified[c]),S.etag[c]&&w.setRequestHeader("If-None-Match",S.etag[c])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&w.setRequestHeader("Content-Type",p.contentType),w.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Se+"; q=0.01":""):p.accepts["*"]),p.headers)w.setRequestHeader(r,p.headers[r]);if(p.beforeSend&&(!1===p.beforeSend.call(g,w,p)||2===y))return w.abort();for(r in a="abort",{success:1,error:1,complete:1})w[r](p[r]);if(u=Ee(De,p,e,w)){if(w.readyState=1,m&&v.trigger("ajaxSend",[w,p]),2===y)return w;p.async&&0<p.timeout&&(d=T.setTimeout(function(){w.abort("timeout")},p.timeout));try{y=1,u.send(s,h)}catch(t){if(!(y<2))throw t;h(-1,t)}}else h(-1,"No Transport");function h(t,e,i,n){var r,s,o,a,h,l=e;2!==y&&(y=2,d&&T.clearTimeout(d),u=void 0,f=n||"",w.readyState=0<t?4:0,r=200<=t&&t<300||304===t,i&&(a=function(t,e,i){for(var n,r,s,o,a=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){h.unshift(r);break}if(h[0]in i)s=h[0];else{for(r in i){if(!h[0]||t.converters[r+" "+h[0]]){s=r;break}o||(o=r)}s=s||o}if(s)return s!==h[0]&&h.unshift(s),i[s]}(p,w,i)),a=function(t,e,i,n){var r,s,o,a,h,l={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)l[o.toLowerCase()]=t.converters[o];for(s=u.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!h&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=s,s=u.shift())if("*"===s)s=h;else if("*"!==h&&h!==s){if(!(o=l[h+" "+s]||l["* "+s]))for(r in l)if((a=r.split(" "))[1]===s&&(o=l[h+" "+a[0]]||l["* "+a[0]])){!0===o?o=l[r]:!0!==l[r]&&(s=a[0],u.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+h+" to "+s}}}return{state:"success",data:e}}(p,a,w,r),r?(p.ifModified&&((h=w.getResponseHeader("Last-Modified"))&&(S.lastModified[c]=h),(h=w.getResponseHeader("etag"))&&(S.etag[c]=h)),204===t||"HEAD"===p.type?l="nocontent":304===t?l="notmodified":(l=a.state,s=a.data,r=!(o=a.error))):(o=l,!t&&l||(l="error",t<0&&(t=0))),w.status=t,w.statusText=(e||l)+"",r?_.resolveWith(g,[s,l,w]):_.rejectWith(g,[w,l,o]),w.statusCode(b),b=void 0,m&&v.trigger(r?"ajaxSuccess":"ajaxError",[w,p,r?s:o]),x.fireWith(g,[w,l]),m&&(v.trigger("ajaxComplete",[w,p]),--S.active||S.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,i){return S.get(t,e,i,"json")},getScript:function(t,e){return S.get(t,void 0,e,"script")}}),S.each(["get","post"],function(t,r){S[r]=function(t,e,i,n){return S.isFunction(e)&&(n=n||i,i=e,e=void 0),S.ajax(S.extend({url:t,type:r,dataType:n,data:e,success:i},S.isPlainObject(t)&&t))}}),S._evalUrl=function(t){return S.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},S.fn.extend({wrapAll:function(e){var t;return S.isFunction(e)?this.each(function(t){S(this).wrapAll(e.call(this,t))}):(this[0]&&(t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(i){return S.isFunction(i)?this.each(function(t){S(this).wrapInner(i.call(this,t))}):this.each(function(){var t=S(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=S.isFunction(e);return this.each(function(t){S(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(){return this.parent().each(function(){S.nodeName(this,"body")||S(this).replaceWith(this.childNodes)}).end()}}),S.expr.filters.hidden=function(t){return!S.expr.filters.visible(t)},S.expr.filters.visible=function(t){return 0<t.offsetWidth||0<t.offsetHeight||0<t.getClientRects().length};var Re=/%20/g,Pe=/\[\]$/,Be=/\r?\n/g,Me=/^(?:submit|button|image|reset|file)$/i,Ie=/^(?:input|select|textarea|keygen)/i;function Le(i,t,n,r){var e;if(S.isArray(t))S.each(t,function(t,e){n||Pe.test(i)?r(i,e):Le(i+"["+("object"==typeof e&&null!=e?t:"")+"]",e,n,r)});else if(n||"object"!==S.type(t))r(i,t);else for(e in t)Le(i+"["+e+"]",t[e],n,r)}S.param=function(t,e){function i(t,e){e=S.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)}var n,r=[];if(void 0===e&&(e=S.ajaxSettings&&S.ajaxSettings.traditional),S.isArray(t)||t.jquery&&!S.isPlainObject(t))S.each(t,function(){i(this.name,this.value)});else for(n in t)Le(n,t[n],e,i);return r.join("&").replace(Re,"+")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=S.prop(this,"elements");return t?S.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!S(this).is(":disabled")&&Ie.test(this.nodeName)&&!Me.test(t)&&(this.checked||!X.test(t))}).map(function(t,e){var i=S(this).val();return null==i?null:S.isArray(i)?S.map(i,function(t){return{name:e.name,value:t.replace(Be,"\r\n")}}):{name:e.name,value:i.replace(Be,"\r\n")}}).get()}}),S.ajaxSettings.xhr=function(){try{return new T.XMLHttpRequest}catch(t){}};var Ne={0:200,1223:204},ke=S.ajaxSettings.xhr();g.cors=!!ke&&"withCredentials"in ke,g.ajax=ke=!!ke,S.ajaxTransport(function(r){var s,o;if(g.cors||ke&&!r.crossDomain)return{send:function(t,e){var i,n=r.xhr();if(n.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(i in r.xhrFields)n[i]=r.xhrFields[i];for(i in r.mimeType&&n.overrideMimeType&&n.overrideMimeType(r.mimeType),r.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)n.setRequestHeader(i,t[i]);s=function(t){return function(){s&&(s=o=n.onload=n.onerror=n.onabort=n.onreadystatechange=null,"abort"===t?n.abort():"error"===t?"number"!=typeof n.status?e(0,"error"):e(n.status,n.statusText):e(Ne[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders()))}},n.onload=s(),o=n.onerror=s("error"),void 0!==n.onabort?n.onabort=o:n.onreadystatechange=function(){4===n.readyState&&T.setTimeout(function(){s&&o()})},s=s("abort");try{n.send(r.hasContent&&r.data||null)}catch(t){if(s)throw t}},abort:function(){s&&s()}}}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return S.globalEval(t),t}}}),S.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),S.ajaxTransport("script",function(i){var n,r;if(i.crossDomain)return{send:function(t,e){n=S("<script>").prop({charset:i.scriptCharset,src:i.url}).on("load error",r=function(t){n.remove(),r=null,t&&e("error"===t.type?404:200,t.type)}),D.head.appendChild(n[0])},abort:function(){r&&r()}}});var Oe=[],ze=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Oe.pop()||S.expando+"_"+ge++;return this[t]=!0,t}}),S.ajaxPrefilter("json jsonp",function(t,e,i){var n,r,s,o=!1!==t.jsonp&&(ze.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ze.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=S.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(ze,"$1"+n):!1!==t.jsonp&&(t.url+=(ve.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return s||S.error(n+" was not called"),s[0]},t.dataTypes[0]="json",r=T[n],T[n]=function(){s=arguments},i.always(function(){void 0===r?S(T).removeProp(n):T[n]=r,t[n]&&(t.jsonpCallback=e.jsonpCallback,Oe.push(n)),s&&S.isFunction(r)&&r(s[0]),s=r=void 0}),"script"}),S.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||D;var n=x.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=et([t],e,r),r&&r.length&&S(r).remove(),S.merge([],n.childNodes))};var Ue=S.fn.load;function He(t){return S.isWindow(t)?t:9===t.nodeType&&t.defaultView}S.fn.load=function(t,e,i){if("string"!=typeof t&&Ue)return Ue.apply(this,arguments);var n,r,s,o=this,a=t.indexOf(" ");return-1<a&&(n=S.trim(t.slice(a)),t=t.slice(0,a)),S.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<o.length&&S.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){s=arguments,o.html(n?S("<div>").append(S.parseHTML(t)).find(n):t)}).always(i&&function(t,e){o.each(function(){i.apply(this,s||[t.responseText,e,t])})}),this},S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){S.fn[e]=function(t){return this.on(e,t)}}),S.expr.filters.animated=function(e){return S.grep(S.timers,function(t){return e===t.elem}).length},S.offset={setOffset:function(t,e,i){var n,r,s,o,a,h,l=S.css(t,"position"),u=S(t),c={};"static"===l&&(t.style.position="relative"),a=u.offset(),s=S.css(t,"top"),h=S.css(t,"left"),r=("absolute"===l||"fixed"===l)&&-1<(s+h).indexOf("auto")?(o=(n=u.position()).top,n.left):(o=parseFloat(s)||0,parseFloat(h)||0),S.isFunction(e)&&(e=e.call(t,i,S.extend({},a))),null!=e.top&&(c.top=e.top-a.top+o),null!=e.left&&(c.left=e.left-a.left+r),"using"in e?e.using.call(t,c):u.css(c)}},S.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){S.offset.setOffset(this,e,t)});var t,i,n=this[0],r={top:0,left:0},s=n&&n.ownerDocument;return s?(t=s.documentElement,S.contains(t,n)?(r=n.getBoundingClientRect(),i=He(s),{top:r.top+i.pageYOffset-t.clientTop,left:r.left+i.pageXOffset-t.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===S.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),S.nodeName(t[0],"html")||(n=t.offset()),n.top+=S.css(t[0],"borderTopWidth",!0),n.left+=S.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-S.css(i,"marginTop",!0),left:e.left-n.left-S.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===S.css(t,"position");)t=t.offsetParent;return t||It})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,r){var s="pageYOffset"===r;S.fn[e]=function(t){return I(this,function(t,e,i){var n=He(t);if(void 0===i)return n?n[r]:t[e];n?n.scrollTo(s?n.pageXOffset:i,s?i:n.pageYOffset):t[e]=i},e,t,arguments.length)}}),S.each(["top","left"],function(t,i){S.cssHooks[i]=kt(g.pixelPosition,function(t,e){if(e)return e=Nt(t,i),Bt.test(e)?S(t).position()[i]+"px":e})}),S.each({Height:"height",Width:"width"},function(s,o){S.each({padding:"inner"+s,content:o,"":"outer"+s},function(n,t){S.fn[t]=function(t,e){var i=arguments.length&&(n||"boolean"!=typeof t),r=n||(!0===t||!0===e?"margin":"border");return I(this,function(t,e,i){var n;return S.isWindow(t)?t.document.documentElement["client"+s]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+s],n["scroll"+s],t.body["offset"+s],n["offset"+s],n["client"+s])):void 0===i?S.css(t,e,r):S.style(t,e,i,r)},o,i?t:void 0,i,null)}})}),S.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},size:function(){return this.length}}),S.fn.andSelf=S.fn.addBack,void 0===(Xe=function(){return S}.apply(Ge,[]))||(We.exports=Xe);var je=T.jQuery,qe=T.$;return S.noConflict=function(t){return T.$===S&&(T.$=qe),t&&T.jQuery===S&&(T.jQuery=je),S},t||(T.jQuery=T.$=S),S},"object"==typeof We.exports?We.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)},function(t,e,i){"use strict";var n=i(1),r=i.n(n);i(6);r.a.noConflict(!0),e.a=r.a},function(s,o,t){(function(t){var e,i,n;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i=this,n=function(t){"use strict";var i=1e-6,s={};!function(){if("undefined"!=typeof Float32Array){var n=new Float32Array(1),r=new Int32Array(n.buffer);s.invsqrt=function(t){var e=.5*t;n[0]=t;r[0]=1597463007-(r[0]>>1);var i=n[0];return i*(1.5-e*i*i)}}else s.invsqrt=function(t){return 1/Math.sqrt(t)}}();var v=null;function e(t){return v=t}function n(){return v="undefined"!=typeof Float32Array?Float32Array:Array}n();var a={create:function(t){var e=new v(3);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2]):e[0]=e[1]=e[2]=0,e},createFrom:function(t,e,i){var n=new v(3);return n[0]=t,n[1]=e,n[2]=i,n},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i},add:function(t,e,i){return i&&t!==i?(i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i):(t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t)},subtract:function(t,e,i){return i&&t!==i?(i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i):(t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t)},multiply:function(t,e,i){return i&&t!==i?(i[0]=t[0]*e[0],i[1]=t[1]*e[1],i[2]=t[2]*e[2],i):(t[0]*=e[0],t[1]*=e[1],t[2]*=e[2],t)},negate:function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},scale:function(t,e,i){return i&&t!==i?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i):(t[0]*=e,t[1]*=e,t[2]*=e,t)},normalize:function(t,e){e||(e=t);var i=t[0],n=t[1],r=t[2],s=Math.sqrt(i*i+n*n+r*r);return s?1===s?(e[0]=i,e[1]=n,e[2]=r):(s=1/s,e[0]=i*s,e[1]=n*s,e[2]=r*s):(e[0]=0,e[1]=0,e[2]=0),e},cross:function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=e[0],a=e[1],h=e[2];return i[0]=r*h-s*a,i[1]=s*o-n*h,i[2]=n*a-r*o,i},length:function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},squaredLength:function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},direction:function(t,e,i){i||(i=t);var n=t[0]-e[0],r=t[1]-e[1],s=t[2]-e[2],o=Math.sqrt(n*n+r*r+s*s);return o?(o=1/o,i[0]=n*o,i[1]=r*o,i[2]=s*o):(i[0]=0,i[1]=0,i[2]=0),i},lerp:function(t,e,i,n){return n||(n=t),n[0]=t[0]+i*(e[0]-t[0]),n[1]=t[1]+i*(e[1]-t[1]),n[2]=t[2]+i*(e[2]-t[2]),n},dist:function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)}},h=null,l=new v(4);a.unproject=function(t,e,i,n,r){r||(r=t),h||(h=T.create());var s=h,o=l;return o[0]=2*(t[0]-n[0])/n[2]-1,o[1]=2*(t[1]-n[1])/n[3]-1,o[2]=2*t[2]-1,o[3]=1,T.multiply(i,e,s),T.inverse(s)?(T.multiplyVec4(s,o),0===o[3]?null:(r[0]=o[0]/o[3],r[1]=o[1]/o[3],r[2]=o[2]/o[3],r)):null};var u=a.createFrom(1,0,0),c=a.createFrom(0,1,0),f=a.createFrom(0,0,1),d=a.create();a.rotationTo=function(t,e,i){i||(i=m.create());var n=a.dot(t,e),r=d;if(1<=n)m.set(p,i);else if(n<1e-6-1)a.cross(u,t,r),a.length(r)<1e-6&&a.cross(c,t,r),a.length(r)<1e-6&&a.cross(f,t,r),a.normalize(r),m.fromAngleAxis(Math.PI,r,i);else{var s=Math.sqrt(2*(1+n)),o=1/s;a.cross(t,e,r),i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[3]=.5*s,m.normalize(i)}return 1<i[3]?i[3]=1:i[3]<-1&&(i[3]=-1),i},a.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+"]"};var r,_={create:function(t){var e=new v(9);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]):e[0]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=0,e},createFrom:function(t,e,i,n,r,s,o,a,h){var l=new v(9);return l[0]=t,l[1]=e,l[2]=i,l[3]=n,l[4]=r,l[5]=s,l[6]=o,l[7]=a,l[8]=h,l},determinant:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],l=t[8];return e*(l*s-o*h)+i*(-l*r+o*a)+n*(h*r-s*a)},inverse:function(t,e){var i,n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],f=c*a-h*u,d=-c*o+h*l,m=u*o-a*l,p=n*f+r*d+s*m;return p?(i=1/p,e||(e=_.create()),e[0]=f*i,e[1]=(-c*r+s*u)*i,e[2]=(h*r-s*a)*i,e[3]=d*i,e[4]=(c*n-s*l)*i,e[5]=(-h*n+s*o)*i,e[6]=m*i,e[7]=(-u*n+r*l)*i,e[8]=(a*n-r*o)*i,e):null},multiply:function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],f=e[0],d=e[1],m=e[2],p=e[3],g=e[4],v=e[5],_=e[6],x=e[7],b=e[8];return i[0]=f*n+d*o+m*l,i[1]=f*r+d*a+m*u,i[2]=f*s+d*h+m*c,i[3]=p*n+g*o+v*l,i[4]=p*r+g*a+v*u,i[5]=p*s+g*h+v*c,i[6]=_*n+x*o+b*l,i[7]=_*r+x*a+b*u,i[8]=_*s+x*h+b*c,i},multiplyVec2:function(t,e,i){i||(i=e);var n=e[0],r=e[1];return i[0]=n*t[0]+r*t[3]+t[6],i[1]=n*t[1]+r*t[4]+t[7],i},multiplyVec3:function(t,e,i){i||(i=e);var n=e[0],r=e[1],s=e[2];return i[0]=n*t[0]+r*t[3]+s*t[6],i[1]=n*t[1]+r*t[4]+s*t[7],i[2]=n*t[2]+r*t[5]+s*t[8],i},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i&&Math.abs(t[4]-e[4])<i&&Math.abs(t[5]-e[5])<i&&Math.abs(t[6]-e[6])<i&&Math.abs(t[7]-e[7])<i&&Math.abs(t[8]-e[8])<i},identity:function(t){return t||(t=_.create()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e;var i=t[1],n=t[2],r=t[5];return t[1]=t[3],t[2]=t[6],t[3]=i,t[5]=t[7],t[6]=n,t[7]=r,t},toMat4:function(t,e){return e||(e=T.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+"]"}},T={create:function(t){var e=new v(16);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e},createFrom:function(t,e,i,n,r,s,o,a,h,l,u,c,f,d,m,p){var g=new v(16);return g[0]=t,g[1]=e,g[2]=i,g[3]=n,g[4]=r,g[5]=s,g[6]=o,g[7]=a,g[8]=h,g[9]=l,g[10]=u,g[11]=c,g[12]=f,g[13]=d,g[14]=m,g[15]=p,g},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i&&Math.abs(t[4]-e[4])<i&&Math.abs(t[5]-e[5])<i&&Math.abs(t[6]-e[6])<i&&Math.abs(t[7]-e[7])<i&&Math.abs(t[8]-e[8])<i&&Math.abs(t[9]-e[9])<i&&Math.abs(t[10]-e[10])<i&&Math.abs(t[11]-e[11])<i&&Math.abs(t[12]-e[12])<i&&Math.abs(t[13]-e[13])<i&&Math.abs(t[14]-e[14])<i&&Math.abs(t[15]-e[15])<i},identity:function(t){return t||(t=T.create()),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},transpose:function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e;var i=t[1],n=t[2],r=t[3],s=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=s,t[11]=t[14],t[12]=r,t[13]=o,t[14]=a,t},determinant:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],l=t[8],u=t[9],c=t[10],f=t[11],d=t[12],m=t[13],p=t[14],g=t[15];return d*u*a*r-l*m*a*r-d*o*c*r+s*m*c*r+l*o*p*r-s*u*p*r-d*u*n*h+l*m*n*h+d*i*c*h-e*m*c*h-l*i*p*h+e*u*p*h+d*o*n*f-s*m*n*f-d*i*a*f+e*m*a*f+s*i*p*f-e*o*p*f-l*o*n*g+s*u*n*g+l*i*a*g-e*u*a*g-s*i*c*g+e*o*c*g},inverse:function(t,e){e||(e=t);var i,n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],f=t[9],d=t[10],m=t[11],p=t[12],g=t[13],v=t[14],_=t[15],x=n*h-r*a,b=n*l-s*a,y=n*u-o*a,w=r*l-s*h,T=r*u-o*h,D=s*u-o*l,S=c*g-f*p,C=c*v-d*p,A=c*_-m*p,E=f*v-d*g,F=f*_-m*g,R=d*_-m*v,P=x*R-b*F+y*E+w*A-T*C+D*S;return P?(i=1/P,e[0]=(h*R-l*F+u*E)*i,e[1]=(-r*R+s*F-o*E)*i,e[2]=(g*D-v*T+_*w)*i,e[3]=(-f*D+d*T-m*w)*i,e[4]=(-a*R+l*A-u*C)*i,e[5]=(n*R-s*A+o*C)*i,e[6]=(-p*D+v*y-_*b)*i,e[7]=(c*D-d*y+m*b)*i,e[8]=(a*F-h*A+u*S)*i,e[9]=(-n*F+r*A-o*S)*i,e[10]=(p*T-g*y+_*x)*i,e[11]=(-c*T+f*y-m*x)*i,e[12]=(-a*E+h*C-l*S)*i,e[13]=(n*E-r*C+s*S)*i,e[14]=(-p*w+g*b-v*x)*i,e[15]=(c*w-f*b+d*x)*i,e):null},toRotationMat:function(t,e){return e||(e=T.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},toMat3:function(t,e){return e||(e=_.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},toInverseMat3:function(t,e){var i,n=t[0],r=t[1],s=t[2],o=t[4],a=t[5],h=t[6],l=t[8],u=t[9],c=t[10],f=c*a-h*u,d=-c*o+h*l,m=u*o-a*l,p=n*f+r*d+s*m;return p?(i=1/p,e||(e=_.create()),e[0]=f*i,e[1]=(-c*r+s*u)*i,e[2]=(h*r-s*a)*i,e[3]=d*i,e[4]=(c*n-s*l)*i,e[5]=(-h*n+s*o)*i,e[6]=m*i,e[7]=(-u*n+r*l)*i,e[8]=(a*n-r*o)*i,e):null},multiply:function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],f=t[9],d=t[10],m=t[11],p=t[12],g=t[13],v=t[14],_=t[15],x=e[0],b=e[1],y=e[2],w=e[3];return i[0]=x*n+b*a+y*c+w*p,i[1]=x*r+b*h+y*f+w*g,i[2]=x*s+b*l+y*d+w*v,i[3]=x*o+b*u+y*m+w*_,x=e[4],b=e[5],y=e[6],w=e[7],i[4]=x*n+b*a+y*c+w*p,i[5]=x*r+b*h+y*f+w*g,i[6]=x*s+b*l+y*d+w*v,i[7]=x*o+b*u+y*m+w*_,x=e[8],b=e[9],y=e[10],w=e[11],i[8]=x*n+b*a+y*c+w*p,i[9]=x*r+b*h+y*f+w*g,i[10]=x*s+b*l+y*d+w*v,i[11]=x*o+b*u+y*m+w*_,x=e[12],b=e[13],y=e[14],w=e[15],i[12]=x*n+b*a+y*c+w*p,i[13]=x*r+b*h+y*f+w*g,i[14]=x*s+b*l+y*d+w*v,i[15]=x*o+b*u+y*m+w*_,i},multiplyVec3:function(t,e,i){i||(i=e);var n=e[0],r=e[1],s=e[2];return i[0]=t[0]*n+t[4]*r+t[8]*s+t[12],i[1]=t[1]*n+t[5]*r+t[9]*s+t[13],i[2]=t[2]*n+t[6]*r+t[10]*s+t[14],i},multiplyVec4:function(t,e,i){i||(i=e);var n=e[0],r=e[1],s=e[2],o=e[3];return i[0]=t[0]*n+t[4]*r+t[8]*s+t[12]*o,i[1]=t[1]*n+t[5]*r+t[9]*s+t[13]*o,i[2]=t[2]*n+t[6]*r+t[10]*s+t[14]*o,i[3]=t[3]*n+t[7]*r+t[11]*s+t[15]*o,i},translate:function(t,e,i){var n,r,s,o,a,h,l,u,c,f,d,m,p=e[0],g=e[1],v=e[2];return i&&t!==i?(n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],u=t[7],c=t[8],f=t[9],d=t[10],m=t[11],i[0]=n,i[1]=r,i[2]=s,i[3]=o,i[4]=a,i[5]=h,i[6]=l,i[7]=u,i[8]=c,i[9]=f,i[10]=d,i[11]=m,i[12]=n*p+a*g+c*v+t[12],i[13]=r*p+h*g+f*v+t[13],i[14]=s*p+l*g+d*v+t[14],i[15]=o*p+u*g+m*v+t[15],i):(t[12]=t[0]*p+t[4]*g+t[8]*v+t[12],t[13]=t[1]*p+t[5]*g+t[9]*v+t[13],t[14]=t[2]*p+t[6]*g+t[10]*v+t[14],t[15]=t[3]*p+t[7]*g+t[11]*v+t[15],t)},scale:function(t,e,i){var n=e[0],r=e[1],s=e[2];return i&&t!==i?(i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*s,i[9]=t[9]*s,i[10]=t[10]*s,i[11]=t[11]*s,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i):(t[0]*=n,t[1]*=n,t[2]*=n,t[3]*=n,t[4]*=r,t[5]*=r,t[6]*=r,t[7]*=r,t[8]*=s,t[9]*=s,t[10]*=s,t[11]*=s,t)},rotate:function(t,e,i,n){var r,s,o,a,h,l,u,c,f,d,m,p,g,v,_,x,b,y,w,T,D,S,C,A,E=i[0],F=i[1],R=i[2],P=Math.sqrt(E*E+F*F+R*R);return P?(1!==P&&(E*=P=1/P,F*=P,R*=P),r=Math.sin(e),o=1-(s=Math.cos(e)),a=t[0],h=t[1],l=t[2],u=t[3],c=t[4],f=t[5],d=t[6],m=t[7],p=t[8],g=t[9],v=t[10],_=t[11],x=E*E*o+s,b=F*E*o+R*r,y=R*E*o-F*r,w=E*F*o-R*r,T=F*F*o+s,D=R*F*o+E*r,S=E*R*o+F*r,C=F*R*o-E*r,A=R*R*o+s,n?t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]):n=t,n[0]=a*x+c*b+p*y,n[1]=h*x+f*b+g*y,n[2]=l*x+d*b+v*y,n[3]=u*x+m*b+_*y,n[4]=a*w+c*T+p*D,n[5]=h*w+f*T+g*D,n[6]=l*w+d*T+v*D,n[7]=u*w+m*T+_*D,n[8]=a*S+c*C+p*A,n[9]=h*S+f*C+g*A,n[10]=l*S+d*C+v*A,n[11]=u*S+m*C+_*A,n):null},rotateX:function(t,e,i){var n=Math.sin(e),r=Math.cos(e),s=t[4],o=t[5],a=t[6],h=t[7],l=t[8],u=t[9],c=t[10],f=t[11];return i?t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[4]=s*r+l*n,i[5]=o*r+u*n,i[6]=a*r+c*n,i[7]=h*r+f*n,i[8]=s*-n+l*r,i[9]=o*-n+u*r,i[10]=a*-n+c*r,i[11]=h*-n+f*r,i},rotateY:function(t,e,i){var n=Math.sin(e),r=Math.cos(e),s=t[0],o=t[1],a=t[2],h=t[3],l=t[8],u=t[9],c=t[10],f=t[11];return i?t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=s*r+l*-n,i[1]=o*r+u*-n,i[2]=a*r+c*-n,i[3]=h*r+f*-n,i[8]=s*n+l*r,i[9]=o*n+u*r,i[10]=a*n+c*r,i[11]=h*n+f*r,i},rotateZ:function(t,e,i){var n=Math.sin(e),r=Math.cos(e),s=t[0],o=t[1],a=t[2],h=t[3],l=t[4],u=t[5],c=t[6],f=t[7];return i?t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=s*r+l*n,i[1]=o*r+u*n,i[2]=a*r+c*n,i[3]=h*r+f*n,i[4]=s*-n+l*r,i[5]=o*-n+u*r,i[6]=a*-n+c*r,i[7]=h*-n+f*r,i},frustum:function(t,e,i,n,r,s,o){o||(o=T.create());var a=e-t,h=n-i,l=s-r;return o[0]=2*r/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r/h,o[6]=0,o[7]=0,o[8]=(e+t)/a,o[9]=(n+i)/h,o[10]=-(s+r)/l,o[11]=-1,o[12]=0,o[13]=0,o[14]=-s*r*2/l,o[15]=0,o},perspective:function(t,e,i,n,r){var s=i*Math.tan(t*Math.PI/360),o=s*e;return T.frustum(-o,o,-s,s,i,n,r)},ortho:function(t,e,i,n,r,s,o){o||(o=T.create());var a=e-t,h=n-i,l=s-r;return o[0]=2/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/h,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/l,o[11]=0,o[12]=-(t+e)/a,o[13]=-(n+i)/h,o[14]=-(s+r)/l,o[15]=1,o},lookAt:function(t,e,i,n){n||(n=T.create());var r,s,o,a,h,l,u,c,f,d,m=t[0],p=t[1],g=t[2],v=i[0],_=i[1],x=i[2],b=e[0],y=e[1],w=e[2];return m===b&&p===y&&g===w?T.identity(n):(u=m-b,c=p-y,f=g-w,r=_*(f*=d=1/Math.sqrt(u*u+c*c+f*f))-x*(c*=d),s=x*(u*=d)-v*f,o=v*c-_*u,(d=Math.sqrt(r*r+s*s+o*o))?(r*=d=1/d,s*=d,o*=d):o=s=r=0,a=c*o-f*s,h=f*r-u*o,l=u*s-c*r,(d=Math.sqrt(a*a+h*h+l*l))?(a*=d=1/d,h*=d,l*=d):l=h=a=0,n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=h,n[6]=c,n[7]=0,n[8]=o,n[9]=l,n[10]=f,n[11]=0,n[12]=-(r*m+s*p+o*g),n[13]=-(a*m+h*p+l*g),n[14]=-(u*m+c*p+f*g),n[15]=1,n)},fromRotationTranslation:function(t,e,i){i||(i=T.create());var n=t[0],r=t[1],s=t[2],o=t[3],a=n+n,h=r+r,l=s+s,u=n*a,c=n*h,f=n*l,d=r*h,m=r*l,p=s*l,g=o*a,v=o*h,_=o*l;return i[0]=1-(d+p),i[1]=c+_,i[2]=f-v,i[3]=0,i[4]=c-_,i[5]=1-(u+p),i[6]=m+g,i[7]=0,i[8]=f+v,i[9]=m-g,i[10]=1-(u+d),i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+"]"}},m={create:function(t){var e=new v(4);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):e[0]=e[1]=e[2]=e[3]=0,e},createFrom:function(t,e,i,n){var r=new v(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i},identity:function(t){return t||(t=m.create()),t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}},p=m.identity();m.calculateW=function(t,e){var i=t[0],n=t[1],r=t[2];return e&&t!==e?(e[0]=i,e[1]=n,e[2]=r,e[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),e):(t[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t)},m.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},m.inverse=function(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],o=i*i+n*n+r*r+s*s,a=o?1/o:0;return e&&t!==e?(e[0]=-t[0]*a,e[1]=-t[1]*a,e[2]=-t[2]*a,e[3]=t[3]*a,e):(t[0]*=-a,t[1]*=-a,t[2]*=-a,t[3]*=a,t)},m.conjugate=function(t,e){return e&&t!==e?(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e):(t[0]*=-1,t[1]*=-1,t[2]*=-1,t)},m.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},m.normalize=function(t,e){e||(e=t);var i=t[0],n=t[1],r=t[2],s=t[3],o=Math.sqrt(i*i+n*n+r*r+s*s);return 0===o?(e[0]=0,e[1]=0,e[2]=0,e[3]=0):(o=1/o,e[0]=i*o,e[1]=n*o,e[2]=r*o,e[3]=s*o),e},m.add=function(t,e,i){return i&&t!==i?(i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3],i):(t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],t)},m.multiply=function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1],l=e[2],u=e[3];return i[0]=n*u+o*a+r*l-s*h,i[1]=r*u+o*h+s*a-n*l,i[2]=s*u+o*l+n*h-r*a,i[3]=o*u-n*a-r*h-s*l,i},m.multiplyVec3=function(t,e,i){i||(i=e);var n=e[0],r=e[1],s=e[2],o=t[0],a=t[1],h=t[2],l=t[3],u=l*n+a*s-h*r,c=l*r+h*n-o*s,f=l*s+o*r-a*n,d=-o*n-a*r-h*s;return i[0]=u*l+d*-o+c*-h-f*-a,i[1]=c*l+d*-a+f*-o-u*-h,i[2]=f*l+d*-h+u*-a-c*-o,i},m.scale=function(t,e,i){return i&&t!==i?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i):(t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t)},m.toMat3=function(t,e){e||(e=_.create());var i=t[0],n=t[1],r=t[2],s=t[3],o=i+i,a=n+n,h=r+r,l=i*o,u=i*a,c=i*h,f=n*a,d=n*h,m=r*h,p=s*o,g=s*a,v=s*h;return e[0]=1-(f+m),e[1]=u+v,e[2]=c-g,e[3]=u-v,e[4]=1-(l+m),e[5]=d+p,e[6]=c+g,e[7]=d-p,e[8]=1-(l+f),e},m.toMat4=function(t,e){e||(e=T.create());var i=t[0],n=t[1],r=t[2],s=t[3],o=i+i,a=n+n,h=r+r,l=i*o,u=i*a,c=i*h,f=n*a,d=n*h,m=r*h,p=s*o,g=s*a,v=s*h;return e[0]=1-(f+m),e[1]=u+v,e[2]=c-g,e[3]=0,e[4]=u-v,e[5]=1-(l+m),e[6]=d+p,e[7]=0,e[8]=c+g,e[9]=d-p,e[10]=1-(l+f),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.slerp=function(t,e,i,n){n||(n=t);var r,s,o,a,h=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];return 1<=Math.abs(h)?(n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3]),n):(r=Math.acos(h),s=Math.sqrt(1-h*h),Math.abs(s)<.001?(n[0]=.5*t[0]+.5*e[0],n[1]=.5*t[1]+.5*e[1],n[2]=.5*t[2]+.5*e[2],n[3]=.5*t[3]+.5*e[3]):(o=Math.sin((1-i)*r)/s,a=Math.sin(i*r)/s,n[0]=t[0]*o+e[0]*a,n[1]=t[1]*o+e[1]*a,n[2]=t[2]*o+e[2]*a,n[3]=t[3]*o+e[3]*a),n)},m.fromRotationMatrix=function(t,e){e||(e=m.create());var i,n=t[0]+t[4]+t[8];if(0<n)i=Math.sqrt(n+1),e[3]=.5*i,i=.5/i,e[0]=(t[7]-t[5])*i,e[1]=(t[2]-t[6])*i,e[2]=(t[3]-t[1])*i;else{var r=m.fromRotationMatrix.s_iNext=m.fromRotationMatrix.s_iNext||[1,2,0],s=0;t[4]>t[0]&&(s=1),t[8]>t[3*s+s]&&(s=2);var o=r[s],a=r[o];i=Math.sqrt(t[3*s+s]-t[3*o+o]-t[3*a+a]+1),e[s]=.5*i,i=.5/i,e[3]=(t[3*a+o]-t[3*o+a])*i,e[o]=(t[3*o+s]+t[3*s+o])*i,e[a]=(t[3*a+s]+t[3*s+a])*i}return e},_.toQuat4=m.fromRotationMatrix,r=_.create(),m.fromAxes=function(t,e,i,n){return r[0]=e[0],r[3]=e[1],r[6]=e[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=t[0],r[5]=t[1],r[8]=t[2],m.fromRotationMatrix(r,n)},m.identity=function(t){return t||(t=m.create()),t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},m.fromAngleAxis=function(t,e,i){i||(i=m.create());var n=.5*t,r=Math.sin(n);return i[3]=Math.cos(n),i[0]=r*e[0],i[1]=r*e[1],i[2]=r*e[2],i},m.toAngleAxis=function(t,e){e||(e=t);var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(0<i){e[3]=2*Math.acos(t[3]);var n=s.invsqrt(i);e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}else e[3]=0,e[0]=1,e[1]=0,e[2]=0;return e},m.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"};var o={create:function(t){var e=new v(2);return t?(e[0]=t[0],e[1]=t[1]):(e[0]=0,e[1]=0),e},createFrom:function(t,e){var i=new v(2);return i[0]=t,i[1]=e,i},add:function(t,e,i){return i||(i=e),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i},subtract:function(t,e,i){return i||(i=e),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i},multiply:function(t,e,i){return i||(i=e),i[0]=t[0]*e[0],i[1]=t[1]*e[1],i},divide:function(t,e,i){return i||(i=e),i[0]=t[0]/e[0],i[1]=t[1]/e[1],i},scale:function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i},dist:function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},set:function(t,e){return e[0]=t[0],e[1]=t[1],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i},negate:function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e},normalize:function(t,e){e||(e=t);var i=t[0]*t[0]+t[1]*t[1];return 0<i?(i=Math.sqrt(i),e[0]=t[0]/i,e[1]=t[1]/i):e[0]=e[1]=0,e},cross:function(t,e,i){var n=t[0]*e[1]-t[1]*e[0];return i?(i[0]=i[1]=0,i[2]=n,i):n},length:function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},squaredLength:function(t){var e=t[0],i=t[1];return e*e+i*i},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},direction:function(t,e,i){i||(i=t);var n=t[0]-e[0],r=t[1]-e[1],s=n*n+r*r;return s?(s=1/Math.sqrt(s),i[0]=n*s,i[1]=r*s):(i[0]=0,i[1]=0,i[2]=0),i},lerp:function(t,e,i,n){return n||(n=t),n[0]=t[0]+i*(e[0]-t[0]),n[1]=t[1]+i*(e[1]-t[1]),n},str:function(t){return"["+t[0]+", "+t[1]+"]"}},g={create:function(t){var e=new v(4);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):e[0]=e[1]=e[2]=e[3]=0,e},createFrom:function(t,e,i,n){var r=new v(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i},identity:function(t){return t||(t=g.create()),t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3],e;var i=t[1];return t[1]=t[2],t[2]=i,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},inverse:function(t,e){e||(e=t);var i=t[0],n=t[1],r=t[2],s=t[3],o=i*s-r*n;return o?(o=1/o,e[0]=s*o,e[1]=-n*o,e[2]=-r*o,e[3]=i*o,e):null},multiply:function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=t[3];return i[0]=n*e[0]+r*e[2],i[1]=n*e[1]+r*e[3],i[2]=s*e[0]+o*e[2],i[3]=s*e[1]+o*e[3],i},rotate:function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(e),h=Math.cos(e);return i[0]=n*h+r*a,i[1]=n*-a+r*h,i[2]=s*h+o*a,i[3]=s*-a+o*h,i},multiplyVec2:function(t,e,i){i||(i=e);var n=e[0],r=e[1];return i[0]=n*t[0]+r*t[1],i[1]=n*t[2]+r*t[3],i},scale:function(t,e,i){i||(i=t);var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1];return i[0]=n*a,i[1]=r*h,i[2]=s*a,i[3]=o*h,i},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"}},x={create:function(t){var e=new v(4);return t?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e},createFrom:function(t,e,i,n){var r=new v(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r},add:function(t,e,i){return i||(i=e),i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i[3]=t[3]+e[3],i},subtract:function(t,e,i){return i||(i=e),i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i[3]=t[3]-e[3],i},multiply:function(t,e,i){return i||(i=e),i[0]=t[0]*e[0],i[1]=t[1]*e[1],i[2]=t[2]*e[2],i[3]=t[3]*e[3],i},divide:function(t,e,i){return i||(i=e),i[0]=t[0]/e[0],i[1]=t[1]/e[1],i[2]=t[2]/e[2],i[3]=t[3]/e[3],i},scale:function(t,e,i){return i||(i=t),i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e,i},set:function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},equal:function(t,e){return t===e||Math.abs(t[0]-e[0])<i&&Math.abs(t[1]-e[1])<i&&Math.abs(t[2]-e[2])<i&&Math.abs(t[3]-e[3])<i},negate:function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},length:function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},squaredLength:function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},lerp:function(t,e,i,n){return n||(n=t),n[0]=t[0]+i*(e[0]-t[0]),n[1]=t[1]+i*(e[1]-t[1]),n[2]=t[2]+i*(e[2]-t[2]),n[3]=t[3]+i*(e[3]-t[3]),n},str:function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"}};return t&&(t.glMatrixArrayType=v,t.MatrixArray=v,t.setMatrixArrayType=e,t.determineMatrixArrayType=n,t.glMath=s,t.vec2=o,t.vec3=a,t.vec4=x,t.mat2=g,t.mat3=_,t.mat4=T,t.quat4=m),{glMatrixArrayType:v,MatrixArray:v,setMatrixArrayType:e,determineMatrixArrayType:n,glMath:s,vec2:o,vec3:a,vec4:x,mat2:g,mat3:_,mat4:T,quat4:m}},"object"===r(o)?s.exports=n(t):void 0===(e=function(){return n(i)}.apply(o,[]))||(s.exports=e)}).call(this,t(7))},function(t,e,i){"use strict";var n,_,x,c,b,d,f,m,p,g,v,y,l,r={};function o(t){return 0==t?0:0<t?1:-1}function s(t,e){for(var i=[],n=f(t,e),r=e.length-1,s=m(n,2*r-1,i,0),o=_(t,e[0]),a=c(o),h=0,l=0;l<s;l++){o=_(t,y(e,r,i[l],null,null));var u=c(o);u<a&&(a=u,h=i[l])}return o=_(t,e[r]),(u=c(o))<a&&(a=u,h=1),{location:h,distance:a}}function h(t,e){for(var i=function(e){var t=l[e];if(!t){var i=function(e){return function(t){return e}},n=function(){return function(t){return t}},r=function(){return function(t){return 1-t}},s=function(n){return function(t){for(var e=1,i=0;i<n.length;i++)e*=n[i](t);return e}};(t=[]).push(new function(){return function(t){return Math.pow(t,e)}});for(var o=1;o<e;o++){for(var a=[new i(e)],h=0;h<e-o;h++)a.push(new n);for(h=0;h<o;h++)a.push(new r);t.push(new s(a))}t.push(new function(){return function(t){return Math.pow(1-t,e)}}),l[e]=t}return t}(t.length-1),n=0,r=0,s=0;s<t.length;s++)n+=t[s].x*i[s](e),r+=t[s].y*i[s](e);return{x:n,y:r}}function u(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function w(t,e,i){for(var n=h(t,e),r=0,s=e,o=0<i?1:-1,a=null;r<Math.abs(i);)a=h(t,s+=.005*o),r+=u(a,n),n=a;return{point:a,location:s}}function T(t,e){var i=h(t,e),n=h(t.slice(0,t.length-1),e),r=n.y-i.y,s=n.x-i.x;return 0==r?1/0:Math.atan(r/s)}n=r,_=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},x=function(t,e){return t.x*e.x+t.y*e.y},c=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},b=function(t,e){return{x:t.x*e,y:t.y*e}},d=Math.pow(2,-65),f=function(t,e){for(var i=e.length-1,n=2*i-1,r=[],s=[],o=[],a=[],h=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],l=0;l<=i;l++)r[l]=_(e[l],t);for(l=0;l<=i-1;l++)s[l]=_(e[l+1],e[l]),s[l]=b(s[l],3);for(var u=0;u<=i-1;u++)for(var c=0;c<=i;c++)o[u]||(o[u]=[]),o[u][c]=x(s[u],r[c]);for(l=0;l<=n;l++)a[l]||(a[l]=[]),a[l].y=0,a[l].x=parseFloat(l)/n;for(var f=i,d=i-1,m=0;m<=f+d;m++){var p=Math.max(0,m-d),g=Math.min(m,f);for(l=p;l<=g;l++){var v=m-l;a[l+v].y+=o[v][l]*h[v][l]}}return a},m=function t(e,i,n,r){var s,o,a=[],h=[],l=[],u=[];switch(p(e,i)){case 0:return 0;case 1:if(64<=r)return n[0]=(e[0].x+e[i].x)/2,1;if(g(e,i))return n[0]=v(e,i),1}y(e,i,.5,a,h),s=t(a,i,l,r+1),o=t(h,i,u,r+1);for(var c=0;c<s;c++)n[c]=l[c];for(c=0;c<o;c++)n[c+s]=u[c];return s+o},p=function(t,e){var i,n,r=0;i=n=o(t[0].y);for(var s=1;s<=e;s++)(i=o(t[s].y))!=n&&r++,n=i;return r},g=function(t,e){var i,n,r,s,o,a,h;s=t[0].y-t[e].y,o=t[e].x-t[0].x,a=t[0].x*t[e].y-t[e].x*t[0].y;for(var l=0,u=0,c=1;c<e;c++){var f=s*t[c].x+o*t[c].y+a;l<f?l=f:f<u&&(u=f)}return i=(1*(a-l)-0*(h=o))*(1/(0*h-1*s)),n=(1*(a-u)-0*(h=o))*(1/(0*h-1*s)),r=Math.min(i,n),Math.max(i,n)-r<d?1:0},v=function(t,e){var i=t[e].x-t[0].x,n=t[e].y-t[0].y,r=t[0].x-0;return 0+1*((i*(t[0].y-0)-n*r)*(1/(0*i-1*n)))},y=function(t,e,i,n,r){for(var s=[[]],o=0;o<=e;o++)s[0][o]=t[o];for(var a=1;a<=e;a++)for(o=0;o<=e-a;o++)s[a]||(s[a]=[]),s[a][o]||(s[a][o]={}),s[a][o].x=(1-i)*s[a-1][o].x+i*s[a-1][o+1].x,s[a][o].y=(1-i)*s[a-1][o].y+i*s[a-1][o+1].y;if(null!=n)for(o=0;o<=e;o++)n[o]=s[o][0];if(null!=r)for(o=0;o<=e;o++)r[o]=s[e-o][o];return s[e][0]},l={},n.jsBezier={distanceFromCurve:s,gradientAtPoint:T,gradientAtPointAlongCurveFrom:function(t,e,i){var n=w(t,e,i);return 1<n.location&&(n.location=1),n.location<0&&(n.location=0),T(t,n.location)},nearestPointOnCurve:function(t,e){var i=s(t,e);return{point:y(e,e.length-1,i.location,null,null),location:i.location}},pointOnCurve:h,pointAlongCurveFrom:function(t,e,i){return w(t,e,i).point},perpendicularToCurveAt:function(t,e,i,n){var r=w(t,e,n=null==n?0:n),s=T(t,r.location),o=Math.atan(-1/s),a=i/2*Math.sin(o),h=i/2*Math.cos(o);return[{x:r.point.x+h,y:r.point.y+a},{x:r.point.x-h,y:r.point.y-a}]},locationAlongCurveFrom:function(t,e,i){return w(t,e,i).location},getLength:function(t){for(var e=h(t,0),i=0,n=0,r=null;n<1;)r=h(t,n+=.005),i+=u(r,e),e=r;return i}},e.a=r.jsBezier},function(t,e,i){"use strict";var w,T,D,S,n=(w=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),T=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],D=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],S=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],function(t,e){var i=[],n=[],r=0,s=new Float32Array(8),o=new Int32Array(12),a=new Int32Array(3);for(a[2]=0;a[2]<e[2]-1;++a[2],r+=e[0])for(a[1]=0;a[1]<e[1]-1;++a[1],++r)for(a[0]=0;a[0]<e[0]-1;++a[0],++r){for(var h=0,l=0;l<8;++l){var u=D[l],c=t[r+u[0]+e[0]*(u[1]+e[1]*u[2])];h|=0<(s[l]=c)?1<<l:0}var f=w[h];if(0!==f){for(l=0;l<12;++l)if(0!=(f&1<<l)){o[l]=i.length;var d=[0,0,0],m=S[l],p=D[m[0]],g=D[m[1]],v=s[m[0]],_=v-s[m[1]],x=0;1e-6<Math.abs(_)&&(x=v/_);for(var b=0;b<3;++b)d[b]=a[b]+p[b]+x*(g[b]-p[b]);i.push(d)}var y=T[h];for(l=0;l<y.length;l+=3)n.push([o[y[l]],o[y[l+1]],o[y[l+2]]])}}return{vertices:i,faces:n}});e.a=n},function(t,e,i){var n,r,s;r=[i(1)],void 0===(s="function"==typeof(n=function(f){var d,m,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],p=Array.prototype.slice;if(f.event.fixHooks)for(var i=t.length;i;)f.event.fixHooks[t[--i]]=f.event.mouseHooks;var g=f.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],n,!1);else this.onmousewheel=n;f.data(this,"mousewheel-line-height",g.getLineHeight(this)),f.data(this,"mousewheel-page-height",g.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],n,!1);else this.onmousewheel=null;f.removeData(this,"mousewheel-line-height"),f.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var e=f(t),i=e["offsetParent"in f.fn?"offsetParent":"parent"]();return i.length||(i=f("body")),parseInt(i.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(t){return f(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function n(t){var e=t||window.event,i=p.call(arguments,1),n=0,r=0,s=0,o=0,a=0,h=0;if((t=f.event.fix(e)).type="mousewheel","detail"in e&&(s=-1*e.detail),"wheelDelta"in e&&(s=e.wheelDelta),"wheelDeltaY"in e&&(s=e.wheelDeltaY),"wheelDeltaX"in e&&(r=-1*e.wheelDeltaX),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(r=-1*s,s=0),n=0===s?r:s,"deltaY"in e&&(s=-1*e.deltaY,n=s),"deltaX"in e&&(r=e.deltaX,0===s&&(n=-1*r)),0!==s||0!==r){if(1===e.deltaMode){var l=f.data(this,"mousewheel-line-height");n*=l,s*=l,r*=l}else if(2===e.deltaMode){var u=f.data(this,"mousewheel-page-height");n*=u,s*=u,r*=u}if(o=Math.max(Math.abs(s),Math.abs(r)),m&&!(o<m)||_(e,m=o)&&(m/=40),_(e,o)&&(n/=40,r/=40,s/=40),n=Math[1<=n?"floor":"ceil"](n/m),r=Math[1<=r?"floor":"ceil"](r/m),s=Math[1<=s?"floor":"ceil"](s/m),g.settings.normalizeOffset&&this.getBoundingClientRect){var c=this.getBoundingClientRect();a=t.clientX-c.left,h=t.clientY-c.top}return t.deltaX=r,t.deltaY=s,t.deltaFactor=m,t.offsetX=a,t.offsetY=h,t.deltaMode=0,i.unshift(t,n,r,s),d&&clearTimeout(d),d=setTimeout(v,200),(f.event.dispatch||f.event.handle).apply(this,i)}}function v(){m=null}function _(t,e){return g.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}f.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})?n.apply(e,r):n)||(t.exports=s)},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"stringStartsWith",function(){return E}),n.d(r,"vec3AngleFrom",function(){return N}),n.d(r,"contextRoundRect",function(){return d}),n.d(r,"contextEllipse",function(){return m}),n.d(r,"getFontString",function(){return F});var o={};n.r(o),n.d(o,"Bounds",function(){return z}),n.d(o,"angleBetweenLargest",function(){return q}),n.d(o,"isBetween",function(){return W}),n.d(o,"getRGB",function(){return G}),n.d(o,"hsl2rgb",function(){return X}),n.d(o,"idx2color",function(){return V}),n.d(o,"distanceFromPointToLineInclusive",function(){return Y}),n.d(o,"calculateDistanceInterior",function(){return rt}),n.d(o,"intersectLines",function(){return Z}),n.d(o,"clamp",function(){return Q}),n.d(o,"rainbowAt",function(){return $}),n.d(o,"angleBounds",function(){return J}),n.d(o,"isPointInPoly",function(){return K});var a={};n.r(a),n.d(a,"_Canvas",function(){return st}),n.d(a,"FileCanvas",function(){return at}),n.d(a,"HyperlinkCanvas",function(){return ht}),n.d(a,"PeriodicTableCanvas",function(){return ct}),n.d(a,"MolGrabberCanvas",function(){return vt}),n.d(a,"SlideshowCanvas",function(){return Tt}),n.d(a,"TransformCanvas",function(){return Ct}),n.d(a,"ViewerCanvas",function(){return Et}),n.d(a,"_SpectrumCanvas",function(){return Ft}),n.d(a,"ObserverCanvas",function(){return Pt}),n.d(a,"OverlayCanvas",function(){return Bt}),n.d(a,"PerspectiveCanvas",function(){return Lt}),n.d(a,"SeekerCanvas",function(){return Ot}),n.d(a,"_AnimatorCanvas",function(){return yt}),n.d(a,"RotatorCanvas",function(){return Gt}),n.d(a,"_Canvas3D",function(){return Zt}),n.d(a,"MolGrabberCanvas3D",function(){return Jt}),n.d(a,"RotatorCanvas3D",function(){return se}),n.d(a,"TransformCanvas3D",function(){return he}),n.d(a,"ViewerCanvas3D",function(){return le}),n.d(a,"MovieCanvas3D",function(){return ce}),n.d(a,"getVersion",function(){return pe}),n.d(a,"SYMBOLS",function(){return ve}),n.d(a,"ELEMENT",function(){return _e}),n.d(a,"RESIDUE",function(){return ye}),n.d(a,"default_backgroundColor",function(){return Te}),n.d(a,"default_scale",function(){return De}),n.d(a,"default_rotateAngle",function(){return Se}),n.d(a,"default_bondLength_2D",function(){return Ce}),n.d(a,"default_angstromsPerBondLength",function(){return Ae}),n.d(a,"default_lightDirection_3D",function(){return Ee}),n.d(a,"default_lightDiffuseColor_3D",function(){return Fe}),n.d(a,"default_lightSpecularColor_3D",function(){return Re}),n.d(a,"default_projectionPerspective_3D",function(){return Pe}),n.d(a,"default_projectionPerspectiveVerticalFieldOfView_3D",function(){return Be}),n.d(a,"default_projectionOrthoWidth_3D",function(){return Me}),n.d(a,"default_projectionWidthHeightRatio_3D",function(){return Ie}),n.d(a,"default_projectionFrontCulling_3D",function(){return Le}),n.d(a,"default_projectionBackCulling_3D",function(){return Ne}),n.d(a,"default_cullBackFace_3D",function(){return ke}),n.d(a,"default_fog_mode_3D",function(){return Oe}),n.d(a,"default_fog_color_3D",function(){return ze}),n.d(a,"default_fog_start_3D",function(){return Ue}),n.d(a,"default_fog_end_3D",function(){return He}),n.d(a,"default_fog_density_3D",function(){return je}),n.d(a,"default_shadow_3D",function(){return qe}),n.d(a,"default_shadow_intensity_3D",function(){return We}),n.d(a,"default_flat_color_3D",function(){return Ge}),n.d(a,"default_antialias_3D",function(){return Xe}),n.d(a,"default_gammaCorrection_3D",function(){return Ve}),n.d(a,"default_colorHover",function(){return Ye}),n.d(a,"default_colorSelect",function(){return Ze}),n.d(a,"default_colorError",function(){return Qe}),n.d(a,"default_colorPreview",function(){return $e}),n.d(a,"default_ssao_3D",function(){return Je}),n.d(a,"default_ssao_kernel_radius",function(){return Ke}),n.d(a,"default_ssao_kernel_samples",function(){return ti}),n.d(a,"default_ssao_power",function(){return ei}),n.d(a,"default_outline_3D",function(){return ni}),n.d(a,"default_outline_thickness",function(){return ri}),n.d(a,"default_outline_normal_threshold",function(){return si}),n.d(a,"default_outline_depth_threshold",function(){return oi}),n.d(a,"default_fxaa_edgeThreshold",function(){return ai}),n.d(a,"default_fxaa_edgeThresholdMin",function(){return hi}),n.d(a,"default_fxaa_searchSteps",function(){return li}),n.d(a,"default_fxaa_searchThreshold",function(){return ui}),n.d(a,"default_fxaa_subpixCap",function(){return ci}),n.d(a,"default_fxaa_subpixTrim",function(){return fi}),n.d(a,"default_atoms_display",function(){return di}),n.d(a,"default_atoms_color",function(){return mi}),n.d(a,"default_atoms_font_size_2D",function(){return pi}),n.d(a,"default_atoms_font_families_2D",function(){return gi}),n.d(a,"default_atoms_font_bold_2D",function(){return vi}),n.d(a,"default_atoms_font_italic_2D",function(){return _i}),n.d(a,"default_atoms_circles_2D",function(){return xi}),n.d(a,"default_atoms_circleDiameter_2D",function(){return bi}),n.d(a,"default_atoms_circleBorderWidth_2D",function(){return yi}),n.d(a,"default_atoms_lonePairDistance_2D",function(){return wi}),n.d(a,"default_atoms_lonePairSpread_2D",function(){return Ti}),n.d(a,"default_atoms_lonePairDiameter_2D",function(){return Di}),n.d(a,"default_atoms_useJMOLColors",function(){return Si}),n.d(a,"default_atoms_usePYMOLColors",function(){return Ci}),n.d(a,"default_atoms_HBlack_2D",function(){return Ai}),n.d(a,"default_atoms_implicitHydrogens_2D",function(){return Ei}),n.d(a,"default_atoms_displayTerminalCarbonLabels_2D",function(){return Fi}),n.d(a,"default_atoms_showHiddenCarbons_2D",function(){return Ri}),n.d(a,"default_atoms_showAttributedCarbons_2D",function(){return Pi}),n.d(a,"default_atoms_displayAllCarbonLabels_2D",function(){return Bi}),n.d(a,"default_atoms_resolution_3D",function(){return Mi}),n.d(a,"default_atoms_sphereDiameter_3D",function(){return Ii}),n.d(a,"default_atoms_useVDWDiameters_3D",function(){return Li}),n.d(a,"default_atoms_vdwMultiplier_3D",function(){return Ni}),n.d(a,"default_atoms_materialAmbientColor_3D",function(){return ki}),n.d(a,"default_atoms_materialSpecularColor_3D",function(){return Oi}),n.d(a,"default_atoms_materialShininess_3D",function(){return zi}),n.d(a,"default_atoms_nonBondedAsStars_3D",function(){return Ui}),n.d(a,"default_atoms_displayLabels_3D",function(){return Hi}),n.d(a,"default_bonds_display",function(){return ji}),n.d(a,"default_bonds_color",function(){return qi}),n.d(a,"default_bonds_width_2D",function(){return Wi}),n.d(a,"default_bonds_useAbsoluteSaturationWidths_2D",function(){return Gi}),n.d(a,"default_bonds_saturationWidth_2D",function(){return Xi}),n.d(a,"default_bonds_saturationWidthAbs_2D",function(){return Vi}),n.d(a,"default_bonds_ends_2D",function(){return Yi}),n.d(a,"default_bonds_splitColor",function(){return Zi}),n.d(a,"default_bonds_colorGradient",function(){return Qi}),n.d(a,"default_bonds_saturationAngle_2D",function(){return $i}),n.d(a,"default_bonds_symmetrical_2D",function(){return Ji}),n.d(a,"default_bonds_clearOverlaps_2D",function(){return Ki}),n.d(a,"default_bonds_overlapClearWidth_2D",function(){return tn}),n.d(a,"default_bonds_atomLabelBuffer_2D",function(){return en}),n.d(a,"default_bonds_wedgeThickness_2D",function(){return nn}),n.d(a,"default_bonds_wavyLength_2D",function(){return rn}),n.d(a,"default_bonds_hashWidth_2D",function(){return sn}),n.d(a,"default_bonds_hashSpacing_2D",function(){return on}),n.d(a,"default_bonds_dotSize_2D",function(){return an}),n.d(a,"default_bonds_lewisStyle_2D",function(){return hn}),n.d(a,"default_bonds_showBondOrders_3D",function(){return ln}),n.d(a,"default_bonds_resolution_3D",function(){return un}),n.d(a,"default_bonds_renderAsLines_3D",function(){return cn}),n.d(a,"default_bonds_cylinderDiameter_3D",function(){return fn}),n.d(a,"default_bonds_pillLatitudeResolution_3D",function(){return dn}),n.d(a,"default_bonds_pillLongitudeResolution_3D",function(){return mn}),n.d(a,"default_bonds_pillHeight_3D",function(){return pn}),n.d(a,"default_bonds_pillSpacing_3D",function(){return gn}),n.d(a,"default_bonds_pillDiameter_3D",function(){return vn}),n.d(a,"default_bonds_materialAmbientColor_3D",function(){return _n}),n.d(a,"default_bonds_materialSpecularColor_3D",function(){return xn}),n.d(a,"default_bonds_materialShininess_3D",function(){return bn}),n.d(a,"default_proteins_displayRibbon",function(){return yn}),n.d(a,"default_proteins_displayBackbone",function(){return wn}),n.d(a,"default_proteins_backboneThickness",function(){return Tn}),n.d(a,"default_proteins_backboneColor",function(){return Dn}),n.d(a,"default_proteins_ribbonCartoonize",function(){return Sn}),n.d(a,"default_proteins_displayPipePlank",function(){return Cn}),n.d(a,"default_proteins_residueColor",function(){return An}),n.d(a,"default_proteins_primaryColor",function(){return En}),n.d(a,"default_proteins_secondaryColor",function(){return Fn}),n.d(a,"default_proteins_ribbonCartoonHelixPrimaryColor",function(){return Rn}),n.d(a,"default_proteins_ribbonCartoonHelixSecondaryColor",function(){return Pn}),n.d(a,"default_proteins_ribbonCartoonSheetColor",function(){return Bn}),n.d(a,"default_proteins_tubeColor",function(){return Mn}),n.d(a,"default_proteins_tubeResolution_3D",function(){return In}),n.d(a,"default_proteins_ribbonThickness",function(){return Ln}),n.d(a,"default_proteins_tubeThickness",function(){return Nn}),n.d(a,"default_proteins_plankSheetWidth",function(){return kn}),n.d(a,"default_proteins_cylinderHelixDiameter",function(){return On}),n.d(a,"default_proteins_verticalResolution",function(){return zn}),n.d(a,"default_proteins_horizontalResolution",function(){return Un}),n.d(a,"default_proteins_materialAmbientColor_3D",function(){return Hn}),n.d(a,"default_proteins_materialSpecularColor_3D",function(){return jn}),n.d(a,"default_proteins_materialShininess_3D",function(){return qn}),n.d(a,"default_nucleics_display",function(){return Wn}),n.d(a,"default_nucleics_tubeColor",function(){return Gn}),n.d(a,"default_nucleics_baseColor",function(){return Xn}),n.d(a,"default_nucleics_residueColor",function(){return Vn}),n.d(a,"default_nucleics_tubeThickness",function(){return Yn}),n.d(a,"default_nucleics_tubeResolution_3D",function(){return Zn}),n.d(a,"default_nucleics_verticalResolution",function(){return Qn}),n.d(a,"default_nucleics_materialAmbientColor_3D",function(){return $n}),n.d(a,"default_nucleics_materialSpecularColor_3D",function(){return Jn}),n.d(a,"default_nucleics_materialShininess_3D",function(){return Kn}),n.d(a,"default_macro_displayAtoms",function(){return tr}),n.d(a,"default_macro_displayBonds",function(){return er}),n.d(a,"default_macro_atomToLigandDistance",function(){return ir}),n.d(a,"default_macro_showWater",function(){return nr}),n.d(a,"default_macro_colorByChain",function(){return rr}),n.d(a,"default_macro_rainbowColors",function(){return sr}),n.d(a,"default_surfaces_display",function(){return or}),n.d(a,"default_surfaces_alpha",function(){return ar}),n.d(a,"default_surfaces_style",function(){return hr}),n.d(a,"default_surfaces_color",function(){return lr}),n.d(a,"default_surfaces_materialAmbientColor_3D",function(){return ur}),n.d(a,"default_surfaces_materialSpecularColor_3D",function(){return cr}),n.d(a,"default_surfaces_materialShininess_3D",function(){return fr}),n.d(a,"default_plots_color",function(){return dr}),n.d(a,"default_plots_width",function(){return mr}),n.d(a,"default_plots_showIntegration",function(){return pr}),n.d(a,"default_plots_integrationColor",function(){return gr}),n.d(a,"default_plots_integrationLineWidth",function(){return vr}),n.d(a,"default_plots_showGrid",function(){return _r}),n.d(a,"default_plots_gridColor",function(){return xr}),n.d(a,"default_plots_gridLineWidth",function(){return br}),n.d(a,"default_plots_showYAxis",function(){return yr}),n.d(a,"default_plots_flipXAxis",function(){return wr}),n.d(a,"default_text_font_size",function(){return Tr}),n.d(a,"default_text_font_families",function(){return Dr}),n.d(a,"default_text_font_bold",function(){return Sr}),n.d(a,"default_text_font_italic",function(){return Cr}),n.d(a,"default_text_font_stroke_3D",function(){return Ar}),n.d(a,"default_text_color",function(){return Er}),n.d(a,"default_shapes_color",function(){return Fr}),n.d(a,"default_shapes_lineWidth",function(){return Rr}),n.d(a,"default_shapes_pointSize",function(){return Pr}),n.d(a,"default_shapes_arrowLength_2D",function(){return Br}),n.d(a,"default_compass_display",function(){return Mr}),n.d(a,"default_compass_axisXColor_3D",function(){return Ir}),n.d(a,"default_compass_axisYColor_3D",function(){return Lr}),n.d(a,"default_compass_axisZColor_3D",function(){return Nr}),n.d(a,"default_compass_size_3D",function(){return kr}),n.d(a,"default_compass_resolution_3D",function(){return Or}),n.d(a,"default_compass_displayText_3D",function(){return zr}),n.d(a,"default_compass_type_3D",function(){return Ur}),n.d(a,"default_measurement_update_3D",function(){return Hr}),n.d(a,"default_measurement_angleBands_3D",function(){return jr}),n.d(a,"default_measurement_displayText_3D",function(){return qr}),n.d(a,"readJSON",function(){return Gr}),n.d(a,"writeJSON",function(){return Xr});var h={};n.r(h),n.d(h,"_Counter",function(){return hs}),n.d(h,"NumberOfMoleculesCounter",function(){return us}),n.d(h,"FrerejacqueNumberCounter",function(){return cs}),n.d(h,"_RingFinder",function(){return fs}),n.d(h,"EulerFacetRingFinder",function(){return gs}),n.d(h,"SSSRFinder",function(){return _s}),n.d(h,"BondDeducer",function(){return bs}),n.d(h,"getPointsPerAngstrom",function(){return xs}),n.d(h,"HydrogenDeducer",function(){return ws}),n.d(h,"Splitter",function(){return Ts}),n.d(h,"StructureBuilder",function(){return Ds});var l={};n.r(l),n.d(l,"Point",function(){return P}),n.d(l,"Queue",function(){return x}),n.d(l,"Query",function(){return T}),n.d(l,"Ring",function(){return C}),n.d(l,"Atom",function(){return Zr}),n.d(l,"Bond",function(){return Jr}),n.d(l,"Residue",function(){return ns}),n.d(l,"Molecule",function(){return Cs}),n.d(l,"Spectrum",function(){return Fs}),n.d(l,"Plate",function(){return Bs}),n.d(l,"VisualSpecifications",function(){return os}),n.d(l,"d2",function(){return Ls}),n.d(l,"d3",function(){return Co});var u={};n.r(u),n.d(u,"_Interpreter",function(){return Mo}),n.d(u,"JSONInterpreter",function(){return R});var L=n(0),f=Math;function E(t,e){return t.slice(0,e.length)===e}function N(t,e){var i=L.vec3.length(t),n=L.vec3.length(e),r=L.vec3.dot(t,e)/i/n;return f.acos(r)}function d(t,e,i,n,r,s){t.beginPath(),t.moveTo(e+s,i),t.lineTo(e+n-s,i),t.quadraticCurveTo(e+n,i,e+n,i+s),t.lineTo(e+n,i+r-s),t.quadraticCurveTo(e+n,i+r,e+n-s,i+r),t.lineTo(e+s,i+r),t.quadraticCurveTo(e,i+r,e,i+r-s),t.lineTo(e,i+s),t.quadraticCurveTo(e,i,e+s,i),t.closePath()}function m(t,e,i,n,r){var s=n/2*.5522848,o=r/2*.5522848,a=e+n,h=i+r,l=e+n/2,u=i+r/2;t.beginPath(),t.moveTo(e,u),t.bezierCurveTo(e,u-o,l-s,i,l,i),t.bezierCurveTo(l+s,i,a,u-o,a,u),t.bezierCurveTo(a,u+o,l+s,h,l,h),t.bezierCurveTo(l-s,h,e,u+o,e,u),t.closePath()}function F(t,e,i,n){var r=[];i&&r.push("bold "),n&&r.push("italic "),r.push(t+"px ");for(var s=0,o=e.length;s<o;s++){var a=e[s];-1!==a.indexOf(" ")&&(a='"'+a+'"'),r.push((0!==s?",":"")+a)}return r.join("")}var p=Math;function P(t,e){this.x=t||0,this.y=e||0}var g=P.prototype;function x(){this.queue=[]}g.sub=function(t){this.x-=t.x,this.y-=t.y},g.add=function(t){this.x+=t.x,this.y+=t.y},g.distance=function(t){var e=t.x-this.x,i=t.y-this.y;return p.sqrt(e*e+i*i)},g.angleForStupidCanvasArcs=function(t){var e=t.x-this.x,i=t.y-this.y,n=0;for(n=0==e?0==i?0:0<i?p.PI/2:3*p.PI/2:0==i?0<e?0:p.PI:e<0?p.atan(i/e)+p.PI:i<0?p.atan(i/e)+2*p.PI:p.atan(i/e);n<0;)n+=2*p.PI;return n%=2*p.PI},g.angle=function(t){var e=t.x-this.x,i=this.y-t.y,n=0;for(n=0==e?0==i?0:0<i?p.PI/2:3*p.PI/2:0==i?0<e?0:p.PI:e<0?p.atan(i/e)+p.PI:i<0?p.atan(i/e)+2*p.PI:p.atan(i/e);n<0;)n+=2*p.PI;return n%=2*p.PI};var v=x.prototype;v.queueSpace=0,v.getSize=function(){return this.queue.length-this.queueSpace},v.isEmpty=function(){return 0===this.queue.length},v.enqueue=function(t){this.queue.push(t)},v.dequeue=function(){var t;return this.queue.length&&(t=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)),t},v.getOldestElement=function(){var t;return this.queue.length&&(t=this.queue[this.queueSpace]),t};var _={getFontString:F},b=(Math,/[ ,]+/),y=/\-+/,w=["Helvetica","Arial","Dialog"];function T(t){this.type=t,this.elements={v:[],not:!1},this.charge=void 0,this.chirality=void 0,this.connectivity=void 0,this.connectivityNoH=void 0,this.hydrogens=void 0,this.saturation=void 0,this.orders={v:[],not:!1},this.stereo=void 0,this.aromatic=void 0,this.ringCount=void 0,this.cache=void 0}T.TYPE_ATOM=0,T.TYPE_BOND=1;var D=T.prototype;D.parseRange=function(t){for(var e=[],i=t.split(b),n=0,r=i.length;n<r;n++){var s=i[n],o=!1,a=!1;if("-"===s.charAt(0)&&(o=!0,s=s.substring(1)),-1!=s.indexOf("--")&&(a=!0),-1!=s.indexOf("-")){var h=s.split(y),l={x:parseInt(h[0])*(o?-1:1),y:parseInt(h[1])*(a?-1:1)};if(l.y<l.x){var u=l.y;l.y=l.x,l.x=u}e.push(l)}else e.push({x:parseInt(s)*(o?-1:1)})}return e},D.draw=function(t,e,i){this.cache||(this.cache=this.toString());var n=this.cache,r=void 0,s=n.indexOf("(");-1!=s&&(n=this.cache.substring(0,s),r=this.cache.substring(s,this.cache.length)),t.textAlign="center",t.textBaseline="middle",t.font=_.getFontString(12,w,!0,!1);var o=t.measureText(n).width;t.fillStyle=e.backgroundColor,t.fillRect(i.x-o/2,i.y-6,o,12),t.fillStyle="black",t.fillText(n,i.x,i.y),r&&(t.font=_.getFontString(10,w,!1,!0),o=t.measureText(r).width,t.fillStyle=e.backgroundColor,t.fillRect(i.x-o/2,i.y+6,o,11),t.fillStyle="black",t.fillText(r,i.x,i.y+11))},D.outputRange=function(t){for(var e=!1,i=[],n=0,r=t.length;n<r;n++){e&&i.push(","),e=!0;var s=t[n];s.y?(i.push(s.x),i.push("-"),i.push(s.y)):i.push(s.x)}return i.join("")},D.toString=function(){var t=[],e=[];return this.type===T.TYPE_ATOM?(this.elements&&0!==this.elements.v.length?(this.elements.not&&t.push("!"),t.push("["),t.push(this.elements.v.join(",")),t.push("]")):t.push("[a]"),this.chirality&&e.push((this.chirality.not?"!":"")+"@="+this.chirality.v),this.aromatic&&e.push((this.aromatic.not?"!":"")+"A"),this.charge&&e.push((this.charge.not?"!":"")+"C="+this.outputRange(this.charge.v)),this.hydrogens&&e.push((this.hydrogens.not?"!":"")+"H="+this.outputRange(this.hydrogens.v)),this.ringCount&&e.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v)),this.saturation&&e.push((this.saturation.not?"!":"")+"S"),this.connectivity&&e.push((this.connectivity.not?"!":"")+"X="+this.outputRange(this.connectivity.v)),this.connectivityNoH&&e.push((this.connectivityNoH.not?"!":"")+"x="+this.outputRange(this.connectivityNoH.v))):this.type===T.TYPE_BOND&&(this.orders&&0!==this.orders.v.length?(this.orders.not&&t.push("!"),t.push("["),t.push(this.orders.v.join(",")),t.push("]")):t.push("[a]"),this.stereo&&e.push((this.stereo.not?"!":"")+"@="+this.stereo.v),this.aromatic&&e.push((this.aromatic.not?"!":"")+"A"),this.ringCount&&e.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v))),0<e.length&&(t.push("("),t.push(e.join(",")),t.push(")")),t.join("")};var S=Math;function C(){this.atoms=[],this.bonds=[]}var A=C.prototype;function R(){}A.center=void 0,A.setupBonds=function(){for(var t=0,e=this.bonds.length;t<e;t++)this.bonds[t].ring=this;this.center=this.getCenter()},A.getCenter=function(){for(var t=1/0,e=1/0,i=-1/0,n=-1/0,r=0,s=this.atoms.length;r<s;r++)t=S.min(this.atoms[r].x,t),e=S.min(this.atoms[r].y,e),i=S.max(this.atoms[r].x,i),n=S.max(this.atoms[r].y,n);return new P((i+t)/2,(n+e)/2)};var B=R.prototype;B.contentTo=function(t,e){t||(t=[]),e||(e=[]);for(var i=0,n=0,r=0,s=t.length;r<s;r++){for(var o=0,a=(l=t[r]).atoms.length;o<a;o++)l.atoms[o].tmpid="a"+i++;for(o=0,a=l.bonds.length;o<a;o++)l.bonds[o].tmpid="b"+n++}for(r=i=0,s=e.length;r<s;r++)e[r].tmpid="s"+i++;var h={};if(t&&0<t.length){h.m=[];for(r=0,s=t.length;r<s;r++)h.m.push(this.molTo(t[r]))}if(e&&0<e.length){h.s=[];for(r=0,s=e.length;r<s;r++)h.s.push(this.shapeTo(e[r]))}for(r=0,s=t.length;r<s;r++){var l;for(o=0,a=(l=t[r]).atoms.length;o<a;o++)l.atoms[o].tmpid=void 0;for(o=0,a=l.bonds.length;o<a;o++)l.bonds[o].tmpid=void 0}for(r=0,s=e.length;r<s;r++)e[r].tmpid=void 0;return h},B.contentFrom=function(t){var e={molecules:[],shapes:[]};if(t.m)for(var i=0,n=t.m.length;i<n;i++)e.molecules.push(this.molFrom(t.m[i]));if(t.s)for(i=0,n=t.s.length;i<n;i++)e.shapes.push(this.shapeFrom(t.s[i],e.molecules));for(i=0,n=e.molecules.length;i<n;i++){for(var r=e.molecules[i],s=0,o=r.atoms.length;s<o;s++)r.atoms[s].tmpid=void 0;for(s=0,o=r.bonds.length;s<o;s++)r.bonds[s].tmpid=void 0}for(i=0,n=e.shapes.length;i<n;i++)e.shapes[i].tmpid=void 0;return e},B.queryTo=function(r){function t(t,e,i,n){e&&(t[i]={v:n?r.outputRange(e.v):e.v,n:e.not})}var e={};return r.type===T.TYPE_ATOM?(t(e,r.elements,"as"),t(e,r.chirality,"@"),t(e,r.aromatic,"A"),t(e,r.charge,"C",!0),t(e,r.hydrogens,"H",!0),t(e,r.ringCount,"R",!0),t(e,r.saturation,"S"),t(e,r.connectivity,"X",!0),t(e,r.connectivityNoH,"x",!0)):(t(e,r.orders,"bs"),t(e,r.stereo,"@"),t(e,r.aromatic,"A"),t(e,r.ringCount,"R",!0)),e},B.molTo=function(t){for(var e={a:[]},i=0,n=t.atoms.length;i<n;i++){var r=t.atoms[i],s={x:r.x,y:r.y};r.tmpid&&(s.i=r.tmpid),"C"!==r.label&&(s.l=r.label),0!==r.z&&(s.z=r.z),0!==r.charge&&(s.c=r.charge),-1!==r.mass&&(s.m=r.mass),-1!==r.implicitH&&(s.h=r.implicitH),0!==r.numRadical&&(s.r=r.numRadical),0!==r.numLonePair&&(s.p=r.numLonePair),r.query&&(s.q=this.queryTo(r.query)),e.a.push(s)}if(0<t.bonds.length){e.b=[];for(i=0,n=t.bonds.length;i<n;i++){var o=t.bonds[i],a={b:t.atoms.indexOf(o.a1),e:t.atoms.indexOf(o.a2)};o.tmpid&&(a.i=o.tmpid),1!==o.bondOrder&&(a.o=o.bondOrder),o.stereo!==Jr.STEREO_NONE&&(a.s=o.stereo),o.query&&(a.q=this.queryTo(o.query)),e.b.push(a)}}return e},B.queryFrom=function(t){function e(t,e,i,n){e&&(t[i]={},t[i].v=n?t.parseRange(e.v):e.v,e.n&&(t[i].not=!0))}var i=new T(t.as?T.TYPE_ATOM:T.TYPE_BOND);return i.type===T.TYPE_ATOM?(e(i,t.as,"elements"),e(i,t["@"],"chirality"),e(i,t.A,"aromatic"),e(i,t.C,"charge",!0),e(i,t.H,"hydrogens",!0),e(i,t.R,"ringCount",!0),e(i,t.S,"saturation"),e(i,t.X,"connectivity",!0),e(i,t.x,"connectivityNoH",!0)):(e(i,t.bs,"orders"),e(i,t["@"],"stereo"),e(i,t.A,"aromatic"),e(i,t.R,"ringCount",!0)),i},B.molFrom=function(t){for(var e=new Cs,i=0,n=t.a.length;i<n;i++){var r=new Zr((s=t.a[i]).l?s.l:"C",s.x,s.y);s.i&&(r.tmpid=s.i),s.z&&(r.z=s.z),s.c&&(r.charge=s.c),s.m&&(r.mass=s.m),s.h&&(r.implicitH=s.h),s.r&&(r.numRadical=s.r),s.p&&(r.numLonePair=s.p),s.q&&(r.query=this.queryFrom(s.q)),void 0!==s.p_h&&(r.hetatm=s.p_h),void 0!==s.p_w&&(r.isWater=s.p_w),void 0!==s.p_d&&(r.closestDistance=s.p_d),e.atoms.push(r)}if(t.b)for(i=0,n=t.b.length;i<n;i++){var s=t.b[i],o=new Jr(e.atoms[s.b],e.atoms[s.e],void 0===s.o?1:s.o);s.i&&(o.tmpid=s.i),s.s&&(o.stereo=s.s),s.q&&(o.query=this.queryFrom(s.q)),e.bonds.push(o)}return e},B.shapeTo=function(t){var e={};if(t.tmpid&&(e.i=t.tmpid),t instanceof Ls.Line)e.t="Line",e.x1=t.p1.x,e.y1=t.p1.y,e.x2=t.p2.x,e.y2=t.p2.y,e.a=t.arrowType;else if(t instanceof Ls.Pusher)e.t="Pusher",e.o1=t.o1.tmpid,e.o2=t.o2.tmpid,1!==t.numElectron&&(e.e=t.numElectron);else if(t instanceof Ls.AtomMapping)e.t="AtomMapping",e.a1=t.o1.tmpid,e.a2=t.o2.tmpid;else if(t instanceof Ls.Bracket)e.t="Bracket",e.x1=t.p1.x,e.y1=t.p1.y,e.x2=t.p2.x,e.y2=t.p2.y,0!==t.charge&&(e.c=t.charge),0!==t.mult&&(e.m=t.mult),0!==t.repeat&&(e.r=t.repeat);else if(t instanceof Ls.DynamicBracket)e.t="DynamicBracket",e.b1=t.b1.tmpid,e.b2=t.b2.tmpid,e.n1=t.n1,e.n2=t.n2,!0===t.flip&&(e.f=!0);else if(t instanceof Ls.VAP){e.t="VAP",e.x=t.asterisk.x,e.y=t.asterisk.y,1!==t.bondType&&(e.o=t.bondType),t.substituent&&(e.s=t.substituent.tmpid),e.a=[];for(var i=0,n=t.attachments.length;i<n;i++)e.a.push(t.attachments[i].tmpid)}else if(t instanceof Co.Distance)e.t="Distance",e.a1=t.a1.tmpid,e.a2=t.a2.tmpid,t.node&&(e.n=t.node,e.o=t.offset);else if(t instanceof Co.Angle)e.t="Angle",e.a1=t.a1.tmpid,e.a2=t.a2.tmpid,e.a3=t.a3.tmpid;else if(t instanceof Co.Torsion)e.t="Torsion",e.a1=t.a1.tmpid,e.a2=t.a2.tmpid,e.a3=t.a3.tmpid,e.a4=t.a4.tmpid;else if(t instanceof Co._Surface){e.t="Surface",e.a=[];for(i=0,n=t.atoms.length;i<n;i++)e.a.push(t.atoms[i].tmpid);t instanceof Co.VDWSurface||(e.p=t.probeRadius),e.r=t.resolution;var r="vdw";t instanceof Co.SASSurface?r="sas":Co.SESSurface&&t instanceof Co.SESSurface&&(r="ses"),e.f=r}else if(t instanceof Co.UnitCell)for(var s in e.t="UnitCell",t.unitCell)e[s]=t.unitCell[s];return e},B.shapeFrom=function(t,e){var i;if("Line"===t.t)(i=new Ls.Line(new P(t.x1,t.y1),new P(t.x2,t.y2))).arrowType=t.a;else if("Pusher"===t.t){for(var n,r,s=0,o=e.length;s<o;s++){for(var a=0,h=(x=e[s]).atoms.length;a<h;a++){(b=x.atoms[a]).tmpid===t.o1?n=b:b.tmpid===t.o2&&(r=b)}for(a=0,h=x.bonds.length;a<h;a++){(c=x.bonds[a]).tmpid===t.o1?n=c:c.tmpid===t.o2&&(r=c)}}i=new Ls.Pusher(n,r),t.e&&(i.numElectron=t.e)}else if("AtomMapping"===t.t){for(s=0,o=e.length;s<o;s++)for(a=0,h=(x=e[s]).atoms.length;a<h;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2&&(p=b)}i=new Ls.AtomMapping(m,p)}else if("Bracket"===t.t)i=new Ls.Bracket(new P(t.x1,t.y1),new P(t.x2,t.y2)),void 0!==t.c&&(i.charge=t.c),void 0!==t.m&&(i.mult=t.m),void 0!==t.r&&(i.repeat=t.r);else if("DynamicBracket"===t.t){var l,u;for(s=0,o=e.length;s<o;s++)for(a=0,h=(x=e[s]).bonds.length;a<h;a++){var c;(c=x.bonds[a]).tmpid===t.b1?l=c:c.tmpid===t.b2&&(u=c)}(i=new Ls.DynamicBracket(l,u)).n1=t.n1,i.n2=t.n2,t.f&&(i.flip=!0)}else if("VAP"===t.t){i=new Ls.VAP(t.x,t.y),t.o&&(i.bondType=t.o);for(s=0,o=e.length;s<o;s++)for(a=0,h=(x=e[s]).atoms.length;a<h;a++){if((b=x.atoms[a]).tmpid===t.s)i.substituent=b;else for(var f=0,d=t.a.length;f<d;f++)b.tmpid===t.a[f]&&i.attachments.push(b)}}else if("Distance"===t.t){for(s=0,o=e.length;s<o;s++)for(a=0,h=(x=e[s]).atoms.length;a<h;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2&&(p=b)}i=new Co.Distance(m,p,t.n,t.o)}else if("Angle"===t.t){for(s=0,o=e.length;s<o;s++)for(a=0,h=(x=e[s]).atoms.length;a<h;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2?p=b:b.tmpid===t.a3&&(g=b)}i=new Co.Angle(m,p,g)}else if("Torsion"===t.t){var m,p,g,v;for(s=0,o=e.length;s<o;s++)for(a=0,h=(x=e[s]).atoms.length;a<h;a++){(b=x.atoms[a]).tmpid===t.a1?m=b:b.tmpid===t.a2?p=b:b.tmpid===t.a3?g=b:b.tmpid===t.a4&&(v=b)}i=new Co.Torsion(m,p,g,v)}else if("Surface"===t.t){var _=[];for(s=0,o=e.length;s<o;s++){var x;for(a=0,h=(x=e[s]).atoms.length;a<h;a++){var b=x.atoms[a];for(f=0,d=t.a.length;f<d;f++)b.tmpid===t.a[f]&&_.push(b)}}var y=t.p?t.p:1.4,w=t.r?t.r:30;"vdw"===t.f?i=new Co.VDWSurface(_,w):"sas"===t.f?i=new Co.SASSurface(_,y,w):"ses"===t.f&&(i=new Co.SESSurface(_,y,w))}else if("UnitCell"===t.t){var T={};for(var D in t)T[D]=t[D];i=new Co.UnitCell(T)}return i},B.pdbFrom=function(t){var e=this.molFrom(t.mol);return e.findRings=!1,e.fromJSON=!0,e.chains=this.chainsFrom(t.ribbons),e},B.chainsFrom=function(t){for(var e=[],i=0,n=t.cs.length;i<n;i++){for(var r=t.cs[i],s=[],o=0,a=r.length;o<a;o++){var h=r[o],l=new ns;l.name=h.n,l.cp1=new Zr("",h.x1,h.y1,h.z1),l.cp2=new Zr("",h.x2,h.y2,h.z2),h.x3&&(l.cp3=new Zr("",h.x3,h.y3,h.z3),l.cp4=new Zr("",h.x4,h.y4,h.z4),l.cp5=new Zr("",h.x5,h.y5,h.z5)),l.helix=h.h,l.sheet=h.s,l.arrow=0<o&&r[o-1].a,s.push(l)}e.push(s)}return e};var M={},I=M,k=M;k.supports_canvas=function(){return!!document.createElement("canvas").getContext},k.supports_canvas_text=function(){return!!k.supports_canvas()&&"function"==typeof document.createElement("canvas").getContext("2d").fillText},k.supports_webgl=function(){var t=document.createElement("canvas");try{if(t.getContext("webgl"))return!0;if(t.getContext("experimental-webgl"))return!0}catch(t){}return!1},k.supports_xhr2=function(){return L.jQuery.support.cors},k.supports_touch=function(){return"ontouchstart"in window&&!!navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i)},k.supports_gesture=function(){return"ongesturestart"in window};var O=Math;function z(){}var U=z.prototype;U.minX=U.minY=U.minZ=1/0,U.maxX=U.maxY=U.maxZ=-1/0,U.expand=function(t,e,i,n){t instanceof z?(this.minX=O.min(this.minX,t.minX),this.minY=O.min(this.minY,t.minY),this.maxX=O.max(this.maxX,t.maxX),this.maxY=O.max(this.maxY,t.maxY),t.maxZ!==1/0&&(this.minZ=O.min(this.minZ,t.minZ),this.maxZ=O.max(this.maxZ,t.maxZ))):(this.minX=O.min(this.minX,t),this.maxX=O.max(this.maxX,t),this.minY=O.min(this.minY,e),this.maxY=O.max(this.maxY,e),void 0!==i&&void 0!==n&&(this.minX=O.min(this.minX,i),this.maxX=O.max(this.maxX,i),this.minY=O.min(this.minY,n),this.maxY=O.max(this.maxY,n)))},U.expand3D=function(t,e,i,n,r,s){this.minX=O.min(this.minX,t),this.maxX=O.max(this.maxX,t),this.minY=O.min(this.minY,e),this.maxY=O.max(this.maxY,e),this.minZ=O.min(this.minZ,i),this.maxZ=O.max(this.maxZ,i),void 0!==n&&void 0!==r&&void 0!==s&&(this.minX=O.min(this.minX,n),this.maxX=O.max(this.maxX,n),this.minY=O.min(this.minY,r),this.maxY=O.max(this.maxY,r),this.minZ=O.min(this.minZ,s),this.maxZ=O.max(this.maxZ,s))};var H=Math,j={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function q(t){if(0===t.length)return{angle:0,largest:2*H.PI};if(1===t.length)return{angle:t[0]+H.PI,largest:2*H.PI};for(var e=0,i=0,n=0,r=t.length-1;n<r;n++){var s=t[n+1]-t[n];e<s&&(e=s,i=(t[n+1]+t[n])/2)}var o=t[0]+2*H.PI-t[t.length-1];return e<o&&(e=o,(i=t[0]-o/2)<0&&(i+=2*H.PI)),{angle:i,largest:e}}function W(t,e,i){if(i<e){var n=e;e=i,i=n}return e<=t&&t<=i}function G(t,e){var i=[0,0,0];if(j[t.toLowerCase()]&&(t=j[t.toLowerCase()]),"#"===t.charAt(0))return 4===t.length&&(t="#"+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3)),[parseInt(t.substring(1,3),16)/255*e,parseInt(t.substring(3,5),16)/255*e,parseInt(t.substring(5,7),16)/255*e];if(E(t,"rgb")){var n=t.replace(/rgb\(|\)/g,"").split(",");return 3!==n.length?i:[parseInt(n[0])/255*e,parseInt(n[1])/255*e,parseInt(n[2])/255*e]}return i}function X(t,e,i){function n(t,e,i){return i<0?i+=1:1<i&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var r,s,o;if(0===e)r=s=o=i;else{var a=i<.5?i*(1+e):i+e-i*e,h=2*i-a;r=n(h,a,t+1/3),s=n(h,a,t),o=n(h,a,t-1/3)}return[255*r,255*s,255*o]}function V(t){for(var e=t.toString(16),i=0,n=6-e.length;i<n;i++)e="0"+e;return"#"+e}function Y(t,e,i,n){var r=e.distance(i),s=e.angle(i),o=H.PI/2-s,a=e.angle(t)+o,h=e.distance(t),l=new P(h*H.cos(a),-h*H.sin(a)),u=n||0;return W(-l.y,u,r-u)?H.abs(l.x):-1}function rt(t,e,i){if(W(e.x,i.x,i.x+i.w)&&W(e.y,i.y,i.y+i.h))return t.distance(e);var n=[];n.push({x1:i.x,y1:i.y,x2:i.x+i.w,y2:i.y}),n.push({x1:i.x,y1:i.y+i.h,x2:i.x+i.w,y2:i.y+i.h}),n.push({x1:i.x,y1:i.y,x2:i.x,y2:i.y+i.h}),n.push({x1:i.x+i.w,y1:i.y,x2:i.x+i.w,y2:i.y+i.h});for(var r=[],s=0;s<4;s++){var o=n[s];(l=Z(e.x,e.y,t.x,t.y,o.x1,o.y1,o.x2,o.y2))&&r.push(l)}if(0===r.length)return 0;for(var a=0,h=(s=0,r.length);s<h;s++){var l=r[s],u=t.x-l.x,c=t.y-l.y;a=H.max(a,H.sqrt(u*u+c*c))}return a}function Z(t,e,i,n,r,s,o,a){var h=(n-=e)*(o-=r)-(i-=t)*(a-=s);if(0==h)return!1;var l=(a*(t-r)-o*(e-s))/h,u=(n*(t-r)-i*(e-s))/h;return 0<=u&&u<=1&&0<=l&&l<=1&&{x:t+l*i,y:e+l*n}}function Q(t,e,i){return t<e?e:i<t?i:t}function $(t,e,i){i.length<1?i.push("#000000","#FFFFFF"):i.length<2&&i.push("#FFFFFF");var n=e/(i.length-1),r=H.floor(t/n),s=(t-r*n)/n,o=G(i[r],1),a=G(i[r+1],1);return"rgb("+[255*(o[0]+(a[0]-o[0])*s),255*(o[1]+(a[1]-o[1])*s),255*(o[2]+(a[2]-o[2])*s)].join(",")+")"}function J(t,e,i){for(var n=2*H.PI;t<0;)t+=n;for(;n<t;)t-=n;return i&&t>H.PI&&(t=2*H.PI-t),e&&(t=180*t/H.PI),t}function K(t,e){for(var i=!1,n=-1,r=t.length,s=r-1;++n<r;s=n)(t[n].y<=e.y&&e.y<t[s].y||t[s].y<=e.y&&e.y<t[n].y)&&e.x<(t[s].x-t[n].x)*(e.y-t[n].y)/(t[s].y-t[n].y)+t[n].x&&(i=!i);return i}Object(L.jQuery)(document).ready(function(){void 0});var tt={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};I.supports_touch()||Object(L.jQuery)(document).ready(function(){Object(L.jQuery)(document).mousemove(function(t){!tt.CANVAS_DRAGGING||tt.CANVAS_DRAGGING.drag&&(tt.CANVAS_DRAGGING.prehandleEvent(t),tt.CANVAS_DRAGGING.drag(t))}),Object(L.jQuery)(document).mouseup(function(t){!tt.CANVAS_DRAGGING||tt.CANVAS_DRAGGING===tt.CANVAS_OVER||tt.CANVAS_DRAGGING.mouseup&&(tt.CANVAS_DRAGGING.prehandleEvent(t),tt.CANVAS_DRAGGING.mouseup(t)),tt.CANVAS_DRAGGING=void 0}),Object(L.jQuery)(document).keydown(function(t){tt.SHIFT=t.shiftKey,tt.ALT=t.altKey,tt.META=t.metaKey||t.ctrlKey;var e=tt.CANVAS_OVER;tt.CANVAS_DRAGGING&&(e=tt.CANVAS_DRAGGING),!e||e.keydown&&(e.prehandleEvent(t),e.keydown(t))}),Object(L.jQuery)(document).keypress(function(t){var e=tt.CANVAS_OVER;tt.CANVAS_DRAGGING&&(e=tt.CANVAS_DRAGGING),!e||e.keypress&&(e.prehandleEvent(t),e.keypress(t))}),Object(L.jQuery)(document).keyup(function(t){tt.SHIFT=t.shiftKey,tt.ALT=t.altKey,tt.META=t.metaKey||t.ctrlKey;var e=tt.CANVAS_OVER;tt.CANVAS_DRAGGING&&(e=tt.CANVAS_DRAGGING),!e||e.keyup&&(e.prehandleEvent(t),e.keyup(t))})});var et=tt,it=Math,nt=navigator.userAgent;function st(){}var ot=st.prototype;function at(t,e,i,n){t&&this.create(t,e,i);var r='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+n+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+t+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+t+"', "+t+')"></iframe>';document.writeln(r),this.emptyMessage="Click below to load file",this.repaint()}function ht(t,e,i,n,r,s){t&&this.create(t,e,i),this.urlOrFunction=n,this.color=r||"blue",this.size=s||2}ot.molecules=void 0,ot.shapes=void 0,ot.emptyMessage=void 0,ot.image=void 0,ot.repaint=function(){if(!this.test){var t=document.getElementById(this.id);if(t.getContext){var e=t.getContext("2d");if(1!==this.pixelRatio&&t.width===this.width&&(t.width=this.width*this.pixelRatio,t.height=this.height*this.pixelRatio,e.scale(this.pixelRatio,this.pixelRatio)),this.image?e.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==t.style.backgroundColor&&(t.style.backgroundColor=this.specs.backgroundColor,this.bgCache=t.style.backgroundColor),e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.innerRepaint)this.innerRepaint(e);else if(0!==this.molecules.length||0!==this.shapes.length){e.save(),e.translate(this.width/2,this.height/2),e.rotate(this.specs.rotateAngle),e.scale(this.specs.scale,this.specs.scale),e.translate(-this.width/2,-this.height/2);for(var i=0,n=this.molecules.length;i<n;i++)this.molecules[i].check(!0),this.molecules[i].draw(e,this.specs);this.checksOnAction&&this.checksOnAction(!0);for(i=0,n=this.shapes.length;i<n;i++)this.shapes[i].draw(e,this.specs);e.restore()}else this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(e,this.specs)}}},ot.resize=function(t,e){var i=Object(L.jQuery)("#"+this.id);if(i.attr({width:t,height:e}),i.css("width",t),i.css("height",e),this.width=t,this.height=e,this instanceof Zt){var n=t,r=e;1!==this.pixelRatio&&(n*=this.pixelRatio,r*=this.pixelRatio,this.gl.canvas.width=n,this.gl.canvas.height=r),this.gl.viewport(0,0,n,r),this.afterLoadContent()}else if(0<this.molecules.length){this.center();for(var s=0,o=this.molecules.length;s<o;s++)this.molecules[s].check()}this.repaint()},ot.setBackgroundImage=function(t){this.image=new Image;var e=this;this.image.onload=function(){e.repaint()},this.image.src=t},ot.loadMolecule=function(t){this.clear(),this.molecules.push(t);for(var e=0;e<2;e++)this.center(),this instanceof Zt||t.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()},ot.loadContent=function(t,e){this.molecules=t||[],this.shapes=e||[];for(var i=0;i<2;i++){if(this.center(),!(this instanceof Zt)){i=0;for(var n=this.molecules.length;i<n;i++)this.molecules[i].check()}this.afterLoadContent&&this.afterLoadContent(),this.repaint()}},ot.addMolecule=function(t){this.molecules.push(t),this instanceof Zt||t.check(),this.repaint()},ot.removeMolecule=function(e){this.molecules=L.jQuery.grep(this.molecules,function(t){return t!==e}),this.repaint()},ot.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0},ot.getMolecules=function(){return this.molecules},ot.addShape=function(t){this.shapes.push(t),this.repaint()},ot.removeShape=function(e){this.shapes=L.jQuery.grep(this.shapes,function(t){return t!==e}),this.repaint()},ot.getShapes=function(){return this.shapes},ot.clear=function(){this.molecules=[],this.shapes=[],this.specs.scale=1,this.repaint()},ot.center=function(){for(var t=this.getContentBounds(),e=new P((this.width-t.minX-t.maxX)/2,(this.height-t.minY-t.maxY)/2),i=0,n=this.molecules.length;i<n;i++)for(var r=this.molecules[i],s=0,o=r.atoms.length;s<o;s++)r.atoms[s].add(e);for(i=0,n=this.shapes.length;i<n;i++){var a=this.shapes[i].getPoints();for(s=0,o=a.length;s<o;s++)a[s].add(e)}this.specs.scale=1;var h=t.maxX-t.minX,l=t.maxY-t.minY;(h>this.width-20||l>this.height-20)&&(this.specs.scale=.85*it.min(this.width/h,this.height/l))},ot.bondExists=function(t,e){for(var i=0,n=this.molecules.length;i<n;i++)for(var r=this.molecules[i],s=0,o=r.bonds.length;s<o;s++){var a=r.bonds[s];if(a.contains(t)&&a.contains(e))return!0}return!1},ot.getBond=function(t,e){for(var i=0,n=this.molecules.length;i<n;i++)for(var r=this.molecules[i],s=0,o=r.bonds.length;s<o;s++){var a=r.bonds[s];if(a.contains(t)&&a.contains(e))return a}},ot.getMoleculeByAtom=function(t){for(var e=0,i=this.molecules.length;e<i;e++){var n=this.molecules[e];if(-1!==n.atoms.indexOf(t))return n}},ot.getAllAtoms=function(){for(var t=[],e=0,i=this.molecules.length;e<i;e++)t=t.concat(this.molecules[e].atoms);return t},ot.getAllBonds=function(){for(var t=[],e=0,i=this.molecules.length;e<i;e++)t=t.concat(this.molecules[e].bonds);return t},ot.getAllPoints=function(){for(var t=[],e=0,i=this.molecules.length;e<i;e++)t=t.concat(this.molecules[e].atoms);for(e=0,i=this.shapes.length;e<i;e++)t=t.concat(this.shapes[e].getPoints());return t},ot.getContentBounds=function(){for(var t=new z,e=0,i=this.molecules.length;e<i;e++)t.expand(this.molecules[e].getBounds());for(e=0,i=this.shapes.length;e<i;e++)t.expand(this.shapes[e].getBounds());return t},ot.create=function(t,e,i){if(this.id=t,this.width=e,this.height=i,this.molecules=[],this.shapes=[],document.getElementById(t)){var n=Object(L.jQuery)("#"+t);e?n.attr("width",e):this.width=n.attr("width"),i?n.attr("height",i):this.height=n.attr("height"),n.attr("class","ChemDoodleWebComponent")}else{if(!I.supports_canvas_text()&&-1!=nt.indexOf("MSIE"))return void document.writeln('<div style="border: 1px solid black;" width="'+e+'" height="'+i+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');document.writeln('<canvas class="ChemDoodleWebComponent" id="'+t+'" width="'+e+'" height="'+i+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}var r=Object(L.jQuery)("#"+t);r.css("width",this.width),r.css("height",this.height),this.pixelRatio=window.devicePixelRatio?window.devicePixelRatio:1,this.specs=new os;var l=this;I.supports_touch()?(r.bind("touchstart",function(t){var e=(new Date).getTime();if(!I.supports_gesture()&&2===t.originalEvent.touches.length){var i=t.originalEvent.touches,n=new P(i[0].pageX,i[0].pageY),r=new P(i[1].pageX,i[1].pageY);l.implementedGestureDist=n.distance(r),l.implementedGestureAngle=n.angle(r),l.gesturestart&&(l.prehandleEvent(t),l.gesturestart(t))}l.lastTouch&&1===t.originalEvent.touches.length&&e-l.lastTouch<500?l.dbltap?(l.prehandleEvent(t),l.dbltap(t)):l.dblclick?(l.prehandleEvent(t),l.dblclick(t)):l.touchstart?(l.prehandleEvent(t),l.touchstart(t)):l.mousedown&&(l.prehandleEvent(t),l.mousedown(t)):l.touchstart?(l.prehandleEvent(t),l.touchstart(t),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){l.touchhold(t)},1e3))):l.mousedown&&(l.prehandleEvent(t),l.mousedown(t)),l.lastTouch=e}),r.bind("touchmove",function(t){if(this.hold&&(clearTimeout(this.hold),this.hold=void 0),!I.supports_gesture()&&2===t.originalEvent.touches.length&&l.gesturechange){var e=t.originalEvent.touches,i=new P(e[0].pageX,e[0].pageY),n=new P(e[1].pageX,e[1].pageY),r=i.distance(n),s=i.angle(n);t.originalEvent.scale=r/l.implementedGestureDist,t.originalEvent.rotation=180*(l.implementedGestureAngle-s)/it.PI,l.prehandleEvent(t),l.gesturechange(t)}if(1<t.originalEvent.touches.length&&l.multitouchmove){var o=t.originalEvent.touches.length;l.prehandleEvent(t);for(var a=new P(-t.offset.left*o,-t.offset.top*o),h=0;h<o;h++)a.x+=t.originalEvent.changedTouches[h].pageX,a.y+=t.originalEvent.changedTouches[h].pageY;a.x/=o,a.y/=o,t.p=a,l.multitouchmove(t,o)}else l.touchmove?(l.prehandleEvent(t),l.touchmove(t)):l.drag&&(l.prehandleEvent(t),l.drag(t))}),r.bind("touchend",function(t){this.hold&&(clearTimeout(this.hold),this.hold=void 0),!I.supports_gesture()&&l.implementedGestureDist&&(l.implementedGestureDist=void 0,l.implementedGestureAngle=void 0,l.gestureend&&(l.prehandleEvent(t),l.gestureend(t))),l.touchend?(l.prehandleEvent(t),l.touchend(t)):l.mouseup&&(l.prehandleEvent(t),l.mouseup(t)),(new Date).getTime()-l.lastTouch<250&&(l.tap?(l.prehandleEvent(t),l.tap(t)):l.click&&(l.prehandleEvent(t),l.click(t)))}),r.bind("gesturestart",function(t){l.gesturestart&&(l.prehandleEvent(t),l.gesturestart(t))}),r.bind("gesturechange",function(t){l.gesturechange&&(l.prehandleEvent(t),l.gesturechange(t))}),r.bind("gestureend",function(t){l.gestureend&&(l.prehandleEvent(t),l.gestureend(t))})):(r.click(function(t){switch(t.which){case 1:l.click&&(l.prehandleEvent(t),l.click(t));break;case 2:l.middleclick&&(l.prehandleEvent(t),l.middleclick(t));break;case 3:l.rightclick&&(l.prehandleEvent(t),l.rightclick(t))}}),r.dblclick(function(t){l.dblclick&&(l.prehandleEvent(t),l.dblclick(t))}),r.mousedown(function(t){switch(t.which){case 1:(et.CANVAS_DRAGGING=l).mousedown&&(l.prehandleEvent(t),l.mousedown(t));break;case 2:l.middlemousedown&&(l.prehandleEvent(t),l.middlemousedown(t));break;case 3:l.rightmousedown&&(l.prehandleEvent(t),l.rightmousedown(t))}}),r.mousemove(function(t){!et.CANVAS_DRAGGING&&l.mousemove&&(l.prehandleEvent(t),l.mousemove(t))}),r.mouseout(function(t){et.CANVAS_OVER=void 0,l.mouseout&&(l.prehandleEvent(t),l.mouseout(t))}),r.mouseover(function(t){(et.CANVAS_OVER=l).mouseover&&(l.prehandleEvent(t),l.mouseover(t))}),r.mouseup(function(t){switch(t.which){case 1:l.mouseup&&(l.prehandleEvent(t),l.mouseup(t));break;case 2:l.middlemouseup&&(l.prehandleEvent(t),l.middlemouseup(t));break;case 3:l.rightmouseup&&(l.prehandleEvent(t),l.rightmouseup(t))}}),r.mousewheel(function(t,e){l.mousewheel&&(l.prehandleEvent(t),l.mousewheel(t,e))})),this.subCreate&&this.subCreate()},ot.prehandleEvent=function(t){t.originalEvent.changedTouches&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY),this.doEventDefault||(t.preventDefault(),t.returnValue=!1),t.offset=Object(L.jQuery)("#"+this.id).offset(),t.p=new P(t.pageX-t.offset.left,t.pageY-t.offset.top)},at.prototype=new st;var lt=ht.prototype=new st;function ut(t,e,i,n){this.element=t,this.x=e,this.y=i,this.dimension=n,this.allowMultipleSelections=!1}function ct(t,e){this.padding=5,t&&this.create(t,18*e+2*this.padding,10*e+2*this.padding),this.cellDimension=e||20,this.setupTable(),this.repaint()}lt.openInNewWindow=!0,lt.hoverImage=void 0,lt.drawChildExtras=function(t){this.e&&(this.hoverImage?t.drawImage(this.hoverImage,0,0):(t.strokeStyle=this.color,t.lineWidth=2*this.size,t.strokeRect(0,0,this.width,this.height)))},lt.setHoverImage=function(t){this.hoverImage=new Image,this.hoverImage.src=t},lt.click=function(t){this.e=void 0,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},lt.mouseout=function(t){this.e=void 0,this.repaint()},lt.mouseover=function(t){this.e=t,this.repaint()};var ft=ct.prototype=new st;ft.loadMolecule=void 0,ft.getMolecule=void 0,ft.getHoveredElement=function(){if(this.hovered)return this.hovered.element},ft.innerRepaint=function(t){for(var e=0,i=this.cells.length;e<i;e++)this.drawCell(t,this.specs,this.cells[e]);this.hovered&&this.drawCell(t,this.specs,this.hovered),this.selected&&this.drawCell(t,this.specs,this.selected)},ft.setupTable=function(){this.cells=[];for(var t=this.padding,e=this.padding,i=0,n=0,r=ve.length;n<r;n++){18===i&&(i=0,e+=this.cellDimension,t=this.padding),2===(s=_e[ve[n]]).atomicNumber?(t+=16*this.cellDimension,i+=16):5!==s.atomicNumber&&13!==s.atomicNumber||(t+=10*this.cellDimension,i+=10),(s.atomicNumber<58||71<s.atomicNumber&&s.atomicNumber<90||103<s.atomicNumber)&&s.atomicNumber<=118&&(this.cells.push(new ut(s,t,e,this.cellDimension)),t+=this.cellDimension,i++)}e+=2*this.cellDimension,t=3*this.cellDimension+this.padding;for(n=57;n<104;n++){var s;90===(s=_e[ve[n]]).atomicNumber&&(e+=this.cellDimension,t=3*this.cellDimension+this.padding),(58<=s.atomicNumber&&s.atomicNumber<=71||90<=s.atomicNumber&&s.atomicNumber<=103)&&(this.cells.push(new ut(s,t,e,this.cellDimension)),t+=this.cellDimension)}},ft.drawCell=function(t,e,i){var n=t.createRadialGradient(i.x+i.dimension/3,i.y+i.dimension/3,1.5*i.dimension,i.x+i.dimension/3,i.y+i.dimension/3,i.dimension/10);n.addColorStop(0,"#000000"),n.addColorStop(.7,i.element.jmolColor),n.addColorStop(1,"#FFFFFF"),t.fillStyle=n,d(t,i.x,i.y,i.dimension,i.dimension,i.dimension/8),i!==this.hovered&&i!==this.selected&&!i.selected||(t.lineWidth=2,t.strokeStyle="#c10000",t.stroke(),t.fillStyle="white"),t.fill(),t.font=F(e.text_font_size,e.text_font_families),t.fillStyle=e.text_color,t.textAlign="center",t.textBaseline="middle",t.fillText(i.element.symbol,i.x+i.dimension/2,i.y+i.dimension/2)},ft.click=function(t){this.hovered&&(this.allowMultipleSelections?this.hovered.selected=!this.hovered.selected:this.selected=this.hovered,this.repaint())},ft.touchstart=function(t){this.mousemove(t)},ft.mousemove=function(t){var e=t.p.x,i=t.p.y;this.hovered=void 0;for(var n=0,r=this.cells.length;n<r;n++){var s=this.cells[n];if(W(e,s.x,s.x+s.dimension)&&W(i,s.y,s.y+s.dimension)){this.hovered=s;break}}this.repaint()},ft.mouseout=function(t){this.hovered=void 0,this.repaint()};var dt={},mt=dt;dt.SERVER_URL="https://ichemlabs.cloud.chemdoodle.com/icl_cdc_v070001/WebHQ",dt.inRelay=!1,dt.asynchronous=!0,dt.INFO={userAgent:navigator.userAgent,v_cwc:pe(),v_jQuery:L.jQuery.fn.jquery,v_jQuery_ui:L.jQuery.ui?L.jQuery.ui.version:"N/A"};var pt=new R,gt=new x;function vt(t,e,i){t&&this.create(t,e,i);var n=[];n.push('<br><input type="text" id="'),n.push(t),n.push('_query" size="32" value="" />'),n.push(this.getInputFields()),document.getElementById(t),Object(L.jQuery)("#"+t).after(n.join(""));var r=this;Object(L.jQuery)("#"+t+"_submit").click(function(){r.search()}),Object(L.jQuery)("#"+t+"_query").keypress(function(t){13===t.which&&r.search()}),this.emptyMessage="Enter search term below",this.repaint()}dt._contactServer=function(r,t,e,n,s){this.inRelay?gt.enqueue({call:r,content:t,options:e,callback:n,errorback:s}):(dt.inRelay=!0,L.jQuery.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:r,content:t,options:e,info:dt.INFO}),url:this.SERVER_URL,success:function(t){var e=JSON.parse(t);if(e.message&&alert(e.message),dt.inRelay=!1,n&&e.content&&!e.stop&&n(e.content),e.stop&&s&&s(),!gt.isEmpty()){var i=gt.dequeue();dt._contactServer(i.call,i.content,i.options,i.callback,i.errorback)}},error:function(t,e,i){if("checkForUpdates"!=r&&alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support."),dt.inRelay=!1,s&&s(),!gt.isEmpty()){var n=gt.dequeue();dt._contactServer(n.call,n.content,n.options,n.callback,n.errorback)}},xhrFields:{withCredentials:!0},async:dt.asynchronous}))},dt.authenticate=function(t,e,i,n){this._contactServer("authenticate",{credential:t},e,function(t){i(t)},n)},dt.calculate=function(t,e,i,n){this._contactServer("calculate",{mol:pt.molTo(t)},e,function(t){i(t)},n)},dt.createLewisDotStructure=function(t,e,i,n){this._contactServer("createLewisDot",{mol:pt.molTo(t)},e,function(t){i(pt.molFrom(t.mol))},n)},dt.generateImage=function(t,e,i,n){this._contactServer("generateImage",{mol:pt.molTo(t)},e,function(t){i(t.link)},n)},dt.generateIUPACName=function(t,e,i,n){this._contactServer("generateIUPACName",{mol:pt.molTo(t)},e,function(t){i(t.iupac)},n)},dt.getAd=function(e,t){this._contactServer("getAd",{},{},function(t){e(t.image_url,t.target_url)},t)},dt.getMoleculeFromContent=function(t,e,r,i){this._contactServer("getMoleculeFromContent",{content:t},e,function(t){for(var e=!1,i=0,n=t.mol.a.length;i<n;i++)if(0!==t.mol.a[i].z){e=!0;break}if(e)for(i=0,n=t.mol.a.length;i<n;i++)t.mol.a[i].x/=20,t.mol.a[i].y/=20,t.mol.a[i].z/=20;r(pt.molFrom(t.mol))},i)},dt.getMoleculeFromDatabase=function(t,n,r,e){this._contactServer("getMoleculeFromDatabase",{query:t},n,function(t){if(3===n.dimension)for(var e=0,i=t.mol.a.length;e<i;e++)t.mol.a[e].x/=20,t.mol.a[e].y/=-20,t.mol.a[e].z/=20;r(pt.molFrom(t.mol))},e)},dt.getOptimizedPDBStructure=function(t,e,i,n){this._contactServer("getOptimizedPDBStructure",{id:t},e,function(t){var e;(e=t.mol?pt.molFrom(t.mol):new Cs).chains=pt.chainsFrom(t.ribbons),e.fromJSON=!0,i(e)},n)},dt.getZeoliteFromIZA=function(t,e,i,n){this._contactServer("getZeoliteFromIZA",{query:t},e,function(t){i(ChemDoodle.readCIF(t.cif,e.xSuper,e.ySuper,e.zSuper))},n)},dt.isGraphIsomorphism=function(t,e,i,n,r){this._contactServer("isGraphIsomorphism",{arrow:pt.molTo(t),target:pt.molTo(e)},i,function(t){n(t.value)},r)},dt.isSubgraphIsomorphism=function(t,e,i,n,r){this._contactServer("isSubgraphIsomorphism",{arrow:pt.molTo(t),target:pt.molTo(e)},i,function(t){n(t.value)},r)},dt.isSupergraphIsomorphism=function(t,e,i,n,r){this._contactServer("isSupergraphIsomorphism",{arrow:pt.molTo(t),target:pt.molTo(e)},i,function(t){n(t.value)},r)},dt.getSimilarityMeasure=function(t,e,i,n,r){this._contactServer("getSimilarityMeasure",{first:pt.molTo(t),second:pt.molTo(e)},i,function(t){n(t.value)},r)},dt.kekulize=function(t,e,i,n){this._contactServer("kekulize",{mol:pt.molTo(t)},e,function(t){i(pt.molFrom(t.mol))},n)},dt.mechanismMatch=function(t,e,i,n,r){this._contactServer("matchMechanism",{arrow:t,targets:e},i,function(t){n(t)},r)},dt.optimize=function(r,s,o,t){this._contactServer("optimize",{mol:pt.molTo(r)},s,function(t){var e=pt.molFrom(t.mol);if(2===s.dimension){for(var i=0,n=e.atoms.length;i<n;i++)r.atoms[i].x=e.atoms[i].x,r.atoms[i].y=e.atoms[i].y;o()}else if(3===s.dimension){for(i=0,n=e.atoms.length;i<n;i++)e.atoms[i].x/=20,e.atoms[i].y/=-20,e.atoms[i].z/=20;o(e)}},t)},dt.readIUPACName=function(t,e,i,n){this._contactServer("readIUPACName",{iupac:t},e,function(t){i(pt.molFrom(t.mol))},n)},dt.readSMILES=function(t,e,i,n){this._contactServer("readSMILES",{smiles:t},e,function(t){i(pt.molFrom(t.mol))},n)},dt.saveFile=function(t,e,i,n){this._contactServer("saveFile",{mol:pt.molTo(t)},e,function(t){i(t.link)},n)},dt.simulate13CNMR=function(t,e,i,n){e.nucleus="C",e.isotope=13,this._contactServer("simulateNMR",{mol:pt.molTo(t)},e,function(t){i(c.readJCAMP(t.jcamp))},n)},dt.simulate1HNMR=function(t,e,i,n){e.nucleus="H",e.isotope=1,this._contactServer("simulateNMR",{mol:pt.molTo(t)},e,function(t){i(c.readJCAMP(t.jcamp))},n)},dt.simulateMassParentPeak=function(t,e,i,n){this._contactServer("simulateMassParentPeak",{mol:pt.molTo(t)},e,function(t){i(c.readJCAMP(t.jcamp))},n)},dt.writeSMILES=function(t,e,i,n){this._contactServer("writeSMILES",{mol:pt.molTo(t)},e,function(t){i(t.smiles)},n)},dt.version=function(t,e,i){this._contactServer("version",{},t,function(t){e(t.value)},i)},dt.checkForUpdates=function(t){this._contactServer("checkForUpdates",{value:location.href},t,function(t){},function(){})};var _t=vt.prototype=new st;_t.setSearchTerm=function(t){Object(L.jQuery)("#"+this.id+"_query").val(t),this.search()},_t.getInputFields=function(){var t=[];return t.push("<br><nobr>"),t.push('<select id="'),t.push(this.id),t.push('_select">'),t.push('<option value="chemexper">ChemExper'),t.push('<option value="chemspider">ChemSpider'),t.push('<option value="pubchem" selected>PubChem'),t.push("</select>"),t.push('<button id="'),t.push(this.id),t.push('_submit">Show Molecule</button>'),t.push("</nobr>"),t.join("")},_t.search=function(){this.emptyMessage="Searching...",this.clear();var e=this;mt.getMoleculeFromDatabase(Object(L.jQuery)("#"+this.id+"_query").val(),{database:Object(L.jQuery)("#"+this.id+"_select").val()},function(t){e.loadMolecule(t)})};var xt={};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)},xt.requestInterval=function(i,n){if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setInterval(i,n);var r=(new Date).getTime(),s=new Object;return s.value=window.requestAnimFrame(function t(){var e=(new Date).getTime();n<=e-r&&(i.call(),r=(new Date).getTime()),s.value=window.requestAnimFrame(t)}),s},xt.clearRequestInterval=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearInterval(t)},xt.requestTimeout=function(i,n){if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setTimeout(i,n);var r=(new Date).getTime(),s=new Object;return s.value=window.requestAnimFrame(function t(){var e=(new Date).getTime();n<=e-r?i.call():s.value=window.requestAnimFrame(t)}),s},xt.clearRequestTimeout=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearTimeout(t)};var bt=xt;function yt(t,e,i){t&&this.create(t,e,i)}var wt=yt.prototype=new st;function Tt(t,e,i){t&&this.create(t,e,i)}wt.timeout=33,wt.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var e=this;this.nextFrame&&(this.handle=bt.requestInterval(function(){var t=(new Date).getTime();e.nextFrame(t-e.lastTime),e.repaint(),e.lastTime=t},this.timeout))},wt.stopAnimation=function(){this.handle&&(bt.clearRequestInterval(this.handle),this.handle=void 0)},wt.isRunning=function(){return void 0!==this.handle};var Dt=Tt.prototype=new yt;Dt.frames=[],Dt.curIndex=0,Dt.timeout=5e3,Dt.alpha=0,Dt.innerHandle=void 0,Dt.phase=0,Dt.drawChildExtras=function(t){var e=G(this.specs.backgroundColor,255);t.fillStyle="rgba("+e[0]+", "+e[1]+", "+e[2]+", "+this.alpha+")",t.fillRect(0,0,this.width,this.height)},Dt.nextFrame=function(t){if(0!==this.frames.length){this.phase=0;var e=this,i=1;this.innerHandle=setInterval(function(){e.alpha=i/15,e.repaint(),15===i&&e.breakInnerHandle(),i++},33)}else this.stopAnimation()},Dt.breakInnerHandle=function(){if(this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0),0===this.phase){this.curIndex++,this.curIndex>this.frames.length-1&&(this.curIndex=0),this.alpha=1;var t=this.frames[this.curIndex];this.loadContent(t.mols,t.shapes),this.phase=1;var e=this,i=1;this.innerHandle=setInterval(function(){e.alpha=(15-i)/15,e.repaint(),15===i&&e.breakInnerHandle(),i++},33)}else 1===this.phase&&(this.alpha=0,this.repaint())},Dt.addFrame=function(t,e){0===this.frames.length&&this.loadContent(t,e),this.frames.push({mols:t,shapes:e})};var St=Math;function Ct(t,e,i,n){t&&this.create(t,e,i),this.rotate3D=n}var At=Ct.prototype=new st;function Et(t,e,i){t&&this.create(t,e,i)}function Ft(t,e,i){t&&this.create(t,e,i)}At.lastPoint=void 0,At.rotationMultMod=1.3,At.lastPinchScale=1,At.lastGestureRotate=0,At.mousedown=function(t){this.lastPoint=t.p},At.dblclick=function(t){this.center(),this.repaint()},At.drag=function(t){if(!this.lastPoint.multi)if(et.ALT){var e=new P(t.p.x,t.p.y);e.sub(this.lastPoint);for(var i=0,n=this.molecules.length;i<n;i++){for(var r=0,s=(d=this.molecules[i]).atoms.length;r<s;r++)d.atoms[r].add(e);d.check()}for(i=0,n=this.shapes.length;i<n;i++){var o=this.shapes[i].getPoints();for(r=0,s=o.length;r<s;r++)o[r].add(e)}this.lastPoint=t.p,this.repaint()}else if(!0===this.rotate3D){var a=St.max(this.width/4,this.height/4),h=t.p.x-this.lastPoint.x,l=t.p.y-this.lastPoint.y,u=h/a*this.rotationMultMod,c=-l/a*this.rotationMultMod,f=[];L.mat4.identity(f),L.mat4.rotate(f,c,[1,0,0]),L.mat4.rotate(f,u,[0,1,0]);for(i=0,n=this.molecules.length;i<n;i++){var d;for(r=0,s=(d=this.molecules[i]).atoms.length;r<s;r++){var m=d.atoms[r],p=[m.x-this.width/2,m.y-this.height/2,m.z];L.mat4.multiplyVec3(f,p),m.x=p[0]+this.width/2,m.y=p[1]+this.height/2,m.z=p[2]}for(i=0,n=d.rings.length;i<n;i++)d.rings[i].center=d.rings[i].getCenter();this.lastPoint=t.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&d.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&d.sortBondsByZ()}this.repaint()}else{var g=new P(this.width/2,this.height/2),v=g.angle(this.lastPoint),_=g.angle(t.p);this.specs.rotateAngle-=_-v,this.lastPoint=t.p,this.repaint()}},At.mousewheel=function(t,e){this.specs.scale+=e/50,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},At.multitouchmove=function(t,e){if(2===e)if(this.lastPoint.multi){var i=new P(t.p.x,t.p.y);i.sub(this.lastPoint);for(var n=0,r=this.molecules.length;n<r;n++){for(var s=this.molecules[n],o=0,a=s.atoms.length;o<a;o++)s.atoms[o].add(i);s.check()}for(n=0,r=this.shapes.length;n<r;n++){var h=this.shapes[n].getPoints();for(o=0,a=h.length;o<a;o++)h[o].add(i)}this.lastPoint=t.p,this.lastPoint.multi=!0,this.repaint()}else this.lastPoint=t.p,this.lastPoint.multi=!0},At.gesturechange=function(t){if(t.originalEvent.scale-this.lastPinchScale!=0&&(this.specs.scale*=t.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=t.originalEvent.scale),this.lastGestureRotate-t.originalEvent.rotation!=0){for(var e=(this.lastGestureRotate-t.originalEvent.rotation)/180*St.PI,i=new P(this.width/2,this.height/2),n=0,r=this.molecules.length;n<r;n++){for(var s=this.molecules[n],o=0,a=s.atoms.length;o<a;o++){var h=s.atoms[o],l=i.distance(h),u=i.angle(h)+e;h.x=i.x+l*St.cos(u),h.y=i.y-l*St.sin(u)}s.check()}this.lastGestureRotate=t.originalEvent.rotation}this.repaint()},At.gestureend=function(t){this.lastPinchScale=1,this.lastGestureRotate=0},Et.prototype=new st;var Rt=Ft.prototype=new st;function Pt(t,e,i){t&&this.create(t,e,i)}function Bt(t,e,i){t&&this.create(t,e,i)}Rt.spectrum=void 0,Rt.emptyMessage="No Spectrum Loaded or Recognized",Rt.loadMolecule=void 0,Rt.getMolecule=void 0,Rt.innerRepaint=function(t){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(t,this.specs,this.width,this.height):this.emptyMessage&&(t.fillStyle="#737683",t.textAlign="center",t.textBaseline="middle",t.font="18px Helvetica, Verdana, Arial, Sans-serif",t.fillText(this.emptyMessage,this.width/2,this.height/2))},Rt.loadSpectrum=function(t){this.spectrum=t,this.repaint()},Rt.getSpectrum=function(){return this.spectrum},Rt.getSpectrumCoordinates=function(t,e){return spectrum.getInternalCoordinates(t,e,this.width,this.height)},Pt.prototype=new Ft;var Mt=Bt.prototype=new Ft;Mt.overlaySpectra=[],Mt.superRepaint=Mt.innerRepaint,Mt.innerRepaint=function(t){if(this.superRepaint(t),this.spectrum&&0<this.spectrum.data.length)for(var e=0,i=this.overlaySpectra.length;e<i;e++){var n=this.overlaySpectra[e];n&&0<n.data.length&&(n.minX=this.spectrum.minX,n.maxX=this.spectrum.maxX,n.drawPlot(t,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}},Mt.addSpectrum=function(t){this.spectrum?this.overlaySpectra.push(t):this.spectrum=t};var It=Math;function Lt(t,e,i){t&&this.create(t,e,i)}var Nt=Lt.prototype=new Ft;Nt.dragRange=void 0,Nt.rescaleYAxisOnZoom=!0,Nt.lastPinchScale=1,Nt.mousedown=function(t){this.dragRange=new P(t.p.x,t.p.x)},Nt.mouseup=function(t){if(this.dragRange&&this.dragRange.x!==this.dragRange.y){if(!this.dragRange.multi){var e=this.spectrum.zoom(this.dragRange.x,t.p.x,this.width,this.rescaleYAxisOnZoom);this.rescaleYAxisOnZoom&&(this.specs.scale=e)}this.dragRange=void 0,this.repaint()}},Nt.drag=function(t){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(et.SHIFT&&(this.spectrum.translate(t.p.x-this.dragRange.x,this.width),this.dragRange.x=t.p.x),this.dragRange.y=t.p.x),this.repaint())},Nt.drawChildExtras=function(t){if(this.dragRange){var e=It.min(this.dragRange.x,this.dragRange.y),i=It.max(this.dragRange.x,this.dragRange.y);t.strokeStyle="gray",t.lineStyle=1,t.beginPath(),t.moveTo(e,this.height/2);for(var n=e;n<=i;n++)n%10<5?t.lineTo(n,It.round(this.height/2)):t.moveTo(n,It.round(this.height/2));t.stroke()}},Nt.mousewheel=function(t,e){this.specs.scale+=e/10,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},Nt.dblclick=function(t){this.spectrum.setup(),this.specs.scale=1,this.repaint()},Nt.multitouchmove=function(t,e){2===e&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(t.p.x-this.dragRange.x,this.width),this.dragRange.x=t.p.x,this.dragRange.y=t.p.x,this.repaint()):(this.dragRange=new P(t.p.x,t.p.x),this.dragRange.multi=!0))},Nt.gesturechange=function(t){this.specs.scale*=t.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=t.originalEvent.scale,this.repaint()},Nt.gestureend=function(t){this.lastPinchScale=1};var kt=Math;function Ot(t,e,i,n){t&&this.create(t,e,i),this.seekType=n}var zt=Ot.prototype=new Ft;zt.superRepaint=zt.innerRepaint,zt.innerRepaint=function(t){if(this.superRepaint(t),this.spectrum&&0<this.spectrum.data.length&&this.p){var e,i;if(this.seekType===Ot.SEEK_POINTER)e=this.p,i=this.spectrum.getInternalCoordinates(e.x,e.y);else if(this.seekType===Ot.SEEK_PLOT||this.seekType===Ot.SEEK_PEAK){if(!(i=this.seekType===Ot.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x)))return;e={x:this.spectrum.getTransformedX(i.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(i.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}t.fillStyle="white",t.strokeStyle=this.specs.plots_color,t.lineWidth=this.specs.plots_width,t.beginPath(),t.arc(e.x,e.y,3,0,2*kt.PI,!1),t.fill(),t.stroke(),t.font=F(this.specs.text_font_size,this.specs.text_font_families),t.textAlign="left",t.textBaseline="bottom";var n="x:"+i.x.toFixed(3)+", y:"+i.y.toFixed(3),r=e.x+3,s=t.measureText(n).width;r+s>this.width-2&&(r-=6+s);var o=e.y;o-this.specs.text_font_size-2<0&&(o+=this.specs.text_font_size),t.fillRect(r,o-this.specs.text_font_size,s,this.specs.text_font_size),t.fillStyle="black",t.fillText(n,r,o)}},zt.mouseout=function(t){this.p=void 0,this.repaint()},zt.mousemove=function(t){this.p={x:t.p.x-2,y:t.p.y-3},this.repaint()},zt.touchstart=function(t){this.mousemove(t)},zt.touchmove=function(t){this.mousemove(t)},zt.touchend=function(t){this.mouseout(t)},Ot.SEEK_POINTER="pointer",Ot.SEEK_PLOT="plot",Ot.SEEK_PEAK="peak";var Ut=Math,Ht=[],jt=[1,0,0],qt=[0,1,0],Wt=[0,0,1];function Gt(t,e,i,n){t&&this.create(t,e,i),this.rotate3D=n}var Xt=Gt.prototype=new yt,Vt=Ut.PI/15;Xt.xIncrement=Vt,Xt.yIncrement=Vt,Xt.zIncrement=Vt,Xt.nextFrame=function(t){if(0!==this.molecules.length||0!==this.shapes.length){var e=t/1e3;if(this.rotate3D){L.mat4.identity(Ht),L.mat4.rotate(Ht,this.xIncrement*e,jt),L.mat4.rotate(Ht,this.yIncrement*e,qt),L.mat4.rotate(Ht,this.zIncrement*e,Wt);for(var i=0,n=this.molecules.length;i<n;i++){for(var r=this.molecules[i],s=0,o=r.atoms.length;s<o;s++){var a=[(l=r.atoms[s]).x-this.width/2,l.y-this.height/2,l.z];L.mat4.multiplyVec3(Ht,a),l.x=a[0]+this.width/2,l.y=a[1]+this.height/2,l.z=a[2]}for(s=0,o=r.rings.length;s<o;s++)r.rings[s].center=r.rings[s].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&r.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&r.sortBondsByZ()}for(i=0,n=this.shapes.length;i<n;i++){var h=this.shapes[i].getPoints();for(s=0,o=h.length;s<o;s++){var l;a=[(l=h[s]).x-this.width/2,l.y-this.height/2,0];L.mat4.multiplyVec3(Ht,a),l.x=a[0]+this.width/2,l.y=a[1]+this.height/2}}}else this.specs.rotateAngle+=this.zIncrement*e}else this.stopAnimation()},Xt.dblclick=function(t){this.isRunning()?this.stopAnimation():this.startAnimation()};var Yt=Math;function Zt(t,e,i){t&&this.create(t,e,i)}var Qt=Zt.prototype=new st,$t=st.prototype;function Jt(t,e,i){t&&this.create(t,e,i);var n=[];n.push('<br><input type="text" id="'),n.push(t),n.push('_query" size="32" value="" />'),n.push("<br><nobr>"),n.push('<select id="'),n.push(t),n.push('_select">'),n.push('<option value="pubchem" selected>PubChem'),n.push("</select>"),n.push('<button id="'),n.push(t),n.push('_submit">Show Molecule</button>'),n.push("</nobr>"),document.writeln(n.join(""));var r=this;Object(L.jQuery)("#"+t+"_submit").click(function(){r.search()}),Object(L.jQuery)("#"+t+"_query").keypress(function(t){13===t.which&&r.search()})}Qt.rotationMatrix=void 0,Qt.lastPoint=void 0,Qt.emptyMessage="WebGL is Unavailable!",Qt.lastPinchScale=1,Qt.lastGestureRotate=0,Qt.afterLoadContent=function(){for(var t=new z,e=0,i=this.molecules.length;e<i;e++)t.expand(this.molecules[e].getBounds3D());var n=L.vec3.dist([t.maxX,t.maxY,t.maxZ],[t.minX,t.minY,t.minZ])/2+1.5;n===1/0&&(n=10),this.maxDimension=Yt.max(t.maxX-t.minX,t.maxY-t.minY);var r=Yt.min(179.9,Yt.max(this.specs.projectionPerspectiveVerticalFieldOfView_3D,.1)),s=r/360*Yt.PI,o=n,a=o/(Yt.tan(s)/.8),h=a-o,l=a+o,u=this.width/this.height;this.camera.fieldOfView=r,this.camera.near=h,this.camera.far=l,this.camera.aspect=u,L.mat4.translate(L.mat4.identity(this.camera.viewMatrix),[0,0,-a]);var c=o/Yt.tan(s);this.lighting.camera.fieldOfView=r,this.lighting.camera.near=c-o,this.lighting.camera.far=c+o,this.lighting.updateView(),this.setupScene()},Qt.renderDepthMap=function(){if(this.specs.shadow_3D&&Co.DepthShader){var t=this.gl.isEnabled(this.gl.CULL_FACE);t||this.gl.enable(this.gl.CULL_FACE),this.depthShader.useShaderProgram(this.gl);var e=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0),this.lightDepthMapFramebuffer.bind(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.depthShader.setProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix),this.depthShader.enableAttribsArray(this.gl);for(var i=0,n=this.molecules.length;i<n;i++)this.molecules[i].render(this.gl,this.specs);this.gl.flush(),this.depthShader.disableAttribsArray(this.gl),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(e[0],e[1],e[2],e[3]),t||this.gl.disable(this.gl.CULL_FACE)}},Qt.renderExtras=function(){this.phongShader.useShaderProgram(this.gl),this.phongShader.enableAttribsArray(this.gl);for(var t=[],e=0,i=this.shapes.length;e<i;e++){(n=this.shapes[e])instanceof Co._Surface&&(!n.specs&&1!==this.specs.surfaces_alpha||n.specs&&1!==n.specs.surfaces_alpha)?t.push(n):n.render(this.gl,this.specs)}if(0!==t.length){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1);for(e=0,i=t.length;e<i;e++){(n=t[e]).render(this.gl,this.specs)}this.gl.depthMask(!0),this.gl.disable(this.gl.BLEND),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}if(this.phongShader.setShadow(this.gl,!1),this.phongShader.setFogMode(this.gl,0),this.phongShader.setFlatColor(this.gl,!1),this.specs.compass_display&&(this.phongShader.setLightDirection(this.gl,[0,0,-1]),this.compass.render(this.gl,this.specs)),this.phongShader.disableAttribsArray(this.gl),this.gl.flush(),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.labelShader.useShaderProgram(this.gl),this.labelShader.setMatrixUniforms(this.gl,this.gl.modelViewMatrix),this.labelShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.labelShader.setDimension(this.gl,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.labelShader.enableAttribsArray(this.gl),this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules()),this.specs.measurement_displayText_3D)for(e=0,i=this.shapes.length;e<i;e++){var n;(n=this.shapes[e]).renderText&&n.renderText(this.gl,this.specs)}this.specs.compass_display&&this.specs.compass_displayText_3D&&this.compass.renderAxis(this.gl),this.labelShader.disableAttribsArray(this.gl),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0),this.gl.flush(),this.drawChildExtras&&this.drawChildExtras(this.gl),this.gl.flush()},Qt.renderColor=function(){this.phongShader.useShaderProgram(this.gl),this.gl.uniform1i(this.phongShader.shadowDepthSampleUniform,0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lightDepthMapTexture.texture),this.phongShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.phongShader.setShadow(this.gl,this.specs.shadow_3D),this.phongShader.setFlatColor(this.gl,this.specs.flat_color_3D),this.phongShader.setGammaCorrection(this.gl,this.specs.gammaCorrection_3D),this.phongShader.setShadowTextureSize(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.phongShader.setShadowIntensity(this.gl,this.specs.shadow_intensity_3D),this.phongShader.setFogMode(this.gl,this.specs.fog_mode_3D),this.phongShader.setFogColor(this.gl,this.fogging.colorRGB),this.phongShader.setFogStart(this.gl,this.fogging.fogStart),this.phongShader.setFogEnd(this.gl,this.fogging.fogEnd),this.phongShader.setFogDensity(this.gl,this.fogging.density),this.phongShader.setLightProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix),this.phongShader.setLightDiffuseColor(this.gl,this.lighting.diffuseRGB),this.phongShader.setLightSpecularColor(this.gl,this.lighting.specularRGB),this.phongShader.setLightDirection(this.gl,this.lighting.direction),this.phongShader.enableAttribsArray(this.gl);for(var t=0,e=this.molecules.length;t<e;t++)this.molecules[t].render(this.gl,this.specs);this.phongShader.disableAttribsArray(this.gl),this.gl.flush()},Qt.renderPosition=function(){this.positionShader.useShaderProgram(this.gl),this.positionShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.positionShader.enableAttribsArray(this.gl);for(var t=0,e=this.molecules.length;t<e;t++)this.molecules[t].render(this.gl,this.specs);this.positionShader.disableAttribsArray(this.gl),this.gl.flush()},Qt.renderNormal=function(){this.normalShader.useShaderProgram(this.gl),this.normalShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.normalShader.enableAttribsArray(this.gl);for(var t=0,e=this.molecules.length;t<e;t++)this.molecules[t].render(this.gl,this.specs);this.normalShader.disableAttribsArray(this.gl),this.gl.flush()},Qt.renderSSAO=function(){this.ssaoShader.useShaderProgram(this.gl),this.ssaoShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.ssaoShader.setSampleKernel(this.gl,this.ssao.sampleKernel),this.ssaoShader.setKernelRadius(this.gl,this.specs.ssao_kernel_radius),this.ssaoShader.setPower(this.gl,this.specs.ssao_power),this.ssaoShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.uniform1i(this.ssaoShader.positionSampleUniform,0),this.gl.uniform1i(this.ssaoShader.normalSampleUniform,1),this.gl.uniform1i(this.ssaoShader.noiseSampleUniform,2),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssao.noiseTexture),this.gl.activeTexture(this.gl.TEXTURE0),this.ssaoShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.ssaoShader.disableAttribsArray(this.gl),this.gl.flush(),this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.ssaoBlurShader.useShaderProgram(this.gl),this.ssaoBlurShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.uniform1i(this.ssaoBlurShader.aoSampleUniform,0),this.gl.uniform1i(this.ssaoBlurShader.depthSampleUniform,1),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.ssaoBlurShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.ssaoBlurShader.disableAttribsArray(this.gl),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.flush()},Qt.renderOutline=function(){this.outlineShader.useShaderProgram(this.gl),this.outlineShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.outlineShader.setNormalThreshold(this.gl,this.specs.outline_normal_threshold),this.outlineShader.setDepthThreshold(this.gl,this.specs.outline_depth_threshold),this.outlineShader.setThickness(this.gl,this.specs.outline_thickness),this.gl.uniform1i(this.outlineShader.normalSampleUniform,0),this.gl.uniform1i(this.outlineShader.depthSampleUniform,1),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.outlineShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.outlineShader.disableAttribsArray(this.gl),this.gl.flush()},Qt.deferredRender=function(){var t=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(0,0,0,0),this.colorFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.renderColor(),this.positionFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.renderPosition(),this.normalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.renderNormal(),this.specs.ssao_3D&&Co.SSAOShader?(this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.renderSSAO()):(this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this.outlineFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.specs.outline_3D&&this.renderOutline(),this.gl.clearColor(t[0],t[1],t[2],t[3]),this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.lightingShader.useShaderProgram(this.gl),this.gl.uniform1i(this.lightingShader.positionSampleUniform,0),this.gl.uniform1i(this.lightingShader.colorSampleUniform,1),this.gl.uniform1i(this.lightingShader.ssaoSampleUniform,2),this.gl.uniform1i(this.lightingShader.outlineSampleUniform,3),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colorTexture.texture),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssaoTexture.texture),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outlineTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.lightingShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.lightingShader.disableAttribsArray(this.gl),this.gl.flush(),this.fxaaFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.fxaaShader.useShaderProgram(this.gl),this.fxaaShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaShader.setAntialias(this.gl,this.specs.antialias_3D),this.fxaaShader.setEdgeThreshold(this.gl,this.specs.fxaa_edgeThreshold),this.fxaaShader.setEdgeThresholdMin(this.gl,this.specs.fxaa_edgeThresholdMin),this.fxaaShader.setSearchSteps(this.gl,this.specs.fxaa_searchSteps),this.fxaaShader.setSearchThreshold(this.gl,this.specs.fxaa_searchThreshold),this.fxaaShader.setSubpixCap(this.gl,this.specs.fxaa_subpixCap),this.fxaaShader.setSubpixTrim(this.gl,this.specs.fxaa_subpixTrim),this.fxaaShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.fxaaShader.disableAttribsArray(this.gl),this.gl.flush(),this.finalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.renderExtras(),this.gl.clearColor(t[0],t[1],t[2],t[3]),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.fxaaTexture.texture),this.quadShader.useShaderProgram(this.gl),this.quadShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.quadShader.disableAttribsArray(this.gl),this.gl.flush()},Qt.forwardRender=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.renderColor(),this.renderExtras()},Qt.repaint=function(){this.gl&&(this.gl.lightViewMatrix=L.mat4.multiply(this.lighting.camera.viewMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,this.gl.modelViewMatrix=this.gl.lightViewMatrix,this.renderDepthMap(),this.gl.modelViewMatrix=L.mat4.multiply(this.camera.viewMatrix,this.rotationMatrix,[]),this.isSupportDeferred()&&(this.specs.ssao_3D||this.specs.outline_3D)?this.deferredRender():this.forwardRender())},Qt.pick=function(t,e,i,n){if(this.gl){var r=t,s=this.height-e;1!==this.pixelRatio&&(r*=this.pixelRatio,s*=this.pixelRatio),L.mat4.multiply(this.camera.viewMatrix,this.rotationMatrix,this.gl.modelViewMatrix),this.gl.rotationMatrix=this.rotationMatrix,this.pickShader.useShaderProgram(this.gl);var o=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0),this.pickerFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.pickShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix),this.pickShader.enableAttribsArray(this.gl);for(var a=[],h=0,l=this.molecules.length;h<l;h++)this.molecules[h].renderPickFrame(this.gl,this.specs,a,i,n);this.pickShader.disableAttribsArray(this.gl),this.gl.flush();var u=new Uint8Array(4);this.gl.readPixels(r-2,s+2,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,u);var c=void 0;if(0<u[3])c=a[u[2]|u[1]<<8|u[0]<<16];return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(o[0],o[1],o[2],o[3]),c}},Qt.center=function(){for(var t=new Zr,e=0,i=this.molecules.length;e<i;e++){var n=this.molecules[e];t.add3D(n.getCenter3D())}t.x/=this.molecules.length,t.y/=this.molecules.length;for(e=0,i=this.molecules.length;e<i;e++){for(var r=0,s=(n=this.molecules[e]).atoms.length;r<s;r++)n.atoms[r].sub3D(t);if(n.chains&&n.fromJSON)for(r=0,s=n.chains.length;r<s;r++)for(var o=n.chains[r],a=0,h=o.length;a<h;a++){var l=o[a];l.cp1.sub3D(t),l.cp2.sub3D(t),l.cp3&&(l.cp3.sub3D(t),l.cp4.sub3D(t),l.cp5.sub3D(t))}}},Qt.isSupportDeferred=function(){return this.gl.textureFloatExt&&this.gl.depthTextureExt},Qt.create=function(t,e,i){$t.create.call(this,t,e,i);try{var n=document.getElementById(this.id);this.gl=n.getContext("webgl"),this.gl||(this.gl=n.getContext("experimental-webgl"))}catch(t){}this.gl?(1!==this.pixelRatio&&this.gl.canvas.width===this.width&&(this.gl.canvas.style.width=this.width+"px",this.gl.canvas.style.height=this.height+"px",this.gl.canvas.width=this.width*this.pixelRatio,this.gl.canvas.height=this.height*this.pixelRatio),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearDepth(1),this.shadowTextureSize=1024,this.rotationMatrix=L.mat4.identity([]),this.camera=new Co.Camera,this.label3D=new Co.Label,this.lighting=new Co.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.fogging=new Co.Fog(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.gl.depthTextureExt=this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture"),this.gl.textureFloatExt=this.gl.getExtension("OES_texture_float")||this.gl.getExtension("WEBKIT_OES_texture_float")||this.gl.getExtension("MOZ_OES_texture_float"),this.ssao=new Co.SSAO,this.pickerColorTexture=new Co.Texture,this.pickerColorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.pickerDepthRenderbuffer=new Co.Renderbuffer,this.pickerDepthRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.pickerFramebuffer=new Co.Framebuffer,this.pickerFramebuffer.init(this.gl),this.pickerFramebuffer.setColorTexture(this.gl,this.pickerColorTexture.texture),this.pickerFramebuffer.setDepthRenderbuffer(this.gl,this.pickerDepthRenderbuffer.renderbuffer),this.lightDepthMapTexture=new Co.Texture,this.lightDepthMapRenderbuffer=new Co.Renderbuffer,this.lightDepthMapFramebuffer=new Co.Framebuffer,this.lightDepthMapFramebuffer.init(this.gl),this.gl.depthTextureExt?(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.RGBA4),this.lightDepthMapFramebuffer.setColorRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer),this.lightDepthMapFramebuffer.setDepthTexture(this.gl,this.lightDepthMapTexture.texture)):(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.lightDepthMapFramebuffer.setColorTexture(this.gl,this.lightDepthMapTexture.texture),this.lightDepthMapFramebuffer.setDepthRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer)),this.isSupportDeferred()&&(this.depthTexture=new Co.Texture,this.depthTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.colorTexture=new Co.Texture,this.colorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.positionTexture=new Co.Texture,this.positionTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.normalTexture=new Co.Texture,this.normalTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.ssaoTexture=new Co.Texture,this.ssaoTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.outlineTexture=new Co.Texture,this.outlineTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.fxaaTexture=new Co.Texture,this.fxaaTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.imageTexture=new Co.Texture,this.imageTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.colorFramebuffer=new Co.Framebuffer,this.colorFramebuffer.init(this.gl),this.colorFramebuffer.setColorTexture(this.gl,this.colorTexture.texture),this.colorFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalFramebuffer=new Co.Framebuffer,this.normalFramebuffer.init(this.gl),this.normalFramebuffer.setColorTexture(this.gl,this.normalTexture.texture),this.normalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.positionFramebuffer=new Co.Framebuffer,this.positionFramebuffer.init(this.gl),this.positionFramebuffer.setColorTexture(this.gl,this.positionTexture.texture),this.positionFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.ssaoFramebuffer=new Co.Framebuffer,this.ssaoFramebuffer.init(this.gl),this.ssaoFramebuffer.setColorTexture(this.gl,this.ssaoTexture.texture),this.outlineFramebuffer=new Co.Framebuffer,this.outlineFramebuffer.init(this.gl),this.outlineFramebuffer.setColorTexture(this.gl,this.outlineTexture.texture),this.fxaaFramebuffer=new Co.Framebuffer,this.fxaaFramebuffer.init(this.gl),this.fxaaFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.quadFramebuffer=new Co.Framebuffer,this.quadFramebuffer.init(this.gl),this.quadFramebuffer.setColorTexture(this.gl,this.imageTexture.texture),this.finalFramebuffer=new Co.Framebuffer,this.finalFramebuffer.init(this.gl),this.finalFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.finalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalShader=new Co.NormalShader,this.normalShader.init(this.gl),this.positionShader=new Co.PositionShader,this.positionShader.init(this.gl),Co.SSAOShader&&(this.ssaoShader=new Co.SSAOShader,this.ssaoShader.init(this.gl),this.ssaoBlurShader=new Co.SSAOBlurShader,this.ssaoBlurShader.init(this.gl)),this.outlineShader=new Co.OutlineShader,this.outlineShader.init(this.gl),this.lightingShader=new Co.LightingShader,this.lightingShader.init(this.gl),this.fxaaShader=new Co.FXAAShader,this.fxaaShader.init(this.gl),this.quadShader=new Co.QuadShader,this.quadShader.init(this.gl)),this.labelShader=new Co.LabelShader,this.labelShader.init(this.gl),this.pickShader=new Co.PickShader,this.pickShader.init(this.gl),this.phongShader=new Co.PhongShader,this.phongShader.init(this.gl),Co.DepthShader&&(this.depthShader=new Co.DepthShader,this.depthShader.init(this.gl)),this.textTextImage=new Co.TextImage,this.textTextImage.init(this.gl),this.gl.textImage=new Co.TextImage,this.gl.textImage.init(this.gl),this.gl.textMesh=new Co.TextMesh,this.gl.textMesh.init(this.gl),this.gl.material=new Co.Material,this.setupScene()):this.displayMessage()},Qt.displayMessage=function(){var t=document.getElementById(this.id);if(t.getContext){var e=t.getContext("2d");this.specs.backgroundColor&&(e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2))}},Qt.renderText=function(t,e){var i={position:[],texCoord:[],translation:[]};this.textTextImage.pushVertexData(t,e,0,i),this.gl.textMesh.storeData(this.gl,i.position,i.texCoord,i.translation),this.textTextImage.useTexture(this.gl),this.gl.textMesh.render(this.gl)},Qt.setupScene=function(){if(this.gl){Object(L.jQuery)("#"+this.id).css("background-color",this.specs.backgroundColor);var t=G(this.specs.backgroundColor,1);this.gl.clearColor(t[0],t[1],t[2],1),this.specs.cullBackFace_3D?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.sphereBuffer=new Co.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new Co.Star,this.gl.cylinderBuffer=new Co.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.cylinderClosedBuffer=new Co.Cylinder(1,1,this.specs.bonds_resolution_3D,!0),this.gl.boxBuffer=new Co.Box(1,1,1),this.gl.pillBuffer=new Co.Pill(this.specs.bonds_pillDiameter_3D/2,this.specs.bonds_pillHeight_3D,this.specs.bonds_pillLatitudeResolution_3D,this.specs.bonds_pillLongitudeResolution_3D),this.gl.lineBuffer=new Co.Line,this.gl.lineArrowBuffer=new Co.LineArrow,this.gl.arrowBuffer=new Co.Arrow(.3,this.specs.compass_resolution_3D),this.gl.quadBuffer=new Co.Quad,this.gl.textImage.updateFont(this.gl,this.specs.text_font_size,this.specs.text_font_families,this.specs.text_font_bold,this.specs.text_font_italic,this.specs.text_font_stroke_3D),this.lighting.lightScene(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.fogging.fogScene(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.compass=new Co.Compass(this.gl,this.specs),this.lightDepthMapTexture.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.lightDepthMapRenderbuffer.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize),this.pickerColorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.pickerDepthRenderbuffer.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.isSupportDeferred()&&(this.depthTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.colorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.imageTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.positionTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.normalTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssaoTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.outlineTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssao.initSampleKernel(this.specs.ssao_kernel_samples),this.ssao.initNoiseTexture(this.gl)),this.camera.updateProjectionMatrix(this.specs.projectionPerspective_3D);for(var e=0,i=this.molecules.length;e<i;e++){if((g=this.molecules[e]).labelMesh instanceof Co.TextMesh||(g.labelMesh=new Co.TextMesh,g.labelMesh.init(this.gl)),g.chains){g.ribbons=[],g.cartoons=[],g.tubes=[],g.pipePlanks=[];for(var n=0,r=g.chains.length;n<r;n++){for(var s=g.chains[n],o=0,a=s.length-1;o<a;o++)s[o].Test=o;var h=3<s.length&&ye[s[3].name]&&"#BEA06E"===ye[s[3].name].aminoColor;if(0<s.length&&!s[0].lineSegments){for(o=0,a=s.length-1;o<a;o++)s[o].setup(s[o+1].cp1,h?1:this.specs.proteins_horizontalResolution);if(!h)for(o=1,a=s.length-1;o<a;o++)N(s[o-1].D,s[o].D)>Yt.PI/2&&(s[o].guidePointsSmall.reverse(),s[o].guidePointsLarge.reverse(),L.vec3.scale(s[o].D,-1));for(o=2,a=s.length-3;o<a;o++)s[o].computeLineSegments(s[o-2],s[o-1],s[o+1],!h,h?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);s.pop(),s.pop(),s.pop(),s.shift(),s.shift()}var l=X(1===r?.5:n/r,1,.5),u="rgb("+l[0]+","+l[1]+","+l[2]+")";if(s.chainColor=u,h){(c=new Co.Tube(s,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D)).chainColor=u,g.tubes.push(c)}else{var c=new Co.PipePlank(s,this.specs);g.pipePlanks.push(c);var f=s.shift(),d={front:new Co.Ribbon(s,this.specs.proteins_ribbonThickness,!1),back:new Co.Ribbon(s,-this.specs.proteins_ribbonThickness,!1)};d.front.chainColor=u,d.back.chainColor=u,g.ribbons.push(d);var m={front:new Co.Ribbon(s,this.specs.proteins_ribbonThickness,!0),back:new Co.Ribbon(s,-this.specs.proteins_ribbonThickness,!0)};m.front.chainColor=u,m.back.chainColor=u,g.cartoons.push(m),s.unshift(f)}}}}if(this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs),this instanceof ce&&this.frames)for(o=0,a=this.frames.length;o<a;o++){var p=this.frames[o];for(n=0,r=p.mols.length;n<r;n++){var g;(g=p.mols[n]).labelMesh instanceof Co.TextMesh||(g.labelMesh=new Co.TextMesh,g.labelMesh.init(this.gl))}this.label3D.updateVerticesBuffer(this.gl,p.mols,this.specs)}}},Qt.updateScene=function(){this.camera.updateProjectionMatrix(this.specs.projectionPerspective_3D),this.lighting.lightScene(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.fogging.fogScene(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.repaint()},Qt.mousedown=function(t){this.lastPoint=t.p},Qt.mouseup=function(t){this.lastPoint=void 0},Qt.rightmousedown=function(t){this.lastPoint=t.p},Qt.drag=function(t){if(this.lastPoint){if(et.ALT){var e=new P(t.p.x,t.p.y);e.sub(this.lastPoint);var i=this.camera.fieldOfView/360*Yt.PI,n=Yt.tan(i),r=this.height/2/this.camera.zoom/n,s=this.camera.focalLength()/r;L.mat4.translate(this.camera.viewMatrix,[e.x*s,-e.y*s,0])}else{var o=t.p.x-this.lastPoint.x,a=t.p.y-this.lastPoint.y,h=L.mat4.rotate(L.mat4.identity([]),o*Yt.PI/180,[0,1,0]);L.mat4.rotate(h,a*Yt.PI/180,[1,0,0]),this.rotationMatrix=L.mat4.multiply(h,this.rotationMatrix)}this.lastPoint=t.p,this.repaint()}},Qt.mousewheel=function(t,e){0<e?this.camera.zoomIn():this.camera.zoomOut(),this.updateScene()},Qt.multitouchmove=function(t,e){if(2===e)if(this.lastPoint&&this.lastPoint.multi){var i=new P(t.p.x,t.p.y);i.sub(this.lastPoint);var n=this.camera.fieldOfView/360*Yt.PI,r=Yt.tan(n),s=this.height/2/this.camera.zoom/r,o=this.camera.focalLength()/s;L.mat4.translate(this.camera.viewMatrix,[i.x*o,-i.y*o,0]),this.lastPoint=t.p,this.repaint()}else this.lastPoint=t.p,this.lastPoint.multi=!0},Qt.gesturechange=function(t){if(t.originalEvent.scale-this.lastPinchScale!=0){var e=30*-(t.originalEvent.scale/this.lastPinchScale-1);if(isNaN(e))return;0<e?this.camera.zoomIn():this.camera.zoomOut(),this.updateScene(),this.lastPinchScale=t.originalEvent.scale}this.repaint()},Qt.gestureend=function(t){this.lastPinchScale=1,this.lastGestureRotate=0};var Kt=Jt.prototype=new Zt;Kt.setSearchTerm=function(t){Object(L.jQuery)("#"+this.id+"_query").val(t),this.search()},Kt.search=function(){var e=this;mt.getMoleculeFromDatabase(Object(L.jQuery)("#"+this.id+"_query").val(),{database:Object(L.jQuery)("#"+this.id+"_select").val(),dimension:3},function(t){e.loadMolecule(t)})};var te=Math,ee=[],ie=[1,0,0],ne=[0,1,0],re=[0,0,1];function se(t,e,i){t&&this.create(t,e,i)}var oe=se.prototype=new Zt;oe.timeout=33;var ae=te.PI/15;function he(t,e,i){t&&this.create(t,e,i)}function le(t,e,i){t&&this.create(t,e,i)}oe.xIncrement=ae,oe.yIncrement=ae,oe.zIncrement=ae,oe.startAnimation=yt.prototype.startAnimation,oe.stopAnimation=yt.prototype.stopAnimation,oe.isRunning=yt.prototype.isRunning,oe.dblclick=Gt.prototype.dblclick,oe.mousedown=void 0,oe.rightmousedown=void 0,oe.drag=void 0,oe.mousewheel=void 0,oe.nextFrame=function(t){if(0!==this.molecules.length||0!==this.shapes.length){L.mat4.identity(ee);var e=t/1e3;L.mat4.rotate(ee,this.xIncrement*e,ie),L.mat4.rotate(ee,this.yIncrement*e,ne),L.mat4.rotate(ee,this.zIncrement*e,re),L.mat4.multiply(this.rotationMatrix,ee)}else this.stopAnimation()},he.prototype=new Zt;var ue=le.prototype=new Zt;function ce(t,e,i){t&&this.create(t,e,i),this.frames=[]}ue.mousedown=void 0,ue.rightmousedown=void 0,ue.drag=void 0,ue.mousewheel=void 0,ce.PLAY_ONCE=0,ce.PLAY_LOOP=1,ce.PLAY_SPRING=2;var fe=ce.prototype=new Zt;fe.timeout=50,fe.frameNumber=0,fe.playMode=2,fe.reverse=!1,fe.startAnimation=yt.prototype.startAnimation,fe.stopAnimation=yt.prototype.stopAnimation,fe.isRunning=yt.prototype.isRunning,fe.dblclick=Gt.prototype.dblclick,fe.nextFrame=function(t){var e=this.frames[this.frameNumber];this.molecules=e.mols,this.shapes=e.shapes,2===this.playMode&&this.reverse?(this.frameNumber--,this.frameNumber<0&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0)===this.playMode&&this.stopAnimation()))},fe.center=function(){for(var t=new Zr,e=this.frames[0],i=0,n=e.mols.length;i<n;i++)t.add3D(e.mols[i].getCenter3D());t.x/=e.mols.length,t.y/=e.mols.length;var r=new Zr;r.sub3D(t);for(var s=0,o=this.frames.length;s<o;s++){var a=this.frames[s];for(i=0,n=a.mols.length;i<n;i++)for(var h=a.mols[i],l=0,u=h.atoms.length;l<u;l++)h.atoms[l].add3D(r)}},fe.addFrame=function(t,e){this.frames.push({mols:t,shapes:e})};var de=Math,me="8.0.0";function pe(){return me}var ge,ve=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"],_e=((ge=[]).H=new xe("H","Hydrogen",1,!1,"#FFFFFF",.31,1.1,1,1),ge.He=new xe("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4),ge.Li=new xe("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7),ge.Be=new xe("Be","Beryllium",4,!1,"#C2FF00",.96,1.53,2,9),ge.B=new xe("B","Boron",5,!0,"#FFB5B5",.84,1.92,3,11),ge.C=new xe("C","Carbon",6,!0,"#909090",.76,1.7,4,12),ge.N=new xe("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14),ge.O=new xe("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16),ge.F=new xe("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19),ge.Ne=new xe("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20),ge.Na=new xe("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23),ge.Mg=new xe("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24),ge.Al=new xe("Al","Aluminum",13,!1,"#BFA6A6",1.21,1.84,0,27),ge.Si=new xe("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28),ge.P=new xe("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31),ge.S=new xe("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32),ge.Cl=new xe("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35),ge.Ar=new xe("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40),ge.K=new xe("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39),ge.Ca=new xe("Ca","Calcium",20,!1,"#3DFF00",1.76,2.31,0,40),ge.Sc=new xe("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45),ge.Ti=new xe("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48),ge.V=new xe("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51),ge.Cr=new xe("Cr","Chromium",24,!1,"#8A99C7",1.39,0,2,52),ge.Mn=new xe("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55),ge.Fe=new xe("Fe","Iron",26,!1,"#E06633",1.32,0,2,56),ge.Co=new xe("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59),ge.Ni=new xe("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58),ge.Cu=new xe("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63),ge.Zn=new xe("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64),ge.Ga=new xe("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69),ge.Ge=new xe("Ge","Germanium",32,!1,"#668F8F",1.2,2.11,4,74),ge.As=new xe("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75),ge.Se=new xe("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80),ge.Br=new xe("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79),ge.Kr=new xe("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84),ge.Rb=new xe("Rb","Rubidium",37,!1,"#702EB0",2.2,3.03,0,85),ge.Sr=new xe("Sr","Strontium",38,!1,"#00FF00",1.95,2.49,0,88),ge.Y=new xe("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89),ge.Zr=new xe("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90),ge.Nb=new xe("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93),ge.Mo=new xe("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98),ge.Tc=new xe("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0),ge.Ru=new xe("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102),ge.Rh=new xe("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103),ge.Pd=new xe("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106),ge.Ag=new xe("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107),ge.Cd=new xe("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114),ge.In=new xe("In","Indium",49,!1,"#A67573",1.42,1.93,0,115),ge.Sn=new xe("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120),ge.Sb=new xe("Sb","Antimony",51,!1,"#9E63B5",1.39,2.06,3,121),ge.Te=new xe("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130),ge.I=new xe("I","Iodine",53,!0,"#940094",1.39,1.98,1,127),ge.Xe=new xe("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132),ge.Cs=new xe("Cs","Cesium",55,!1,"#57178F",2.44,3.43,0,133),ge.Ba=new xe("Ba","Barium",56,!1,"#00C900",2.15,2.68,0,138),ge.La=new xe("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139),ge.Ce=new xe("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140),ge.Pr=new xe("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,0,0,141),ge.Nd=new xe("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142),ge.Pm=new xe("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0),ge.Sm=new xe("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152),ge.Eu=new xe("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153),ge.Gd=new xe("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158),ge.Tb=new xe("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159),ge.Dy=new xe("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164),ge.Ho=new xe("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165),ge.Er=new xe("Er","Erbium",68,!1,"#00E675",1.89,0,0,166),ge.Tm=new xe("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169),ge.Yb=new xe("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174),ge.Lu=new xe("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175),ge.Hf=new xe("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180),ge.Ta=new xe("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181),ge.W=new xe("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184),ge.Re=new xe("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187),ge.Os=new xe("Os","Osmium",76,!1,"#266696",1.44,0,2,192),ge.Ir=new xe("Ir","Iridium",77,!1,"#175487",1.41,0,3,193),ge.Pt=new xe("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195),ge.Au=new xe("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197),ge.Hg=new xe("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202),ge.Tl=new xe("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205),ge.Pb=new xe("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208),ge.Bi=new xe("Bi","Bismuth",83,!1,"#9E4FB5",1.48,2.07,3,209),ge.Po=new xe("Po","Polonium",84,!1,"#AB5C00",1.4,1.97,2,0),ge.At=new xe("At","Astatine",85,!0,"#754F45",1.5,2.02,1,0),ge.Rn=new xe("Rn","Radon",86,!1,"#428296",1.5,2.2,0,0),ge.Fr=new xe("Fr","Francium",87,!1,"#420066",2.6,3.48,0,0),ge.Ra=new xe("Ra","Radium",88,!1,"#007D00",2.21,2.83,0,0),ge.Ac=new xe("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0),ge.Th=new xe("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232),ge.Pa=new xe("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231),ge.U=new xe("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238),ge.Np=new xe("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0),ge.Pu=new xe("Pu","Plutonium",94,!1,"#006BFF",1.87,0,0,0),ge.Am=new xe("Am","Americium",95,!1,"#545CF2",1.8,0,0,0),ge.Cm=new xe("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0),ge.Bk=new xe("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0),ge.Cf=new xe("Cf","Californium",98,!1,"#A136D4",0,0,0,0),ge.Es=new xe("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0),ge.Fm=new xe("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0),ge.Md=new xe("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0),ge.No=new xe("No","Nobelium",102,!1,"#BD0D87",0,0,0,0),ge.Lr=new xe("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0),ge.Rf=new xe("Rf","Rutherfordium",104,!1,"#CC0059",0,0,0,0),ge.Db=new xe("Db","Dubnium",105,!1,"#D1004F",0,0,0,0),ge.Sg=new xe("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0),ge.Bh=new xe("Bh","Bohrium",107,!1,"#E00038",0,0,0,0),ge.Hs=new xe("Hs","Hassium",108,!1,"#E6002E",0,0,0,0),ge.Mt=new xe("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0),ge.Ds=new xe("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0),ge.Rg=new xe("Rg","Roentgenium",111,!1,"#000000",0,0,0,0),ge.Cn=new xe("Cn","Copernicium",112,!1,"#000000",0,0,0,0),ge.Nh=new xe("Nh","Nihonium",113,!1,"#000000",0,0,0,0),ge.Fl=new xe("Fl","Flerovium",114,!1,"#000000",0,0,0,0),ge.Mc=new xe("Mc","Moscovium",115,!1,"#000000",0,0,0,0),ge.Lv=new xe("Lv","Livermorium",116,!1,"#000000",0,0,0,0),ge.Ts=new xe("Ts","Tennessine",117,!1,"#000000",0,0,0,0),ge.Og=new xe("Og","Oganesson",118,!1,"#000000",0,0,0,0),ge.H.pymolColor="#E6E6E6",ge.C.pymolColor="#33FF33",ge.N.pymolColor="#3333FF",ge.O.pymolColor="#FF4D4D",ge.F.pymolColor="#B3FFFF",ge.S.pymolColor="#E6C640",ge);function xe(t,e,i,n,r,s,o,a,h){this.symbol=t,this.name=e,this.atomicNumber=i,this.addH=n,this.jmolColor=this.pymolColor=r,this.covalentRadius=s,this.vdWRadius=o,this.valency=a,this.mass=h}var be,ye=((be=[]).Ala=new we("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0),be.Arg=new we("Arg","Arginine",!0,"#145AFF","#00007C",1),be.Asn=new we("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0),be.Asp=new we("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1),be.Cys=new we("Cys","Cysteine",!0,"#E6E600","#FFFF70",0),be.Gln=new we("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0),be.Glu=new we("Glu","Glutamic Acid",!0,"#E60A0A","#660000",-1),be.Gly=new we("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0),be.His=new we("His","Histidine",!0,"#8282D2","#7070FF",1),be.Ile=new we("Ile","Isoleucine",!1,"#0F820F","#004C00",0),be.Leu=new we("Leu","Leucine",!1,"#0F820F","#455E45",0),be.Lys=new we("Lys","Lysine",!0,"#145AFF","#4747B8",1),be.Met=new we("Met","Methionine",!1,"#E6E600","#B8A042",0),be.Phe=new we("Phe","Phenylalanine",!1,"#3232AA","#534C52",0),be.Pro=new we("Pro","Proline",!1,"#DC9682","#525252",0),be.Ser=new we("Ser","Serine",!0,"#FA9600","#FF7042",0),be.Thr=new we("Thr","Threonine",!0,"#FA9600","#B84C00",0),be.Trp=new we("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0),be.Tyr=new we("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0),be.Val=new we("Val","Valine",!1,"#0F820F","#FF8CFF",0),be.Asx=new we("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0),be.Glx=new we("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0),be["*"]=new we("*","Other",!1,"#BEA06E","#FF00FF",0),be.A=new we("A","Adenine",!1,"#BEA06E","#A0A0FF",0),be.G=new we("G","Guanine",!1,"#BEA06E","#FF7070",0),be.I=new we("I","",!1,"#BEA06E","#80FFFF",0),be.C=new we("C","Cytosine",!1,"#BEA06E","#FF8C4B",0),be.T=new we("T","Thymine",!1,"#BEA06E","#A0FFA0",0),be.U=new we("U","Uracil",!1,"#BEA06E","#FF8080",0),be);function we(t,e,i,n,r,s){this.symbol=t,this.name=e,this.polar=i,this.aminoColor=n,this.shapelyColor=r,this.acidity=s}var Te="#FFFFFF",De=1,Se=0,Ce=20,Ae=1.25,Ee=[-.1,-.1,-1],Fe="#FFFFFF",Re="#FFFFFF",Pe=!0,Be=45,Me=40,Ie=void 0,Le=.1,Ne=1e4,ke=!0,Oe=0,ze="#000000",Ue=0,He=1,je=1,qe=!1,We=.85,Ge=!1,Xe=!0,Ve=2.2,Ye="#885110",Ze="#0060B2",Qe="#c10000",$e="#00FF00",Je=!1,Ke=17,ti=32,ei=1,ni=!1,ri=1,si=.85,oi=.1,ai=1/16,hi=1/12,li=64,ui=.25,ci=1,fi=0,di=!0,mi="#000000",pi=12,gi=["Helvetica","Arial","Dialog"],vi=!1,_i=!1,xi=!1,bi=10,yi=1,wi=8,Ti=4,Di=1,Si=!1,Ci=!1,Ai=!0,Ei=!0,Fi=!1,Ri=!0,Pi=!0,Bi=!1,Mi=30,Ii=.8,Li=!1,Ni=1,ki="#000000",Oi="#555555",zi=32,Ui=!1,Hi=!1,ji=!0,qi="#000000",Wi=1,Gi=!0,Xi=.2,Vi=5,Yi="round",Zi=!1,Qi=!1,$i=de.PI/3,Ji=!1,Ki=!1,tn=.5,en=1,nn=6,rn=4,sn=1,on=2.5,an=2,hn=!1,ln=!1,un=30,cn=!1,fn=.3,dn=10,mn=20,pn=.3,gn=.1,vn=.3,_n="#000000",xn="#555555",bn=32,yn=!0,wn=!1,Tn=1.5,Dn="#CCCCCC",Sn=!1,Cn=!1,An="none",En="#FF0D0D",Fn="#FFFF30",Rn="#00E740",Pn="#9905FF",Bn="#E8BB99",Mn="#FF0D0D",In=15,Ln=.2,Nn=.5,kn=3.5,On=4,zn=8,Un=8,Hn="#000000",jn="#555555",qn=32,Wn=!0,Gn="#CCCCCC",Xn="#C10000",Vn="none",Yn=1.5,Zn=15,Qn=8,$n="#000000",Jn="#555555",Kn=32,tr=!1,er=!1,ir=-1,nr=!1,rr=!1,sr=["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],or=!0,ar=.5,hr="Solid",lr="white",ur="#000000",cr="#000000",fr=32,dr="#000000",mr=1,pr=!1,gr="#c10000",vr=1,_r=!1,xr="gray",br=.5,yr=!0,wr=!1,Tr=12,Dr=["Helvetica","Arial","Dialog"],Sr=!0,Cr=!1,Ar=!0,Er="#000000",Fr="#000000",Rr=1,Pr=2,Br=8,Mr=!1,Ir="#FF0000",Lr="#00FF00",Nr="#0000FF",kr=50,Or=10,zr=!0,Ur=0,Hr=!1,jr=10,qr=!0,Wr=new R;function Gr(t){var e;try{e=JSON.parse(t)}catch(t){return}if(e)return e.m||e.s?Wr.contentFrom(e):e.a?{molecules:[Wr.molFrom(e)],shapes:[]}:{molecules:[],shapes:[]}}function Xr(t,e){return JSON.stringify(Wr.contentTo(t,e))}var Vr=void 0,Yr=Math;function Zr(t,e,i,n){this.label=t?t.replace(/\s/g,""):"C",this.x=e||0,this.y=i||0,this.z=n||0}var Qr=Zr.prototype=new P(0,0);Qr.charge=0,Qr.numLonePair=0,Qr.numRadical=0,Qr.mass=-1,Qr.implicitH=-1,Qr.coordinationNumber=0,Qr.bondNumber=0,Qr.angleOfLeastInterference=0,Qr.isHidden=!1,Qr.altLabel=void 0,Qr.isLone=!1,Qr.isHover=!1,Qr.isSelected=!1,Qr.add3D=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},Qr.sub3D=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},Qr.distance3D=function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Yr.sqrt(e*e+i*i+n*n)},Qr.draw=function(t,e){if(!this.dontDraw){if(this.isLassoed){var i=t.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);i.addColorStop(0,"rgba(212, 99, 0, 0)"),i.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),t.fillStyle=i,t.beginPath(),t.arc(this.x,this.y,5,0,2*Yr.PI,!1),t.fill()}if(!this.query){this.textBounds=[],this.specs&&(e=this.specs);var n,r=F(e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);t.font=r,t.fillStyle=this.getElementColor(e.atoms_useJMOLColors,e.atoms_usePYMOLColors,e.atoms_color,2),"H"===this.label&&e.atoms_HBlack_2D&&(t.fillStyle="black"),this.error&&(t.fillStyle=e.colorError);var s=this.isLabelVisible(e);if(this.isLone&&!s||e.atoms_circles_2D)this.isLone&&(t.fillStyle="#909090"),t.beginPath(),t.arc(this.x,this.y,e.atoms_circleDiameter_2D/2,0,2*Yr.PI,!1),t.fill(),0<e.atoms_circleBorderWidth_2D&&(t.lineWidth=e.atoms_circleBorderWidth_2D,t.strokeStyle="black",t.stroke());else if(s)if(t.textAlign="center",t.textBaseline="middle",void 0!==this.altLabel){t.fillText(this.altLabel,this.x,this.y);var o=t.measureText(this.altLabel).width;this.textBounds.push({x:this.x-o/2,y:this.y-e.atoms_font_size_2D/2+1,w:o,h:e.atoms_font_size_2D-2})}else if(_e[this.label]){t.fillText(this.label,this.x,this.y);o=t.measureText(this.label).width;this.textBounds.push({x:this.x-o/2,y:this.y-e.atoms_font_size_2D/2+1,w:o,h:e.atoms_font_size_2D-2});var a=0;if(-1!==this.mass){var h=t.font;t.font=F(.7*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D),a=t.measureText(this.mass).width,t.fillText(this.mass,this.x-a-.5,this.y-e.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-o/2-a-.5,y:this.y-1.7*e.atoms_font_size_2D/2+1,w:a,h:e.atoms_font_size_2D/2-1}),t.font=h}var l=o/2,u=this.getImplicitHydrogenCount();if(e.atoms_implicitHydrogens_2D&&0<u){n=0;var c=t.measureText("H").width,f=!0;if(1<u){var d=o/2+c/2,m=0,p=F(.8*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);t.font=p;var g=t.measureText(u).width;1===this.bondNumber?this.angleOfLeastInterference>Yr.PI/2&&this.angleOfLeastInterference<3*Yr.PI/2&&(d=-o/2-g-c/2-a/2,f=!1,n=Yr.PI):this.angleOfLeastInterference<=Yr.PI/4||(this.angleOfLeastInterference<3*Yr.PI/4?(d=0,m=.9*-e.atoms_font_size_2D,0!==this.charge&&(m-=.3*e.atoms_font_size_2D),f=!1,n=Yr.PI/2):this.angleOfLeastInterference<=5*Yr.PI/4?(d=-o/2-g-c/2-a/2,f=!1,n=Yr.PI):this.angleOfLeastInterference<7*Yr.PI/4&&(d=0,m=.9*e.atoms_font_size_2D,f=!1,n=3*Yr.PI/2)),t.font=r,t.fillText("H",this.x+d,this.y+m),t.font=p,t.fillText(u,this.x+d+c/2+g/2,this.y+m+.3*e.atoms_font_size_2D),this.textBounds.push({x:this.x+d-c/2,y:this.y+m-e.atoms_font_size_2D/2+1,w:c,h:e.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+d+c/2,y:this.y+m+.3*e.atoms_font_size_2D-e.atoms_font_size_2D/2+1,w:g,h:.8*e.atoms_font_size_2D-2})}else{d=o/2+c/2,m=0;1===this.bondNumber?this.angleOfLeastInterference>Yr.PI/2&&this.angleOfLeastInterference<3*Yr.PI/2&&(d=-o/2-c/2-a/2,f=!1,n=Yr.PI):this.angleOfLeastInterference<=Yr.PI/4||(this.angleOfLeastInterference<3*Yr.PI/4?(d=0,m=.9*-e.atoms_font_size_2D,f=!1,n=Yr.PI/2):this.angleOfLeastInterference<=5*Yr.PI/4?(d=-o/2-c/2-a/2,f=!1,n=Yr.PI):this.angleOfLeastInterference<7*Yr.PI/4&&(d=0,m=.9*e.atoms_font_size_2D,f=!1,n=3*Yr.PI/2)),t.fillText("H",this.x+d,this.y+m),this.textBounds.push({x:this.x+d-c/2,y:this.y+m-e.atoms_font_size_2D/2+1,w:c,h:e.atoms_font_size_2D-2})}f&&(l+=c)}if(0!==this.charge){var v=this.charge.toFixed(0);"1"===v?v="+":"-1"===v?v="":E(v,"-")?v=v.substring(1)+"":v+="+";var _=t.measureText(v).width;l+=_/2,t.textAlign="center",t.textBaseline="middle",t.font=F(Yr.floor(.8*e.atoms_font_size_2D),e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D),t.fillText(v,this.x+l-1,this.y-e.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+l-_/2-1,y:this.y-1.8*e.atoms_font_size_2D/2+5,w:_,h:e.atoms_font_size_2D/2-1})}}else if(Vr)this.condensed&&this.condensed.text===this.label||(this.condensed=new Vr(this,this.label)),this.condensed.draw(t,e);else{t.fillText(this.label,this.x,this.y);var o=t.measureText(this.label).width;this.textBounds.push({x:this.x-o/2,y:this.y-e.atoms_font_size_2D/2+1,w:o,h:e.atoms_font_size_2D-2})}if(0<this.numLonePair||0<this.numRadical){t.fillStyle="black";var x=this.angles.slice(0),b=this.angleOfLeastInterference,y=this.largestAngle;if(void 0!==n){x.push(n),x.sort(function(t,e){return t-e});var w=q(x);b=w.angle%(2*Yr.PI),y=w.largest}for(var T=[],D=0;D<this.numLonePair;D++)T.push({t:2});for(D=0;D<this.numRadical;D++)T.push({t:1});if(void 0===n&&Yr.abs(y-2*Yr.PI/x.length)<Yr.PI/60)for(var S=Yr.ceil(T.length/x.length),C=(D=0,T.length);D<C;D+=S,b+=y)this.drawElectrons(t,e,T.slice(D,Yr.min(T.length,D+S)),b,y,n);else this.drawElectrons(t,e,T,b,y,n)}}}},Qr.drawElectrons=function(t,e,i,n,r,s){for(var o=r/(i.length+(0===this.bonds.length&&void 0===s?0:1)),a=n-r/2+o,h=0;h<i.length;h++){var l=i[h],u=(n=a+h*o,this.x+Math.cos(n)*e.atoms_lonePairDistance_2D),c=this.y-Math.sin(n)*e.atoms_lonePairDistance_2D;if(2===l.t){var f=n+Math.PI/2,d=Math.cos(f)*e.atoms_lonePairSpread_2D/2,m=-Math.sin(f)*e.atoms_lonePairSpread_2D/2;t.beginPath(),t.arc(u+d,c+m,e.atoms_lonePairDiameter_2D,0,2*Yr.PI,!1),t.fill(),t.beginPath(),t.arc(u-d,c-m,e.atoms_lonePairDiameter_2D,0,2*Yr.PI,!1),t.fill()}else 1===l.t&&(t.beginPath(),t.arc(u,c,e.atoms_lonePairDiameter_2D,0,2*Yr.PI,!1),t.fill())}},Qr.drawDecorations=function(t,e){if(this.isHover||this.isSelected){t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1.2,t.beginPath();var i=this.isHover?7:15;t.arc(this.x,this.y,i,0,2*Yr.PI,!1),t.stroke()}this.isOverlap&&(t.strokeStyle=e.colorError,t.lineWidth=1.2,t.beginPath(),t.arc(this.x,this.y,7,0,2*Yr.PI,!1),t.stroke())},Qr.render=function(t,e,i){this.specs&&(e=this.specs);var n=L.mat4.translate(L.mat4.identity(),[this.x,this.y,this.z]),r=e.atoms_useVDWDiameters_3D?_e[this.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D/2;if(0===r&&(r=1),L.mat4.scale(n,[r,r,r]),!i){var s=e.atoms_color;e.atoms_useJMOLColors?s=_e[this.label].jmolColor:e.atoms_usePYMOLColors&&(s=_e[this.label].pymolColor),t.material.setDiffuseColor(t,s)}t.shader.setMatrixUniforms(t,n);var o=this.renderAsStar?t.starBuffer:t.sphereBuffer;t.drawElements(t.TRIANGLES,o.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},Qr.renderHighlight=function(t,e){if(this.isSelected||this.isHover){this.specs&&(e=this.specs);var i=L.mat4.translate(L.mat4.identity(),[this.x,this.y,this.z]),n=e.atoms_useVDWDiameters_3D?_e[this.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D/2;0===n&&(n=1),n*=1.3,L.mat4.scale(i,[n,n,n]),t.shader.setMatrixUniforms(t,i),t.material.setDiffuseColor(t,this.isHover?e.colorHover:e.colorSelect);var r=this.renderAsStar?t.starBuffer:t.sphereBuffer;t.drawElements(t.TRIANGLES,r.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}},Qr.isLabelVisible=function(t){return!!t.atoms_displayAllCarbonLabels_2D||("C"!==this.label||(!(!this.altLabel&&_e[this.label])||(-1!==this.mass||-1!==this.implicitH||0!==this.charge||(!(!t.atoms_showAttributedCarbons_2D||0===this.numRadical&&0===this.numLonePair)||(!(!this.isHidden||!t.atoms_showHiddenCarbons_2D)||!(!t.atoms_displayTerminalCarbonLabels_2D||1!==this.bondNumber))))))},Qr.getImplicitHydrogenCount=function(){if(!_e[this.label]||!_e[this.label].addH)return 0;if(-1!==this.implicitH)return this.implicitH;if("H"===this.label)return 0;var t=_e[this.label].valency,e=t-this.coordinationNumber;if(0<this.numRadical&&(e=Yr.max(0,e-this.numRadical)),0<this.charge){var i=4-t;this.charge<=i?e+=this.charge:e=4-this.coordinationNumber-this.charge+i}else e+=this.charge;return e<0?0:Yr.floor(e)},Qr.getBounds=function(){var t=new z;if(t.expand(this.x,this.y),this.textBounds)for(var e=0,i=this.textBounds.length;e<i;e++){var n=this.textBounds[e];t.expand(n.x,n.y,n.x+n.w,n.y+n.h)}return t},Qr.getBounds3D=function(){var t=new z;return t.expand3D(this.x,this.y,this.z),t},Qr.getElementColor=function(t,e,i){return _e[this.label]?(t?i=_e[this.label].jmolColor:e&&(i=_e[this.label].pymolColor),i):"#000"};var $r=Math;function Jr(t,e,i){this.a1=t,this.a2=e,this.bondOrder=void 0!==i?i:1}Jr.STEREO_NONE="none",Jr.STEREO_PROTRUDING="protruding",Jr.STEREO_RECESSED="recessed",Jr.STEREO_AMBIGUOUS="ambiguous";var Kr=Jr.prototype;Kr.stereo=Jr.STEREO_NONE,Kr.isHover=!1,Kr.ring=void 0,Kr.getCenter=function(){return new P((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},Kr.getLength=function(){return this.a1.distance(this.a2)},Kr.getLength3D=function(){return this.a1.distance3D(this.a2)},Kr.contains=function(t){return t===this.a1||t===this.a2},Kr.getNeighbor=function(t){return t===this.a1?this.a2:t===this.a2?this.a1:void 0},Kr.draw=function(t,e){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.specs&&(e=this.specs);var i=this.a1.x,n=this.a2.x,r=this.a1.y,s=this.a2.y,o=this.a1.distance(this.a2),a=n-i,h=s-r;if(this.a1.isLassoed&&this.a2.isLassoed){var l=t.createLinearGradient(i,r,n,s);l.addColorStop(0,"rgba(212, 99, 0, 0)"),l.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),l.addColorStop(1,"rgba(212, 99, 0, 0)");var u=2.5,c=this.a1.angle(this.a2)+$r.PI/2,f=i-(Z=$r.cos(c))*u,d=r+(Q=$r.sin(c))*u,m=i+Z*u,p=r-Q*u,g=n+Z*u,v=s-Q*u,_=n-Z*u,x=s+Q*u;t.fillStyle=l,t.beginPath(),t.moveTo(f,d),t.lineTo(m,p),t.lineTo(g,v),t.lineTo(_,x),t.closePath(),t.fill()}if(e.atoms_display&&!e.atoms_circles_2D&&this.a1.isLabelVisible(e)&&this.a1.textBounds){for(var b=0,y=0,w=this.a1.textBounds.length;y<w;y++)b=Math.max(b,rt(this.a1,this.a2,this.a1.textBounds[y]));i+=a*(T=(b+=e.bonds_atomLabelBuffer_2D)/o),r+=h*T}if(e.atoms_display&&!e.atoms_circles_2D&&this.a2.isLabelVisible(e)&&this.a2.textBounds){for(b=0,y=0,w=this.a2.textBounds.length;y<w;y++)b=Math.max(b,rt(this.a2,this.a1,this.a2.textBounds[y]));var T;n-=a*(T=(b+=e.bonds_atomLabelBuffer_2D)/o),s-=h*T}if(e.bonds_clearOverlaps_2D){var D=i+.15*a,S=r+.15*h,C=n-.15*a,A=s-.15*h;t.strokeStyle=e.backgroundColor,t.lineWidth=e.bonds_width_2D+2*e.bonds_overlapClearWidth_2D,t.lineCap="round",t.beginPath(),t.moveTo(D,S),t.lineTo(C,A),t.closePath(),t.stroke()}if(t.strokeStyle=this.error?e.colorError:e.bonds_color,t.fillStyle=this.error?e.colorError:e.bonds_color,t.lineWidth=e.bonds_width_2D,t.lineCap=e.bonds_ends_2D,e.bonds_splitColor){var E=t.createLinearGradient(i,r,n,s),F=this.a1.specs?this.a1.specs:e,R=this.a2.specs?this.a2.specs:e,P=this.a1.getElementColor(F.atoms_useJMOLColors,F.atoms_usePYMOLColors,F.atoms_color,2),B=this.a2.getElementColor(R.atoms_useJMOLColors,R.atoms_usePYMOLColors,R.atoms_color,2);E.addColorStop(0,P),e.bonds_colorGradient||(E.addColorStop(.5,P),E.addColorStop(.51,B)),E.addColorStop(1,B),t.strokeStyle=E,t.fillStyle=E}if(e.bonds_lewisStyle_2D&&this.bondOrder%1==0)this.drawLewisStyle(t,e,i,r,n,s);else switch(this.query?1:this.bondOrder){case 0:var M=n-i,I=s-r,L=$r.sqrt(M*M+I*I),N=$r.floor(L/e.bonds_dotSize_2D),k=(L-(N-1)*e.bonds_dotSize_2D)/2;N%2==1?k+=e.bonds_dotSize_2D/4:(k-=e.bonds_dotSize_2D/4,N+=2),N/=2;var O=this.a1.angle(this.a2);D=i+k*Math.cos(O),S=r-k*Math.sin(O);t.beginPath();for(y=0;y<N;y++)t.arc(D,S,e.bonds_dotSize_2D/2,0,2*$r.PI,!1),D+=2*e.bonds_dotSize_2D*Math.cos(O),S-=2*e.bonds_dotSize_2D*Math.sin(O);t.fill();break;case.5:t.beginPath(),t.moveTo(i,r),t.lineTo(n,s),t.setLineDash([e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([]);break;case 1:if(this.query||this.stereo!==Jr.STEREO_PROTRUDING&&this.stereo!==Jr.STEREO_RECESSED){if(!this.query&&this.stereo===Jr.STEREO_AMBIGUOUS){t.beginPath(),t.moveTo(i,r);var z,U,H,j,q=$r.floor($r.sqrt(a*a+h*h)/e.bonds_wavyLength_2D),W=i,G=r,X=(c=this.a1.angle(this.a2)+$r.PI/2,Z=$r.cos(c),Q=$r.sin(c),a/q),V=h/q;for(y=0,w=q;y<w;y++)W+=X,G+=V,z=e.bonds_wavyLength_2D*Z+W-.5*X,H=e.bonds_wavyLength_2D*-Q+G-.5*V,U=e.bonds_wavyLength_2D*-Z+W-.5*X,j=e.bonds_wavyLength_2D*Q+G-.5*V,y%2==0?t.quadraticCurveTo(z,H,W,G):t.quadraticCurveTo(U,j,W,G);t.stroke();break}t.beginPath(),t.moveTo(i,r),t.lineTo(n,s),t.stroke(),this.query&&this.query.draw(t,e,this.getCenter())}else{var Y=e.bonds_width_2D/2,c=(u=e.bonds_wedgeThickness_2D/2,this.a1.angle(this.a2)+$r.PI/2);f=i-(Z=$r.cos(c))*Y,d=r+(Q=$r.sin(c))*Y,m=i+Z*Y,p=r-Q*Y,g=n+Z*u,v=s-Q*u,_=n-Z*u,x=s+Q*u;if(t.beginPath(),t.moveTo(f,d),t.lineTo(m,p),t.lineTo(g,v),t.lineTo(_,x),t.closePath(),this.stereo===Jr.STEREO_PROTRUDING)t.fill();else{t.save(),t.clip(),t.lineWidth=2*u,t.lineCap="butt",t.beginPath(),t.moveTo(i,r);M=n-i,I=s-r;t.lineTo(n+5*M,s+5*I),t.setLineDash([e.bonds_hashWidth_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([]),t.restore()}}break;case 1.5:case 2:c=(O=this.a1.angle(this.a2))+$r.PI/2;var Z=$r.cos(c),Q=$r.sin(c);o=this.a1.distance(this.a2),u=e.bonds_useAbsoluteSaturationWidths_2D?e.bonds_saturationWidthAbs_2D/2:o*e.bonds_saturationWidth_2D/2;if(this.stereo===Jr.STEREO_AMBIGUOUS){f=i-Z*u,d=r+Q*u,m=i+Z*u,p=r-Q*u,g=n+Z*u,v=s-Q*u,_=n-Z*u,x=s+Q*u;t.beginPath(),t.moveTo(f,d),t.lineTo(g,v),t.moveTo(m,p),t.lineTo(_,x),t.stroke()}else if(!e.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)){t.beginPath(),t.moveTo(i,r),t.lineTo(n,s),t.stroke();var $=0;u*=2;var J=e.bonds_saturationAngle_2D;if(J<$r.PI/2&&($=-u/$r.tan(J)),$r.abs($)<o/2){var K=i-$r.cos(O)*$,tt=n+$r.cos(O)*$,et=r+$r.sin(O)*$,it=s-$r.sin(O)*$,nt=(f=K-Z*u,d=et+Q*u,m=K+Z*u,p=et-Q*u,g=tt-Z*u,v=it+Q*u,_=tt+Z*u,x=it-Q*u,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>$r.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-$r.PI);t.beginPath(),nt?(t.moveTo(f,d),t.lineTo(g,v)):(t.moveTo(m,p),t.lineTo(_,x)),2!==this.bondOrder&&t.setLineDash([e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([])}}else{f=i-Z*u,d=r+Q*u,m=i+Z*u,p=r-Q*u,g=n+Z*u,v=s-Q*u,_=n-Z*u,x=s+Q*u;t.beginPath(),t.moveTo(f,d),t.lineTo(_,x),t.stroke(),t.beginPath(),t.moveTo(m,p),t.lineTo(g,v),2!==this.bondOrder&&t.setLineDash([e.bonds_hashWidth_2D,e.bonds_hashSpacing_2D]),t.stroke(),t.setLineDash([])}break;case 3:u=e.bonds_useAbsoluteSaturationWidths_2D?e.bonds_saturationWidthAbs_2D:this.a1.distance(this.a2)*e.bonds_saturationWidth_2D,c=this.a1.angle(this.a2)+$r.PI/2,f=i-(Z=$r.cos(c))*u,d=r+(Q=$r.sin(c))*u,m=i+Z*u,p=r-Q*u,g=n+Z*u,v=s-Q*u,_=n-Z*u,x=s+Q*u;t.beginPath(),t.moveTo(f,d),t.lineTo(_,x),t.moveTo(m,p),t.lineTo(g,v),t.moveTo(i,r),t.lineTo(n,s),t.stroke()}}},Kr.drawDecorations=function(t,e){if(this.isHover||this.isSelected){var i=2*$r.PI,n=(this.a1.angleForStupidCanvasArcs(this.a2)+$r.PI/2)%i;t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1.2,t.beginPath();var r=(n+$r.PI)%i;r%=2*$r.PI,t.arc(this.a1.x,this.a1.y,7,n,r,!1),t.stroke(),t.beginPath(),r=((n+=$r.PI)+$r.PI)%i,t.arc(this.a2.x,this.a2.y,7,n,r,!1),t.stroke()}},Kr.drawLewisStyle=function(t,e,i,n,r,s){for(var o=this.a1.angle(this.a2),a=o+$r.PI/2,h=r-i,l=s-n,u=$r.sqrt(h*h+l*l)/(this.bondOrder+1),c=u*$r.cos(o),f=-u*$r.sin(o),d=i+c,m=n+f,p=0;p<this.bondOrder;p++){var g=e.atoms_lonePairSpread_2D/2,v=d-$r.cos(a)*g,_=m+$r.sin(a)*g,x=d+$r.cos(a)*g,b=m-$r.sin(a)*g;t.beginPath(),t.arc(v-e.atoms_lonePairDiameter_2D/2,_-e.atoms_lonePairDiameter_2D/2,e.atoms_lonePairDiameter_2D,0,2*$r.PI,!1),t.fill(),t.beginPath(),t.arc(x-e.atoms_lonePairDiameter_2D/2,b-e.atoms_lonePairDiameter_2D/2,e.atoms_lonePairDiameter_2D,0,2*$r.PI,!1),t.fill(),d+=c,m+=f}},Kr.render=function(t,e,i){this.specs&&(e=this.specs);var n=this.a1.distance3D(this.a2);if(0!==n){var r,s,o,a=e.bonds_cylinderDiameter_3D/2,h=e.bonds_color,l=L.mat4.translate(L.mat4.identity(),[this.a1.x,this.a1.y,this.a1.z]),u=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],c=[0,1,0],f=0;if(this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(o=[0,0,1],this.a2.y<this.a1.y&&(f=$r.PI)):(f=N(c,u),o=L.vec3.cross(c,u,[])),e.bonds_splitColor){var d=this.a1.specs?this.a1.specs:e,m=this.a2.specs?this.a2.specs:e;(h=this.a1.getElementColor(d.atoms_useJMOLColors,d.atoms_usePYMOLColors,d.atoms_color))!=(r=this.a2.getElementColor(m.atoms_useJMOLColors,m.atoms_usePYMOLColors,m.atoms_color))&&(s=L.mat4.translate(L.mat4.identity(),[this.a2.x,this.a2.y,this.a2.z]))}var p,g=[0];if(i){if(e.bonds_showBondOrders_3D&&1<this.bondOrder){g=[e.bonds_cylinderDiameter_3D];var v=[0,0,1],_=L.mat4.inverse(t.rotationMatrix,[]);L.mat4.multiplyVec3(_,v),p=L.vec3.cross(u,v,[]),L.vec3.normalize(p)}var x=1,b=e.bonds_pillSpacing_3D,y=e.bonds_pillHeight_3D;0==this.bondOrder&&(e.bonds_renderAsLines_3D?y=b:((y=e.bonds_pillDiameter_3D)<e.bonds_cylinderDiameter_3D&&(y/=2),n/=x=y/2,b/=x/2));var w=y+b,T=n/w,D=$r.floor(T),S=n-w*D,C=(b+e.bonds_pillDiameter_3D+S)/2,A=D;s&&(A=$r.floor(D/2));for(var E=0,F=g.length;E<F;E++){var R=L.mat4.set(l,[]);0!==g[E]&&L.mat4.translate(R,L.vec3.scale(p,g[E],[])),0!==f&&L.mat4.rotate(R,f,o),1!=x&&L.mat4.scale(R,[x,x,x]),h&&t.material.setDiffuseColor(t,h),L.mat4.translate(R,[0,C,0]);for(var P=0;P<A;P++)e.bonds_renderAsLines_3D?0==this.bondOrder?(t.shader.setMatrixUniforms(t,R),t.drawArrays(t.POINTS,0,1)):(L.mat4.scale(R,[1,y,1]),t.shader.setMatrixUniforms(t,R),t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems),L.mat4.scale(R,[1,1/y,1])):(t.shader.setMatrixUniforms(t,R),0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)),L.mat4.translate(R,[0,w,0]);if(s){var B,M;M=e.bonds_renderAsLines_3D?(B=y,B/=2,0):(1-(B=2/3))/2,D%2!=0&&(L.mat4.scale(R,[1,B,1]),t.shader.setMatrixUniforms(t,R),e.bonds_renderAsLines_3D?0==this.bondOrder?t.drawArrays(t.POINTS,0,1):t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0),L.mat4.translate(R,[0,w*(1+M),0]),L.mat4.scale(R,[1,1/B,1])),L.mat4.set(s,R),0!==g[E]&&L.mat4.translate(R,L.vec3.scale(p,g[E],[])),L.mat4.rotate(R,f+$r.PI,o),1!=x&&L.mat4.scale(R,[x,x,x]),r&&t.material.setDiffuseColor(t,r),L.mat4.translate(R,[0,C,0]);for(P=0;P<A;P++)e.bonds_renderAsLines_3D?0==this.bondOrder?(t.shader.setMatrixUniforms(t,R),t.drawArrays(t.POINTS,0,1)):(L.mat4.scale(R,[1,y,1]),t.shader.setMatrixUniforms(t,R),t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems),L.mat4.scale(R,[1,1/y,1])):(t.shader.setMatrixUniforms(t,R),0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)),L.mat4.translate(R,[0,w,0]);D%2!=0&&(L.mat4.scale(R,[1,B,1]),t.shader.setMatrixUniforms(t,R),e.bonds_renderAsLines_3D?0==this.bondOrder?t.drawArrays(t.POINTS,0,1):t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0):t.drawElements(t.TRIANGLES,t.pillBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0),L.mat4.translate(R,[0,w*(1+M),0]),L.mat4.scale(R,[1,1/B,1]))}}}else{if(e.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:g=[-e.bonds_cylinderDiameter_3D];break;case 2:g=[-e.bonds_cylinderDiameter_3D,e.bonds_cylinderDiameter_3D];break;case 3:g=[-1.2*e.bonds_cylinderDiameter_3D,0,1.2*e.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){v=[0,0,1],_=L.mat4.inverse(t.rotationMatrix,[]);L.mat4.multiplyVec3(_,v),p=L.vec3.cross(u,v,[]),L.vec3.normalize(p)}}else switch(this.bondOrder){case 0:a*=.25;break;case.5:case 1.5:a*=.5}s&&(n/=2);var I=[a,n,a];for(E=0,F=g.length;E<F;E++){R=L.mat4.set(l,[]);0!==g[E]&&L.mat4.translate(R,L.vec3.scale(p,g[E],[])),0!==f&&L.mat4.rotate(R,f,o),L.mat4.scale(R,I),h&&t.material.setDiffuseColor(t,h),t.shader.setMatrixUniforms(t,R),e.bonds_renderAsLines_3D?t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems),s&&(L.mat4.set(s,R),0!==g[E]&&L.mat4.translate(R,L.vec3.scale(p,g[E],[])),L.mat4.rotate(R,f+$r.PI,o),L.mat4.scale(R,I),r&&t.material.setDiffuseColor(t,r),t.shader.setMatrixUniforms(t,R),e.bonds_renderAsLines_3D?t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems))}}}},Kr.renderHighlight=function(t,e){if(this.isSelected||this.isHover){this.specs&&(e=this.specs),this.specs&&(e=this.specs);var i=this.a1.distance3D(this.a2);if(0===i)return;var n,r=e.bonds_cylinderDiameter_3D/1.2,s=L.mat4.translate(L.mat4.identity(),[this.a1.x,this.a1.y,this.a1.z]),o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[0,1,0],h=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(n=[0,0,1],this.a2.y<this.a1.y&&(h=$r.PI)):(h=N(a,o),n=L.vec3.cross(a,o,[]));var l=[r,i,r];0!==h&&L.mat4.rotate(s,h,n),L.mat4.scale(s,l),t.shader.setMatrixUniforms(t,s),t.material.setDiffuseColor(t,this.isHover?e.colorHover:e.colorSelect),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems)}},Kr.renderPicker=function(t,e){this.specs&&(e=this.specs);var i=this.a1.distance3D(this.a2);if(0!==i){var n,r=e.bonds_cylinderDiameter_3D/2,s=L.mat4.translate(L.mat4.identity(),[this.a1.x,this.a1.y,this.a1.z]),o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[0,1,0],h=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(n=[0,0,1],this.a2.y<this.a1.y&&(h=$r.PI)):(h=N(a,o),n=L.vec3.cross(a,o,[]));var l,u=[0];if(e.bonds_showBondOrders_3D)if(e.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:u=[-e.bonds_cylinderDiameter_3D,e.bonds_cylinderDiameter_3D];break;case 3:u=[-1.2*e.bonds_cylinderDiameter_3D,0,1.2*e.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){var c=[0,0,1],f=L.mat4.inverse(t.rotationMatrix,[]);L.mat4.multiplyVec3(f,c),l=L.vec3.cross(o,c,[]),L.vec3.normalize(l)}}else switch(this.bondOrder){case 1.5:case 2:r*=3;break;case 3:r*=3.4}else switch(this.bondOrder){case 0:r*=.25;break;case.5:case 1.5:r*=.5}for(var d=[r,i,r],m=0,p=u.length;m<p;m++){var g=L.mat4.set(s,[]);0!==u[m]&&L.mat4.translate(g,L.vec3.scale(l,u[m],[])),0!==h&&L.mat4.rotate(g,h,n),L.mat4.scale(g,d),t.shader.setMatrixUniforms(t,g),e.bonds_renderAsLines_3D?t.drawArrays(t.LINES,0,t.lineBuffer.vertexPositionBuffer.numItems):t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems)}}};var ts,es=Math,is=-1;function ns(t){this.resSeq=t}var rs=ns.prototype;function os(){this.backgroundColor=Te,this.scale=De,this.rotateAngle=Se,this.bondLength_2D=Ce,this.angstromsPerBondLength=Ae,this.lightDirection_3D=Ee.slice(0),this.lightDiffuseColor_3D=Fe,this.lightSpecularColor_3D=Re,this.projectionPerspective_3D=Pe,this.projectionPerspectiveVerticalFieldOfView_3D=Be,this.projectionOrthoWidth_3D=Me,this.projectionWidthHeightRatio_3D=Ie,this.projectionFrontCulling_3D=Le,this.projectionBackCulling_3D=Ne,this.cullBackFace_3D=ke,this.fog_mode_3D=Oe,this.fog_color_3D=ze,this.fog_start_3D=Ue,this.fog_end_3D=He,this.fog_density_3D=je,this.shadow_3D=qe,this.shadow_intensity_3D=We,this.flat_color_3D=Ge,this.antialias_3D=Xe,this.gammaCorrection_3D=Ve,this.colorHover=Ye,this.colorSelect=Ze,this.colorError=Qe,this.colorPreview=$e,this.ssao_3D=Je,this.ssao_kernel_radius=Ke,this.ssao_kernel_samples=ti,this.ssao_power=ei,this.outline_3D=ni,this.outline_normal_threshold=si,this.outline_depth_threshold=oi,this.outline_thickness=ri,this.fxaa_edgeThreshold=ai,this.fxaa_edgeThresholdMin=hi,this.fxaa_searchSteps=li,this.fxaa_searchThreshold=ui,this.fxaa_subpixCap=ci,this.fxaa_subpixTrim=fi,this.atoms_display=di,this.atoms_color=mi,this.atoms_font_size_2D=pi,this.atoms_font_families_2D=gi.slice(0),this.atoms_font_bold_2D=vi,this.atoms_font_italic_2D=_i,this.atoms_circles_2D=xi,this.atoms_circleDiameter_2D=bi,this.atoms_circleBorderWidth_2D=yi,this.atoms_lonePairDistance_2D=wi,this.atoms_lonePairSpread_2D=Ti,this.atoms_lonePairDiameter_2D=Di,this.atoms_useJMOLColors=Si,this.atoms_usePYMOLColors=Ci,this.atoms_HBlack_2D=Ai,this.atoms_implicitHydrogens_2D=Ei,this.atoms_displayTerminalCarbonLabels_2D=Fi,this.atoms_showHiddenCarbons_2D=Ri,this.atoms_showAttributedCarbons_2D=Pi,this.atoms_displayAllCarbonLabels_2D=Bi,this.atoms_resolution_3D=Mi,this.atoms_sphereDiameter_3D=Ii,this.atoms_useVDWDiameters_3D=Li,this.atoms_vdwMultiplier_3D=Ni,this.atoms_materialAmbientColor_3D=ki,this.atoms_materialSpecularColor_3D=Oi,this.atoms_materialShininess_3D=zi,this.atoms_nonBondedAsStars_3D=Ui,this.atoms_displayLabels_3D=Hi,this.bonds_display=ji,this.bonds_color=qi,this.bonds_width_2D=Wi,this.bonds_useAbsoluteSaturationWidths_2D=Gi,this.bonds_saturationWidth_2D=Xi,this.bonds_saturationWidthAbs_2D=Vi,this.bonds_ends_2D=Yi,this.bonds_splitColor=Zi,this.bonds_colorGradient=Qi,this.bonds_saturationAngle_2D=$i,this.bonds_symmetrical_2D=Ji,this.bonds_clearOverlaps_2D=Ki,this.bonds_overlapClearWidth_2D=tn,this.bonds_atomLabelBuffer_2D=en,this.bonds_wedgeThickness_2D=nn,this.bonds_wavyLength_2D=rn,this.bonds_hashWidth_2D=sn,this.bonds_hashSpacing_2D=on,this.bonds_dotSize_2D=an,this.bonds_lewisStyle_2D=hn,this.bonds_showBondOrders_3D=ln,this.bonds_resolution_3D=un,this.bonds_renderAsLines_3D=cn,this.bonds_cylinderDiameter_3D=fn,this.bonds_pillHeight_3D=pn,this.bonds_pillLatitudeResolution_3D=dn,this.bonds_pillLongitudeResolution_3D=mn,this.bonds_pillSpacing_3D=gn,this.bonds_pillDiameter_3D=vn,this.bonds_materialAmbientColor_3D=_n,this.bonds_materialSpecularColor_3D=xn,this.bonds_materialShininess_3D=bn,this.proteins_displayRibbon=yn,this.proteins_displayBackbone=wn,this.proteins_backboneThickness=Tn,this.proteins_backboneColor=Dn,this.proteins_ribbonCartoonize=Sn,this.proteins_residueColor=An,this.proteins_primaryColor=En,this.proteins_secondaryColor=Fn,this.proteins_ribbonCartoonHelixPrimaryColor=Rn,this.proteins_ribbonCartoonHelixSecondaryColor=Pn,this.proteins_tubeColor=Mn,this.proteins_tubeResolution_3D=In,this.proteins_displayPipePlank=Cn,this.proteins_ribbonCartoonSheetColor=Bn,this.proteins_ribbonThickness=Ln,this.proteins_tubeThickness=Nn,this.proteins_plankSheetWidth=kn,this.proteins_cylinderHelixDiameter=On,this.proteins_verticalResolution=zn,this.proteins_horizontalResolution=Un,this.proteins_materialAmbientColor_3D=Hn,this.proteins_materialSpecularColor_3D=jn,this.proteins_materialShininess_3D=qn,this.macro_displayAtoms=tr,this.macro_displayBonds=er,this.macro_atomToLigandDistance=ir,this.nucleics_display=Wn,this.nucleics_tubeColor=Gn,this.nucleics_baseColor=Xn,this.nucleics_residueColor=Vn,this.nucleics_tubeThickness=Yn,this.nucleics_tubeResolution_3D=Zn,this.nucleics_verticalResolution=Qn,this.nucleics_materialAmbientColor_3D=$n,this.nucleics_materialSpecularColor_3D=Jn,this.nucleics_materialShininess_3D=Kn,this.macro_showWater=nr,this.macro_colorByChain=rr,this.macro_rainbowColors=sr.slice(0),this.surfaces_display=or,this.surfaces_alpha=ar,this.surfaces_style=hr,this.surfaces_color=lr,this.surfaces_materialAmbientColor_3D=ur,this.surfaces_materialSpecularColor_3D=cr,this.surfaces_materialShininess_3D=fr,this.plots_color=dr,this.plots_width=mr,this.plots_showIntegration=pr,this.plots_integrationColor=gr,this.plots_integrationLineWidth=vr,this.plots_showGrid=_r,this.plots_gridColor=xr,this.plots_gridLineWidth=br,this.plots_showYAxis=yr,this.plots_flipXAxis=wr,this.text_font_size=Tr,this.text_font_families=Dr.slice(0),this.text_font_bold=Sr,this.text_font_italic=Cr,this.text_font_stroke_3D=Ar,this.text_color=Er,this.shapes_color=Fr,this.shapes_lineWidth=Rr,this.shapes_pointSize=Pr,this.shapes_arrowLength_2D=Br,this.compass_display=Mr,this.compass_axisXColor_3D=Ir,this.compass_axisYColor_3D=Lr,this.compass_axisZColor_3D=Nr,this.compass_size_3D=kr,this.compass_resolution_3D=Or,this.compass_displayText_3D=zr,this.compass_type_3D=Ur,this.measurement_update_3D=Hr,this.measurement_angleBands_3D=jr,this.measurement_displayText_3D=qr}rs.setup=function(t,e){this.horizontalResolution=e;var i=[t.x-this.cp1.x,t.y-this.cp1.y,t.z-this.cp1.z],n=[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],r=L.vec3.cross(i,n,[]);this.D=L.vec3.cross(r,i,[]),L.vec3.normalize(r),L.vec3.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[];var s=[(t.x+this.cp1.x)/2,(t.y+this.cp1.y)/2,(t.z+this.cp1.z)/2];this.helix&&(L.vec3.scale(r,1.5),L.vec3.add(s,r)),this.guidePointsSmall[0]=new Zr("",s[0]-this.D[0]/2,s[1]-this.D[1]/2,s[2]-this.D[2]/2);for(var o=1;o<e;o++)this.guidePointsSmall[o]=new Zr("",this.guidePointsSmall[0].x+this.D[0]*o/e,this.guidePointsSmall[0].y+this.D[1]*o/e,this.guidePointsSmall[0].z+this.D[2]*o/e);L.vec3.scale(this.D,4),this.guidePointsLarge[0]=new Zr("",s[0]-this.D[0]/2,s[1]-this.D[1]/2,s[2]-this.D[2]/2);for(o=1;o<e;o++)this.guidePointsLarge[o]=new Zr("",this.guidePointsLarge[0].x+this.D[0]*o/e,this.guidePointsLarge[0].y+this.D[1]*o/e,this.guidePointsLarge[0].z+this.D[2]*o/e)},rs.getGuidePointSet=function(t){return 0===t?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1===t?this.guidePointsSmall:2===t?this.guidePointsLarge:void 0},rs.computeLineSegments=function(t,e,i,n,r){this.setVerticalResolution(r),this.split=i.helix!==this.helix||i.sheet!==this.sheet,this.lineSegments=this.innerCompute(0,t,e,i,!1,r),n&&(this.lineSegmentsCartoon=this.innerCompute(this.helix||this.sheet?2:1,t,e,i,!0,r))},rs.innerCompute=function(t,e,i,n,r,s){for(var o=[],a=this.getGuidePointSet(t),h=e.getGuidePointSet(t),l=i.getGuidePointSet(t),u=n.getGuidePointSet(t),c=0,f=a.length;c<f;c++){for(var d=[h[c].x,h[c].y,h[c].z,1,l[c].x,l[c].y,l[c].z,1,a[c].x,a[c].y,a[c].z,1,u[c].x,u[c].y,u[c].z,1],m=L.mat4.multiply(d,ts,[]),p=[],g=0;g<s;g++){for(var v=3;0<v;v--)for(var _=0;_<4;_++)m[4*v+_]+=m[4*(v-1)+_];p[g]=new Zr("",m[12]/m[15],m[13]/m[15],m[14]/m[15])}o[c]=p}if(r&&this.arrow){v=0;for(var x=s;v<x;v++)for(var b=1.5-1.3*v/s,y=es.floor(this.horizontalResolution/2),w=o[y],T=(_=0,o.length);_<T;_++)if(_!==y){var D=w[v],S=o[_][v],C=[S.x-D.x,S.y-D.y,S.z-D.z];L.vec3.scale(C,b),S.x=D.x+C[0],S.y=D.y+C[1],S.z=D.z+C[2]}}return o},rs.setVerticalResolution=function(t){t!==is&&function(t){var e=t*t,i=t*t*t,n=[6/i,0,0,0,6/i,2/e,0,0,1/i,1/e,1/t,0,0,0,0,1];ts=L.mat4.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],n,[]),is=t}(t)};var as=os.prototype;function hs(){}as.set3DRepresentation=function(t){this.atoms_display=!0,this.bonds_display=!0,this.bonds_color="#777777",this.atoms_useVDWDiameters_3D=!0,this.atoms_useJMOLColors=!0,this.bonds_splitColor=!0,this.bonds_showBondOrders_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"===t?(this.atoms_vdwMultiplier_3D=.3,this.bonds_splitColor=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=ki,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===t?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===t?(this.atoms_useVDWDiameters_3D=!1,this.bonds_showBondOrders_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===t?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=ki):"Line"===t?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+t+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')},as.copy=function(){var t=JSON.parse(JSON.stringify(this));return t.set3DRepresentation=as.set3DRepresentation,t};var ls=hs.prototype;function us(t){this.setMolecule(t)}function cs(t){this.setMolecule(t)}function fs(){}ls.value=0,ls.molecule=void 0,ls.setMolecule=function(t){this.value=0,this.molecule=t,this.innerCalculate&&this.innerCalculate()},(us.prototype=new hs).innerCalculate=function(){for(var t=0,e=this.molecule.atoms.length;t<e;t++)this.molecule.atoms[t].visited=!1;for(t=0,e=this.molecule.atoms.length;t<e;t++)if(!this.molecule.atoms[t].visited){this.value++;var i=new x;for(this.molecule.atoms[t].visited=!0,i.enqueue(this.molecule.atoms[t]);!i.isEmpty();)for(var n=i.dequeue(),r=0,s=this.molecule.bonds.length;r<s;r++){var o=this.molecule.bonds[r];if(o.contains(n)){var a=o.getNeighbor(n);a.visited||(a.visited=!0,i.enqueue(a))}}}},(cs.prototype=new hs).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new us(this.molecule).value};var ds=fs.prototype;function ms(t,e){if(this.atoms=[],e)for(var i=0,n=e.atoms.length;i<n;i++)this.atoms[i]=e.atoms[i];this.atoms.push(t)}ds.atoms=void 0,ds.bonds=void 0,ds.rings=void 0,ds.reduce=function(t){for(var e=0,i=t.atoms.length;e<i;e++)t.atoms[e].visited=!1;for(e=0,i=t.bonds.length;e<i;e++)t.bonds[e].visited=!1;for(var n=!0;n;){n=!1;for(e=0,i=t.atoms.length;e<i;e++){for(var r,s=0,o=0,a=t.bonds.length;o<a;o++)if(t.bonds[o].contains(t.atoms[e])&&!t.bonds[o].visited){if(2===++s)break;r=t.bonds[o]}1===s&&(n=!0,r.visited=!0,t.atoms[e].visited=!0)}}for(e=0,i=t.atoms.length;e<i;e++)t.atoms[e].visited||this.atoms.push(t.atoms[e]);for(e=0,i=t.bonds.length;e<i;e++)t.bonds[e].visited||this.bonds.push(t.bonds[e]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])},ds.setMolecule=function(t){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(t),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},ds.fuse=function(){for(var t=0,e=this.rings.length;t<e;t++)for(var i=0,n=this.bonds.length;i<n;i++)-1!==this.rings[t].atoms.indexOf(this.bonds[i].a1)&&-1!==this.rings[t].atoms.indexOf(this.bonds[i].a2)&&this.rings[t].bonds.push(this.bonds[i])};var ps=ms.prototype;function gs(t){this.setMolecule(t)}ps.grow=function(t,e){for(var i=this.atoms[this.atoms.length-1],n=[],r=0,s=t.length;r<s;r++)if(t[r].contains(i)){var o=t[r].getNeighbor(i);-1===e.indexOf(o)&&n.push(o)}var a=[];for(r=0,s=n.length;r<s;r++)a.push(new ms(n[r],this));return a},ps.check=function(t,e,i){for(var n=0,r=e.atoms.length-1;n<r;n++)if(-1!==this.atoms.indexOf(e.atoms[n]))return;var s;if(e.atoms[e.atoms.length-1]===this.atoms[this.atoms.length-1]){(s=new C).atoms[0]=i;for(n=0,r=this.atoms.length;n<r;n++)s.atoms.push(this.atoms[n]);for(n=e.atoms.length-2;0<=n;n--)s.atoms.push(e.atoms[n])}else{var o=[];for(n=0,r=t.length;n<r;n++)t[n].contains(e.atoms[e.atoms.length-1])&&o.push(t[n]);for(n=0,r=o.length;n<r;n++)if((1===e.atoms.length||!o[n].contains(e.atoms[e.atoms.length-2]))&&o[n].contains(this.atoms[this.atoms.length-1])){(s=new C).atoms[0]=i;for(var a=0,h=this.atoms.length;a<h;a++)s.atoms.push(this.atoms[a]);for(a=e.atoms.length-1;0<=a;a--)s.atoms.push(e.atoms[a]);break}}return s};var vs=gs.prototype=new fs;function _s(t){if(this.rings=[],0<t.atoms.length){var e=new cs(t).value,i=new gs(t).rings;i.sort(function(t,e){return t.atoms.length-e.atoms.length});for(var n=0,r=t.bonds.length;n<r;n++)t.bonds[n].visited=!1;for(n=0,r=i.length;n<r;n++){for(var s=!1,o=0,a=i[n].bonds.length;o<a;o++)if(!i[n].bonds[o].visited){s=!0;break}if(s){for(o=0,a=i[n].bonds.length;o<a;o++)i[n].bonds[o].visited=!0;this.rings.push(i[n])}if(this.rings.length===e)break}}}function xs(){return Ce/Ae}function bs(){}vs.fingerBreak=5,vs.innerGetRings=function(){for(var t=0,e=this.atoms.length;t<e;t++){for(var i=[],n=0,r=this.bonds.length;n<r;n++)this.bonds[n].contains(this.atoms[t])&&i.push(this.bonds[n].getNeighbor(this.atoms[t]));for(n=0,r=i.length;n<r;n++)for(var s=n+1;s<i.length;s++){var o=[];o[0]=new ms(i[n]),o[1]=new ms(i[s]);var a=[];a[0]=this.atoms[t];for(var h=0,l=i.length;h<l;h++)h!==n&&h!==s&&a.push(i[h]);var u=[],c=o[0].check(this.bonds,o[1],this.atoms[t]);for(c&&(u[0]=c);0===u.length&&0<o.length&&o[0].atoms.length<this.fingerBreak;){var f=[];for(h=0,l=o.length;h<l;h++)for(var d=o[h].grow(this.bonds,a),m=0,p=d.length;m<p;m++)f.push(d[m]);for(h=0,l=(o=f).length;h<l;h++)for(m=h+1;m<l;m++){var g=o[h].check(this.bonds,o[m],this.atoms[t]);g&&u.push(g)}if(0===u.length){var v=[];for(h=0,l=a.length;h<l;h++)for(m=0,p=this.bonds.length;m<p;m++)if(this.bonds[m].contains(a[h])){i=this.bonds[m].getNeighbor(a[h]);-1===a.indexOf(i)&&-1===v.indexOf(i)&&v.push(i)}for(h=0,l=v.length;h<l;h++)a.push(v[h])}}if(0<u.length){var _=void 0;for(h=0,l=u.length;h<l;h++)(!_||_.atoms.length>u[h].atoms.length)&&(_=u[h]);var x=!1;for(h=0,l=this.rings.length;h<l;h++){var b=!0;for(m=0,p=_.atoms.length;m<p;m++)if(-1===this.rings[h].atoms.indexOf(_.atoms[m])){b=!1;break}if(b){x=!0;break}}x||this.rings.push(_)}}}this.fuse()};var ys=bs.prototype;function ws(){}function Ts(){}function Ds(){}ys.margin=1.1,ys.deduceCovalentBonds=function(t,e){var i=xs();e&&(i=e);for(var n=0,r=t.atoms.length;n<r;n++)for(var s=n+1;s<r;s++){var o=t.atoms[n],a=t.atoms[s];o.distance3D(a)<(_e[o.label].covalentRadius+_e[a.label].covalentRadius)*i*this.margin&&t.bonds.push(new Jr(o,a,1))}},ws.prototype.removeHydrogens=function(t,e){for(var i=[],n=[],r=0,s=t.bonds.length;r<s;r++){var o=t.bonds[r],a="H"!==o.a1.label&&"H"!==o.a2.label;a||e||o.stereo===Jr.STEREO_NONE||(a=!0),a?(o.a1.tag=!0,n.push(o)):("H"===o.a1.label&&(o.a1.remove=!0),"H"===o.a2.label&&(o.a2.remove=!0))}for(r=0,s=t.atoms.length;r<s;r++){var h=t.atoms[r];h.remove?h.remove=void 0:i.push(h)}t.atoms=i,t.bonds=n},Ts.prototype.split=function(t){for(var e=[],i=0,n=t.atoms.length;i<n;i++)t.atoms[i].visited=!1;for(i=0,n=t.bonds.length;i<n;i++)t.bonds[i].visited=!1;for(i=0,n=t.atoms.length;i<n;i++){var r=t.atoms[i];if(!r.visited){var s=new Cs;s.atoms.push(r),r.visited=!0;var o=new x;for(o.enqueue(r);!o.isEmpty();)for(var a=o.dequeue(),h=0,l=t.bonds.length;h<l;h++){var u=t.bonds[h];if(u.contains(a)&&!u.visited){u.visited=!0,s.bonds.push(u);var c=u.getNeighbor(a);c.visited||(c.visited=!0,s.atoms.push(c),o.enqueue(c))}}e.push(s)}}return e},Ds.prototype.copy=function(t){var e=new R;return e.molFrom(e.molTo(t))};var Ss=Math;function Cs(){this.atoms=[],this.bonds=[],this.rings=[]}var As=Cs.prototype;As.findRings=!0,As.draw=function(t,e){if(this.specs&&(e=this.specs),e.atoms_display&&!e.atoms_circles_2D)for(var i=0,n=this.atoms.length;i<n;i++)this.atoms[i].draw(t,e);if(e.bonds_display)for(i=0,n=this.bonds.length;i<n;i++)this.bonds[i].draw(t,e);if(e.atoms_display)for(i=0,n=this.atoms.length;i<n;i++){var r=this.atoms[i];e.atoms_circles_2D&&r.draw(t,e),r.query&&r.query.draw(t,e,r)}},As.render=function(t,e){this.specs&&(e=this.specs);var i=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(i){if(e.macro_displayBonds){0<this.bonds.length&&(e.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(t.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:e.bonds_width_2D),t.lineBuffer.bindBuffers(t)):t.cylinderBuffer.bindBuffers(t),t.material.setTempColors(t,e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));for(var n=0,r=this.bonds.length;n<r;n++){!(a=this.bonds[n]).a1.hetatm&&(-1===e.macro_atomToLigandDistance||void 0!==a.a1.closestDistance&&e.macro_atomToLigandDistance>=a.a1.closestDistance&&e.macro_atomToLigandDistance>=a.a2.closestDistance)&&a.render(t,this.residueSpecs?this.residueSpecs:e)}}if(e.macro_displayAtoms){0<this.atoms.length&&(t.sphereBuffer.bindBuffers(t),t.material.setTempColors(t,e.atoms_materialAmbientColor_3D,void 0,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D));for(n=0,r=this.atoms.length;n<r;n++){!(l=this.atoms[n]).hetatm&&(-1===e.macro_atomToLigandDistance||void 0!==l.closestDistance&&e.macro_atomToLigandDistance>=l.closestDistance)&&l.render(t,this.residueSpecs?this.residueSpecs:e)}}}if(e.bonds_display){var s=[],o=[];0<this.bonds.length&&(e.bonds_renderAsLines_3D?(t.lineWidth(e.bonds_width_2D),t.lineBuffer.bindBuffers(t)):t.cylinderBuffer.bindBuffers(t),t.material.setTempColors(t,e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));for(n=0,r=this.bonds.length;n<r;n++){var a=this.bonds[n];i&&!a.a1.hetatm||(e.bonds_showBondOrders_3D?0==a.bondOrder?o.push(a):.5==a.bondOrder?s.push(a):(1.5==a.bondOrder&&s.push(a),a.render(t,e)):a.render(t,e))}if(0<s.length){e.bonds_renderAsLines_3D||t.pillBuffer.bindBuffers(t);for(n=0,r=s.length;n<r;n++)s[n].render(t,e,!0)}if(0<o.length){e.bonds_renderAsLines_3D||t.sphereBuffer.bindBuffers(t);for(n=0,r=o.length;n<r;n++)o[n].render(t,e,!0)}}if(e.atoms_display){for(n=0,r=this.atoms.length;n<r;n++){(l=this.atoms[n]).bondNumber=0,l.renderAsStar=!1}for(n=0,r=this.bonds.length;n<r;n++){(a=this.bonds[n]).a1.bondNumber++,a.a2.bondNumber++}0<this.atoms.length&&(t.sphereBuffer.bindBuffers(t),t.material.setTempColors(t,e.atoms_materialAmbientColor_3D,void 0,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D));var h=[];for(n=0,r=this.atoms.length;n<r;n++){var l=this.atoms[n];i&&(!l.hetatm||!e.macro_showWater&&l.isWater)||(e.atoms_nonBondedAsStars_3D&&0===l.bondNumber?(l.renderAsStar=!0,h.push(l)):l.render(t,e))}if(0<h.length){t.starBuffer.bindBuffers(t);for(n=0,r=h.length;n<r;n++)h[n].render(t,e)}}if(this.chains){if(t.shader.setMatrixUniforms(t),e.proteins_displayRibbon){t.material.setTempColors(t,e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D);for(var u=e.proteins_ribbonCartoonize?this.cartoons:this.ribbons,c=0,f=u.length;c<f;c++){var d=u[c];if("none"!==e.proteins_residueColor){d.front.bindBuffers(t);var m="rainbow"===e.proteins_residueColor;for(n=0,r=d.front.segments.length;n<r;n++)m&&t.material.setDiffuseColor(t,$(n,r,e.macro_rainbowColors)),d.front.segments[n].render(t,e);d.back.bindBuffers(t);for(n=0,r=d.back.segments.length;n<r;n++)m&&t.material.setDiffuseColor(t,$(n,r,e.macro_rainbowColors)),d.back.segments[n].render(t,e)}else d.front.render(t,e),d.back.render(t,e)}}if(e.proteins_displayPipePlank)for(c=0,f=this.pipePlanks.length;c<f;c++)this.pipePlanks[c].render(t,e);if(e.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace={nodes:[],edges:[]};for(c=0,f=this.chains.length;c<f;c++){var p=this.chains[c];if(!(2<p.length&&ye[p[2].name]&&"#BEA06E"===ye[p[2].name].aminoColor)&&0<p.length)for(n=0,r=p.length-2;n<r;n++){(v=p[n].cp1).chainColor=p.chainColor,this.alphaCarbonTrace.nodes.push(v),(a=new Jr(p[n].cp1,p[n+1].cp1)).residueName=p[n].name,a.chainColor=p.chainColor,this.alphaCarbonTrace.edges.push(a),n===p.length-3&&((v=p[n+1].cp1).chainColor=p.chainColor,this.alphaCarbonTrace.nodes.push(v))}}}if(0<this.alphaCarbonTrace.nodes.length){var g=new os;g.atoms_display=!0,g.bonds_display=!0,g.atoms_sphereDiameter_3D=e.proteins_backboneThickness,g.bonds_cylinderDiameter_3D=e.proteins_backboneThickness,g.bonds_splitColor=!1,g.atoms_color=e.proteins_backboneColor,g.bonds_color=e.proteins_backboneColor,g.atoms_useVDWDiameters_3D=!1,t.material.setTempColors(t,e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),t.material.setDiffuseColor(t,e.proteins_backboneColor);for(n=0,r=this.alphaCarbonTrace.nodes.length;n<r;n++){var v=this.alphaCarbonTrace.nodes[n];e.macro_colorByChain&&(g.atoms_color=v.chainColor),t.sphereBuffer.bindBuffers(t),v.render(t,g)}for(n=0,r=this.alphaCarbonTrace.edges.length;n<r;n++){var _,x=this.alphaCarbonTrace.edges[n],b=ye[x.residueName]?ye[x.residueName]:ye["*"];e.macro_colorByChain?_=x.chainColor:"shapely"===e.proteins_residueColor?_=b.shapelyColor:"amino"===e.proteins_residueColor?_=b.aminoColor:"polarity"===e.proteins_residueColor?_=b.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?_=1===b.acidity?"#0000FF":-1===b.acidity?"#FF0000":b.polar?"#FFFFFF":"#773300":"rainbow"===e.proteins_residueColor&&(_=$(n,r,e.macro_rainbowColors)),_&&(g.bonds_color=_),t.cylinderBuffer.bindBuffers(t),x.render(t,g)}}}if(e.nucleics_display){t.material.setTempColors(t,e.nucleics_materialAmbientColor_3D,void 0,e.nucleics_materialSpecularColor_3D,e.nucleics_materialShininess_3D);for(c=0,f=this.tubes.length;c<f;c++){t.shader.setMatrixUniforms(t),(d=this.tubes[c]).render(t,e)}}}if(e.atoms_display){var y=!1;for(n=0,r=this.atoms.length;n<r;n++){if((l=this.atoms[n]).isHover||l.isSelected){y=!0;break}}if(!y)for(n=0,r=this.bonds.length;n<r;n++){if((a=this.bonds[n]).isHover||a.isSelected){y=!0;break}}if(y){t.sphereBuffer.bindBuffers(t),t.blendFunc(t.SRC_ALPHA,t.ONE),t.material.setTempColors(t,e.atoms_materialAmbientColor_3D,void 0,"#000000",0),t.enable(t.BLEND),t.depthMask(!1),t.material.setAlpha(t,.4),t.sphereBuffer.bindBuffers(t);for(n=0,r=this.atoms.length;n<r;n++){((l=this.atoms[n]).isHover||l.isSelected)&&l.renderHighlight(t,e)}t.cylinderBuffer.bindBuffers(t);for(n=0,r=this.bonds.length;n<r;n++){((a=this.bonds[n]).isHover||a.isSelected)&&a.renderHighlight(t,e)}t.depthMask(!0),t.disable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)}}},As.renderPickFrame=function(t,e,i,n,r){this.specs&&(e=this.specs);var s=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(r&&e.bonds_display){0<this.bonds.length&&(e.bonds_renderAsLines_3D?(t.lineWidth(e.bonds_width_2D),t.lineBuffer.bindBuffers(t)):t.cylinderBuffer.bindBuffers(t));for(var o=0,a=this.bonds.length;o<a;o++){var h=this.bonds[o];s&&!h.a1.hetatm||(t.material.setDiffuseColor(t,V(i.length)),h.renderPicker(t,e),i.push(h))}}if(n&&e.atoms_display){for(o=0,a=this.atoms.length;o<a;o++){(u=this.atoms[o]).bondNumber=0,u.renderAsStar=!1}for(o=0,a=this.bonds.length;o<a;o++){(h=this.bonds[o]).a1.bondNumber++,h.a2.bondNumber++}0<this.atoms.length&&t.sphereBuffer.bindBuffers(t);var l=[];for(o=0,a=this.atoms.length;o<a;o++){var u=this.atoms[o];s&&(!u.hetatm||!e.macro_showWater&&u.isWater)||(e.atoms_nonBondedAsStars_3D&&0===u.bondNumber?(u.renderAsStar=!0,l.push(u)):(t.material.setDiffuseColor(t,V(i.length)),u.render(t,e,!0),i.push(u)))}if(0<l.length){t.starBuffer.bindBuffers(t);for(o=0,a=l.length;o<a;o++){u=l[o];t.material.setDiffuseColor(t,V(i.length)),u.render(t,e,!0),i.push(u)}}}},As.getCenter3D=function(){if(1===this.atoms.length)return new Zr("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var t=1/0,e=1/0,i=1/0,n=-1/0,r=-1/0,s=-1/0;if(this.chains)for(var o=0,a=this.chains.length;o<a;o++)for(var h=this.chains[o],l=0,u=h.length;l<u;l++){var c=h[l];t=Ss.min(c.cp1.x,c.cp2.x,t),e=Ss.min(c.cp1.y,c.cp2.y,e),i=Ss.min(c.cp1.z,c.cp2.z,i),n=Ss.max(c.cp1.x,c.cp2.x,n),r=Ss.max(c.cp1.y,c.cp2.y,r),s=Ss.max(c.cp1.z,c.cp2.z,s)}for(o=0,a=this.atoms.length;o<a;o++)t=Ss.min(this.atoms[o].x,t),e=Ss.min(this.atoms[o].y,e),i=Ss.min(this.atoms[o].z,i),n=Ss.max(this.atoms[o].x,n),r=Ss.max(this.atoms[o].y,r),s=Ss.max(this.atoms[o].z,s);return new Zr("C",(n+t)/2,(r+e)/2,(s+i)/2)},As.getCenter=function(){if(1===this.atoms.length)return new P(this.atoms[0].x,this.atoms[0].y);for(var t=1/0,e=1/0,i=-1/0,n=-1/0,r=0,s=this.atoms.length;r<s;r++)t=Ss.min(this.atoms[r].x,t),e=Ss.min(this.atoms[r].y,e),i=Ss.max(this.atoms[r].x,i),n=Ss.max(this.atoms[r].y,n);return new P((i+t)/2,(n+e)/2)},As.getDimension=function(){if(1===this.atoms.length)return new P(0,0);var t=1/0,e=1/0,i=-1/0,n=-1/0;if(this.chains){for(var r=0,s=this.chains.length;r<s;r++)for(var o=this.chains[r],a=0,h=o.length;a<h;a++){var l=o[a];t=Ss.min(l.cp1.x,l.cp2.x,t),e=Ss.min(l.cp1.y,l.cp2.y,e),i=Ss.max(l.cp1.x,l.cp2.x,i),n=Ss.max(l.cp1.y,l.cp2.y,n)}t-=30,e-=30,i+=30,n+=30}for(r=0,s=this.atoms.length;r<s;r++)t=Ss.min(this.atoms[r].x,t),e=Ss.min(this.atoms[r].y,e),i=Ss.max(this.atoms[r].x,i),n=Ss.max(this.atoms[r].y,n);return new P(i-t,n-e)},As.check=function(t){if(t&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){this.rings=new _s(this).rings;for(var e=0,i=this.bonds.length;e<i;e++)this.bonds[e].ring=void 0;for(e=0,i=this.rings.length;e<i;e++)this.rings[e].setupBonds()}else for(e=0,i=this.rings.length;e<i;e++){var n=this.rings[e];n.center=n.getCenter()}for(e=0,i=this.atoms.length;e<i;e++)if(this.atoms[e].isLone=!1,"C"===this.atoms[e].label){for(var r=0,s=0,o=this.bonds.length;s<o;s++)this.bonds[s].a1!==this.atoms[e]&&this.bonds[s].a2!==this.atoms[e]||r++;0===r&&(this.atoms[e].isLone=!0)}var a=!1;for(e=0,i=this.atoms.length;e<i;e++)0!==this.atoms[e].z&&(a=!0);a&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!t},As.getAngles=function(t){for(var e=[],i=0,n=this.bonds.length;i<n;i++)this.bonds[i].contains(t)&&e.push(t.angle(this.bonds[i].getNeighbor(t)));return e.sort(function(t,e){return t-e}),e},As.getCoordinationNumber=function(t){for(var e=0,i=0,n=t.length;i<n;i++)e+=t[i].bondOrder;return e},As.getBonds=function(t){for(var e=[],i=0,n=this.bonds.length;i<n;i++)this.bonds[i].contains(t)&&e.push(this.bonds[i]);return e},As.sortAtomsByZ=function(){for(var t=1,e=this.atoms.length;t<e;t++)for(var i=t;0<i&&this.atoms[i].z<this.atoms[i-1].z;){var n=this.atoms[i];this.atoms[i]=this.atoms[i-1],this.atoms[i-1]=n,i--}},As.sortBondsByZ=function(){for(var t=1,e=this.bonds.length;t<e;t++)for(var i=t;0<i&&this.bonds[i].a1.z+this.bonds[i].a2.z<this.bonds[i-1].a1.z+this.bonds[i-1].a2.z;){var n=this.bonds[i];this.bonds[i]=this.bonds[i-1],this.bonds[i-1]=n,i--}},As.setupMetaData=function(){for(var t=this.getCenter(),e=0,i=this.atoms.length;e<i;e++){var n=this.atoms[e];n.bonds=this.getBonds(n),n.angles=this.getAngles(n),n.isHidden=2===n.bonds.length&&Ss.abs(Ss.abs(n.angles[1]-n.angles[0])-Ss.PI)<Ss.PI/30&&n.bonds[0].bondOrder===n.bonds[1].bondOrder;var r=q(n.angles);n.angleOfLeastInterference=r.angle%(2*Ss.PI),n.largestAngle=r.largest,n.coordinationNumber=this.getCoordinationNumber(n.bonds),n.bondNumber=n.bonds.length,n.molCenter=t}for(e=0,i=this.bonds.length;e<i;e++){this.bonds[e].molCenter=t}},As.scaleToAverageBondLength=function(t){var e=this.getAverageBondLength();if(0!==e)for(var i=t/e,n=0,r=this.atoms.length;n<r;n++)this.atoms[n].x*=i,this.atoms[n].y*=i},As.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var t=0,e=0,i=this.bonds.length;e<i;e++)t+=this.bonds[e].getLength();return t/=this.bonds.length},As.getBounds=function(){for(var t=new z,e=0,i=this.atoms.length;e<i;e++)t.expand(this.atoms[e].getBounds());if(this.chains){for(e=0,i=this.chains.length;e<i;e++)for(var n=this.chains[e],r=0,s=n.length;r<s;r++){var o=n[r];t.expand(o.cp1.x,o.cp1.y),t.expand(o.cp2.x,o.cp2.y)}t.minX-=30,t.minY-=30,t.maxX+=30,t.maxY+=30}return t},As.getBounds3D=function(){for(var t=new z,e=0,i=this.atoms.length;e<i;e++)t.expand(this.atoms[e].getBounds3D());if(this.chains)for(e=0,i=this.chains.length;e<i;e++)for(var n=this.chains[e],r=0,s=n.length;r<s;r++){var o=n[r];t.expand3D(o.cp1.x,o.cp1.y,o.cp1.z),t.expand3D(o.cp2.x,o.cp2.y,o.cp2.z)}return t},As.getAtomGroup=function(t){for(var e=!1,i=0,n=this.atoms.length;i<n;i++)this.atoms[i].visited=!1;for(i=0,n=this.bonds.length;i<n;i++){var r=this.bonds[i];!e&&r.contains(t)&&void 0!==r.ring&&(e=!0)}if(e){var s=[t];t.visited=!0;var o=new x;for(o.enqueue(t);!o.isEmpty();){var a=o.dequeue();for(i=0,n=this.bonds.length;i<n;i++){if((r=this.bonds[i]).contains(a)&&e===(void 0!==r.ring)){var h=r.getNeighbor(a);h.visited||(h.visited=!0,s.push(h),o.enqueue(h))}}}return s}},As.getBondGroup=function(t){for(var e=void 0!==t.ring,i=!1,n=0,r=this.bonds.length;n<r;n++){var s=this.bonds[n];s===t&&(i=!0),s.visited=!1}if(i){var o=[t];t.visited=!0;var a=new x;for(a.enqueue(t);!a.isEmpty();){var h=a.dequeue();for(n=0,r=this.bonds.length;n<r;n++){var l=this.bonds[n];l.visited||l.a1!==h.a1&&l.a2!==h.a1&&l.a1!==h.a2&&l.a2!==h.a2||void 0!==l.ring!=e||(l.visited=!0,o.push(l),a.enqueue(l))}}return o}};var Es=Math;function Fs(){this.data=[],this.metadata=[],this.dataDisplay=[],this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}}var Rs=Fs.prototype;Rs.title=void 0,Rs.xUnit=void 0,Rs.yUnit=void 0,Rs.continuous=!0,Rs.integrationSensitivity=.01,Rs.draw=function(t,e,i,n){this.specs&&(e=this.specs);var r=5,s=0,o=0;t.fillStyle=e.text_color,t.textAlign="center",t.textBaseline="alphabetic",t.font=F(e.text_font_size,e.text_font_families),this.xUnit&&(o+=e.text_font_size,t.fillText(this.xUnit,i/2,n-2)),this.yUnit&&e.plots_showYAxis&&(s+=e.text_font_size,t.save(),t.translate(e.text_font_size,n/2),t.rotate(-Es.PI/2),t.fillText(this.yUnit,0,0),t.restore()),this.title&&(r+=e.text_font_size,t.fillText(this.title,i/2,e.text_font_size)),t.lineCap="square",o+=5+e.text_font_size,e.plots_showYAxis&&(s+=5+t.measureText("1000").width),e.plots_showGrid&&(t.strokeStyle=e.plots_gridColor,t.lineWidth=e.plots_gridLineWidth,t.strokeRect(s,r,i-s,n-o-r)),t.textAlign="center",t.textBaseline="top";for(var a=this.maxX-this.minX,h=a/100,l=.001;l<h||25<a/l;)l*=10;for(var u=0,c=e.plots_flipXAxis?i:0,f=Es.round(this.minX/l)*l;f<=this.maxX;f+=l/2){var d=this.getTransformedX(f,e,i,s);if(s<d)if(t.strokeStyle="black",t.lineWidth=1,u%2==0){t.beginPath(),t.moveTo(d,n-o),t.lineTo(d,n-o+2),t.stroke();for(var m=f.toFixed(5);"0"===m.charAt(m.length-1);)m=m.substring(0,m.length-1);"."===m.charAt(m.length-1)&&(m=m.substring(0,m.length-1));var p=t.measureText(m).width;e.plots_flipXAxis&&(p*=-1);var g=d-p/2;(e.plots_flipXAxis?g<c:c<g)&&(t.fillText(m,d,n-o+2),c=d+p/2),e.plots_showGrid&&(t.strokeStyle=e.plots_gridColor,t.lineWidth=e.plots_gridLineWidth,t.beginPath(),t.moveTo(d,n-o),t.lineTo(d,r),t.stroke())}else t.beginPath(),t.moveTo(d,n-o),t.lineTo(d,n-o+2),t.stroke();u++}if(e.plots_showYAxis||e.plots_showGrid){var v=1/e.scale;t.textAlign="right",t.textBaseline="middle";for(f=0;f<=10;f++){var _=v/10*f,x=r+(n-o-r)*(1-_*e.scale);if(e.plots_showGrid&&(t.strokeStyle=e.plots_gridColor,t.lineWidth=e.plots_gridLineWidth,t.beginPath(),t.moveTo(s,x),t.lineTo(i,x),t.stroke()),e.plots_showYAxis){t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(s,x),t.lineTo(s-3,x),t.stroke();var b=100*_,y=Es.max(0,3-Es.floor(b).toString().length);m=b.toFixed(y);if(0<y)for(;"0"===m.charAt(m.length-1);)m=m.substring(0,m.length-1);"."===m.charAt(m.length-1)&&(m=m.substring(0,m.length-1)),t.fillText(m,s-3,x)}}}if(t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(i,n-o),t.lineTo(s,n-o),e.plots_showYAxis&&t.lineTo(s,r),t.stroke(),0<this.dataDisplay.length){t.textAlign="left",t.textBaseline="top";for(var w=0,T=(f=0,this.dataDisplay.length);f<T;f++)if(this.dataDisplay[f].value)t.fillText([this.dataDisplay[f].display,": ",this.dataDisplay[f].value].join(""),s+10,r+10+w*(e.text_font_size+5)),w++;else if(this.dataDisplay[f].tag)for(var D=0,S=this.metadata.length;D<S;D++)if(E(this.metadata[D],this.dataDisplay[f].tag)){var C=this.metadata[D];if(this.dataDisplay[f].display){var A=this.metadata[D].indexOf("=");C=[this.dataDisplay[f].display,": ",-1<A?this.metadata[D].substring(A+2):this.metadata[D]].join("")}t.fillText(C,s+10,r+10+w*(e.text_font_size+5)),w++;break}}this.drawPlot(t,e,i,n,r,s,o),this.memory.offsetTop=r,this.memory.offsetLeft=s,this.memory.offsetBottom=o,this.memory.flipXAxis=e.plots_flipXAxis,this.memory.scale=e.scale,this.memory.width=i,this.memory.height=n},Rs.drawPlot=function(t,e,i,n,r,s,o){this.specs&&(e=this.specs),t.strokeStyle=e.plots_color,t.lineWidth=e.plots_width;var a=[];if(t.save(),t.rect(s,r,i-s,n-o-r),t.clip(),t.beginPath(),this.continuous)for(var h=!1,l=0,u=!1,c=0,f=this.data.length;c<f;c++){var d,m=this.getTransformedX(this.data[c].x,e,i,s);if(c<f&&!h&&this.data[c+1]&&(d=this.getTransformedX(this.data[c+1].x,e,i,s)),s<=m&&m<i||void 0!==d&&s<=d&&d<i){var p=this.getTransformedY(this.data[c].y,e,n,o,r);if(e.plots_showIntegration&&Es.abs(this.data[c].y)>this.integrationSensitivity&&a.push(new P(this.data[c].x,this.data[c].y)),h||(t.moveTo(m,p),h=!0),t.lineTo(m,p),++l%1e3==0&&(t.stroke(),t.beginPath(),t.moveTo(m,p)),u)break}else h&&(u=!0)}else for(c=0,f=this.data.length;c<f;c++){s<=(m=this.getTransformedX(this.data[c].x,e,i,s))&&m<i&&(t.moveTo(m,n-o),t.lineTo(m,this.getTransformedY(this.data[c].y,e,n,o,r)))}if(t.stroke(),e.plots_showIntegration&&1<a.length){t.strokeStyle=e.plots_integrationColor,t.lineWidth=e.plots_integrationLineWidth,t.beginPath();var g,v=a[1].x>a[0].x;if(this.flipXAxis&&!v||!this.flipXAxis&&v){for(c=a.length-2;0<=c;c--)a[c].y=a[c].y+a[c+1].y;g=a[0].y}else{for(c=1,f=a.length;c<f;c++)a[c].y=a[c].y+a[c-1].y;g=a[a.length-1].y}for(c=0,f=a.length;c<f;c++){m=this.getTransformedX(a[c].x,e,i,s),p=this.getTransformedY(a[c].y/e.scale/g,e,n,o,r);0===c?t.moveTo(m,p):t.lineTo(m,p)}t.stroke()}t.restore()},Rs.getTransformedY=function(t,e,i,n,r){return r+(i-n-r)*(1-t*e.scale)},Rs.getInverseTransformedY=function(t){return(1-(t-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100},Rs.getTransformedX=function(t,e,i,n){var r=n+(t-this.minX)/(this.maxX-this.minX)*(i-n);return e.plots_flipXAxis&&(r=i+n-r),r},Rs.getInverseTransformedX=function(t){return this.memory.flipXAxis&&(t=this.memory.width+this.memory.offsetLeft-t),(t-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},Rs.setup=function(){for(var t=Number.MAX_VALUE,e=Number.MIN_VALUE,i=Number.MIN_VALUE,n=0,r=this.data.length;n<r;n++)t=Es.min(t,this.data[n].x),e=Es.max(e,this.data[n].x),i=Es.max(i,this.data[n].y);this.continuous?(this.minX=t,this.maxX=e):(this.minX=t-1,this.maxX=e+1);for(n=0,r=this.data.length;n<r;n++)this.data[n].y/=i},Rs.zoom=function(t,e,i,n){var r=this.getInverseTransformedX(t),s=this.getInverseTransformedX(e);if(this.minX=Es.min(r,s),this.maxX=Es.max(r,s),n){for(var o=Number.MIN_VALUE,a=0,h=this.data.length;a<h;a++)W(this.data[a].x,this.minX,this.maxX)&&(o=Es.max(o,this.data[a].y));return 1/o}},Rs.translate=function(t,e){var i=t/(e-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=i,this.maxX+=i},Rs.alertMetadata=function(){alert(this.metadata.join("\n"))},Rs.getInternalCoordinates=function(t,e){return new P(this.getInverseTransformedX(t),this.getInverseTransformedY(e))},Rs.getClosestPlotInternalCoordinates=function(t){var e=this.getInverseTransformedX(t-1),i=this.getInverseTransformedX(t+1);if(i<e){var n=e;e=i,i=n}for(var r=-1,s=-1/0,o=!1,a=0,h=this.data.length;a<h;a++){var l;if(W((l=this.data[a]).x,e,i))l.y>s&&(o=!0,s=l.y,r=a);else if(o)break}if(-1!==r)return new P((l=this.data[r]).x,100*l.y)},Rs.getClosestPeakInternalCoordinates=function(t){for(var e=this.getInverseTransformedX(t),i=0,n=1/0,r=0,s=this.data.length;r<s;r++){var o=Es.abs(this.data[r].x-e);if(!(o<=n))break;n=o,i=r}var a=i,h=i,l=this.data[i].y,u=this.data[i].y;for(r=i+1,s=this.data.length;r<s&&this.data[r].y+.05>u;r++)u=this.data[r].y,h=r;for(r=i-1;0<=r&&this.data[r].y+.05>l;r--)l=this.data[r].y,a=r;var c=this.data[h-i<a-i?h:a];return new P(c.x,100*c.y)};var Ps=Math;function Bs(t){for(this.lanes=new Array(t),i=0,ii=t;i<ii;i++)this.lanes[i]=[]}var Ms=Bs.prototype;Ms.sort=function(){for(i=0,ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(t,e){return t-e})},Ms.draw=function(t,e){var n=t.canvas.width,r=t.canvas.height;for(this.origin=9*r/10,this.front=r/10,this.laneLength=this.origin-this.front,t.strokeStyle="#000000",t.beginPath(),t.moveTo(0,this.front),t.lineTo(n,this.front),t.setLineDash([3]),t.stroke(),t.setLineDash([]),t.beginPath(),t.moveTo(0,this.origin),t.lineTo(n,this.origin),t.closePath(),t.stroke(),i=0,ii=this.lanes.length;i<ii;i++){var o=(i+1)*n/(ii+1);for(t.beginPath(),t.moveTo(o,this.origin),t.lineTo(o,this.origin+3),t.closePath(),t.stroke(),s=0,ss=this.lanes[i].length;s<ss;s++){var a=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case"compact":t.beginPath(),t.arc(o,a,3,0,2*Ps.PI,!1),t.closePath();break;case"expanded":t.beginPath(),t.arc(o,a,7,0,2*Ps.PI,!1),t.closePath();break;case"trailing":break;case"widened":m(t,o-18,a-10,36,10);break;case"cresent":t.beginPath(),t.arc(o,a,9,0,Ps.PI,!0),t.closePath()}switch(this.lanes[i][s].style){case"solid":t.fillStyle="#000000",t.fill();break;case"transparent":t.stroke()}}}},Bs.Spot=function(t,e,i){this.type=t,this.rf=e,this.style=i||"solid"};var Is=Math,Ls={};!function(t){Ls._Shape=function(){};var e=Ls._Shape.prototype;e.drawDecorations=function(t,e){if(this.isHover)for(var i=this.getPoints(),n=0,r=i.length;n<r;n++){var s=i[n];this.drawAnchor(t,e,s,s===this.hoverPoint)}},e.getBounds=function(){for(var t=new z,e=this.getPoints(),i=0,n=e.length;i<n;i++){var r=e[i];t.expand(r.x,r.y)}return t},e.drawAnchor=function(t,e,i,n){t.save(),t.translate(i.x,i.y),t.rotate(Is.PI/4),t.scale(1/e.scale,1/e.scale);t.beginPath(),t.moveTo(-4,-4),t.lineTo(4,-4),t.lineTo(4,4),t.lineTo(-4,4),t.closePath(),t.fillStyle=n?e.colorHover:"white",t.fill(),t.beginPath(),t.moveTo(-4,-2),t.lineTo(-4,-4),t.lineTo(-2,-4),t.moveTo(2,-4),t.lineTo(4,-4),t.lineTo(4,-2),t.moveTo(4,2),t.lineTo(4,4),t.lineTo(2,4),t.moveTo(-2,4),t.lineTo(-4,4),t.lineTo(-4,2),t.moveTo(-4,-2),t.strokeStyle="rgba(0,0,0,.2)",t.lineWidth=5,t.stroke(),t.strokeStyle="blue",t.lineWidth=1,t.stroke(),t.restore()}}(),function(t){Ls.AtomMapping=function(t,e){this.o1=t,this.o2=e,this.label="0",this.error=!1};var e=Ls.AtomMapping.prototype=new Ls._Shape;e.drawDecorations=function(t,e){(this.isHover||this.isSelected)&&(t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1,t.beginPath(),t.moveTo(this.o1.x,this.o1.y),t.lineTo(this.o2.x,this.o2.y),t.setLineDash([2]),t.stroke(),t.setLineDash([]))},e.draw=function(t,e){if(this.o1&&this.o2){this.x1=this.o1.x+14*Is.cos(this.o1.angleOfLeastInterference),this.y1=this.o1.y-14*Is.sin(this.o1.angleOfLeastInterference),this.x2=this.o2.x+14*Is.cos(this.o2.angleOfLeastInterference),this.y2=this.o2.y-14*Is.sin(this.o2.angleOfLeastInterference),t.font=F(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic);var i=this.label,n=t.measureText(i).width;this.isLassoed&&(t.fillStyle=e.colorHover,t.fillRect(this.x1-n/2-3,this.y1-e.text_font_size/2-3,n+6,e.text_font_size+6),t.fillRect(this.x2-n/2-3,this.y2-e.text_font_size/2-3,n+6,e.text_font_size+6));var r=this.error?e.colorError:e.shapes_color;(this.isHover||this.isSelected)&&(r=this.isHover?e.colorHover:e.colorSelect),t.fillStyle=r,t.fillRect(this.x1-n/2-1,this.y1-e.text_font_size/2-1,n+2,e.text_font_size+2),t.fillRect(this.x2-n/2-1,this.y2-e.text_font_size/2-1,n+2,e.text_font_size+2),t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.backgroundColor,t.fillText(i,this.x1,this.y1),t.fillText(i,this.x2,this.y2)}},e.getPoints=function(){return[new P(this.x1,this.y1),new P(this.x2,this.y2)]},e.isOver=function(t,e){return!!this.x1&&(t.distance({x:this.x1,y:this.y1})<e||t.distance({x:this.x2,y:this.y2})<e)}}(),function(t){Ls.Bracket=function(t,e){this.p1=t||new P,this.p2=e||new P};var e=Ls.Bracket.prototype=new Ls._Shape;e.charge=0,e.mult=0,e.repeat=0,e.draw=function(t,e){var i=Is.min(this.p1.x,this.p2.x),n=Is.max(this.p1.x,this.p2.x),r=Is.min(this.p1.y,this.p2.y),s=Is.max(this.p1.y,this.p2.y),o=s-r,a=o/10;if(t.beginPath(),t.moveTo(i+a,r),t.lineTo(i,r),t.lineTo(i,s),t.lineTo(i+a,s),t.moveTo(n-a,s),t.lineTo(n,s),t.lineTo(n,r),t.lineTo(n-a,r),this.isLassoed){var h=t.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);h.addColorStop(0,"rgba(212, 99, 0, 0)"),h.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),h.addColorStop(1,"rgba(212, 99, 0, 0)"),t.lineWidth=e.shapes_lineWidth+5,t.strokeStyle=h,t.lineJoin="miter",t.lineCap="square",t.stroke()}(t.strokeStyle=e.shapes_color,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt",t.stroke(),0!==this.charge)&&(t.fillStyle=e.text_color,t.textAlign="left",t.textBaseline="alphabetic",t.font=F(e.text_font_size,e.text_font_families),"1"===(l=this.charge.toFixed(0))?l="+":"-1"===l?l="":E(l,"-")?l=l.substring(1)+"":l+="+",t.fillText(l,n+5,r+5));if(0!==this.mult&&(t.fillStyle=e.text_color,t.textAlign="right",t.textBaseline="middle",t.font=F(e.text_font_size,e.text_font_families),t.fillText(this.mult.toFixed(0),i-5,r+o/2)),0!==this.repeat){t.fillStyle=e.text_color,t.textAlign="left",t.textBaseline="top",t.font=F(e.text_font_size,e.text_font_families);var l=this.repeat.toFixed(0);t.fillText(l,n+5,s-5)}},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(t,e){return W(t.x,this.p1.x,this.p2.x)&&W(t.y,this.p1.y,this.p2.y)}}(),function(t){Ls.DynamicBracket=function(t,e){this.b1=t,this.b2=e,this.n1=1,this.n2=4,this.contents=[],this.ps=[]};var e=Ls.DynamicBracket.prototype=new Ls._Shape;e.drawDecorations=function(t,e){if(this.isHover)for(var i=0,n=this.contents.length;i<n;i++){var r=this.contents[i],s=t.createRadialGradient(r.x-1,r.y-1,0,r.x,r.y,7);s.addColorStop(0,"rgba(212, 99, 0, 0)"),s.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),t.fillStyle=s,t.beginPath(),t.arc(r.x,r.y,5,0,2*Is.PI,!1),t.fill()}};function s(t,e,i,n,r){var s=[],o=0<r.length?-1===r.indexOf(i.a1)?i.a2:i.a1:i.a1.distance(n.getCenter())<i.a2.distance(n.getCenter())?i.a1:i.a2,a=o.angle(i.getNeighbor(o)),h=a+Is.PI/2,l=i.getLength()/(1<r.length?4:2),u=o.x+l*Is.cos(a),c=o.y-l*Is.sin(a),f=10*Is.cos(h),d=10*Is.sin(h),m=u+f,p=c-d,g=u-f,v=c+d,_=-4*Is.cos(a),x=-4*Is.sin(a),b=m+_,y=p-x,w=g+_,T=v-x;return t.beginPath(),t.moveTo(b,y),t.lineTo(m,p),t.lineTo(g,v),t.lineTo(w,T),t.stroke(),s.push(new P(m,p)),s.push(new P(g,v)),s}e.draw=function(t,e){if(this.b1&&this.b2){var i=this.error?e.colorError:e.shapes_color;(this.isHover||this.isSelected)&&(i=this.isHover?e.colorHover:e.colorSelect),t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt";var n=s(t,0,this.b1,this.b2,this.contents),r=s(t,0,this.b2,this.b1,this.contents);this.ps=n.concat(r),this.b1.getCenter().x>this.b2.getCenter().x?this.ps[0].x>this.ps[1].x+5?this.textPos=this.ps[0]:this.textPos=this.ps[1]:this.ps[2].x>this.ps[3].x+5?this.textPos=this.ps[2]:this.textPos=this.ps[3],!this.error&&0<this.contents.length&&(t.font=F(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic),t.fillStyle=this.isHover?e.colorHover:e.text_color,t.textAlign="left",t.textBaseline="bottom",t.fillText(this.n1+"-"+this.n2,this.textPos.x+2,this.textPos.y+2))}},e.getPoints=function(){return this.ps},e.isOver=function(t,e){return!1},e.setContents=function(t){this.contents=[];var e=t.getMoleculeByAtom(this.b1.a1),i=t.getMoleculeByAtom(this.b2.a1);if(e&&e===i){for(var n=0,r=0,s=0,o=e.rings.length;s<o;s++)for(var a=e.rings[s],h=0,l=a.bonds.length;h<l;h++){var u=a.bonds[h];u===this.b1?n++:u===this.b2&&r++}var c=1===n&&1===r&&this.b1.ring===this.b2.ring;if(this.contents.flippable=c,void 0===this.b1.ring&&void 0===this.b2.ring||c)for(s=0,o=e.atoms.length;s<o;s++){var f=!1,d=!1,m=!1;for(h=0,l=e.bonds.length;h<l;h++)e.bonds[h].visited=!1;var p=new x,g=e.atoms[s];for(p.enqueue(g);!(p.isEmpty()||f&&d);){var v=p.dequeue();c&&(!this.flip&&v===this.b1.a1||this.flip&&v===this.b1.a2)&&(m=!0);for(h=0,l=e.bonds.length;h<l;h++){var _=e.bonds[h];_.a1!==v&&_.a2!==v||(_===this.b1?f=!0:_===this.b2?d=!0:_.visited||(_.visited=!0,p.enqueue(_.getNeighbor(v))))}}f&&d&&(!c||m)&&this.contents.push(g)}}}}(),function(t){Ls.Line=function(t,e){this.p1=t||new P,this.p2=e||new P},Ls.Line.ARROW_SYNTHETIC="synthetic",Ls.Line.ARROW_RETROSYNTHETIC="retrosynthetic",Ls.Line.ARROW_RESONANCE="resonance",Ls.Line.ARROW_EQUILIBRIUM="equilibrium";var e=Ls.Line.prototype=new Ls._Shape;e.arrowType=void 0,e.topText=void 0,e.bottomText=void 0,e.draw=function(t,e){if(this.isLassoed){var i=t.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);i.addColorStop(0,"rgba(212, 99, 0, 0)"),i.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),i.addColorStop(1,"rgba(212, 99, 0, 0)");var n=2.5,r=this.p1.angle(this.p2)+Is.PI/2,s=Is.cos(r),o=Is.sin(r),a=this.p1.x-s*n,h=this.p1.y+o*n,l=this.p1.x+s*n,u=this.p1.y-o*n,c=this.p2.x+s*n,f=this.p2.y-o*n,d=this.p2.x-s*n,m=this.p2.y+o*n;t.fillStyle=i,t.beginPath(),t.moveTo(a,h),t.lineTo(l,u),t.lineTo(c,f),t.lineTo(d,m),t.closePath(),t.fill()}if(t.strokeStyle=e.shapes_color,t.fillStyle=e.shapes_color,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt",this.p1.x!==this.p2.x||this.p1.y!==this.p2.y){if(this.arrowType===Ls.Line.ARROW_RETROSYNTHETIC){var p=2*Is.sqrt(2),g=(n=e.shapes_arrowLength_2D/p,r=(S=this.p1.angle(this.p2))+Is.PI/2,e.shapes_arrowLength_2D/p),v=Is.cos(S),_=Is.sin(S),x=(s=Is.cos(r),o=Is.sin(r),a=this.p1.x-s*n,h=this.p1.y+o*n,l=this.p1.x+s*n,u=this.p1.y-o*n,c=this.p2.x+s*n-v*g,f=this.p2.y-o*n+_*g,d=this.p2.x-s*n-v*g,m=this.p2.y+o*n+_*g,this.p2.x+s*n*2-v*g*2),b=this.p2.y-o*n*2+_*g*2,y=this.p2.x-s*n*2-v*g*2,w=this.p2.y+o*n*2+_*g*2;t.beginPath(),t.moveTo(l,u),t.lineTo(c,f),t.moveTo(x,b),t.lineTo(this.p2.x,this.p2.y),t.lineTo(y,w),t.moveTo(d,m),t.lineTo(a,h),t.stroke()}else if(this.arrowType===Ls.Line.ARROW_EQUILIBRIUM){p=2*Is.sqrt(2),n=e.shapes_arrowLength_2D/p/2,r=(S=this.p1.angle(this.p2))+Is.PI/2,g=2*e.shapes_arrowLength_2D/Is.sqrt(3),v=Is.cos(S),_=Is.sin(S),s=Is.cos(r),o=Is.sin(r),a=this.p1.x-s*n,h=this.p1.y+o*n,l=this.p1.x+s*n,u=this.p1.y-o*n,c=this.p2.x+s*n,f=this.p2.y-o*n,d=this.p2.x-s*n,m=this.p2.y+o*n;t.beginPath(),t.moveTo(l,u),t.lineTo(c,f),t.moveTo(d,m),t.lineTo(a,h),t.stroke();var T=c-v*g*.8,D=f+_*g*.8;x=c+s*e.shapes_arrowLength_2D/3-v*g,b=f-o*e.shapes_arrowLength_2D/3+_*g;t.beginPath(),t.moveTo(c,f),t.lineTo(x,b),t.lineTo(T,D),t.closePath(),t.fill(),t.stroke(),T=a+v*g*.8,D=h-_*g*.8,x=a-s*e.shapes_arrowLength_2D/3+v*g,b=h+o*e.shapes_arrowLength_2D/3-_*g,t.beginPath(),t.moveTo(a,h),t.lineTo(x,b),t.lineTo(T,D),t.closePath(),t.fill(),t.stroke()}else if(this.arrowType===Ls.Line.ARROW_SYNTHETIC){r=(S=this.p1.angle(this.p2))+Is.PI/2,g=2*e.shapes_arrowLength_2D/Is.sqrt(3),v=Is.cos(S),_=Is.sin(S),s=Is.cos(r),o=Is.sin(r);t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(this.p2.x-v*g/2,this.p2.y+_*g/2),t.stroke();T=this.p2.x-v*g*.8,D=this.p2.y+_*g*.8,x=this.p2.x+s*e.shapes_arrowLength_2D/3-v*g,b=this.p2.y-o*e.shapes_arrowLength_2D/3+_*g,y=this.p2.x-s*e.shapes_arrowLength_2D/3-v*g,w=this.p2.y+o*e.shapes_arrowLength_2D/3+_*g;t.beginPath(),t.moveTo(this.p2.x,this.p2.y),t.lineTo(y,w),t.lineTo(T,D),t.lineTo(x,b),t.closePath(),t.fill(),t.stroke()}else if(this.arrowType===Ls.Line.ARROW_RESONANCE){var S;r=(S=this.p1.angle(this.p2))+Is.PI/2,g=2*e.shapes_arrowLength_2D/Is.sqrt(3),v=Is.cos(S),_=Is.sin(S),s=Is.cos(r),o=Is.sin(r);t.beginPath(),t.moveTo(this.p1.x+v*g/2,this.p1.y-_*g/2),t.lineTo(this.p2.x-v*g/2,this.p2.y+_*g/2),t.stroke();T=this.p2.x-v*g*.8,D=this.p2.y+_*g*.8,x=this.p2.x+s*e.shapes_arrowLength_2D/3-v*g,b=this.p2.y-o*e.shapes_arrowLength_2D/3+_*g,y=this.p2.x-s*e.shapes_arrowLength_2D/3-v*g,w=this.p2.y+o*e.shapes_arrowLength_2D/3+_*g;t.beginPath(),t.moveTo(this.p2.x,this.p2.y),t.lineTo(y,w),t.lineTo(T,D),t.lineTo(x,b),t.closePath(),t.fill(),t.stroke(),T=this.p1.x+v*g*.8,D=this.p1.y-_*g*.8,x=this.p1.x-s*e.shapes_arrowLength_2D/3+v*g,b=this.p1.y+o*e.shapes_arrowLength_2D/3-_*g,y=this.p1.x+s*e.shapes_arrowLength_2D/3+v*g,w=this.p1.y-o*e.shapes_arrowLength_2D/3-_*g,t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(y,w),t.lineTo(T,D),t.lineTo(x,b),t.closePath(),t.fill(),t.stroke()}else t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(this.p2.x,this.p2.y),t.stroke();(this.topText||this.bottomText)&&(t.font=F(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic),t.fillStyle=e.text_color),this.topText&&(t.textAlign="center",t.textBaseline="bottom",t.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5)),this.bottomText&&(t.textAlign="center",t.textBaseline="top",t.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(t,e){var i=Y(t,this.p1,this.p2);return-1!==i&&i<e}}(),function(t){function F(t){var e=[];if(t instanceof Zr){if(0===t.bondNumber)e.push(Is.PI);else if(t.angles){if(1===t.angles.length)e.push(t.angles[0]+Is.PI);else{for(var i=1,n=t.angles.length;i<n;i++)e.push(t.angles[i-1]+(t.angles[i]-t.angles[i-1])/2);var r=t.angles[0]+2*Is.PI,s=t.angles[t.angles.length-1];e.push(s+(r-s)/2)}if(t.largestAngle>Is.PI&&(e=[t.angleOfLeastInterference]),t.bonds)for(i=0,n=t.bonds.length;i<n;i++){var o=t.bonds[i];if(2===o.bondOrder){var a=o.getNeighbor(t);if("O"===a.label){e=[a.angle(t)];break}}}}}else{var h=t.a1.angle(t.a2);e.push(h+Is.PI/2),e.push(h+3*Is.PI/2)}for(i=0,n=e.length;i<n;i++){for(;e[i]>2*Is.PI;)e[i]-=2*Is.PI;for(;e[i]<0;)e[i]+=2*Is.PI}return e}function C(t,e){var i=3;return t instanceof Zr?(t.isLabelVisible(e)&&(i=8),0===t.charge&&0===t.numRadical&&0===t.numLonePair||(i=13)):t instanceof P?i=0:1<t.bondOrder&&(i=5),i}function R(t,e,i,n,r,s,o,a,h,l){var u=s.angle(r),c=o.angle(a),f=Is.cos(u),d=Is.sin(u),m=C(i,e);r.x-=f*m,r.y+=d*m;var p=c+Is.PI/2,g=2*e.shapes_arrowLength_2D/Is.sqrt(3),v=(f=Is.cos(c),d=Is.sin(c),Is.cos(p)),_=Is.sin(p);a.x-=5*f,a.y+=5*d;var x=new P(a.x,a.y);m=C(n,e)/3,x.x-=f*m,x.y+=d*m,a.x-=f*(.8*g+m),a.y+=d*(.8*g+m);var b=x.x-f*g*.8,y=x.y+d*g*.8,w=new P(x.x+v*e.shapes_arrowLength_2D/3-f*g,x.y-_*e.shapes_arrowLength_2D/3+d*g),T=new P(x.x-v*e.shapes_arrowLength_2D/3-f*g,x.y+_*e.shapes_arrowLength_2D/3+d*g),D=!0,S=!0;1===h&&(w.distance(s)>T.distance(s)?S=!1:D=!1),t.beginPath(),t.moveTo(x.x,x.y),S&&t.lineTo(T.x,T.y),t.lineTo(b,y),D&&t.lineTo(w.x,w.y),t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.moveTo(r.x,r.y),t.bezierCurveTo(s.x,s.y,o.x,o.y,a.x,a.y),t.stroke(),l.push([r,s,o,a])}Ls.Pusher=function(t,e,i){this.o1=t,this.o2=e,this.numElectron=i||1};var e=Ls.Pusher.prototype=new Ls._Shape;e.drawDecorations=function(t,e){if(this.isHover)for(var i=[this.o1 instanceof Zr?new P(this.o1.x,this.o1.y):this.o1.getCenter(),this.o2 instanceof Zr?new P(this.o2.x,this.o2.y):this.o2.getCenter()],n=0,r=i.length;n<r;n++){var s=i[n];this.drawAnchor(t,e,s,s===this.hoverPoint)}},e.draw=function(t,e){if(this.o1&&this.o2){t.strokeStyle=e.shapes_color,t.fillStyle=e.shapes_color,t.lineWidth=e.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt";for(var i,n,r=this.o1 instanceof Zr?new P(this.o1.x,this.o1.y):this.o1.getCenter(),s=this.o2 instanceof Zr?new P(this.o2.x,this.o2.y):this.o2.getCenter(),o=F(this.o1),a=F(this.o2),h=1/0,l=0,u=o.length;l<u;l++)for(var c=0,f=a.length;c<f;c++){var d=new P(r.x+35*Is.cos(o[l]),r.y-35*Is.sin(o[l])),m=new P(s.x+35*Is.cos(a[c]),s.y-35*Is.sin(a[c])),p=d.distance(m);p<h&&(h=p,i=d,n=m)}if(this.caches=[],-1===this.numElectron){var g=r.distance(s)/2,v=r.angle(s),_=v+Is.PI/2,x=Is.cos(v),b=Is.sin(v),y=new P(r.x+(g-1)*x,r.y-(g-1)*b),w=new P(y.x+35*Is.cos(_+Is.PI/6),y.y-35*Is.sin(_+Is.PI/6)),T=new P(r.x+(1+g)*x,r.y-(1+g)*b),D=new P(T.x+35*Is.cos(_-Is.PI/6),T.y-35*Is.sin(_-Is.PI/6));R(t,e,this.o1,y,r,i,w,y,1,this.caches),R(t,e,this.o2,T,s,n,D,T,1,this.caches)}else{if(Z(r.x,r.y,i.x,i.y,s.x,s.y,n.x,n.y)){var S=i;i=n,n=S}var C=i.angle(r),A=n.angle(s),E=Is.max(C,A)-Is.min(C,A);Is.abs(E-Is.PI)<.001&&this.o1.molCenter===this.o2.molCenter&&(C+=Is.PI/2,A-=Is.PI/2,i.x=r.x+35*Is.cos(C+Is.PI),i.y=r.y-35*Is.sin(C+Is.PI),n.x=s.x+35*Is.cos(A+Is.PI),n.y=s.y-35*Is.sin(A+Is.PI)),R(t,e,this.o1,this.o2,r,i,n,s,this.numElectron,this.caches)}}},e.getPoints=function(){return[]},e.isOver=function(t,e){for(var i=0,n=this.caches.length;i<n;i++){if(L.jsBezier.distanceFromCurve(t,this.caches[i]).distance<e)return!0}return!1}}(),function(t){var o=new Jr;Ls.VAP=function(t,e){this.asterisk=new Zr("O",t,e),this.substituent,this.bondType=1,this.attachments=[]};var e=Ls.VAP.prototype=new Ls._Shape;e.drawDecorations=function(t,e){if(this.isHover||this.isSelected){t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.lineWidth=1.2;if(this.hoverBond){var i=2*Is.PI,n=(this.asterisk.angleForStupidCanvasArcs(this.hoverBond)+Is.PI/2)%i;t.strokeStyle=this.isHover?e.colorHover:e.colorSelect,t.beginPath();var r=(n+Is.PI)%i;r%=2*Is.PI,t.arc(this.asterisk.x,this.asterisk.y,7,n,r,!1),t.stroke(),t.beginPath(),r=((n+=Is.PI)+Is.PI)%i,t.arc(this.hoverBond.x,this.hoverBond.y,7,n,r,!1),t.stroke()}else t.beginPath(),t.arc(this.asterisk.x,this.asterisk.y,7,0,2*Is.PI,!1),t.stroke()}},e.draw=function(t,e){t.strokeStyle=this.error?e.colorError:e.shapes_color,t.lineWidth=1;var i=Is.sqrt(3)/2;t.beginPath(),t.moveTo(this.asterisk.x,this.asterisk.y-4),t.lineTo(this.asterisk.x,this.asterisk.y+4),t.moveTo(this.asterisk.x-4*i,this.asterisk.y-2),t.lineTo(this.asterisk.x+4*i,this.asterisk.y+2),t.moveTo(this.asterisk.x-4*i,this.asterisk.y+2),t.lineTo(this.asterisk.x+4*i,this.asterisk.y-2),t.stroke(),this.asterisk.textBounds=[],this.asterisk.textBounds.push({x:this.asterisk.x-4,y:this.asterisk.y-4,w:8,h:8});var n=e.bonds_color;this.error&&(e.bonds_color=e.colorError),o.a1=this.asterisk,this.substituent&&(o.a2=this.substituent,o.bondOrder=this.bondType,o.draw(t,e)),o.bondOrder=0,this.error||(e.bonds_color=e.shapes_color);for(var r=0,s=this.attachments.length;r<s;r++)o.a2=this.attachments[r],o.draw(t,e);e.bonds_color=n},e.getPoints=function(){return[this.asterisk]},e.isOver=function(t,e){return!1}}();var Ns,ks,Os,zs,Us,Hs,js,qs,Ws,Gs,Xs,Vs,Ys,Zs,Qs,$s,Js,Ks,to,eo,io,no,ro,so,oo,ao,ho,lo,uo,co,fo,mo,po,go,vo,_o,xo,bo,yo,wo,To,Do,So=Math,Co={};function Ao(t,e,i,n){this.entire=t,this.name=e,this.indexes=i,this.pi=n}function Eo(t,e,i){var n=new ns(-1);return n.cp1=n.cp2=new Zr("",t,e,i),n}function Fo(t,e){this.a1=t,this.a2=e}function Ro(t,e,i){this.a1=t,this.a2=e,this.vx=i}function Po(t,e){t.bindBuffer(t.ARRAY_BUFFER,e.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,e.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.vertexNormalBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,e.vertexNormalBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)}function Bo(t,e,i){var n=mo.sqrt(e[1]*e[1]+e[2]*e[2]),r=[1,0,0,0,0,e[2]/n,-e[1]/n,0,0,e[1]/n,e[2]/n,0,0,0,0,1],s=[1,0,0,0,0,e[2]/n,e[1]/n,0,0,-e[1]/n,e[2]/n,0,0,0,0,1],o=[n,0,-e[0],0,0,1,0,0,e[0],0,n,0,0,0,0,1],a=[n,0,e[0],0,0,1,0,0,-e[0],0,n,0,0,0,0,1],h=[mo.cos(i),-mo.sin(i),0,0,mo.sin(i),mo.cos(i),0,0,0,0,1,0,0,0,0,1],l=po.multiply(r,po.multiply(o,po.multiply(h,po.multiply(a,s,[]))));this.rotate=function(){return po.multiplyVec3(l,t)}}function Mo(){}!function(t,e,i){t._Mesh=function(){};var n=t._Mesh.prototype;n.storeData=function(t,e,i){this.positionData=t,this.normalData=e,this.indexData=i},n.setupBuffers=function(t){if(this.vertexPositionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.positionData),t.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexNormalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.normalData),t.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),t.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(var e=0,i=this.partitions.length;e<i;e++){var n=this.partitions[e],r=this.generateBuffers(t,n.positionData,n.normalData,n.indexData);n.vertexPositionBuffer=r[0],n.vertexNormalBuffer=r[1],n.vertexIndexBuffer=r[2]}},n.generateBuffers=function(t,e,i,n){var r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),r.itemSize=3,r.numItems=e.length/3;var s,o=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),o.itemSize=3,o.numItems=i.length/3,n&&(s=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),t.STATIC_DRAW),s.itemSize=1,s.numItems=n.length),[r,o,s]},n.bindBuffers=function(t){this.vertexPositionBuffer||this.setupBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexNormalBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,t.FLOAT,!1,0,0),this.vertexIndexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(Co),function(t,e){t._Measurement=function(){};var i=t._Measurement.prototype=new t._Mesh;i.render=function(t,e){t.shader.setMatrixUniforms(t),e.measurement_update_3D&&(this.vertexPositionBuffer=void 0,this.text=void 0),this.vertexPositionBuffer||this.calculateData(e),this.bindBuffers(t),t.material.setDiffuseColor(t,e.shapes_color),t.lineWidth(e.shapes_lineWidth),t.drawElements(t.LINES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},i.renderText=function(t,e){t.shader.setMatrixUniforms(t),this.text||(this.text=this.getText(e));var i={position:[],texCoord:[],translation:[]};t.textImage.pushVertexData(this.text.value,this.text.pos,1,i),t.textMesh.storeData(t,i.position,i.texCoord,i.translation),t.textImage.useTexture(t),t.textMesh.render(t)}}(Co),function(t,m,e,i,p,n,g,r){e.Angle=function(t,e,i){this.a1=t,this.a2=e,this.a3=i};var s=e.Angle.prototype=new e._Measurement;s.calculateData=function(t){var e=[],i=[],n=[],r=this.a2.distance3D(this.a1),s=this.a2.distance3D(this.a3);this.distUse=p.min(r,s)/2,this.vec1=g.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]),this.vec2=g.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]),this.angle=m.vec3AngleFrom(this.vec1,this.vec2);for(var o=g.normalize(g.cross(this.vec1,this.vec2,[])),a=g.normalize(g.cross(o,this.vec1,[])),h=t.measurement_angleBands_3D,l=0;l<=h;++l){var u=this.angle*l/h,c=g.scale(this.vec1,p.cos(u),[]),f=g.scale(a,p.sin(u),[]),d=g.scale(g.normalize(g.add(c,f,[])),this.distUse);e.push(this.a2.x+d[0],this.a2.y+d[1],this.a2.z+d[2]),i.push(0,0,0),l<h&&n.push(l,l+1)}this.storeData(e,i,n)},s.getText=function(t){var e=g.scale(g.normalize(g.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+e[0],this.a2.y+e[1],this.a2.z+e[2]],value:[i.angleBounds(this.angle,!0).toFixed(2)," "].join("")}}}(0,r,Co,o,So,L.mat4,L.vec3),ks=So,(Ns=Co).Arrow=function(t,e){for(var i=[],n=[],r=0;r<=e;r++){var s=2*r*ks.PI/e,o=ks.sin(s),a=ks.cos(s),h=o;n.push(0,0,-1,0,0,-1,a,h,0,a,h,0,0,0,-1,0,0,-1,a,h,1,a,h,1),i.push(0,0,0,t*a,t*h,0,t*a,t*h,0,t*a,t*h,2,t*a,t*h,2,t*a*2,t*h*2,2,t*a*2,t*h*2,2,0,0,3)}for(var l=[],u=0;u<e;u++)for(var c=8*u,f=0;f<7;f++){var d=f+c,m=d+1,p=d+7+2,g=p-1;l.push(d,p,m,p,d,g)}this.storeData(i,n,l)},Ns.Arrow.prototype=new Ns._Mesh,(Os=Co).Box=function(t,e,i){t/=2,i/=2;var n=[],r=[];n.push(t,e,-i),n.push(t,e,-i),n.push(-t,e,-i),n.push(t,e,i),n.push(-t,e,i),n.push(-t,e,i);for(var s=6;s--;r.push(0,1,0));for(n.push(-t,e,i),n.push(-t,e,i),n.push(-t,0,i),n.push(t,e,i),n.push(t,0,i),n.push(t,0,i),s=6;s--;r.push(0,0,1));for(n.push(t,e,i),n.push(t,e,i),n.push(t,0,i),n.push(t,e,-i),n.push(t,0,-i),n.push(t,0,-i),s=6;s--;r.push(1,0,0));for(n.push(t,e,-i),n.push(t,e,-i),n.push(t,0,-i),n.push(-t,e,-i),n.push(-t,0,-i),n.push(-t,0,-i),s=6;s--;r.push(0,0,-1));for(n.push(-t,e,-i),n.push(-t,e,-i),n.push(-t,0,-i),n.push(-t,e,i),n.push(-t,0,i),n.push(-t,0,i),s=6;s--;r.push(-1,0,0));for(n.push(-t,0,i),n.push(-t,0,i),n.push(-t,0,-i),n.push(t,0,i),n.push(t,0,-i),n.push(t,0,-i),s=6;s--;r.push(0,-1,0));this.storeData(n,r)},Os.Box.prototype=new Os._Mesh,function(t,e,i,n,r,s){e.Camera=function(){this.fieldOfView=45,this.aspect=1,this.near=.1,this.far=1e4,this.zoom=1,this.viewMatrix=n.identity([]),this.projectionMatrix=n.identity([])};var o=e.Camera.prototype;o.perspectiveProjectionMatrix=function(){var t=r.tan(this.fieldOfView/360*r.PI)*this.near*this.zoom,e=this.aspect*t;return n.frustum(-e,e,-t,t,this.near,this.far,this.projectionMatrix)},o.orthogonalProjectionMatrix=function(){var t=r.tan(this.fieldOfView/360*r.PI)*((this.far-this.near)/2+this.near)*this.zoom,e=this.aspect*t;return n.ortho(-e,e,-t,t,this.near,this.far,this.projectionMatrix)},o.updateProjectionMatrix=function(t){return t?this.perspectiveProjectionMatrix():this.orthogonalProjectionMatrix()},o.focalLength=function(){return(this.far-this.near)/2+this.near},o.zoomIn=function(){this.zoom=r.min(1.25*this.zoom,200)},o.zoomOut=function(){this.zoom=r.max(this.zoom/1.25,.0025)}}(0,Co,L.vec3,L.mat4,So),function(_,x,b,t){_.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},_.LineArrow.prototype=new _._Mesh,_.Compass=function(t,e){this.textImage=new _.TextImage,this.textImage.init(t),this.textImage.updateFont(t,e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic,e.text_font_stroke_3D),this.textMesh=new _.TextMesh,this.textMesh.init(t);var i,n,r=3/(e.compass_size_3D/t.canvas.clientHeight),s=x.tan(e.projectionPerspectiveVerticalFieldOfView_3D/360*x.PI),o=r/s,a=x.max(o-r,.1),h=o+r,l=t.canvas.clientWidth/t.canvas.clientHeight;i=e.projectionPerspective_3D?(n=a,b.frustum):(n=o,b.ortho);var u=n/t.canvas.clientHeight*2*s,c=s*n,f=-c,d=l*f,m=l*c;if(0===e.compass_type_3D){var p=(-(t.canvas.clientWidth-e.compass_size_3D)/2+this.textImage.charHeight)*u,g=(-(t.canvas.clientHeight-e.compass_size_3D)/2+this.textImage.charHeight)*u;d-=p,m-=p,f-=g,c-=g}this.projectionMatrix=i(d,m,f,c,a,h),this.translationMatrix=b.translate(b.identity([]),[0,0,-o]);var v={position:[],texCoord:[],translation:[]};this.textImage.pushVertexData("X",[3.5,0,0],0,v),this.textImage.pushVertexData("Y",[0,3.5,0],0,v),this.textImage.pushVertexData("Z",[0,0,3.5],0,v),this.textMesh.storeData(t,v.position,v.texCoord,v.translation)};var e=_.Compass.prototype;e.renderArrow=function(t,e,i,n){t.material.setDiffuseColor(t,i),t.shader.setModelViewMatrix(t,n),1===e?t.drawArrays(t.LINES,0,t.lineArrowBuffer.vertexPositionBuffer.numItems):t.drawElements(t.TRIANGLES,t.arrowBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},e.render=function(t,e){t.shader.setProjectionMatrix(t,this.projectionMatrix),1===e.compass_type_3D?t.lineArrowBuffer.bindBuffers(t):t.arrowBuffer.bindBuffers(t),t.material.setTempColors(t,e.bonds_materialAmbientColor_3D,void 0,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D);var i=b.multiply(this.translationMatrix,t.rotationMatrix,[]),n=x.PI/2;this.renderArrow(t,e.compass_type_3D,e.compass_axisXColor_3D,b.rotateY(i,n,[])),this.renderArrow(t,e.compass_type_3D,e.compass_axisYColor_3D,b.rotateX(i,-n,[])),this.renderArrow(t,e.compass_type_3D,e.compass_axisZColor_3D,i)},e.renderAxis=function(t){t.shader.setProjectionMatrix(t,this.projectionMatrix);var e=b.multiply(this.translationMatrix,t.rotationMatrix,[]);t.shader.setModelViewMatrix(t,e),this.textImage.useTexture(t),this.textMesh.render(t)}}(Co,So,L.mat4),Us=So,(zs=Co).Cylinder=function(t,e,i,n){var r=[],s=[];if(n){for(var o=0;o<=i;o++){var a=o%i*2*Us.PI/i,h=Us.cos(a),l=Us.sin(a);s.push(0,-1,0),r.push(0,0,0),s.push(0,-1,0),r.push(t*h,0,t*l)}for(o=0;o<=i;o++)a=o%i*2*Us.PI/i,h=Us.cos(a),l=Us.sin(a),s.push(h,0,l),r.push(t*h,0,t*l),s.push(h,0,l),r.push(t*h,e,t*l);for(o=0;o<=i;o++)a=o%i*2*Us.PI/i,h=Us.cos(a),l=Us.sin(a),s.push(0,1,0),r.push(t*h,e,t*l),s.push(0,1,0),r.push(0,e,0)}else{for(o=0;o<i;o++)a=2*o*Us.PI/i,h=Us.cos(a),l=Us.sin(a),s.push(h,0,l),r.push(t*h,0,t*l),s.push(h,0,l),r.push(t*h,e,t*l);s.push(1,0,0),r.push(t,0,0),s.push(1,0,0),r.push(t,e,0)}this.storeData(r,s)},zs.Cylinder.prototype=new zs._Mesh,function(s,t,o,a,e){t.Distance=function(t,e,i,n){this.a1=t,this.a2=e,this.node=i,this.offset=n||0};var i=t.Distance.prototype=new t._Measurement;i.calculateData=function(t){var e=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];if(this.node){var i=t.atoms_useVDWDiameters_3D?s[this.a1.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2,n=t.atoms_useVDWDiameters_3D?s[this.a2.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2;this.move=this.offset+o.max(i,n),this.displacement=[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],a.normalize(this.displacement);var r=a.scale(this.displacement,this.move,[]);e[0]+=r[0],e[1]+=r[1],e[2]+=r[2],e[3]+=r[0],e[4]+=r[1],e[5]+=r[2]}this.storeData(e,[0,0,0,0,0,0],[0,1])},i.getText=function(t){var e=this.a1.distance3D(this.a2),i=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){var n=a.scale(this.displacement,this.move+.1,[]);i[0]+=n[0],i[1]+=n[1],i[2]+=n[2]}return{pos:i,value:[e.toFixed(2)," "].join("")}}}(_e,Co,So,L.vec3),Hs=o,js=Co,L.vec3,js.Fog=function(t,e,i,n){this.fogScene(t,e,i,n)},js.Fog.prototype.fogScene=function(t,e,i,n){this.colorRGB=Hs.getRGB(t,1),this.fogStart=e,this.fogEnd=i,this.density=n},function(y,t,e){t.Label=function(t){};var i=t.Label.prototype;i.updateVerticesBuffer=function(t,e,i){for(var n=0,r=e.length;n<r;n++){for(var s=e[n],o=s.labelMesh,a=s.atoms,h={position:[],texCoord:[],translation:[]},l=0<a.length&&null!=a[0].hetatm,u=0,c=a.length;u<c;u++){var f=(b=a[u]).label,d=.05;if(i.atoms_useVDWDiameters_3D){var m=y[f].vdWRadius*i.atoms_vdwMultiplier_3D;0===m&&(m=1),d+=m}else i.atoms_sphereDiameter_3D&&(d+=i.atoms_sphereDiameter_3D/2*1.5);if(l)if(b.hetatm){if(b.isWater&&!i.macro_showWaters)continue}else if(!i.macro_displayAtoms)continue;t.textImage.pushVertexData(b.altLabel?b.altLabel:b.label,[b.x,b.y,b.z],d,h)}var p=s.chains;if(p&&(i.proteins_displayRibbon||i.proteins_displayBackbone))for(u=0,c=p.length;u<c;u++)for(var g=p[u],v=0,_=g.length;v<_;v++){var x=g[v];if(x.name){var b=x.cp1;t.textImage.pushVertexData(x.name,[b.x,b.y,b.z],2,h)}}o.storeData(t,h.position,h.texCoord,h.translation,h.zDepth)}},i.render=function(t,e,i){t.shader.setMatrixUniforms(t),t.textImage.useTexture(t);for(var n=0,r=i.length;n<r;n++)i[n].labelMesh&&i[n].labelMesh.render(t)}}(_e,Co),Ws=So,(qs=Co).Sphere=function(t,e,i){for(var n=[],r=[],s=0;s<=e;s++)for(var o=s*Ws.PI/e,a=Ws.sin(o),h=Ws.cos(o),l=0;l<=i;l++){var u=2*l*Ws.PI/i,c=Ws.sin(u),f=Ws.cos(u)*a,d=h,m=c*a;r.push(f,d,m),n.push(t*f,t*d,t*m)}var p=[];for(i+=1,s=0;s<e;s++)for(l=0;l<i;l++){var g=s*i+l%i,v=g+i;p.push(g,1+g,v),l<i-1&&p.push(v,1+g,v+1)}this.storeData(n,r,p)},qs.Sphere.prototype=new qs._Mesh,Gs=ye,Xs=Co,Vs=So,Ys=L.vec3,(Qs=Ao.prototype).getColor=function(t){return t.macro_colorByChain?this.entire.chainColor:this.name?this.getResidueColor(Gs[this.name]?this.name:"*",t):this.helix?this.entire.front?t.proteins_ribbonCartoonHelixPrimaryColor:t.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?t.proteins_ribbonCartoonSheetColor:this.entire.front?t.proteins_primaryColor:t.proteins_secondaryColor},Qs.getResidueColor=function(t,e){var i=Gs[t];return"shapely"===e.proteins_residueColor?i.shapelyColor:"amino"===e.proteins_residueColor?i.aminoColor:"polarity"===e.proteins_residueColor?i.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?1===i.acidity?"#0000FF":-1===i.acidity?"#FF0000":i.polar?"#FFFFFF":"#773300":"#FFFFFF"},Qs.render=function(t,e,i){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(function(t,e){t.bindBuffer(t.ARRAY_BUFFER,e.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,e.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.vertexNormalBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,e.vertexNormalBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)}(t,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),t.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),i||"rainbow"===e.proteins_residueColor||t.material.setDiffuseColor(t,this.getColor(e)),t.drawElements(t.TRIANGLES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},Xs.Ribbon=function(t,e,i){var n=t[0].lineSegments.length,r=t[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0,this.front=0<e;for(var s=0,o=t.length;s<o;s++){(!S||65e3<S.positionData.length)&&(0<this.partitions.length&&s--,S={count:0,positionData:[],normalData:[]},this.partitions.push(S));var a=t[s];S.count++;for(var h=0;h<n;h++)for(var l=i?a.lineSegmentsCartoon[h]:a.lineSegments[h],u=0===h,c=!1,f=0;f<r;f++){var d=l[f],m=s,p=f+1;s===t.length-1&&f===r-1?p--:f===r-1&&(m++,p=0);var g=i?t[m].lineSegmentsCartoon[h][p]:t[m].lineSegments[h][p],v=!1,_=h+1;h===n-1&&(_-=2,v=!0);var x=i?a.lineSegmentsCartoon[_][f]:a.lineSegments[_][f],b=[g.x-d.x,g.y-d.y,g.z-d.z],y=[x.x-d.x,x.y-d.y,x.z-d.z],w=Ys.cross(b,y,[]);0===f&&(Ys.normalize(b),Ys.scale(b,-1),S.normalData.push(b[0],b[1],b[2]),S.positionData.push(d.x,d.y,d.z)),u||c?(Ys.normalize(y),Ys.scale(y,-1),S.normalData.push(y[0],y[1],y[2]),S.positionData.push(d.x,d.y,d.z),u&&f===r-1&&(u=!1,f=-1)):(Ys.normalize(w),(v&&!this.front||!v&&this.front)&&Ys.scale(w,-1),S.normalData.push(w[0],w[1],w[2]),Ys.scale(w,Vs.abs(e)),S.positionData.push(d.x+w[0],d.y+w[1],d.z+w[2]),h===n-1&&f===r-1&&(c=!0,f=-1)),-1!==f&&f!==r-1||(Ys.normalize(b),S.normalData.push(b[0],b[1],b[2]),S.positionData.push(d.x,d.y,d.z))}}n+=2,r+=2,this.segments=[],this.partitionSegments=[];for(var T=0,D=this.partitions.length;T<D;T++){var S,C,A=[];for(s=0,o=(S=this.partitions[T]).count-1;s<o;s++){var E=s;for(h=0;h<T;h++)E+=this.partitions[h].count-1;for(var F=t[E],R=s*n*r,P=[],B=(h=0,n-1);h<B;h++){var M=R+h*r;for(f=0;f<r-1;f++){var I=1;s===o&&(I=0);var L=[M+f,M+r+f,M+r+f+I,M+f,M+f+I,M+r+f+I];if(f!==r-1&&(this.front?P.push(L[0],L[1],L[2],L[3],L[5],L[4]):P.push(L[0],L[2],L[1],L[3],L[4],L[5])),f===r-2&&(s!==S.count-2||T!==this.partitions.length-1)){var N=n*r-f;L[2]+=N,L[4]+=N,L[5]+=N}this.front?A.push(L[0],L[1],L[2],L[3],L[5],L[4]):A.push(L[0],L[2],L[1],L[3],L[4],L[5])}}i&&F.split&&((C=new Ao(this,Zs,A,T)).helix=F.helix,C.sheet=F.sheet,this.partitionSegments.push(C),A=[]),this.segments.push(new Ao(this,F.name,P,T))}(C=new Ao(this,Zs,A,T)).helix=F.helix,C.sheet=F.sheet,this.partitionSegments.push(C)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData),1===this.partitions.length&&(this.partitions=Zs)},(Xs.Ribbon.prototype=new Xs._Mesh).render=function(t,e){this.bindBuffers(t);var i=e.macro_colorByChain?this.chainColor:Zs;i||(i=this.front?e.proteins_primaryColor:e.proteins_secondaryColor),t.material.setDiffuseColor(t,i);for(var n=0,r=this.partitionSegments.length;n<r;n++)this.partitionSegments[n].render(t,e,!e.proteins_ribbonCartoonize)},function(n,r,s,o,t){r.Light=function(t,e,i){this.camera=new r.Camera,this.lightScene(t,e,i)};var e=r.Light.prototype;e.lightScene=function(t,e,i){this.diffuseRGB=n.getRGB(t,1),this.specularRGB=n.getRGB(e,1),this.direction=i,this.updateView()},e.updateView=function(){var t=s.normalize(this.direction,[]),e=s.scale(t,(this.camera.near-this.camera.far)/2-this.camera.near,[]),i=s.equal(t,[0,1,0])?[0,0,1]:[0,1,0];o.lookAt(e,[0,0,0],i,this.camera.viewMatrix),this.camera.orthogonalProjectionMatrix()}}(o,Co,L.vec3,L.mat4),($s=Co).Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])},$s.Line.prototype=new $s._Mesh,function(s,t,e){t.Material=function(){};var i=t.Material.prototype;i.setTempColors=function(t,e,i,n,r){e&&t.shader.setMaterialAmbientColor(t,s.getRGB(e,1)),i&&t.shader.setMaterialDiffuseColor(t,s.getRGB(i,1)),n&&t.shader.setMaterialSpecularColor(t,s.getRGB(n,1)),t.shader.setMaterialShininess(t,r),t.shader.setMaterialAlpha(t,1)},i.setDiffuseColor=function(t,e){t.shader.setMaterialDiffuseColor(t,s.getRGB(e,1))},i.setAlpha=function(t,e){t.shader.setMaterialAlpha(t,e)}}(o,Co),function(t,e,i,n){t.Picker=function(){};var r=t.Picker.prototype;r.init=function(t){this.framebuffer=t.createFramebuffer();var e=t.createTexture(),i=t.createRenderbuffer();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindRenderbuffer(t.RENDERBUFFER,i),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,i),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setDimension=function(t,e,i){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer);var n=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);t.isRenderbuffer(n)&&(t.bindRenderbuffer(t.RENDERBUFFER,n),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e,i),t.bindRenderbuffer(t.RENDERBUFFER,null));var r=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);t.isTexture(r)&&(t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,null)),t.bindFramebuffer(t.FRAMEBUFFER,null)}}(Co,0,document),Ks=So,(Js=Co).Pill=function(t,e,i,n){var r=1,s=2*t;(e-=s)<0?(r=0,e+=s):e<s&&(r=e/s,e=s);for(var o=[],a=[],h=0;h<=i;h++)for(var l=h*Ks.PI/i,u=Ks.sin(l),c=Ks.cos(l)*r,f=0;f<=n;f++){var d=2*f*Ks.PI/n,m=Ks.sin(d),p=Ks.cos(d)*u,g=c,v=m*u;a.push(p,g,v),o.push(t*p,t*g+(h<i/2?e:0),t*v)}var _=[];for(n+=1,h=0;h<i;h++)for(f=0;f<n;f++){var x=h*n+f%n,b=x+n;_.push(x,1+x,b),f<n-1&&_.push(b,1+x,b+1)}this.storeData(o,a,_)},Js.Pill.prototype=new Js._Mesh,to=r,eo=Co,io=So,no=L.mat4,ro=L.vec3,Fo.prototype.render=function(t,e){var i,n=this.a1,r=this.a2,s=1.001*n.distance3D(r),o=e.proteins_cylinderHelixDiameter/2,a=[o,s,o],h=no.translate(no.identity(),[n.x,n.y,n.z]),l=[0,1,0],u=0;if(n.x===r.x&&n.z===r.z)i=[0,0,1],r.y<n.y&&(u=io.PI);else{var c=[r.x-n.x,r.y-n.y,r.z-n.z];u=to.vec3AngleFrom(l,c),i=ro.cross(l,c,[])}0!==u&&no.rotate(h,u,i),no.scale(h,a),t.shader.setMatrixUniforms(t,h),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderClosedBuffer.vertexPositionBuffer.numItems)},Ro.prototype.render=function(t,e){this.specs&&(e=this.specs);var i=1.001*this.a1.distance3D(this.a2),n=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=ro.cross(n,this.vx,[]),s=ro.cross(r,n,[]);ro.normalize(s),ro.normalize(n),ro.normalize(r);var o=[s[0],s[1],s[2],0,n[0],n[1],n[2],0,r[0],r[1],r[2],0,this.a1.x,this.a1.y,this.a1.z,1],a=[e.proteins_plankSheetWidth,i,e.proteins_tubeThickness];no.scale(o,a),t.shader.setMatrixUniforms(t,o),t.drawArrays(t.TRIANGLE_STRIP,0,t.boxBuffer.vertexPositionBuffer.numItems)},eo.PipePlank=function(t,e){this.tubes=[],this.helixCylinders=[],this.sheetPlanks=[],this.chainColor=t.chainColor;var i=[],n=[],r=[],s=[];if(1<t.length){var o=t[0],a=t[1];a.helix?r.push(o):a.sheet?s.push(o):n.push(o)}for(var h=1,l=t.length-1;h<=l;h++){var u=t[h];if(u.helix){if(r.push(u),u.arrow){var c=ro.create(),f=ro.create();if(2==r.length)c=[r[0].cp1.x,r[0].cp1.y,r[0].cp1.z],f=[r[1].cp1.x,r[1].cp1.y,r[1].cp1.z];else{3==r.length&&r.unshift(t[io.max(h-3,0)]);for(var d=[],m=[],p=1,g=r.length-1;p<g;p++){var v=[r[p].cp1.x,r[p].cp1.y,r[p].cp1.z],_=[r[p-1].cp1.x,r[p-1].cp1.y,r[p-1].cp1.z],x=[r[p+1].cp1.x,r[p+1].cp1.y,r[p+1].cp1.z];ro.subtract(_,v),ro.subtract(x,v);var b=ro.scale(_,ro.length(x),[]),y=ro.scale(x,ro.length(_),[]),w=ro.normalize(ro.add(b,y,[]));d.push(v),m.push(w)}var T=[];for(p=0,g=d.length-1;p<g;p++){var D=d[p],S=m[p],C=d[p+1],A=m[p+1],E=ro.normalize(ro.cross(S,A,[])),F=ro.subtract(C,D,[]),R=ro.dot(F,E),P=ro.scale(E,R,[]),B=ro.length(P),M=ro.length(F),I=-(B*B-M*M)/(2*ro.dot(ro.subtract(D,C,[]),A)),L=ro.add(D,ro.scale(S,I,[]),[]),N=ro.add(C,ro.scale(A,I,[]),[]);T.push([L,N])}var k=T[0][0],O=T[0][1],z=ro.subtract(k,O,[]);ro.add(k,z,c),k=T[T.length-1][1],O=T[T.length-1][0],z=ro.subtract(k,O,[]),ro.add(k,z,f)}var U=new Zr("",c[0],c[1],c[2]),H=new Zr("",f[0],f[1],f[2]);this.helixCylinders.push(new Fo(U,H)),r=[];var j=ro.subtract(c,f,[]);if(ro.normalize(j),ro.scale(j,.5),0<n.length){var q=ro.add(c,j,[]),W=n[n.length-1].cp1,G=ro.subtract([W.x,W.y,W.z],q,[]);ro.normalize(G),ro.scale(G,.5),ro.add(q,G),(X=new ns(-1)).cp1=X.cp2=new Zr("",q[0],q[1],q[2]),n.push(X);var X=Eo(c[0],c[1],c[2]);n.push(X),i.push(n)}if(n=[],h<l)if(X=Eo(f[0],f[1],f[2]),n.push(X),(rt=t[h+1]).sheet)n.push(u),n.push(u),i.push(n),n=[],s.push(u);else{ro.scale(j,-1),q=ro.add(f,j,[]);var V=rt.cp1,Y=ro.subtract([V.x,V.y,V.z],q,[]);ro.normalize(Y),ro.scale(Y,.5),ro.add(q,Y),X=Eo(q[0],q[1],q[2]),n.push(X)}}}else if(u.sheet){if(s.push(u),u.arrow){var Z=[0,0,0],Q=[0,0,0];for(p=0,g=s.length;p<g;p++){var $=(st=s[p].guidePointsLarge)[0],J=st[st.length-1];ro.add(Z,[$.x,$.y,$.z]),ro.add(Q,[J.x,J.y,J.z])}ro.scale(Z,1/g),ro.scale(Q,1/g);var K=ro.subtract(Z,Q),tt=s[0],et=s[s.length-1],it=tt.guidePointsSmall[0],nt=et.guidePointsSmall[0];this.sheetPlanks.push(new Ro(it,nt,K)),s=[],h<l&&((rt=t[h+1]).sheet?s.push(u):(X=Eo(nt.x,nt.y,nt.z),n.push(X)))}}else{var rt,st;if(n.push(u),h<l&&(rt=t[h+1]).sheet)X=Eo((st=u.guidePointsSmall[0]).x,st.y,st.z),n.push(X),i.push(n),n=[],s.push(u)}}1<n.length&&(2==n.length&&n.push(n[n.length-1]),i.push(n)),n=[];for(var ot=[],at=0,ht=i.length;at<ht;at++){var lt=i[at],ut=[];for(h=0,l=lt.length-1;h<=l;h++)ut.push(lt[h].cp1);ot.push(ut)}for(h=0,l=ot.length;h<l;h++){var ct=new eo.CatmullTube(ot[h],e.proteins_tubeThickness,e.proteins_tubeResolution_3D,e.proteins_horizontalResolution);ct.chainColor=t.chainColor,this.tubes.push(ct)}},(eo.PipePlank.prototype=new eo._Mesh).render=function(t,e){t.material.setTempColors(t,e.proteins_materialAmbientColor_3D,void 0,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),t.material.setDiffuseColor(t,e.macro_colorByChain?this.chainColor:e.proteins_tubeColor);for(var i=0,n=this.tubes.length;i<n;i++)t.shader.setMatrixUniforms(t),this.tubes[i].render(t,e);for(e.macro_colorByChain||t.material.setDiffuseColor(t,e.proteins_ribbonCartoonHelixSecondaryColor),t.cylinderClosedBuffer.bindBuffers(t),i=0,n=this.helixCylinders.length;i<n;i++)this.helixCylinders[i].render(t,e);for(e.macro_colorByChain||t.material.setDiffuseColor(t,e.proteins_ribbonCartoonSheetColor),t.boxBuffer.bindBuffers(t),i=0,n=this.sheetPlanks.length;i<n;i++)this.sheetPlanks[i].render(t,e)},(so=Co).Quad=function(){this.storeData([-1,1,0,-1,-1,0,1,1,0,1,-1,0],[0,0,0,0,0,0,0,0,0,0,0,0])},so.Quad.prototype=new so._Mesh,oo=Co,ao=L.vec3,oo.Shape=function(t,e){for(var i=t.length,n=[],r=[],s=new P,o=0,a=i;o<a;o++){var h=o+1;o===a-1&&(h=0);for(var l=t[o],u=t[h],c=[u.x-l.x,u.y-l.y,0],f=ao.cross([0,0,1],c),d=0;d<2;d++)n.push(l.x,l.y,e/2),n.push(l.x,l.y,-e/2),n.push(u.x,u.y,e/2),n.push(u.x,u.y,-e/2);for(d=0;d<4;d++)r.push(f[0],f[1],f[2]);r.push(0,0,1),r.push(0,0,-1),r.push(0,0,1),r.push(0,0,-1),s.add(l)}s.x/=i,s.y/=i,r.push(0,0,1),n.push(s.x,s.y,e/2),r.push(0,0,-1),n.push(s.x,s.y,-e/2);var m=[],p=8*i;for(o=0,a=i;o<a;o++){var g=8*o;m.push(g),m.push(3+g),m.push(1+g),m.push(g),m.push(2+g),m.push(3+g),m.push(4+g),m.push(p),m.push(6+g),m.push(5+g),m.push(7+g),m.push(1+p)}this.storeData(n,r,m)},oo.Shape.prototype=new oo._Mesh,ho=Co,lo=L.vec3,ho.Star=function(){for(var t=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],e=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],i=[],n=[],r=[],s=0,o=e.length;s<o;s+=3){var a=3*e[s],h=3*e[s+1],l=3*e[s+2],u=[t[a],t[1+a],t[2+a]],c=[t[h],t[1+h],t[2+h]],f=[t[l],t[1+l],t[2+l]],d=[u[0]-c[0],u[1]-c[1],u[2]-c[2]],m=[f[0]-c[0],f[1]-c[1],f[2]-c[2]],p=lo.cross(m,d,[]);lo.normalize(p),i.push(u[0],u[1],u[2],c[0],c[1],c[2],f[0],f[1],f[2]),n.push(p[0],p[1],p[2],p[0],p[1],p[2],p[0],p[1],p[2]),r.push(s,s+1,s+2)}this.storeData(i,n,r)},ho.Star.prototype=new ho._Mesh,function(t,E,e,i,n){var F=1;i.devicePixelRatio&&(F=i.devicePixelRatio),t.TextImage=function(){this.ctx=e.createElement("canvas").getContext("2d"),this.data=[],this.text="",this.charHeight=0};var r=t.TextImage.prototype;r.init=function(t){this.textureImage=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.textureImage),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,null),this.updateFont(t,12,["Sans-serif"],!1,!1,!1)},r.charData=function(t){var e=this.text.indexOf(t);return 0<=e?this.data[e]:null},r.updateFont=function(t,e,i,n,r,s){var o=this.ctx,a=this.ctx.canvas,h=[],l="";e*=F;var u=E.getFontString(e,i,n,r);o.font=u,o.save();for(var c=0,f=1.5*e,d=32,m=127;d<m;d++){var p=String.fromCharCode(d),g=o.measureText(p).width;h.push({text:p,width:g,height:f}),c+=2*g}var v="".split("");for(d=0,m=v.length;d<m;d++){p=v[d],g=o.measureText(p).width;h.push({text:p,width:g,height:f}),c+=2*g}var _=c*f,x=So.sqrt(_),b=So.ceil(x/f),y=So.ceil(c/(b-1));a.width=y,a.height=b*f,o.font=u,o.textAlign="left",o.textBaseline="middle",o.strokeStyle="#000",o.lineWidth=1.4,o.fillStyle="#fff";var w=0,T=0;for(d=0,m=h.length;d<m;d++){var D=h[d],S=2*D.width,C=(f=D.height,D.text);y<T+S&&(w++,T=0);var A=w*f;s&&o.strokeText(C,T,A+f/2),o.fillText(C,T,A+f/2),D.x=T,D.y=A,l+=C,T+=S}this.text=l,this.data=h,this.charHeight=f,t.bindTexture(t.TEXTURE_2D,this.textureImage),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.bindTexture(t.TEXTURE_2D,null)},r.pushVertexData=function(t,e,i,n){for(var r=t.toString().split(""),s=this.getHeight(),o=this.getWidth(),a=-this.textWidth(t)/2/F,h=-this.charHeight/2/F,l=0,u=r.length;l<u;l++){var c=this.charData(r[l]),f=c.width,d=c.x/o,m=d+1.8*c.width/o,p=c.y/s,g=p+c.height/s,v=a+1.8*f/F,_=this.charHeight/2/F;n.position.push(e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2]),n.texCoord.push(d,p,m,g,m,p,d,p,d,g,m,g),n.translation.push(a,_,i,v,h,i,v,_,i,a,_,i,a,h,i,v,h,i),a=v+(f-1.8*f)/F}},r.getCanvas=function(){return this.ctx.canvas},r.getHeight=function(){return this.getCanvas().height},r.getWidth=function(){return this.getCanvas().width},r.textWidth=function(t){return this.ctx.measureText(t).width},r.test=function(){e.body.appendChild(this.getCanvas())},r.useTexture=function(t){t.bindTexture(t.TEXTURE_2D,this.textureImage)}}(Co,r,document,window),function(t,e,i){t.TextMesh=function(){};var n=t.TextMesh.prototype;n.init=function(t){this.vertexPositionBuffer=t.createBuffer(),this.vertexTexCoordBuffer=t.createBuffer(),this.vertexTranslationBuffer=t.createBuffer()},n.setVertexData=function(t,e,i,n){t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),e.itemSize=n,e.numItems=i.length/n},n.storeData=function(t,e,i,n){this.setVertexData(t,this.vertexPositionBuffer,e,3),this.setVertexData(t,this.vertexTexCoordBuffer,i,2),this.setVertexData(t,this.vertexTranslationBuffer,n,3)},n.bindBuffers=function(t){t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.vertexAttribPointer(t.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexTexCoordBuffer),t.vertexAttribPointer(t.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexTranslationBuffer),t.vertexAttribPointer(t.shader.vertexNormalAttribute,this.vertexTranslationBuffer.itemSize,t.FLOAT,!1,0,0)},n.render=function(t){var e=this.vertexPositionBuffer.numItems;e&&(this.bindBuffers(t),t.drawArrays(t.TRIANGLES,0,e))}}(Co),function(t,e,i,y,n,w,r){i.Torsion=function(t,e,i,n){this.a1=t,this.a2=e,this.a3=i,this.a4=n};var s=i.Torsion.prototype=new i._Measurement;s.calculateData=function(t){var e=[],i=[],n=[],r=this.a2.distance3D(this.a1),s=this.a2.distance3D(this.a3);this.distUse=y.min(r,s)/2;var o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z],h=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],l=w.cross(o,a,[]),u=w.cross(a,h,[]);w.scale(o,w.length(a)),this.torsion=y.atan2(w.dot(o,u),w.dot(l,u));var c=w.normalize(w.cross(l,a,[])),f=w.normalize(w.cross(a,c,[]));this.pos=w.add([this.a2.x,this.a2.y,this.a2.z],w.scale(w.normalize(a,[]),this.distUse));for(var d=[],m=t.measurement_angleBands_3D,p=0;p<=m;++p){var g=this.torsion*p/m,v=w.scale(c,y.cos(g),[]),_=w.scale(f,y.sin(g),[]),x=w.scale(w.normalize(w.add(v,_,[])),this.distUse);0==p&&(d=x),e.push(this.pos[0]+x[0],this.pos[1]+x[1],this.pos[2]+x[2]),i.push(0,0,0),p<m&&n.push(p,p+1)}this.vecText=w.normalize(w.add(d,x,[]));var b=w.normalize(a,[]);w.scale(b,.0625);g=this.torsion-2*y.asin(.125)*this.torsion/y.abs(this.torsion),v=w.scale(c,y.cos(g),[]),_=w.scale(f,y.sin(g),[]),x=w.scale(w.normalize(w.add(v,_,[])),this.distUse);e.push(this.pos[0]+b[0]+x[0],this.pos[1]+b[1]+x[1],this.pos[2]+b[2]+x[2]),i.push(0,0,0),e.push(this.pos[0]-b[0]+x[0],this.pos[1]-b[1]+x[1],this.pos[2]-b[2]+x[2]),i.push(0,0,0),n.push(--p,p+1,p,p+2),this.storeData(e,i,n)},s.getText=function(t){return w.add(this.pos,w.scale(this.vecText,this.distUse+.3,[])),{pos:this.pos,value:[e.angleBounds(this.torsion,!0,!0).toFixed(2)," "].join("")}}}(0,o,Co,So,L.mat4,L.vec3),uo=r,co=ye,fo=Co,mo=So,po=L.mat4,go=L.vec3,vo=o,fo.Tube=function(T,D,t){var e=T[0].lineSegments[0].length;this.partitions=[],this.ends=[],this.ends.push(T[0].lineSegments[0][0]),this.ends.push(T[T.length-1].lineSegments[0][0]);for(var i=[1,0,0],n=0,r=T.length;n<r;n++){(!b||65e3<b.positionData.length)&&(0<this.partitions.length&&n--,b={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(b));var s=T[n];b.count++;for(var o=1/0,a=new Zr("",T[n].cp1.x,T[n].cp1.y,T[n].cp1.z),h=0;h<e;h++){var l,u=s.lineSegments[0][h],c=[(l=h===e-1?n===T.length-1?s.lineSegments[0][h-1]:T[n+1].lineSegments[0][0]:s.lineSegments[0][h+1]).x-u.x,l.y-u.y,l.z-u.z];go.normalize(c),n===T.length-1&&h===e-1&&go.scale(c,-1);var f=go.cross(c,i,[]);go.normalize(f),go.scale(f,D/2);for(var d=new Bo(f,c,2*mo.PI/t),m=0,p=t;m<p;m++){var g=d.rotate();m===mo.floor(t/4)&&(i=[g[0],g[1],g[2]]),b.normalData.push(g[0],g[1],g[2]),b.positionData.push(u.x+g[0],u.y+g[1],u.z+g[2])}if(a){var v=u.distance3D(a);v<o&&(o=v,T[n].pPoint=u)}}}for(var _=0,x=this.partitions.length;_<x;_++){var b;for(n=0,r=(b=this.partitions[_]).count-1;n<r;n++)for(var y=n*e*t,w=(h=0,e);h<w;h++){var S=y+h*t;for(m=0;m<t;m++){var C=S+m;b.indexData.push(C),b.indexData.push(C+t),b.indexData.push(C+t+1),b.indexData.push(C),b.indexData.push(C+t+1),b.indexData.push(C+1)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);var A=[new P(2,0)];for(n=0;n<60;n++){var E=n/60*mo.PI;A.push(new P(2*mo.cos(E),-2*mo.sin(E)))}A.push(new P(-2,0),new P(-2,4),new P(2,4));var F=new fo.Shape(A,1);this.render=function(t,e){if(this.bindBuffers(t),t.material.setDiffuseColor(t,e.macro_colorByChain?this.chainColor:e.nucleics_tubeColor),t.drawElements(t.TRIANGLES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0),this.partitions)for(var i=1,n=this.partitions.length;i<n;i++){var r=this.partitions[i];Po(t,r),t.drawElements(t.TRIANGLES,r.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}for(t.sphereBuffer.bindBuffers(t),i=0;i<2;i++){r=this.ends[i];var s=po.translate(po.identity(),[r.x,r.y,r.z]),o=D/2;po.scale(s,[o,o,o]),t.shader.setMatrixUniforms(t,s),t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}for(t.cylinderBuffer.bindBuffers(t),i=0,n=T.length-1;i<n;i++){var a=(m=T[i]).pPoint,h=new Zr("",m.cp2.x,m.cp2.y,m.cp2.z),l=1.001*a.distance3D(h),u=[D/4,l,D/4],c=(s=po.translate(po.identity(),[a.x,a.y,a.z]),[0,1,0]),f=0,d=[h.x-a.x,h.y-a.y,h.z-a.z];a.x===h.x&&a.z===h.z?(p=[0,0,1],a.y<a.y&&(f=mo.PI)):(f=uo.vec3AngleFrom(c,d),p=go.cross(c,d,[])),0!==f&&po.rotate(s,f,p),po.scale(s,u),t.shader.setMatrixUniforms(t,s),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderBuffer.vertexPositionBuffer.numItems)}for(F.bindBuffers(t),"none"!==e.nucleics_residueColor||e.macro_colorByChain||t.material.setDiffuseColor(t,e.nucleics_baseColor),i=0,n=T.length-1;i<n;i++){h=(m=T[i]).cp2,s=po.translate(po.identity(),[h.x,h.y,h.z]),c=[0,1,0],f=0;var m,p,g=m.cp3;if(g){d=[g.x-h.x,g.y-h.y,g.z-h.z],h.x===g.x&&h.z===g.z?(p=[0,0,1],h.y<h.y&&(f=mo.PI)):(f=uo.vec3AngleFrom(c,d),p=go.cross(c,d,[])),0!==f&&po.rotate(s,f,p);var v=[1,0,0],_=po.rotate(po.identity([]),f,p);po.multiplyVec3(_,v);var x=m.cp4,b=m.cp5;if(x.y!==b.y||x.z!==b.z){var y=[b.x-x.x,b.y-x.y,b.z-x.z],w=uo.vec3AngleFrom(v,y);go.dot(d,go.cross(v,y))<0&&(w*=-1),po.rotateY(s,w)}e.macro_colorByChain||("shapely"===e.nucleics_residueColor?co[m.name]?t.material.setDiffuseColor(t,co[m.name].shapelyColor):t.material.setDiffuseColor(t,co["*"].shapelyColor):"rainbow"===e.nucleics_residueColor&&t.material.setDiffuseColor(t,vo.rainbowAt(i,n,e.macro_rainbowColors))),t.shader.setMatrixUniforms(t,s),t.drawElements(t.TRIANGLES,F.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}}}},fo.Tube.prototype=new fo._Mesh,fo.CatmullTube=function(t,e,i,n){var r=[];t.push(t[t.length-1]);for(var s=0,o=t.length-2;s<=o;s++){for(var a=t[0==s?0:s-1],h=t[s+0],l=t[s+1],u=t[s==o?s+1:s+2],c=[],f=0;f<n;f++){var d=f/n;s==o&&(d=f/(n-1));var m=new Zr("C",.5*(2*h.x+(l.x-a.x)*d+(2*a.x-5*h.x+4*l.x-u.x)*d*d+(3*h.x-a.x-3*l.x+u.x)*d*d*d),.5*(2*h.y+(l.y-a.y)*d+(2*a.y-5*h.y+4*l.y-u.y)*d*d+(3*h.y-a.y-3*l.y+u.y)*d*d*d),.5*(2*h.z+(l.z-a.z)*d+(2*a.z-5*h.z+4*l.z-u.z)*d*d+(3*h.z-a.z-3*l.z+u.z)*d*d*d));c.push(m)}r.push(c)}var p=r[0].length;this.partitions=[],this.ends=[],this.ends.push(r[0][0]),this.ends.push(r[r.length-1][0]);var g=[1,0,0];for(s=0,o=r.length;s<o;s++){(!E||65e3<E.positionData.length)&&(0<this.partitions.length&&s--,E={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(E));var v=r[s];for(E.count++,f=0;f<p;f++){var _,x=v[f],b=[(_=f===p-1?s===r.length-1?v[f-1]:r[s+1][0]:v[f+1]).x-x.x,_.y-x.y,_.z-x.z];go.normalize(b),s===r.length-1&&f===p-1&&go.scale(b,-1);var y=go.cross(b,g,[]);go.normalize(y),go.scale(y,e/2);for(var w=new Bo(y,b,2*mo.PI/i),T=0,D=i;T<D;T++){var S=w.rotate();T===mo.floor(i/4)&&(g=[S[0],S[1],S[2]]),E.normalData.push(S[0],S[1],S[2]),E.positionData.push(x.x+S[0],x.y+S[1],x.z+S[2])}}}for(var C=0,A=this.partitions.length;C<A;C++){var E;for(s=0,o=(E=this.partitions[C]).count-1;s<o;s++)for(var F=s*p*i,R=(f=0,p);f<R;f++){var P=F+f*i;for(T=0;T<=i;T++){var B=P+T%i;E.indexData.push(B,B+i)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData)},(fo.CatmullTube.prototype=new fo._Mesh).render=function(t,e){this.bindBuffers(t);for(var i=0,n=this.partitions.length;i<n;i++){var r=this.partitions[i];Po(t,r),t.drawElements(t.TRIANGLE_STRIP,r.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}for(t.sphereBuffer.bindBuffers(t),i=0;i<2;i++){r=this.ends[i];var s=po.translate(po.identity(),[r.x,r.y,r.z]),o=e.proteins_tubeThickness/2;po.scale(s,[o,o,o]),t.shader.setMatrixUniforms(t,s),t.drawElements(t.TRIANGLES,t.sphereBuffer.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}},_o=Co,L.vec3,_o.UnitCell=function(t){function e(t,e,i,n){s.push(t[0],t[1],t[2]),s.push(e[0],e[1],e[2]),s.push(i[0],i[1],i[2]),s.push(n[0],n[1],n[2]);for(var r=0;r<4;r++)o.push(0,0,0)}this.unitCell=t;var s=[],o=[];e(t.o,t.x,t.xy,t.y),e(t.o,t.y,t.yz,t.z),e(t.o,t.z,t.xz,t.x),e(t.yz,t.y,t.xy,t.xyz),e(t.xyz,t.xz,t.z,t.yz),e(t.xy,t.x,t.xz,t.xyz);for(var i=[],n=0;n<6;n++){var r=4*n;i.push(r,1+r,1+r,2+r,2+r,3+r,3+r,r)}this.storeData(s,o,i)},(_o.UnitCell.prototype=new _o._Mesh).render=function(t,e){t.shader.setMatrixUniforms(t),this.bindBuffers(t),t.material.setDiffuseColor(t,e.shapes_color),t.lineWidth(e.shapes_lineWidth),t.drawElements(t.LINES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},function(t,e,i,n){t.Framebuffer=function(){};var r=t.Framebuffer.prototype;r.init=function(t){this.framebuffer=t.createFramebuffer()},r.setColorTexture=function(t,e,i){var n=void 0===i?0:i;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindTexture(t.TEXTURE_2D,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.TEXTURE_2D,e,0),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setColorRenderbuffer=function(t,e,i){var n=void 0===i?0:i;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,e),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setDepthTexture=function(t,e){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindTexture(t.TEXTURE_2D,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,e,0),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.setDepthRenderbuffer=function(t,e){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},r.bind=function(t,e,i){t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.viewport(0,0,e,i)}}(Co,0,document),function(t,e,i,n){t.Renderbuffer=function(){};var r=t.Renderbuffer.prototype;r.init=function(t,e){this.renderbuffer=t.createRenderbuffer(),this.format=e},r.setParameter=function(t,e,i){this.width=e,this.height=i,t.bindRenderbuffer(t.RENDERBUFFER,this.renderbuffer),t.renderbufferStorage(t.RENDERBUFFER,this.format,this.width,this.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}}(Co,0,document),function(t,e,h,i){e.SSAO=function(){};var n=e.SSAO.prototype;n.initSampleKernel=function(t){for(var e=[],i=0;i<t;i++){var n=2*h.random()-1,r=2*h.random()-1,s=2*h.random()-1,o=i/t,a=.1+.9*(o*o);n*=a,r*=a,s*=a,e.push(n,r,s)}this.sampleKernel=new Float32Array(e)},n.initNoiseTexture=function(t){for(var e=[],i=0;i<16;i++)e.push(2*h.random()-1),e.push(2*h.random()-1),e.push(0);this.noiseTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.noiseTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGB,4,4,0,t.RGB,t.FLOAT,new Float32Array(e)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null)}}(0,Co,So),function(t,e,i,n){t.Texture=function(){};var r=t.Texture.prototype;r.init=function(t,e,i,n){this.texture=t.createTexture(),this.type=e,this.internalFormat=i,this.format=void 0!==n?n:i,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)},r.setParameter=function(t,e,i){this.width=e,this.height=i,t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,null),t.bindTexture(t.TEXTURE_2D,null)}}(Co,0,document),function(t,e,i,a,h){t._Shader=function(){};var n=t._Shader.prototype;n.useShaderProgram=function(t){t.useProgram(this.gProgram),t.shader=this},n.init=function(t){var e=this.getShader(t,"vertex-shader");e||(e=this.loadDefaultVertexShader(t));var i=this.getShader(t,"fragment-shader");i||(i=this.loadDefaultFragmentShader(t)),this.gProgram=t.createProgram(),t.attachShader(this.gProgram,e),t.attachShader(this.gProgram,i),this.onShaderAttached(t),t.linkProgram(this.gProgram),t.getProgramParameter(this.gProgram,t.LINK_STATUS)||alert("Could not initialize shaders: "+t.getProgramInfoLog(this.gProgram)),t.useProgram(this.gProgram),this.initUniformLocations(t),t.useProgram(null)},n.onShaderAttached=function(t){this.vertexPositionAttribute=0,this.vertexNormalAttribute=1,t.bindAttribLocation(this.gProgram,this.vertexPositionAttribute,"a_vertex_position"),t.bindAttribLocation(this.gProgram,this.vertexNormalAttribute,"a_vertex_normal")},n.getShaderFromStr=function(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert(shaderScript.type+" "+t.getShaderInfoLog(n)),t.deleteShader(n),h)},n.enableAttribsArray=function(t){t.enableVertexAttribArray(this.vertexPositionAttribute)},n.disableAttribsArray=function(t){t.disableVertexAttribArray(this.vertexPositionAttribute)},n.getShader=function(t,e){var i=a.getElementById(e);if(!i)return h;for(var n=[],r=i.firstChild;r;)3===r.nodeType&&n.push(r.textContent),r=r.nextSibling;var s,o=n.join("");if("x-shader/x-fragment"===i.type)s=this.getShaderFromStr(t,t.FRAGMENT_SHADER,o);else{if("x-shader/x-vertex"!==i.type)return h;s=this.getShaderFromStr(t,t.VERTEX_SHADER,o)}return s},n.initUniformLocations=function(t){this.modelViewMatrixUniform=t.getUniformLocation(this.gProgram,"u_model_view_matrix"),this.projectionMatrixUniform=t.getUniformLocation(this.gProgram,"u_projection_matrix")},n.loadDefaultVertexShader=function(t){},n.loadDefaultFragmentShader=function(t){},n.setMatrixUniforms=function(t,e){e===h?this.setModelViewMatrix(t,t.modelViewMatrix):this.setModelViewMatrix(t,i.multiply(t.modelViewMatrix,e,[]))},n.setProjectionMatrix=function(t,e){t.uniformMatrix4fv(this.projectionMatrixUniform,!1,e)},n.setModelViewMatrix=function(t,e){t.uniformMatrix4fv(this.modelViewMatrixUniform,!1,e)},n.setMaterialAmbientColor=function(t,e){},n.setMaterialDiffuseColor=function(t,e){},n.setMaterialSpecularColor=function(t,e){},n.setMaterialShininess=function(t,e){},n.setMaterialAlpha=function(t,e){}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.FXAAShader=function(){};var s=t._Shader.prototype,o=t.FXAAShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.buffersizeUniform=t.getUniformLocation(this.gProgram,"u_buffersize"),this.antialiasUniform=t.getUniformLocation(this.gProgram,"u_antialias"),this.edgeThresholdUniform=t.getUniformLocation(this.gProgram,"u_edge_threshold"),this.edgeThresholdMinUniform=t.getUniformLocation(this.gProgram,"u_edge_threshold_min"),this.searchStepsUniform=t.getUniformLocation(this.gProgram,"u_search_steps"),this.searchThresholdUniform=t.getUniformLocation(this.gProgram,"u_search_threshold"),this.subpixCapUniform=t.getUniformLocation(this.gProgram,"u_subpix_cap"),this.subpixTrimUniform=t.getUniformLocation(this.gProgram,"u_subpix_trim")},o.setBuffersize=function(t,e,i){t.uniform2f(this.buffersizeUniform,e,i)},o.setAntialias=function(t,e){t.uniform1f(this.antialiasUniform,e)},o.setEdgeThreshold=function(t,e){t.uniform1f(this.edgeThresholdUniform,e)},o.setEdgeThresholdMin=function(t,e){t.uniform1f(this.edgeThresholdMinUniform,e)},o.setSearchSteps=function(t,e){t.uniform1i(this.searchStepsUniform,e)},o.setSearchThreshold=function(t,e){t.uniform1f(this.searchThresholdUniform,e)},o.setSubpixCap=function(t,e){t.uniform1f(this.subpixCapUniform,e)},o.setSubpixTrim=function(t,e){t.uniform1f(this.subpixTrimUniform,e)},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","const int fxaaMaxSearchSteps = 128;","uniform float u_edge_threshold;","uniform float u_edge_threshold_min;","uniform int u_search_steps;","uniform float u_search_threshold;","uniform float u_subpix_cap;","uniform float u_subpix_trim;","uniform sampler2D u_sampler0;","uniform vec2 u_buffersize;","uniform bool u_antialias;","varying vec2 v_texcoord;","float FxaaLuma(vec3 rgb) {","return rgb.y * (0.587/0.299) + rgb.x;","}","vec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {","return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);","}","vec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 off, vec2 rcpFrame) {","return texture2D(tex, pos + off * rcpFrame);","}","vec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {","float subpix_trim_scale = (1.0/(1.0 - u_subpix_trim));","vec3 rgbN = FxaaTexOff(tex, pos.xy, vec2( 0.,-1.), rcpFrame).xyz;","vec3 rgbW = FxaaTexOff(tex, pos.xy, vec2(-1., 0.), rcpFrame).xyz;","vec3 rgbM = FxaaTexOff(tex, pos.xy, vec2( 0., 0.), rcpFrame).xyz;","vec3 rgbE = FxaaTexOff(tex, pos.xy, vec2( 1., 0.), rcpFrame).xyz;","vec3 rgbS = FxaaTexOff(tex, pos.xy, vec2( 0., 1.), rcpFrame).xyz;","float lumaN = FxaaLuma(rgbN);","float lumaW = FxaaLuma(rgbW);","float lumaM = FxaaLuma(rgbM);","float lumaE = FxaaLuma(rgbE);","float lumaS = FxaaLuma(rgbS);","float rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));","float rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));","float range = rangeMax - rangeMin;","if(range < max(u_edge_threshold_min, rangeMax * u_edge_threshold)) {","return rgbM;","}","vec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;","float lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;","float rangeL = abs(lumaL - lumaM);","float blendL = max(0.0, (rangeL / range) - u_subpix_trim) * subpix_trim_scale;","blendL = min(u_subpix_cap, blendL);","vec3 rgbNW = FxaaTexOff(tex, pos.xy, vec2(-1.,-1.), rcpFrame).xyz;","vec3 rgbNE = FxaaTexOff(tex, pos.xy, vec2( 1.,-1.), rcpFrame).xyz;","vec3 rgbSW = FxaaTexOff(tex, pos.xy, vec2(-1., 1.), rcpFrame).xyz;","vec3 rgbSE = FxaaTexOff(tex, pos.xy, vec2( 1., 1.), rcpFrame).xyz;","rgbL += (rgbNW + rgbNE + rgbSW + rgbSE);","rgbL *= vec3(1.0/9.0);","float lumaNW = FxaaLuma(rgbNW);","float lumaNE = FxaaLuma(rgbNE);","float lumaSW = FxaaLuma(rgbSW);","float lumaSE = FxaaLuma(rgbSE);","float edgeVert =","abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +","abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +","abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));","float edgeHorz =","abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +","abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +","abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));","bool horzSpan = edgeHorz >= edgeVert;","float lengthSign = horzSpan ? -rcpFrame.y : -rcpFrame.x;","if(!horzSpan) {","lumaN = lumaW;","lumaS = lumaE;","}","float gradientN = abs(lumaN - lumaM);","float gradientS = abs(lumaS - lumaM);","lumaN = (lumaN + lumaM) * 0.5;","lumaS = (lumaS + lumaM) * 0.5;","if (gradientN < gradientS) {","lumaN = lumaS;","lumaN = lumaS;","gradientN = gradientS;","lengthSign *= -1.0;","}","vec2 posN;","posN.x = pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);","posN.y = pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);","gradientN *= u_search_threshold;","vec2 posP = posN;","vec2 offNP = horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);","float lumaEndN = lumaN;","float lumaEndP = lumaN;","bool doneN = false;","bool doneP = false;","posN += offNP * vec2(-1.0, -1.0);","posP += offNP * vec2( 1.0,  1.0);","for(int i = 0; i < fxaaMaxSearchSteps; i++) {","if(i >= u_search_steps) break;","if(!doneN) {","lumaEndN = FxaaLuma(texture2D(tex, posN.xy).xyz);","}","if(!doneP) {","lumaEndP = FxaaLuma(texture2D(tex, posP.xy).xyz);","}","doneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);","doneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);","if(doneN && doneP) {","break;","}","if(!doneN) {","posN -= offNP;","}","if(!doneP) {","posP += offNP;","}","}","float dstN = horzSpan ? pos.x - posN.x : pos.y - posN.y;","float dstP = horzSpan ? posP.x - pos.x : posP.y - pos.y;","bool directionN = dstN < dstP;","lumaEndN = directionN ? lumaEndN : lumaEndP;","if(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0)) {","lengthSign = 0.0;","}","float spanLength = (dstP + dstN);","dstN = directionN ? dstN : dstP;","float subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;","vec3 rgbF = texture2D(tex, vec2(","pos.x + (horzSpan ? 0.0 : subPixelOffset),","pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;","return FxaaLerp3(rgbL, rgbF, blendL);","}","void main() {","gl_FragColor = texture2D(u_sampler0, v_texcoord);","if(u_antialias) {","gl_FragColor.xyz = FxaaPixelShader(v_texcoord, u_sampler0, 1. / u_buffersize).xyz;","}","}"].join("\n");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.LabelShader=function(){};var s=t._Shader.prototype,o=t.LabelShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.dimensionUniform=t.getUniformLocation(this.gProgram,"u_dimension")},o.onShaderAttached=function(t){s.onShaderAttached.call(this,t),this.vertexTexCoordAttribute=2,t.bindAttribLocation(this.gProgram,this.vertexTexCoordAttribute,"a_vertex_texcoord")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","attribute vec3 a_vertex_normal;","attribute vec2 a_vertex_texcoord;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","uniform vec2 u_dimension;","varying vec2 v_texcoord;","void main() {","gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);","vec4 depth_pos = vec4(gl_Position);","depth_pos.z += a_vertex_normal.z;","gl_Position = u_projection_matrix * gl_Position;","depth_pos = u_projection_matrix * depth_pos;","gl_Position /= gl_Position.w;","gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;","gl_Position.z = depth_pos.z / depth_pos.w;","v_texcoord = a_vertex_texcoord;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=[t.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;","uniform sampler2D u_image;","varying vec2 v_texcoord;","void main(void) {","gl_FragColor = texture2D(u_image, v_texcoord);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.enableAttribsArray=function(t){s.enableAttribsArray.call(this,t),t.enableVertexAttribArray(this.vertexNormalAttribute),t.enableVertexAttribArray(this.vertexTexCoordAttribute)},o.disableAttribsArray=function(t){s.disableAttribsArray.call(this,t),t.disableVertexAttribArray(this.vertexNormalAttribute),t.disableVertexAttribArray(this.vertexTexCoordAttribute)},o.setDimension=function(t,e,i){t.uniform2f(this.dimensionUniform,e,i)}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.LightingShader=function(){};var s=t._Shader.prototype,o=t.LightingShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.positionSampleUniform=t.getUniformLocation(this.gProgram,"u_position_sample"),this.colorSampleUniform=t.getUniformLocation(this.gProgram,"u_color_sample"),this.ssaoSampleUniform=t.getUniformLocation(this.gProgram,"u_ssao_sample"),this.outlineSampleUniform=t.getUniformLocation(this.gProgram,"u_outline_sample")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","uniform sampler2D u_position_sample;","uniform sampler2D u_color_sample;","uniform sampler2D u_ssao_sample;","uniform sampler2D u_outline_sample;","varying vec2 v_texcoord;","void main() {","vec4 position = texture2D(u_position_sample, v_texcoord);","vec4 color = texture2D(u_color_sample, v_texcoord);","vec4 ao = texture2D(u_ssao_sample, v_texcoord);","float outline = texture2D(u_outline_sample, v_texcoord).r;","if(position.w == 0. && outline == 1.) {","return;","}","gl_FragColor = vec4(color.rgb * ao.r * outline, 1.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Co,L.mat3,L.mat4,document),function(t,n,r,e,i){t.NormalShader=function(){};var s=t._Shader.prototype,o=t.NormalShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.normalMatrixUniform=t.getUniformLocation(this.gProgram,"u_normal_matrix")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","attribute vec3 a_vertex_normal;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","uniform mat3 u_normal_matrix;","varying vec3 v_normal;","void main() {","v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;","gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","varying vec3 v_normal;","void main(void) {","vec3 normal = length(v_normal)==0. ? vec3(0., 0., 1.) : normalize(v_normal);","gl_FragColor = vec4(normal, 0.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.enableAttribsArray=function(t){s.enableAttribsArray.call(this,t),t.enableVertexAttribArray(this.vertexNormalAttribute)},o.disableAttribsArray=function(t){s.disableAttribsArray.call(this,t),t.disableVertexAttribArray(this.vertexNormalAttribute)},o.setModelViewMatrix=function(t,e){s.setModelViewMatrix.call(this,t,e);var i=n.transpose(r.toInverseMat3(e,[]));t.uniformMatrix3fv(this.normalMatrixUniform,!1,i)}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.OutlineShader=function(){};var s=t._Shader.prototype,o=t.OutlineShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.normalSampleUniform=t.getUniformLocation(this.gProgram,"u_normal_sample"),this.depthSampleUniform=t.getUniformLocation(this.gProgram,"u_depth_sample"),this.gbufferTextureSizeUniform=t.getUniformLocation(this.gProgram,"u_gbuffer_texture_size"),this.normalThresholdUniform=t.getUniformLocation(this.gProgram,"u_normal_threshold"),this.depthThresholdUniform=t.getUniformLocation(this.gProgram,"u_depth_threshold"),this.thicknessUniform=t.getUniformLocation(this.gProgram,"u_thickness")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","uniform sampler2D u_normal_sample;","uniform sampler2D u_depth_sample;","uniform float u_normal_threshold;","uniform float u_depth_threshold;","uniform float u_thickness;","uniform vec2 u_gbuffer_texture_size;","varying vec2 v_texcoord;","void main() {","vec3 normal = texture2D(u_normal_sample, v_texcoord).xyz;","float depth = texture2D(u_depth_sample, v_texcoord).r;","vec2 texelSize = u_thickness/u_gbuffer_texture_size * .5;","vec2 offsets[8];","offsets[0] = vec2(-texelSize.x, -texelSize.y);","offsets[1] = vec2(-texelSize.x, 0);","offsets[2] = vec2(-texelSize.x, texelSize.y);","offsets[3] = vec2(0, -texelSize.y);","offsets[4] = vec2(0,  texelSize.y);","offsets[5] = vec2(texelSize.x, -texelSize.y);","offsets[6] = vec2(texelSize.x, 0);","offsets[7] = vec2(texelSize.x, texelSize.y);","float edge = 0.;","for (int i = 0; i < 8; i++) {","vec3 sampleNorm = texture2D(u_normal_sample, v_texcoord + offsets[i]).xyz;","if(normal == vec3(.0, .0, .0)) {","if(sampleNorm != vec3(.0, .0, .0)) {","edge = 1.0;","break;","}","continue;","}","if (dot(sampleNorm, normal) < u_normal_threshold) {","edge = 1.0;","break;","}","float sampleDepth = texture2D(u_depth_sample, v_texcoord + offsets[i]).r;","if (abs(sampleDepth - depth) > u_depth_threshold) {","edge = 1.0;","break;","}","}","edge = 1. - edge;","gl_FragColor = vec4(edge, edge, edge, 1.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.setGbufferTextureSize=function(t,e,i){t.uniform2f(this.gbufferTextureSizeUniform,e,i)},o.setNormalThreshold=function(t,e){t.uniform1f(this.normalThresholdUniform,e)},o.setDepthThreshold=function(t,e){t.uniform1f(this.depthThresholdUniform,e)},o.setThickness=function(t,e){t.uniform1f(this.thicknessUniform,e)}}(Co,L.mat3,L.mat4,document),function(t,n,r,e,i){t.PhongShader=function(){};var s=t._Shader.prototype,o=t.PhongShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.shadowUniform=t.getUniformLocation(this.gProgram,"u_shadow"),this.flatColorUniform=t.getUniformLocation(this.gProgram,"u_flat_color"),this.normalMatrixUniform=t.getUniformLocation(this.gProgram,"u_normal_matrix"),this.lightModelViewMatrixUniform=t.getUniformLocation(this.gProgram,"u_light_model_view_matrix"),this.lightProjectionMatrixUniform=t.getUniformLocation(this.gProgram,"u_light_projection_matrix"),this.lightDiffuseColorUniform=t.getUniformLocation(this.gProgram,"u_light_diffuse_color"),this.lightSpecularColorUniform=t.getUniformLocation(this.gProgram,"u_light_specular_color"),this.lightDirectionUniform=t.getUniformLocation(this.gProgram,"u_light_direction"),this.materialAmbientColorUniform=t.getUniformLocation(this.gProgram,"u_material_ambient_color"),this.materialDiffuseColorUniform=t.getUniformLocation(this.gProgram,"u_material_diffuse_color"),this.materialSpecularColorUniform=t.getUniformLocation(this.gProgram,"u_material_specular_color"),this.materialShininessUniform=t.getUniformLocation(this.gProgram,"u_material_shininess"),this.materialAlphaUniform=t.getUniformLocation(this.gProgram,"u_material_alpha"),this.fogModeUniform=t.getUniformLocation(this.gProgram,"u_fog_mode"),this.fogColorUniform=t.getUniformLocation(this.gProgram,"u_fog_color"),this.fogStartUniform=t.getUniformLocation(this.gProgram,"u_fog_start"),this.fogEndUniform=t.getUniformLocation(this.gProgram,"u_fog_end"),this.fogDensityUniform=t.getUniformLocation(this.gProgram,"u_fog_density"),this.shadowDepthSampleUniform=t.getUniformLocation(this.gProgram,"u_shadow_depth_sample"),this.shadowTextureSizeUniform=t.getUniformLocation(this.gProgram,"u_shadow_texture_size"),this.shadowIntensityUniform=t.getUniformLocation(this.gProgram,"u_shadow_intensity"),this.gammaCorrectionUniform=t.getUniformLocation(this.gProgram,"u_gamma_inverted"),this.pointSizeUniform=t.getUniformLocation(this.gProgram,"u_point_size")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","attribute vec3 a_vertex_normal;","uniform vec3 u_light_diffuse_color;","uniform vec3 u_material_ambient_color;","uniform vec3 u_material_diffuse_color;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","uniform mat3 u_normal_matrix;","uniform mat4 u_light_model_view_matrix;","uniform mat4 u_light_projection_matrix;","uniform bool u_shadow;","varying vec3 v_viewpos;","varying vec4 v_shadcoord;","varying vec3 v_diffuse;","varying vec3 v_ambient;","varying vec3 v_normal;","uniform float u_point_size;","void main() {","v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;","v_ambient = u_material_ambient_color;","v_diffuse = u_material_diffuse_color * u_light_diffuse_color;","if(u_shadow) {","v_shadcoord = u_light_projection_matrix * u_light_model_view_matrix * vec4(a_vertex_position, 1.);","v_shadcoord /= v_shadcoord.w;","}","vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);","v_viewpos = viewPos.xyz / viewPos.w;","gl_Position = u_projection_matrix * viewPos;","gl_Position /= gl_Position.w;","gl_PointSize = u_point_size;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=[t.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;","uniform vec3 u_light_specular_color;","uniform vec3 u_light_direction;","uniform vec3 u_material_specular_color;","uniform float u_material_shininess;","uniform float u_material_alpha;","uniform int u_fog_mode;","uniform vec3 u_fog_color;","uniform float u_fog_density;","uniform float u_fog_start;","uniform float u_fog_end;","uniform bool u_shadow;","uniform float u_shadow_intensity;","uniform bool u_flat_color;","uniform float u_gamma_inverted;","uniform sampler2D u_shadow_depth_sample;","uniform vec2 u_shadow_texture_size;","varying vec3 v_viewpos;","varying vec4 v_shadcoord;","varying vec3 v_diffuse;","varying vec3 v_ambient;","varying vec3 v_normal;","\n#ifndef CWC_DEPTH_TEX\n","float unpack (vec4 colour) {","const vec4 bitShifts = vec4(1.,","1. / 255.,","1. / (255. * 255.),","1. / (255. * 255. * 255.));","return dot(colour, bitShifts);","}","\n#endif\n","float shadowMapDepth(vec4 shadowMapColor) {","float zShadowMap;","\n#ifdef CWC_DEPTH_TEX\n","zShadowMap = shadowMapColor.r;","\n#else\n","zShadowMap = unpack(shadowMapColor);","\n#endif\n","return zShadowMap;","}","void main(void) {","vec3 color = v_diffuse;","if(length(v_normal)!=0.){","vec3 normal = normalize(v_normal);","vec3 lightDir = normalize(-u_light_direction);","float nDotL = dot(normal, lightDir);","float shadow = 0.0;","if(u_shadow) {","vec3 depthCoord = .5 + v_shadcoord.xyz / v_shadcoord.w * .5;","if(depthCoord.z <= 1. && depthCoord.z >= 0.) {","float bias = max(.05 * (1. - nDotL), .005);","vec2 texelSize = 1. / u_shadow_texture_size;","for(int x = -1; x <= 1; ++x) {","for(int y = -1; y <= 1; ++y)  {","vec4 shadowMapColor = texture2D(u_shadow_depth_sample, depthCoord.xy + vec2(x, y) * texelSize);","float zShadowMap = shadowMapDepth(shadowMapColor);","shadow += zShadowMap + bias < depthCoord.z ? 1. : 0.;","}","}","shadow /= 9.;","shadow *= u_shadow_intensity;","}","}","if(!u_flat_color) {","vec3 viewDir = normalize(-v_viewpos);","vec3 halfDir = normalize(lightDir + viewDir);","float nDotHV = max(dot(halfDir, normal), 0.);","vec3 specular = u_material_specular_color * u_light_specular_color;","color*=max(nDotL, 0.);","color+=specular * pow(nDotHV, u_material_shininess);","}","color = (1.-shadow)*color+v_ambient;","}","gl_FragColor = vec4(pow(color, vec3(u_gamma_inverted)), u_material_alpha);","if(u_fog_mode != 0){","float fogCoord = 1.-clamp((u_fog_end - gl_FragCoord.z/gl_FragCoord.w) / (u_fog_end - u_fog_start), 0., 1.);","float fogFactor = 1.;","if(u_fog_mode == 1){","fogFactor = 1.-fogCoord;","}","else if(u_fog_mode == 2) {","fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);","}","else if(u_fog_mode == 3) {","fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);","}","gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);","}","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.enableAttribsArray=function(t){s.enableAttribsArray.call(this,t),t.enableVertexAttribArray(this.vertexNormalAttribute)},o.disableAttribsArray=function(t){s.disableAttribsArray.call(this,t),t.disableVertexAttribArray(this.vertexNormalAttribute)},o.setMatrixUniforms=function(t,e){if(void 0===e)this.setModelViewMatrix(t,t.modelViewMatrix),this.setLightModelViewMatrix(t,t.lightViewMatrix);else{var i=r.multiply(t.modelViewMatrix,e,[]),n=r.multiply(t.lightViewMatrix,e,[]);this.setModelViewMatrix(t,i),this.setLightModelViewMatrix(t,n)}},o.setModelViewMatrix=function(t,e){s.setModelViewMatrix.call(this,t,e);var i=n.transpose(r.toInverseMat3(e,[]));t.uniformMatrix3fv(this.normalMatrixUniform,!1,i)},o.setFlatColor=function(t,e){t.uniform1i(this.flatColorUniform,e)},o.setShadow=function(t,e){t.uniform1i(this.shadowUniform,e)},o.setFogMode=function(t,e){t.uniform1i(this.fogModeUniform,e)},o.setFogColor=function(t,e){t.uniform3fv(this.fogColorUniform,e)},o.setFogStart=function(t,e){t.uniform1f(this.fogStartUniform,e)},o.setFogEnd=function(t,e){t.uniform1f(this.fogEndUniform,e)},o.setFogDensity=function(t,e){t.uniform1f(this.fogDensityUniform,e)},o.setMaterialAmbientColor=function(t,e){t.uniform3fv(this.materialAmbientColorUniform,e)},o.setMaterialDiffuseColor=function(t,e){t.uniform3fv(this.materialDiffuseColorUniform,e)},o.setMaterialSpecularColor=function(t,e){t.uniform3fv(this.materialSpecularColorUniform,e)},o.setMaterialShininess=function(t,e){t.uniform1f(this.materialShininessUniform,e)},o.setMaterialAlpha=function(t,e){t.uniform1f(this.materialAlphaUniform,e)},o.setLightDiffuseColor=function(t,e){t.uniform3fv(this.lightDiffuseColorUniform,e)},o.setLightSpecularColor=function(t,e){t.uniform3fv(this.lightSpecularColorUniform,e)},o.setLightDirection=function(t,e){t.uniform3fv(this.lightDirectionUniform,e)},o.setLightModelViewMatrix=function(t,e){t.uniformMatrix4fv(this.lightModelViewMatrixUniform,!1,e)},o.setLightProjectionMatrix=function(t,e){t.uniformMatrix4fv(this.lightProjectionMatrixUniform,!1,e)},o.setShadowTextureSize=function(t,e,i){t.uniform2f(this.shadowTextureSizeUniform,e,i)},o.setShadowIntensity=function(t,e){t.uniform1f(this.shadowIntensityUniform,e)},o.setGammaCorrection=function(t,e){t.uniform1f(this.gammaCorrectionUniform,1/e)},o.setPointSize=function(t,e){t.uniform1f(this.pointSizeUniform,e)}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.PickShader=function(){};var s=t._Shader.prototype,o=t.PickShader.prototype=new t._Shader;o.initUniformLocations=function(t){s.initUniformLocations.call(this,t),this.materialDiffuseColorUniform=t.getUniformLocation(this.gProgram,"u_material_diffuse_color")},o.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","void main() {","gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);","gl_Position /= gl_Position.w;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},o.loadDefaultFragmentShader=function(t){var e=[t.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;","uniform vec3 u_material_diffuse_color;","void main(void) {","gl_FragColor = vec4(u_material_diffuse_color, 1.);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)},o.setMaterialDiffuseColor=function(t,e){t.uniform3fv(this.materialDiffuseColorUniform,e)}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.PositionShader=function(){};t._Shader.prototype;var s=t.PositionShader.prototype=new t._Shader;s.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","uniform mat4 u_model_view_matrix;","uniform mat4 u_projection_matrix;","varying vec4 v_position;","void main() {","vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);","gl_Position = u_projection_matrix * viewPos;","v_position = viewPos / viewPos.w;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},s.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","varying vec4 v_position;","void main(void) {","gl_FragColor = v_position;","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Co,L.mat3,L.mat4,document),function(t,e,i,n,r){t.QuadShader=function(){};var s=t.QuadShader.prototype=new t._Shader;s.loadDefaultVertexShader=function(t){var e=["precision mediump float;","attribute vec3 a_vertex_position;","varying vec2 v_texcoord;","void main() {","gl_Position = vec4(a_vertex_position, 1.);","v_texcoord = a_vertex_position.xy * .5 + .5;","}"].join("");return this.getShaderFromStr(t,t.VERTEX_SHADER,e)},s.loadDefaultFragmentShader=function(t){var e=["precision mediump float;","uniform sampler2D u_image;","varying vec2 v_texcoord;","void main() {","gl_FragColor = texture2D(u_image, v_texcoord);","}"].join("");return this.getShaderFromStr(t,t.FRAGMENT_SHADER,e)}}(Co,L.mat3,L.mat4,document),function(t,e,j,q,W,i){function G(t,e,i){this.i1=t,this.i2=e,this.i3=i}function X(t,e,i,n,r,s){for(var o=t[0]*s+i-s,a=t[1]*s+n-s,h=t[2]*s+r-s,l=-1,u=0,c=e.length;u<c;u++){var f=e[u];if(W.abs(f.x-o)<.001&&W.abs(f.y-a)<.001&&W.abs(f.z-h)<.001){l=u;break}}return-1==l&&(l=e.length,e.push(new Zr("C",o,a,h))),l}t._Surface=function(){};var n=t._Surface.prototype=new t._Mesh;n.generate=function(t,e,i,n,r,s,o,a){for(var h=[],l=r[4]-n,u=0;u<a;u++){for(var c=r[2]-n,f=0;f<o;f++){for(var d=r[0]-n,m=0;m<s;m++)h.push(this.calculate(d,c,l)),d+=n;c+=n}l+=n}return h},n.build=function(t,e,i){for(var n=[],r=[],s=[],o=function(t,e){for(var i=[1/0,-1/0,1/0,-1/0,1/0,-1/0],n=e+2,r=0,s=t.length;r<s;r++){var o=t[r];i[0]=W.min(i[0],o.x-n),i[1]=W.max(i[1],o.x+n),i[2]=W.min(i[2],o.y-n),i[3]=W.max(i[3],o.y+n),i[4]=W.min(i[4],o.z-n),i[5]=W.max(i[5],o.z+n)}return i}(t,e),a=o[1]-o[0],h=o[3]-o[2],l=o[5]-o[4],u=W.min(a,W.min(h,l))/i,c=2+W.ceil(a/u),f=2+W.ceil(h/u),d=2+W.ceil(l/u),m=this.generate(a,h,l,u,o,c,f,d),p=j(m,[c,f,d]),g=[],v=[],_=0,x=p.vertices.length;_<x;_++)v.push(X(p.vertices[_],g,o[0],o[2],o[4],u));var b=[];for(_=0,x=p.faces.length;_<x;_++){var y=p.faces[_],w=v[y[0]],T=v[y[1]],D=v[y[2]];b.push(new G(w,T,D)),s.push(w,T,D)}var S=[];for(_=0,x=g.length;_<x;_++){for(var C=[],A=0,E=b.length;A<E;A++){(H=b[A]).i1!==_&&H.i2!==_&&H.i3!==_||(H.i1!=_&&-1===C.indexOf(H.i1)&&C.push(H.i1),H.i2!=_&&-1===C.indexOf(H.i2)&&C.push(H.i2),H.i3!=_&&-1===C.indexOf(H.i3)&&C.push(H.i3))}S.push(C)}var F=[];for(_=0,x=g.length;_<x;_++){var R=g[_],P=(C=S[_],new Zr);if(C.length<3)P.x=R.x,P.y=R.y,P.z=R.z;else{var B=1;C.length<5&&(B=.5);for(A=0,E=C.length;A<E;A++){var M=g[C[A]];P.x+=M.x,P.y+=M.y,P.z+=M.z}P.x+=R.x*B,P.y+=R.y*B,P.z+=R.z*B;var I=1/(B+C.length);P.x*=I,P.y*=I,P.z*=I}F.push(P)}for(_=0,x=(g=F).length;_<x;_++){R=g[_];n.push(R.x,R.y,R.z)}for(_=0,x=b.length;_<x;_++){var L=g[(H=b[_]).i1],N=g[H.i2],k=g[H.i3],O=[N.x-L.x,N.y-L.y,N.z-L.z],z=[k.x-L.x,k.y-L.y,k.z-L.z];q.cross(O,z),isNaN(O[0])&&(O=[0,0,0]),H.normal=O}for(_=0,x=g.length;_<x;_++){var U=[0,0,0];for(A=0,E=b.length;A<E;A++){var H;(H=b[A]).i1!==_&&H.i2!==_&&H.i3!==_||(U[0]+=H.normal[0],U[1]+=H.normal[1],U[2]+=H.normal[2])}q.normalize(U),r.push(U[0],U[1],U[2])}this.storeData(n,r,s)},n.render=function(t,e){this.specs&&(e=this.specs),e.surfaces_display&&(t.shader.setMatrixUniforms(t),this.bindBuffers(t),t.material.setTempColors(t,e.surfaces_materialAmbientColor_3D,e.surfaces_color,e.surfaces_materialSpecularColor_3D,e.surfaces_materialShininess_3D),t.material.setAlpha(t,e.surfaces_alpha),"Dots"===e.surfaces_style?(t.shader.setPointSize(t,e.shapes_pointSize),t.drawElements(t.POINTS,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)):"Mesh"===e.surfaces_style?(t.lineWidth(e.shapes_lineWidth),t.drawElements(t.LINES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)):t.drawElements(t.TRIANGLES,this.vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0))}}(Co,0,L.MarchingCubes,L.vec3,So),bo=_e,yo=So,(xo=Co).SASSurface=function(t,e,i){this.atoms=t,this.probeRadius=e,this.resolution=i,this.build(t,e,i)},(xo.SASSurface.prototype=new xo._Surface).calculate=function(t,e,i){for(var n=1/0,r=new Zr("C",t,e,i),s=0,o=this.atoms.length;s<o;s++){var a=this.atoms[s],h=bo[a.label]&&0!==bo[a.label].vdWRadius?bo[a.label].vdWRadius:2,l=a.distance3D(r)-this.probeRadius-h;n=yo.min(n,l)}return n},To=_e,Do=So,(wo=Co).VDWSurface=function(t,e){this.atoms=t,this.probeRadius=0,this.resolution=e,this.build(t,0,e)},(wo.VDWSurface.prototype=new wo._Surface).calculate=function(t,e,i){for(var n=1/0,r=new Zr("C",t,e,i),s=0,o=this.atoms.length;s<o;s++){var a=this.atoms[s],h=To[a.label]&&0!==To[a.label].vdWRadius?To[a.label].vdWRadius:2,l=a.distance3D(r)-h;n=Do.min(n,l)}return n},Mo.prototype.fit=function(t,e,i){for(var n=t.length,r=[],s=0;s<e-n;s++)r.push(" ");return i?t+r.join(""):r.join("")+t},n.d(e,"ChemDoodle",function(){return zo});var Io,Lo,No,ko,Oo,zo=a;zo.iChemLabs=mt,zo.informatics=h,zo.io=u,zo.lib=L,zo.notations={},zo.structures=l,zo.animations=bt,zo.extensions=r,zo.math=o,zo.featureDetection=I,function(lt,ut,t,ct,ft,dt,mt,e,pt){function gt(t){return 0!==t.length}function vt(t){var e=0,i=0,n=0,r=0,s=t.indexOf("x"),o=t.indexOf("y"),a=t.indexOf("z");if(-1!==s&&(i++,0<s&&"+"!==t.charAt(s-1)&&(i*=-1)),-1!==o&&(n++,0<o&&"+"!==t.charAt(o-1)&&(n*=-1)),-1!==a&&(r++,0<a&&"+"!==t.charAt(a-1)&&(r*=-1)),2<t.length)for(var h="+",l=0,u=t.length;l<u;l++){var c=t.charAt(l);"-"!==c&&"/"!==c||l!==t.length-1&&!t.charAt(l+1).match(f)||(h=c),c.match(f)&&("+"===h?e+=parseInt(c):"-"===h?e-=parseInt(c):"/"===h&&(e/=parseInt(c)))}return[e,i,n,r]}var _t=/\s+/g,xt=/\(|\)|\s+/g,bt=/\'|\s+/g,yt=/,|\'|\s+/g,wt=/^\s+/,f=/[0-9]/g,Tt=/[0-9]|\+|\-/g,Dt={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]};t.CIFInterpreter=function(){},(t.CIFInterpreter.prototype=new t._Interpreter).read=function(t,e,i,n){e=e||1,i=i||1,n=n||1;var r=new ct.Molecule;if(!t)return r;for(var s,o,a,h,l=t.split("\n"),u=0,c=0,f=0,d=0,m=0,p=0,g="P",v=!0;0<l.length;)if(v?h=l.shift():v=!0,0<h.length)if(ut.stringStartsWith(h,"_cell_length_a"))u=parseFloat(h.split(xt)[1]);else if(ut.stringStartsWith(h,"_cell_length_b"))c=parseFloat(h.split(xt)[1]);else if(ut.stringStartsWith(h,"_cell_length_c"))f=parseFloat(h.split(xt)[1]);else if(ut.stringStartsWith(h,"_cell_angle_alpha"))d=dt.PI*parseFloat(h.split(xt)[1])/180;else if(ut.stringStartsWith(h,"_cell_angle_beta"))m=dt.PI*parseFloat(h.split(xt)[1])/180;else if(ut.stringStartsWith(h,"_cell_angle_gamma"))p=dt.PI*parseFloat(h.split(xt)[1])/180;else if(ut.stringStartsWith(h,"_symmetry_space_group_name_H-M"))g=h.split(bt)[1];else if(ut.stringStartsWith(h,"loop_")){for(var _={fields:[],lines:[]},x=!1;(h=l.shift())!==pt&&!ut.stringStartsWith(h=h.replace(wt,""),"loop_")&&0<h.length;)if(ut.stringStartsWith(h,"_")){if(x)break;_.fields=_.fields.concat(h.split(_t).filter(gt))}else x=!0,_.lines.push(h);0!==l.length&&(ut.stringStartsWith(h,"loop_")||ut.stringStartsWith(h,"_"))&&(v=!1),-1!==_.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==_.fields.indexOf("_space_group_symop_operation_xyz")?s=_:-1!==_.fields.indexOf("_atom_site_label")?o=_:-1!==_.fields.indexOf("_geom_bond_atom_site_label_1")&&(a=_)}var b=function(t,e,i,n,r,s){var o=(dt.cos(n)-dt.cos(s)*dt.cos(r))/dt.sin(s);return[t,0,0,0,e*dt.cos(s),e*dt.sin(s),0,0,i*dt.cos(r),i*o,i*dt.sqrt(1-dt.pow(dt.cos(r),2)-o*o),0,0,0,0,1]}(u,c,f,d,m,p);if(o){for(var y=-1,w=-1,T=-1,D=-1,S=-1,C=0,A=o.fields.length;C<A;C++){"_atom_site_type_symbol"===(it=o.fields[C])?y=C:"_atom_site_label"===it?w=C:"_atom_site_fract_x"===it?T=C:"_atom_site_fract_y"===it?D=C:"_atom_site_fract_z"===it&&(S=C)}for(C=0,A=o.lines.length;C<A;C++){var E=(h=o.lines[C]).split(_t).filter(gt),F=new ct.Atom(E[-1===y?w:y].split(Tt)[0],parseFloat(E[T]),parseFloat(E[D]),parseFloat(E[S]));r.atoms.push(F),-1!==w&&(F.cifId=E[w],F.cifPart=0)}}if(s&&!a){var R=0;for(C=0,A=s.fields.length;C<A;C++){"_symmetry_equiv_pos_as_xyz"!==(it=s.fields[C])&&"_space_group_symop_operation_xyz"!==it||(R=C)}var P=Dt[g],B=[];for(C=0,A=s.lines.length;C<A;C++)for(var M=s.lines[C].split(yt).filter(gt),I=vt(M[R]),L=vt(M[R+1]),N=vt(M[R+2]),k=0,O=r.atoms.length;k<O;k++){var z=(F=r.atoms[k]).x*I[1]+F.y*I[2]+F.z*I[3]+I[0],U=F.x*L[1]+F.y*L[2]+F.z*L[3]+L[0],H=F.x*N[1]+F.y*N[2]+F.z*N[3]+N[0],j=new ct.Atom(F.label,z,U,H);if(B.push(j),F.cifId!==pt&&(j.cifId=F.cifId,j.cifPart=C+1),P)for(var q=0,W=P.length;q<W;q++){var G=P[q],X=new ct.Atom(F.label,z+G[0],U+G[1],H+G[2]);B.push(X),F.cifId!==pt&&(X.cifId=F.cifId,X.cifPart=C+1)}}for(C=0,A=B.length;C<A;C++){for(F=B[C];1<=F.x;)F.x--;for(;F.x<0;)F.x++;for(;1<=F.y;)F.y--;for(;F.y<0;)F.y++;for(;1<=F.z;)F.z--;for(;F.z<0;)F.z++}var V=[];for(C=0,A=B.length;C<A;C++){var Y=!1;for(F=B[C],k=0,O=r.atoms.length;k<O;k++)if(r.atoms[k].distance3D(F)<1e-4){Y=!0;break}if(!Y){for(k=0,O=V.length;k<O;k++)if(V[k].distance3D(F)<1e-4){Y=!0;break}Y||V.push(F)}}r.atoms=r.atoms.concat(V)}var Z=[];for(C=0;C<e;C++)for(k=0;k<i;k++)for(q=0;q<n;q++)if(0!==C||0!==k||0!==q)for(var Q=0,$=r.atoms.length;Q<$;Q++){F=r.atoms[Q];var J=new ct.Atom(F.label,F.x+C,F.y+k,F.z+q);Z.push(J),F.cifId!==pt&&(J.cifId=F.cifId,J.cifPart=F.cifPart+(s?s.lines.length:0)+C+10*k+100*q)}r.atoms=r.atoms.concat(Z);for(C=0,A=r.atoms.length;C<A;C++){F=r.atoms[C];var K=mt.multiplyVec3(b,[F.x,F.y,F.z]);F.x=K[0],F.y=K[1],F.z=K[2]}if(a){var tt=-1,et=-1;for(C=0,A=a.fields.length;C<A;C++){var it;"_geom_bond_atom_site_label_1"===(it=a.fields[C])?tt=C:"_geom_bond_atom_site_label_2"===it&&(et=C)}for(q=0,W=a.lines.length;q<W;q++){var nt=(E=a.lines[q].split(_t).filter(gt))[tt],rt=E[et];for(C=0,A=r.atoms.length;C<A;C++)for(k=C+1;k<A;k++){var st=r.atoms[C],ot=r.atoms[k];if(st.cifPart!==ot.cifPart)break;(st.cifId===nt&&ot.cifId===rt||st.cifId===rt&&ot.cifId===nt)&&r.bonds.push(new ct.Bond(st,ot))}}}else(new lt.informatics.BondDeducer).deduceCovalentBonds(r,1);var at=[-e/2,-i/2,-n/2],ht={o:mt.multiplyVec3(b,at,[]),x:mt.multiplyVec3(b,[at[0]+1,at[1],at[2]]),y:mt.multiplyVec3(b,[at[0],at[1]+1,at[2]]),z:mt.multiplyVec3(b,[at[0],at[1],at[2]+1]),xy:mt.multiplyVec3(b,[at[0]+1,at[1]+1,at[2]]),xz:mt.multiplyVec3(b,[at[0]+1,at[1],at[2]+1]),yz:mt.multiplyVec3(b,[at[0],at[1]+1,at[2]+1]),xyz:mt.multiplyVec3(b,[at[0]+1,at[1]+1,at[2]+1])};return{molecule:r,unitCell:new ft.UnitCell(ht)}};var r=new t.CIFInterpreter;lt.readCIF=function(t,e,i,n){return r.read(t,e,i,n)}}(zo,zo.extensions,zo.io,zo.structures,zo.structures.d3,Math,zo.lib.mat4,zo.lib.vec3),function(t,e,A,E,i){e.CMLInterpreter=function(){};var n=e.CMLInterpreter.prototype=new e._Interpreter;n.read=function(t){for(var e=[],i=E.parseXML(t),n=E(i).find("cml"),r=0,s=n.length;r<s;r++)for(var o=E(n[r]).find("molecule"),a=0,h=o.length;a<h;a++){for(var l=e[a]=new A.Molecule,u=[],c=E(o[a]).find("atom"),f=0,d=c.length;f<d;f++){var m,p,g,v,_=E(c[f]),x=_.attr("elementType");g=null==_.attr("x2")?(m=_.attr("x3"),p=_.attr("y3"),_.attr("z3")):(m=_.attr("x2"),p=_.attr("y2"),0),v=e[a].atoms[f]=new A.Atom(x,m,p,g),u[f]=_.attr("id"),null!=_.attr("formalCharge")&&(v.charge=_.attr("formalCharge"))}var b=E(o[a]).find("bond");for(f=0,d=b.length;f<d;f++){var y,w,T,D=E(b[f]),S=D.attr("atomRefs2").split(" ");switch(y=l.atoms[E.inArray(S[0],u)],w=l.atoms[E.inArray(S[1],u)],D.attr("order")){case"2":case"D":T=2;break;case"3":case"T":T=3;break;case"A":T=1.5;break;default:T=1}var C=e[a].bonds[f]=new A.Bond(y,w,T);switch(D.find("bondStereo").text()){case"W":C.stereo=A.Bond.STEREO_PROTRUDING;break;case"H":C.stereo=A.Bond.STEREO_RECESSED}}}return e},n.write=function(t){var e=[];e.push('<?xml version="1.0" encoding="UTF-8"?>\n'),e.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var i=0,n=t.length;i<n;i++){e.push('<molecule id="m'),e.push(i),e.push('">'),e.push("<atomArray>");for(var r=0,s=t[i].atoms.length;r<s;r++){var o=t[i].atoms[r];e.push('<atom elementType="'),e.push(o.label),e.push('" id="a'),e.push(r),e.push('" '),e.push('x3="'),e.push(o.x),e.push('" y3="'),e.push(o.y),e.push('" z3="'),e.push(o.z),e.push('" '),0!=o.charge&&(e.push('formalCharge="'),e.push(o.charge),e.push('" ')),e.push("/>")}e.push("</atomArray>"),e.push("<bondArray>");for(r=0,s=t[i].bonds.length;r<s;r++){var a=t[i].bonds[r];switch(e.push('<bond atomRefs2="a'),e.push(t[i].atoms.indexOf(a.a1)),e.push(" a"),e.push(t[i].atoms.indexOf(a.a2)),e.push('" order="'),a.bondOrder){case 1.5:e.push("A");break;case 1:case 2:case 3:e.push(a.bondOrder);break;case.5:default:e.push("S")}e.push('"/>')}e.push("</bondArray>"),e.push("</molecule>")}return e.push("</cml>"),e.join("")};var r=new e.CMLInterpreter;t.readCML=function(t){return r.read(t)},t.writeCML=function(t){return r.write(t)}}(zo,zo.io,zo.structures,zo.lib.jQuery),function(d,m,t,p,e){t.MOLInterpreter=function(){};var i=t.MOLInterpreter.prototype=new t._Interpreter;i.read=function(t,e){e||(e=d.default_bondLength_2D);var i=new p.Molecule;if(!t)return i;for(var n=t.split("\n"),r=n[3],s=parseInt(r.substring(0,3)),o=parseInt(r.substring(3,6)),a=0;a<s;a++){var h=n[4+a];i.atoms[a]=new p.Atom(h.substring(31,34),parseFloat(h.substring(0,10))*e,(1===e?1:-1)*parseFloat(h.substring(10,20))*e,parseFloat(h.substring(20,30))*e);var l=parseInt(h.substring(34,36));switch(0!==l&&m[i.atoms[a].label]&&(i.atoms[a].mass=m[i.atoms[a].label].mass+l),parseInt(h.substring(36,39))){case 1:i.atoms[a].charge=3;break;case 2:i.atoms[a].charge=2;break;case 3:i.atoms[a].charge=1;break;case 5:i.atoms[a].charge=-1;break;case 6:i.atoms[a].charge=-2;break;case 7:i.atoms[a].charge=-3}}for(a=0;a<o;a++){h=n[4+s+a];var u=parseInt(h.substring(6,9)),c=parseInt(h.substring(9,12));if(3<u)switch(u){case 4:u=1.5;break;default:u=1}var f=new p.Bond(i.atoms[parseInt(h.substring(0,3))-1],i.atoms[parseInt(h.substring(3,6))-1],u);switch(c){case 3:f.stereo=p.Bond.STEREO_AMBIGUOUS;break;case 1:f.stereo=p.Bond.STEREO_PROTRUDING;break;case 6:f.stereo=p.Bond.STEREO_RECESSED}i.bonds[a]=f}return i},i.write=function(t){var e=[];e.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),e.push(this.fit(t.atoms.length.toString(),3)),e.push(this.fit(t.bonds.length.toString(),3)),e.push("  0  0  0  0            999 V2000\n");for(var i=t.getCenter(),n=0,r=t.atoms.length;n<r;n++){var s=t.atoms[n],o=" 0";if(-1!==s.mass&&m[s.label]){var a=s.mass-m[s.label].mass;a<5&&-4<a&&(o=(-1<a?" ":"")+a)}var h="  0";if(0!==s.charge)switch(s.charge){case 3:h="  1";break;case 2:h="  2";break;case 1:h="  3";break;case-1:h="  5";break;case-2:h="  6";break;case-3:h="  7"}e.push(this.fit(((s.x-i.x)/d.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((-(s.y-i.y)/d.default_bondLength_2D).toFixed(4),10)),e.push(this.fit((s.z/d.default_bondLength_2D).toFixed(4),10)),e.push(" "),e.push(this.fit(s.label,3,!0)),e.push(o),e.push(h),e.push("  0  0  0  0\n")}for(n=0,r=t.bonds.length;n<r;n++){var l=t.bonds[n],u=0;l.stereo===p.Bond.STEREO_AMBIGUOUS?u=3:l.stereo===p.Bond.STEREO_PROTRUDING?u=1:l.stereo===p.Bond.STEREO_RECESSED&&(u=6),e.push(this.fit((t.atoms.indexOf(l.a1)+1).toString(),3)),e.push(this.fit((t.atoms.indexOf(l.a2)+1).toString(),3));var c=l.bondOrder;1.5==c?c=4:(3<c||c%1!=0)&&(c=1),e.push(this.fit(c.toString(),3)),e.push("  "),e.push(u),e.push("  0  0  0\n")}return e.push("M  END"),e.join("")};var n=new t.MOLInterpreter;d.readMOL=function(t,e){return n.read(t,e)},d.writeMOL=function(t){return n.write(t)}}(zo,zo.ELEMENT,zo.io,zo.structures),function(O,z,t,U,H,j,q,e){function W(t,e,i,n,r){for(var s=0,o=e.length;s<o;s++){var a=e[s];if(a.id===i&&n>=a.start&&n<=a.end)return r?t.helix=!0:t.sheet=!0,void(n===a.end&&(t.arrow=!0))}}t.PDBInterpreter=function(){};var i=t.PDBInterpreter.prototype=new t._Interpreter;i.calculateRibbonDistances=!1,i.deduceResidueBonds=!1,i.read=function(t,e){var i=new U.Molecule;if(i.chains=[],!t)return i;var n=t.split("\n");e||(e=1);for(var r,s=[],o=[],a=[],h=[],l=[],u=0,c=n.length;u<c;u++){var f=n[u];if(z.stringStartsWith(f,"HELIX"))s.push({id:f.substring(19,20),start:parseInt(f.substring(21,25)),end:parseInt(f.substring(33,37))});else if(z.stringStartsWith(f,"SHEET"))o.push({id:f.substring(21,22),start:parseInt(f.substring(22,26)),end:parseInt(f.substring(33,37))});else if(z.stringStartsWith(f,"ATOM")){var d=f.substring(16,17);if(" "===d||"A"===d){var m=j(f.substring(76,78));if(0===m.length){var p=j(f.substring(12,14));"HD"===p?m="H":0<p.length&&(m=1<p.length?p.charAt(0)+p.substring(1).toLowerCase():p)}var g=new U.Atom(m,parseFloat(f.substring(30,38))*e,parseFloat(f.substring(38,46))*e,parseFloat(f.substring(46,54))*e);g.hetatm=!1,h.push(g);var v=parseInt(f.substring(22,26));if(0===a.length)for(var _=0;_<3;_++){var x=new U.Residue(-1);x.cp1=g,x.cp2=g,a.push(x)}if(v!==Number.NaN&&a[a.length-1].resSeq!==v){var b=new U.Residue(v);b.name=j(f.substring(17,20)),3===b.name.length?b.name=b.name.substring(0,1)+b.name.substring(1).toLowerCase():2===b.name.length&&"D"===b.name.charAt(0)&&(b.name=b.name.substring(1)),a.push(b);var y=f.substring(21,22);W(b,s,y,v,!0),W(b,o,y,v,!1)}var w=j(f.substring(12,16)),T=a[a.length-1];"CA"===w||"P"===w||"O5'"===w?T.cp1||(T.cp1=g):"N3"===w&&("C"===T.name||"U"===T.name||"T"===T.name)||"N1"===w&&("A"===T.name||"G"===T.name)?T.cp3=g:"C2"===w?T.cp4=g:"C4"===w&&("C"===T.name||"U"===T.name||"T"===T.name)||"C6"===w&&("A"===T.name||"G"===T.name)?T.cp5=g:"O"===w||"C6"===w&&("C"===T.name||"U"===T.name||"T"===T.name)||"N9"===w?a[a.length-1].cp2||("C6"!==w&&"N9"!==w||(r=g),T.cp2=g):"C"===w&&(r=g)}}else if(z.stringStartsWith(f,"HETATM")){var D=j(f.substring(76,78));0===D.length&&(D=j(f.substring(12,16))),1<D.length&&(D=D.substring(0,1)+D.substring(1).toLowerCase());var S=new U.Atom(D,parseFloat(f.substring(30,38))*e,parseFloat(f.substring(38,46))*e,parseFloat(f.substring(46,54))*e);S.hetatm=!0,"HOH"===j(f.substring(17,20))&&(S.isWater=!0),i.atoms.push(S),l[parseInt(j(f.substring(6,11)))]=S}else if(z.stringStartsWith(f,"CONECT")){var C=parseInt(j(f.substring(6,11)));if(l[C])for(var A=l[C],E=0;E<4;E++){var F=j(f.substring(11+5*E,16+5*E));if(0!==F.length){var R=parseInt(F);if(l[R]){for(var P=l[R],B=!1,M=(_=0,i.bonds.length);_<M;_++){var I=i.bonds[_];if(I.a1===A&&I.a2===P||I.a1===P&&I.a2===A){B=!0;break}}B||i.bonds.push(new U.Bond(A,P))}}}}else if(z.stringStartsWith(f,"TER"))this.endChain(i,a,r,h),a=[];else if(z.stringStartsWith(f,"ENDMDL"))break}if(this.endChain(i,a,r,h),0===i.bonds.size&&(new O.informatics.BondDeducer).deduceCovalentBonds(i,e),this.deduceResidueBonds)for(u=0,c=h.length;u<c;u++){var L=q.min(c,u+20);for(_=u+1;_<L;_++){var N=h[u],k=h[_];N.distance3D(k)<1.1*(H[N.label].covalentRadius+H[k.label].covalentRadius)&&i.bonds.push(new U.Bond(N,k,1))}}return i.atoms=i.atoms.concat(h),this.calculateRibbonDistances&&this.calculateDistances(i,h),i},i.endChain=function(t,e,i,n){if(0<e.length){var r=e[e.length-1];r.cp1||(r.cp1=n[n.length-2]),r.cp2||(r.cp2=n[n.length-1]);for(var s=0;s<4;s++){var o=new U.Residue(-1);o.cp1=i,o.cp2=e[e.length-1].cp2,e.push(o)}t.chains.push(e)}},i.calculateDistances=function(t,e){for(var i=[],n=0,r=t.atoms.length;n<r;n++){(s=t.atoms[n]).hetatm&&(s.isWater||i.push(s))}for(n=0,r=e.length;n<r;n++){var s;if((s=e[n]).closestDistance=Number.POSITIVE_INFINITY,0===i.length)s.closestDistance=0;else for(var o=0,a=i.length;o<a;o++)s.closestDistance=Math.min(s.closestDistance,s.distance3D(i[o]))}};var n=new t.PDBInterpreter;O.readPDB=function(t,e){return n.read(t,e)}}(zo,zo.extensions,zo.io,zo.structures,zo.ELEMENT,zo.lib.jQuery.trim,Math),function(i,V,t,Y,e,Z){var Q={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},$={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},J={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};t.JCAMPInterpreter=function(){};var n=t.JCAMPInterpreter.prototype=new t._Interpreter;n.convertHZ2PPM=!1,n.read=function(t){this.isBreak=function(t){return Q[t]!==Z||$[t]!==Z||J[t]!==Z||" "===t||"-"===t||"+"===t},this.getValue=function(t,e){var i=t.charAt(0),n=t.substring(1);return Q[i]!==Z?parseFloat(Q[i]+n):$[i]!==Z?parseFloat($[i]+n)+e:parseFloat(n)};var e=new Y.Spectrum;if(t===Z||0===t.length)return e;for(var i,n,r,s,o=t.split("\n"),a=[],h=1,l=1,u=1,c=-1,f=-1,d=!0,m=!1,p=0,g=o.length;p<g;p++){var v=o[p].trim(),_=v.indexOf("$$");if(-1!==_&&(v=v.substring(0,_)),0!==a.length&&V.stringStartsWith(o[p],"##")){var x=a.join("");if(d&&x.length<100&&e.metadata.push(x),a=[v],V.stringStartsWith(x,"##TITLE="))e.title=x.substring(8).trim();else if(V.stringStartsWith(x,"##XUNITS="))e.xUnit=x.substring(9).trim(),this.convertHZ2PPM&&"HZ"===e.xUnit.toUpperCase()&&(e.xUnit="PPM",m=!0);else if(V.stringStartsWith(x,"##YUNITS="))e.yUnit=x.substring(9).trim();else if(V.stringStartsWith(x,"##XYPAIRS="));else if(V.stringStartsWith(x,"##FIRSTX="))n=parseFloat(x.substring(9).trim());else if(V.stringStartsWith(x,"##LASTX="))i=parseFloat(x.substring(8).trim());else if(V.stringStartsWith(x,"##FIRSTY="))r=parseFloat(x.substring(9).trim());else if(V.stringStartsWith(x,"##NPOINTS="))s=parseFloat(x.substring(10).trim());else if(V.stringStartsWith(x,"##XFACTOR="))h=parseFloat(x.substring(10).trim());else if(V.stringStartsWith(x,"##YFACTOR="))l=parseFloat(x.substring(10).trim());else if(V.stringStartsWith(x,"##DELTAX="))parseFloat(x.substring(9).trim());else if(V.stringStartsWith(x,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(u=parseFloat(x.substring(21).trim()));else if(V.stringStartsWith(x,"##.SHIFT REFERENCE=")){if(this.convertHZ2PPM){var b=x.substring(19).split(",");c=parseInt(b[2].trim()),f=parseFloat(b[3].trim())}}else if(V.stringStartsWith(x,"##XYDATA=")){m||(u=1);for(var y,w=d=!1,T=(i-n)/(s-1),D=n-T,S=r,C=0,A=1,E=(U=x.split("\n")).length;A<E;A++){for(var F=[],R=U[A].trim(),P=(a=[],0),B=R.length;P<B;P++)this.isBreak(R.charAt(P))?(0<a.length&&(1!==a.length||" "!==a[0])&&F.push(a.join("")),a=[R.charAt(P)]):a.push(R.charAt(P));F.push(a.join("")),D=parseFloat(F[0])*h-T;for(P=1,B=F.length;P<B;P++){var M=F[P];if(J[M.charAt(0)]!==Z)for(var I=parseInt(J[M.charAt(0)]+M.substring(1))-1,L=0;L<I;L++)D+=T,S=(C=this.getValue(y,C))*l,0,e.data[e.data.length-1]=new Y.Point(D/u,S);else Q[M.charAt(0)]!==Z&&w?S=this.getValue(M,C)*l:(w=$[M.charAt(0)]!==Z,y=M,D+=T,S=(C=this.getValue(M,C))*l,0,e.data.push(new Y.Point(D/u,S)))}}if(-1!==c){var N=f-e.data[c-1].x;for(p=0,g=e.data.length;p<g;p++)e.data[p].x+=N}}else if(V.stringStartsWith(x,"##PEAK TABLE=")){d=!1,e.continuous=!1;var k=/[\s,]+/;for(A=1,E=(U=x.split("\n")).length;A<E;A++){(O=U[A].split(k)).length/2;for(P=0,B=O.length;P+1<B;P+=2)e.data.push(new Y.Point(parseFloat(O[P].trim()),parseFloat(O[P+1].trim())))}}else if(V.stringStartsWith(x,"##ATOMLIST=")){e.molecule=new Y.Molecule;for(k=/[\s]+/,A=1,E=(U=x.split("\n")).length;A<E;A++){var O=U[A].split(k);e.molecule.atoms.push(new Y.Atom(O[1]))}}else if(V.stringStartsWith(x,"##BONDLIST="))for(k=/[\s]+/,A=1,E=(U=x.split("\n")).length;A<E;A++){var z=1;"D"===(O=U[A].split(k))[2]?z=2:"T"===O[2]&&(z=3),e.molecule.bonds.push(new Y.Bond(e.molecule.atoms[parseInt(O[0])-1],e.molecule.atoms[parseInt(O[1])-1],z))}else if(e.molecule&&V.stringStartsWith(x,"##XY_RASTER=")){for(k=/[\s]+/,A=1,E=(U=x.split("\n")).length;A<E;A++){O=U[A].split(k);(q=e.molecule.atoms[parseInt(O[0])-1]).x=parseInt(O[1]),q.y=parseInt(O[2]),4==O.length&&(q.z=parseInt(O[3]))}e.molecule.scaleToAverageBondLength(20)}else if(V.stringStartsWith(x,"##PEAK ASSIGNMENTS=")){var U=x.split("\n");k=/[\s,()<>]+/;e.assignments=[];for(A=1,E=U.length;A<E;A++){O=U[A].split(k);var H=parseFloat(O[1]),j=parseFloat(O[2]),q=e.molecule.atoms[parseInt(O[3])-1],W=!1;for(P=0,B=e.assignments.length;P<B;P++){if((G=e.assignments[P]).x===H){G.as.push(q),q.assigned=G,W=!0;break}}if(!W){var G={x:H,y:j,as:[q]};q.assigned=G,e.assignments.push(G)}}}}else{var X=v.trim();0!==a.length&&0!==X.length&&a.push("\n"),a.push(X)}}return e.setup(),e},n.makeStructureSpectrumSet=function(t,e){this.convertHZ2PPM=!0;var s=this.read(e),o=new i.ViewerCanvas(t+"_molecule",200,200);o.specs.atoms_displayTerminalCarbonLabels_2D=!0,o.specs.atoms_displayImplicitHydrogens_2D=!0,o.mouseout=function(t){if(0!==this.molecules.length){for(var e=0,i=this.molecules[0].atoms.length;e<i;e++)this.molecules[0].atoms[e].isHover=!1;s.hovered=Z,this.repaint(),a.repaint()}},o.touchend=o.mouseout,o.mousemove=function(t){if(0!==this.molecules.length){for(var e=Z,i=0,n=this.molecules[0].atoms.length;i<n;i++){var r=this.molecules[0].atoms[i];r.isHover=!1,r.assigned&&(e===Z||t.p.distance(r)<t.p.distance(e))&&(e=r)}if(s.hovered=Z,t.p.distance(e)<20){for(i=0,n=e.assigned.as.length;i<n;i++)e.assigned.as[i].isHover=!0;a.spectrum.hovered=e.assigned}this.repaint(),a.repaint()}},o.touchmove=o.mousemove,o.drawChildExtras=function(t,e){if(0!==this.molecules.length)for(var i=0,n=this.molecules[0].atoms.length;i<n;i++)this.molecules[0].atoms[i].drawDecorations(t,e)};var a=new i.ObserverCanvas(t+"_spectrum",400,200);return a.specs.plots_showYAxis=!1,a.specs.plots_flipXAxis=!0,a.mouseout=function(t){if(this.spectrum&&this.spectrum.assignments){for(var e=0,i=o.molecules[0].atoms.length;e<i;e++)o.molecules[0].atoms[e].isHover=!1;this.spectrum.hovered=Z,o.repaint(),this.repaint()}},a.touchend=a.mouseout,a.mousemove=function(t){if(this.spectrum&&this.spectrum.assignments){for(var e=Z,i=0,n=o.molecules[0].atoms.length;i<n;i++)o.molecules[0].atoms[i].isHover=!1;this.spectrum.hovered=Z;for(i=0,n=this.spectrum.assignments.length;i<n;i++){var r=this.spectrum.assignments[i];(e===Z||Math.abs(this.spectrum.getTransformedX(r.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-t.p.x)<Math.abs(this.spectrum.getTransformedX(e.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-t.p.x))&&(e=r)}if(Math.abs(this.spectrum.getTransformedX(e.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-t.p.x)<20){for(i=0,n=e.as.length;i<n;i++)e.as[i].isHover=!0;this.spectrum.hovered=e}o.repaint(),this.repaint()}},a.touchmove=a.mousemove,a.drawChildExtras=function(t){if(this.spectrum&&this.spectrum.hovered){var e=this.spectrum.getTransformedX(this.spectrum.hovered.x,a.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft);e>=this.spectrum.memory.offsetLeft&&e<this.spectrum.memory.width&&(t.save(),t.strokeStyle="#885110",t.lineWidth=3,t.beginPath(),t.moveTo(e,this.spectrum.memory.height-this.spectrum.memory.offsetBottom),t.lineTo(e,this.spectrum.getTransformedY(this.spectrum.hovered.y,a.specs,this.spectrum.memory.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)),t.stroke(),t.restore())}},s&&(a.loadSpectrum(s),s.molecule&&o.loadMolecule(s.molecule)),[o,a]};var r=new t.JCAMPInterpreter;r.convertHZ2PPM=!0,i.readJCAMP=function(t){return r.read(t)}}(zo,zo.extensions,zo.io,zo.structures,zo.lib.jQuery),function(_,t,x,e){t.RXNInterpreter=function(){};var i=t.RXNInterpreter.prototype=new t._Interpreter;i.read=function(t,e){e||(e=_.default_bondLength_2D);var i,n=[];if(t){for(var r=t.split("$MOL\n"),s=r[0].split("\n")[4],o=parseInt(s.substring(0,3)),a=parseInt(s.substring(3,6)),h=1,l=0,u=0,c=o+a;u<c;u++){n[u]=_.readMOL(r[h],e),l-=(f=(g=n[u].getBounds()).maxX-g.minX)+40,h++}for(u=0,c=o;u<c;u++){for(var f=(g=n[u].getBounds()).maxX-g.minX,d=n[u].getCenter(),m=0,p=n[u].atoms.length;m<p;m++){(v=n[u].atoms[m]).x+=l+f/2-d.x,v.y-=d.y}l+=f+40}i=new x.d2.Line(new x.Point(l,0),new x.Point(l+40,0)),l+=80;for(u=o,c=o+a;u<c;u++){var g;for(f=(g=n[u].getBounds()).maxX-g.minX,d=n[u].getCenter(),m=0;m<n[u].atoms.length;m++){var v;(v=n[u].atoms[m]).x+=l+f/2-d.x,v.y-=d.y}l+=f+40}}else n.push(new x.Molecule),i=new x.d2.Line(new x.Point(-20,0),new x.Point(20,0));return i.arrowType=x.d2.Line.ARROW_SYNTHETIC,{molecules:n,shapes:[i]}},i.write=function(t,e){var i=[[],[]],n=void 0;if(t&&e){for(r=0,s=e.length;r<s;r++)if(e[r]instanceof x.d2.Line){n=e[r].getPoints();break}if(!n)return"";for(var r=0,s=t.length;r<s;r++){t[r].getCenter().x<n[1].x?i[0].push(t[r]):i[1].push(t[r])}var o=[];o.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),o.push(this.fit(i[0].length.toString(),3)),o.push(this.fit(i[1].length.toString(),3)),o.push("\n");for(r=0;r<2;r++)for(var a=0,h=i[r].length;a<h;a++)o.push("$MOL\n"),o.push(_.writeMOL(i[r][a])),o.push("\n");return o.join("")}};var n=new t.RXNInterpreter;_.readRXN=function(t,e){return n.read(t,e)},_.writeRXN=function(t,e){return n.write(t,e)}}(zo,zo.io,zo.structures),function(o,t,a,e,h,l,i){e.XYZInterpreter=function(){};var n=e.XYZInterpreter.prototype=new e._Interpreter;n.deduceCovalentBonds=!0,n.read=function(t){var e=new h.Molecule;if(!t)return e;for(var i=t.split("\n"),n=parseInt(l(i[0])),r=0;r<n;r++){var s=i[r+2].split(/\s+/g);e.atoms[r]=new h.Atom(isNaN(s[0])?s[0]:a[parseInt(s[0])-1],parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]))}return this.deduceCovalentBonds&&(new o.informatics.BondDeducer).deduceCovalentBonds(e,1),e};var r=new e.XYZInterpreter;o.readXYZ=function(t){return r.read(t)}}(zo,zo.ELEMENT,zo.SYMBOLS,zo.io,zo.structures,zo.lib.jQuery.trim),zo.monitor=et,Io=zo.io,Lo=document,No=window,Io.png={},Io.png.string=function(t){return Lo.getElementById(t.id).toDataURL("image/png")},Io.png.open=function(t){No.open(this.string(t))},ko=zo.io,Oo=zo.lib.jQuery,ko.file={},ko.file.content=function(t,e){Oo.get(t,"",e)}}],r.c=o,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)).ChemDoodle;function r(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,o});